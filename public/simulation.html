<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å­¦ç¿’é€²æ—ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 40px;
      text-align: center;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.1em;
      opacity: 0.9;
    }

    .content {
      padding: 40px;
    }

    .settings-section {
      margin-bottom: 40px;
    }

    .settings-section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.5em;
    }

    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .setting-item {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 12px;
      border: 2px solid transparent;
      transition: all 0.3s;
    }

    .setting-item:hover {
      border-color: #667eea;
      transform: translateY(-2px);
    }

    .setting-label {
      font-weight: 600;
      color: #333;
      margin-bottom: 10px;
      display: block;
    }

    .setting-select {
      width: 100%;
      padding: 12px;
      border: 2px solid #dee2e6;
      border-radius: 8px;
      font-size: 1em;
      background: white;
      cursor: pointer;
      transition: border-color 0.3s;
    }

    .setting-select:focus {
      outline: none;
      border-color: #667eea;
    }

    .current-value {
      display: block;
      margin-top: 8px;
      font-size: 0.9em;
      color: #666;
    }

    .total-words {
      background: #e8f5e9;
      padding: 20px;
      border-radius: 12px;
      border-left: 4px solid #4caf50;
      margin-bottom: 30px;
    }

    .total-words h3 {
      color: #2e7d32;
      margin-bottom: 10px;
    }

    .total-words .value {
      font-size: 2.5em;
      font-weight: bold;
      color: #4caf50;
    }

    .start-button {
      width: 100%;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.3em;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .start-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }

    .start-button:active {
      transform: translateY(0);
    }

    .chart-section {
      margin-top: 40px;
      padding: 30px;
      background: #f8f9fa;
      border-radius: 12px;
    }

    .chart-section h2 {
      color: #667eea;
      margin-bottom: 20px;
    }

    .chart-container {
      position: relative;
      height: 400px;
      background: white;
      padding: 20px;
      border-radius: 12px;
    }

    .legend {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .legend-color {
      width: 20px;
      height: 20px;
      border-radius: 4px;
    }

    .legend-color-new { background: #6366f1; }
    .legend-color-mastered { background: #10b981; }
    .legend-color-still-learning { background: #f59e0b; }
    .legend-color-incorrect { background: #ef4444; }

    .legend-label {
      font-size: 0.9em;
      color: #666;
    }

    .stats-section {
      margin-top: 30px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
    }

    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      border: 2px solid #dee2e6;
    }

    .stat-value {
      font-size: 2em;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.9em;
      color: #666;
    }

    .color-new { color: #6366f1; }
    .color-mastered { color: #10b981; }
    .color-review { color: #f59e0b; }
    .color-learning { color: #ef4444; }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.8em;
      }

      .settings-grid {
        grid-template-columns: 1fr;
      }

      .content {
        padding: 20px;
      }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“Š å­¦ç¿’é€²æ—ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
      <p>åˆæœŸçŠ¶æ…‹ã‚’è¨­å®šã—ã¦å­¦ç¿’é€²æ—ã®æ¨ç§»ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™</p>
    </div>

    <div class="content">
      <div class="settings-section">
        <h2>ğŸ¯ åˆæœŸçŠ¶æ…‹ã®è¨­å®š</h2>

        <div class="settings-grid">
          <div class="setting-item">
            <label class="setting-label">ğŸ“˜ æœªå­¦ç¿’ï¼ˆnewï¼‰</label>
            <select class="setting-select" id="newWords" aria-label="æœªå­¦ç¿’å˜èªæ•°ã‚’é¸æŠ">
              <option value="10">10èª</option>
              <option value="20">20èª</option>
              <option value="30">30èª</option>
              <option value="40">40èª</option>
              <option value="50">50èª</option>
              <option value="75">75èª</option>
              <option value="100" selected>100èª</option>
              <option value="200">200èª</option>
              <option value="300">300èª</option>
              <option value="500">500èª</option>
              <option value="750">750èª</option>
              <option value="1000">1000èª</option>
              <option value="2000">2000èª</option>
              <option value="3000">3000èª</option>
            </select>
            <span class="current-value">ç¾åœ¨: <span id="newValue">100</span>èª</span>
          </div>

          <div class="setting-item">
            <label class="setting-label">âœ… å®šç€æ¸ˆï¼ˆmasteredï¼‰</label>
            <select class="setting-select" id="masteredWords" aria-label="å®šç€æ¸ˆå˜èªæ•°ã‚’é¸æŠ">
              <option value="10" selected>10èª</option>
              <option value="20">20èª</option>
              <option value="30">30èª</option>
              <option value="40">40èª</option>
              <option value="50">50èª</option>
              <option value="75">75èª</option>
              <option value="100">100èª</option>
              <option value="200">200èª</option>
              <option value="300">300èª</option>
              <option value="500">500èª</option>
              <option value="750">750èª</option>
              <option value="1000">1000èª</option>
              <option value="2000">2000èª</option>
              <option value="3000">3000èª</option>
            </select>
            <span class="current-value">ç¾åœ¨: <span id="masteredValue">10</span>èª</span>
          </div>

          <div class="setting-item">
            <label class="setting-label">âš ï¸ è¦å¾©ç¿’ï¼ˆstill_learningï¼‰</label>
            <select class="setting-select" id="reviewWords" aria-label="è¦å¾©ç¿’å˜èªæ•°ã‚’é¸æŠ">
              <option value="10">10èª</option>
              <option value="20">20èª</option>
              <option value="30">30èª</option>
              <option value="40" selected>40èª</option>
              <option value="50">50èª</option>
              <option value="75">75èª</option>
              <option value="100">100èª</option>
              <option value="200">200èª</option>
              <option value="300">300èª</option>
              <option value="500">500èª</option>
              <option value="750">750èª</option>
              <option value="1000">1000èª</option>
              <option value="2000">2000èª</option>
              <option value="3000">3000èª</option>
            </select>
            <span class="current-value">ç¾åœ¨: <span id="reviewValue">40</span>èª</span>
          </div>

          <div class="setting-item">
            <label class="setting-label">âŒ å­¦ç¿’ä¸­ï¼ˆincorrectï¼‰</label>
            <select class="setting-select" id="learningWords" aria-label="å­¦ç¿’ä¸­å˜èªæ•°ã‚’é¸æŠ">
              <option value="10">10èª</option>
              <option value="20">20èª</option>
              <option value="30" selected>30èª</option>
              <option value="40">40èª</option>
              <option value="50">50èª</option>
              <option value="75">75èª</option>
              <option value="100">100èª</option>
              <option value="200">200èª</option>
              <option value="300">300èª</option>
              <option value="500">500èª</option>
              <option value="750">750èª</option>
              <option value="1000">1000èª</option>
              <option value="2000">2000èª</option>
              <option value="3000">3000èª</option>
            </select>
            <span class="current-value">ç¾åœ¨: <span id="learningValue">30</span>èª</span>
          </div>
        </div>

        <div class="total-words">
          <h3>ğŸ“š åˆè¨ˆå˜èªæ•°</h3>
          <div class="value" id="totalWords">180</div>
        </div>

        <button class="start-button" id="startButton">
          ğŸš€ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
        </button>
      </div>

      <div class="chart-section">
        <h2>ğŸ“ˆ å­¦ç¿’é€²æ—ã‚°ãƒ©ãƒ•</h2>
        <div class="chart-container">
          <canvas id="progressChart"></canvas>
        </div>
        <div class="legend">
          <div class="legend-item">
            <div class="legend-color legend-color-new"></div>
            <span class="legend-label">æœªå­¦ç¿’ (new)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color legend-color-mastered"></div>
            <span class="legend-label">å®šç€æ¸ˆ (mastered)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color legend-color-still-learning"></div>
            <span class="legend-label">è¦å¾©ç¿’ (still_learning)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color legend-color-incorrect"></div>
            <span class="legend-label">å­¦ç¿’ä¸­ (incorrect)</span>
          </div>
        </div>

        <div class="stats-section">
          <div class="stat-card">
            <div class="stat-value color-new" id="statNew">-</div>
            <div class="stat-label">æœªå­¦ç¿’å‰²åˆ</div>
          </div>
          <div class="stat-card">
            <div class="stat-value color-mastered" id="statMastered">-</div>
            <div class="stat-label">å®šç€æ¸ˆå‰²åˆ</div>
          </div>
          <div class="stat-card">
            <div class="stat-value color-review" id="statReview">-</div>
            <div class="stat-label">è¦å¾©ç¿’å‰²åˆ</div>
          </div>
          <div class="stat-card">
            <div class="stat-value color-learning" id="statLearning">-</div>
            <div class="stat-label">å­¦ç¿’ä¸­å‰²åˆ</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let chart = null;

    // è¨­å®šå€¤ã®æ›´æ–°
    function updateValues() {
      const newWords = parseInt(document.getElementById('newWords').value);
      const masteredWords = parseInt(document.getElementById('masteredWords').value);
      const reviewWords = parseInt(document.getElementById('reviewWords').value);
      const learningWords = parseInt(document.getElementById('learningWords').value);

      document.getElementById('newValue').textContent = newWords;
      document.getElementById('masteredValue').textContent = masteredWords;
      document.getElementById('reviewValue').textContent = reviewWords;
      document.getElementById('learningValue').textContent = learningWords;

      const total = newWords + masteredWords + reviewWords + learningWords;
      document.getElementById('totalWords').textContent = total;

      updateStats(newWords, masteredWords, reviewWords, learningWords, total);
    }

    // çµ±è¨ˆè¡¨ç¤ºã®æ›´æ–°
    function updateStats(newWords, mastered, review, learning, total) {
      document.getElementById('statNew').textContent =
        `${((newWords / total) * 100).toFixed(1)}%`;
      document.getElementById('statMastered').textContent =
        `${((mastered / total) * 100).toFixed(1)}%`;
      document.getElementById('statReview').textContent =
        `${((review / total) * 100).toFixed(1)}%`;
      document.getElementById('statLearning').textContent =
        `${((learning / total) * 100).toFixed(1)}%`;
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
    document.getElementById('newWords').addEventListener('change', updateValues);
    document.getElementById('masteredWords').addEventListener('change', updateValues);
    document.getElementById('reviewWords').addEventListener('change', updateValues);
    document.getElementById('learningWords').addEventListener('change', updateValues);

    // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
    document.getElementById('startButton').addEventListener('click', runSimulation);

    // åˆæœŸã‚°ãƒ©ãƒ•ã®æç”»
    function initChart() {
      const ctx = document.getElementById('progressChart').getContext('2d');

      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['åˆæœŸçŠ¶æ…‹'],
          datasets: [
            {
              label: 'æœªå­¦ç¿’ (new)',
              data: [100],
              borderColor: '#6366f1',
              backgroundColor: 'rgba(99, 102, 241, 0.1)',
              tension: 0.4,
              fill: true
            },
            {
              label: 'å®šç€æ¸ˆ (mastered)',
              data: [10],
              borderColor: '#10b981',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              tension: 0.4,
              fill: true
            },
            {
              label: 'è¦å¾©ç¿’ (still_learning)',
              data: [40],
              borderColor: '#f59e0b',
              backgroundColor: 'rgba(245, 158, 11, 0.1)',
              tension: 0.4,
              fill: true
            },
            {
              label: 'å­¦ç¿’ä¸­ (incorrect)',
              data: [30],
              borderColor: '#ef4444',
              backgroundColor: 'rgba(239, 68, 68, 0.1)',
              tension: 0.4,
              fill: true
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            },
            title: {
              display: true,
              text: 'å­¦ç¿’é€²æ—ã®æ¨ç§»',
              font: {
                size: 16
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'å˜èªæ•°'
              }
            },
            x: {
              title: {
                display: true,
                text: 'å­¦ç¿’ã‚¹ãƒ†ãƒƒãƒ—'
              }
            }
          }
        }
      });
    }

    // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
    function runSimulation() {
      const newWords = parseInt(document.getElementById('newWords').value);
      const mastered = parseInt(document.getElementById('masteredWords').value);
      const review = parseInt(document.getElementById('reviewWords').value);
      const learning = parseInt(document.getElementById('learningWords').value);

      // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆï¼ˆ100ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
      const steps = 100;
      const labels = ['åˆæœŸ'];
      const newData = [newWords];
      const masteredData = [mastered];
      const reviewData = [review];
      const learningData = [learning];

      // ç°¡æ˜“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šå­¦ç¿’ãŒé€²ã‚€ã«ã¤ã‚Œã¦çŠ¶æ…‹ãŒå¤‰åŒ–
      for (let i = 1; i <= steps; i++) {
        labels.push(`Step ${i}`);

        // å­¦ç¿’ä¸­ â†’ è¦å¾©ç¿’ â†’ å®šç€æ¸ˆ ã®æµã‚Œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
        const learningToReview = Math.floor(learningData[i-1] * 0.05);
        const reviewToMastered = Math.floor(reviewData[i-1] * 0.03);
        const newToLearning = Math.floor(newData[i-1] * 0.02);

        newData.push(Math.max(0, newData[i-1] - newToLearning));
        learningData.push(Math.max(0, learningData[i-1] - learningToReview + newToLearning));
        reviewData.push(Math.max(0, reviewData[i-1] - reviewToMastered + learningToReview));
        masteredData.push(masteredData[i-1] + reviewToMastered);
      }

      // ã‚°ãƒ©ãƒ•ã®æ›´æ–°
      chart.data.labels = labels;
      chart.data.datasets[0].data = newData;
      chart.data.datasets[1].data = masteredData;
      chart.data.datasets[2].data = reviewData;
      chart.data.datasets[3].data = learningData;
      chart.update();

      // æœ€çµ‚çŠ¶æ…‹ã§çµ±è¨ˆã‚’æ›´æ–°
      const total = newData[steps] + masteredData[steps] + reviewData[steps] + learningData[steps];
      updateStats(newData[steps], masteredData[steps], reviewData[steps], learningData[steps], total);

      // ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´
      document.getElementById('startButton').textContent = 'ğŸ”„ å†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³';
    }

    // åˆæœŸåŒ–
    window.addEventListener('load', () => {
      initChart();
      updateValues();
    });
  </script>
</body>
</html>
