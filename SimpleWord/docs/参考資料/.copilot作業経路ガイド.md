# .copilot 作業経路ガイド

最終更新: 2025年10月20日

---

## 📋 目次

1. [.copilotフォルダとは](#copilotフォルダとは)
2. [作業開始前の必須チェック](#作業開始前の必須チェック)
3. [作業規模別の経路](#作業規模別の経路)
4. [AI自動化システムの使い方](#ai自動化システムの使い方)
5. [ドキュメント体系](#ドキュメント体系)
6. [よくある作業パターン](#よくある作業パターン)
7. [トラブルシューティング](#トラブルシューティング)

---

## 📁 .copilotフォルダとは

SimpleWordプロジェクトの`.copilot/`ディレクトリは、**AI（GitHub Copilot）との協働作業を効率化**するための完全な作業ガイドシステムです。

### フォルダ構成

```
.copilot/
├── README.md                          # 📘 メインガイド（最初に読むべき）
├── AI-TRIGGER-GUIDE.md                # 🤖 自動化トリガーガイド
├── structure-map.md                   # 🗺️ アーキテクチャマップ
├── quick-ref.md                       # ⚡ クイックリファレンス
├── changelog.md                       # 📝 変更履歴
├── task-template.md                   # 📋 タスクテンプレート
├── auto-version-config.json           # ⚙️ 自動バージョン設定
│
├── prompts/                           # 🎯 作業別プロンプト集
│   ├── add-feature.md                 # 新機能追加
│   ├── fix-bug.md                     # バグ修正
│   ├── refactor-component.md          # リファクタリング
│   ├── auto-versioning.md             # 自動バージョン管理
│   └── ...
│
├── scripts/                           # 🛠️ 自動化スクリプト
│   └── auto-version.sh                # 自動バージョン管理
│
├── versions/                          # 📦 バージョン履歴
│   └── v*.md                          # 各バージョンの詳細
│
└── components/                        # 🧩 コンポーネント詳細
    └── ...
```

---

## ✅ 作業開始前の必須チェック

### 🎯 セッション開始時の推奨アクション

作業を始める前に、以下のコマンドをAIに伝えてください：

```
「.copilot/structure-map.md を確認してください」
```

これにより、AIが現在のプロジェクト構造を把握し、適切な作業を行えます。

### 📚 作業規模の判断

| 変更規模 | 目安 | 参照すべきファイル |
|---------|------|------------------|
| **小規模** | 100行以内 | `quick-ref.md` |
| **中規模** | 100-999行 | `structure-map.md` + `prompts/add-feature.md` |
| **大規模** | 1000行以上 | `structure-map.md` + `prompts/refactor-component.md` |

---

## 🛣️ 作業規模別の経路

### 🟢 小規模変更（100行以内）

**例**: バグ修正、微調整、スタイル変更

#### 作業フロー

```mermaid
graph LR
    A[作業開始] --> B[quick-ref.md 確認]
    B --> C[実装]
    C --> D[バージョン管理してください]
    D --> E[完了]
```

#### 手順

1. **パターン確認**
   ```
   AIに伝える: 「.copilot/quick-ref.md を参照してください」
   ```

2. **実装**
   - 既存のコーディング規約に従う
   - 日本語コメントで意図を明記

3. **自動バージョン管理**
   ```
   AIに伝える: 「バージョン管理してください」
   ```
   → AIがすべて自動で実行！

---

### 🟡 中規模変更（100-999行）

**例**: 新機能追加、既存機能の拡張

#### 作業フロー

```mermaid
graph LR
    A[作業開始] --> B[structure-map.md 確認]
    B --> C[影響範囲の特定]
    C --> D[add-feature.md 参照]
    D --> E[実装]
    E --> F[バージョン管理してください]
    F --> G[完了]
```

#### 手順

1. **全体構造の把握**
   ```
   AIに伝える: 「.copilot/structure-map.md を確認してください」
   ```

2. **影響範囲の特定**
   - どのファイルを変更するか
   - どのStoreやServiceに影響があるか
   - 依存関係の確認

3. **作業手順の確認**
   ```
   AIに伝える: 「.copilot/prompts/add-feature.md に従ってください」
   ```

4. **実装**
   - Feature-First アーキテクチャに従う
   - 責務分離を徹底
   - テスタビリティを考慮

5. **自動バージョン管理**
   ```
   AIに伝える: 「バージョン管理してください」
   ```

---

### 🔴 大規模変更（1000行以上）

**例**: アーキテクチャ変更、大規模リファクタリング

#### 作業フロー

```mermaid
graph LR
    A[作業開始] --> B[structure-map.md 熟読]
    B --> C[フェーズ分割計画]
    C --> D[refactor-component.md 参照]
    D --> E[フェーズ1実装]
    E --> F[バージョン管理]
    F --> G[フェーズ2実装]
    G --> H[バージョン管理]
    H --> I[完了]
```

#### 手順

1. **全体像の完全把握**
   ```
   AIに伝える: 「.copilot/structure-map.md を詳細に分析してください」
   ```

2. **フェーズ分割計画**
   - 変更を複数のフェーズに分割
   - 各フェーズで動作確認できる単位に
   - 依存関係を考慮した順序

3. **リファクタリング手順の確認**
   ```
   AIに伝える: 「.copilot/prompts/refactor-component.md に従ってください」
   ```

4. **フェーズごとに実装**
   - 1フェーズずつ確実に実装
   - 各フェーズ完了時にビルドテスト

5. **各フェーズでバージョン管理**
   ```
   AIに伝える: 「バージョン管理してください」
   ```

---

## 🤖 AI自動化システムの使い方

### ⚡ 最重要機能: 自動バージョン管理

**たった一言で、すべてが自動化されます！**

### トリガーフレーズ

以下のいずれかを言うだけ：

```
✅ "バージョン管理してください"
✅ "バージョン管理して"
✅ "バージョニングしてください"
✅ "新しいバージョンを作成"
✅ "リリース準備"
✅ "ブランチを切って"
```

### AIが自動実行する内容（全9ステップ）

1. **📊 変更内容の分析**
   - 変更行数の計算
   - 変更ファイル数のカウント
   - 変更タイプの判定

2. **🔢 バージョン番号の自動決定**
   - 1000行以上 → メジャーアップデート（例: v1.0.0）
   - 100-999行 → マイナーアップデート（例: v0.6.0）
   - 1-99行 → パッチアップデート（例: v0.5.1）

3. **🌿 ブランチの自動作成**
   - 命名規則: `v{version}_{type}/{description}`
   - 例: `v1.2.0_feature/quizview-complete`

4. **💾 コミットとタグの自動作成**
   - 意味のあるコミットメッセージを自動生成
   - バージョンタグを自動付与

5. **📄 ドキュメントの自動生成**
   - `.copilot/versions/v{version}-{description}.md` 作成
   - 変更内容のサマリー、統計情報を含む

6. **📝 Changelogの自動更新**
   - `.copilot/changelog.md` に変更履歴を追記
   - 日付、バージョン、変更内容を記録

7. **🗺️ Structure Mapの自動更新**
   - `.copilot/structure-map.md` を最新状態に更新
   - 変更箇所のハイライト

8. **🔨 ビルドテストの自動実行**
   - Xcodeビルドを自動実行
   - 結果を記録

9. **📊 完了レポートの表示**
   - 実行内容のサマリー
   - 次のステップの提案

### 実行例

```
ユーザー: 「バージョン管理してください」

AI: 「承知しました。自動バージョン管理を実行します。」

[AIが自動で実行]
✅ 変更内容を分析しました（264行、5ファイル）
✅ バージョン番号を決定しました: v1.2.0
✅ ブランチを作成しました: v1.2.0_feature/quizview-complete
✅ コミットを作成しました: c7ad702
✅ タグを作成しました: v1.2.0
✅ ドキュメントを生成しました
✅ ビルドテストを実行しました: BUILD SUCCEEDED

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  バージョン管理完了レポート
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
バージョン: v1.2.0
ブランチ: v1.2.0_feature/quizview-complete
変更: 264行、5ファイル
ビルド: ✅ SUCCESS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

完了しました！
```

**ユーザーは何もする必要がありません！**

---

## 📚 ドキュメント体系

### レベル1: クイックリファレンス（すぐに使える）

| ファイル | 用途 | いつ使う？ |
|---------|------|-----------|
| `quick-ref.md` | よく使う実装パターン | 小規模な実装時 |
| `AI-TRIGGER-GUIDE.md` | 自動化トリガー一覧 | 自動化を使いたい時 |

### レベル2: アーキテクチャ（構造を理解する）

| ファイル | 用途 | いつ使う？ |
|---------|------|-----------|
| `structure-map.md` | プロジェクト全体構造 | 作業開始時、影響範囲の確認 |
| `changelog.md` | 変更履歴 | 過去の変更を追跡 |

### レベル3: 作業手順（詳細な手順）

| ファイル | 用途 | いつ使う？ |
|---------|------|-----------|
| `prompts/add-feature.md` | 新機能追加の手順 | 新機能を追加する時 |
| `prompts/fix-bug.md` | バグ修正の手順 | バグを修正する時 |
| `prompts/refactor-component.md` | リファクタリング手順 | 大規模な変更時 |
| `prompts/auto-versioning.md` | 自動バージョン管理 | AIが内部で使用 |

### レベル4: バージョン履歴（過去を振り返る）

| ファイル | 用途 | いつ使う？ |
|---------|------|-----------|
| `versions/v*.md` | 各バージョンの詳細 | 特定バージョンの変更内容を確認 |

---

## 🎯 よくある作業パターン

### パターン1: 新機能を追加したい

```
1. AIに伝える: 「.copilot/structure-map.md を確認してください」
2. AIに伝える: 「○○機能を追加したいです」
3. [AIが影響範囲を分析]
4. [実装]
5. AIに伝える: 「バージョン管理してください」
```

### パターン2: バグを修正したい

```
1. AIに伝える: 「.copilot/quick-ref.md を参照してください」
2. AIに伝える: 「○○のバグを修正したいです」
3. [実装]
4. AIに伝える: 「バージョン管理してください」
```

### パターン3: コードをリファクタリングしたい

```
1. AIに伝える: 「.copilot/structure-map.md を詳細に分析してください」
2. AIに伝える: 「○○をリファクタリングしたいです」
3. [AIがフェーズ分割を提案]
4. [フェーズ1を実装]
5. AIに伝える: 「バージョン管理してください」
6. [フェーズ2を実装]
7. AIに伝える: 「バージョン管理してください」
```

### パターン4: 過去の変更を確認したい

```
AIに伝える: 「.copilot/changelog.md で○○の変更を確認してください」
```

### パターン5: 特定のバージョンの詳細を知りたい

```
AIに伝える: 「.copilot/versions/v1.2.0-*.md を表示してください」
```

---

## 🔧 トラブルシューティング

### 問題1: AIが適切な作業を提案してくれない

**解決策**:
```
AIに伝える: 「.copilot/structure-map.md を確認してください」
```
→ AIがプロジェクト構造を把握し、適切な提案ができるようになります。

### 問題2: 変更履歴が分からない

**解決策**:
```
AIに伝える: 「.copilot/changelog.md を表示してください」
```

### 問題3: バージョン管理が自動実行されない

**解決策**:
```
正確にトリガーフレーズを伝える:
「バージョン管理してください」
```

### 問題4: どのファイルを変更すべきか分からない

**解決策**:
```
1. AIに伝える: 「.copilot/structure-map.md を確認してください」
2. AIに伝える: 「○○を実装するには、どのファイルを変更すべきですか？」
```

### 問題5: 過去の実装パターンを知りたい

**解決策**:
```
AIに伝える: 「.copilot/quick-ref.md で○○のパターンを確認してください」
```

---

## 📖 実践例: QuizViewに新しいアニメーションを追加

### ステップ1: 構造を確認

```
ユーザー: 「.copilot/structure-map.md を確認して、QuizViewのアニメーション実装を確認してください」
```

### ステップ2: パターンを参照

```
ユーザー: 「.copilot/quick-ref.md のアニメーションパターンを参照してください」
```

### ステップ3: 実装

```swift
// QuizView.swift
@State private var shouldAnimateNewFeature: Bool = false

// アニメーションをトリガー
private func triggerAnimation() {
    shouldAnimateNewFeature = true
    DispatchQueue.main.asyncAfter(deadline: .now() + 1.2) {
        self.shouldAnimateNewFeature = false
    }
}

// Viewに適用
Text("新機能")
    .scaleEffect(shouldAnimateNewFeature ? 1.3 : 1.0)
    .animation(.spring(), value: shouldAnimateNewFeature)
```

### ステップ4: バージョン管理

```
ユーザー: 「バージョン管理してください」

AI: [自動実行]
✅ v1.2.1_feature/add-new-animation
✅ ドキュメント生成
✅ ビルドテスト成功
✅ 完了！
```

---

## 🎓 ベストプラクティス

### ✅ DO（推奨）

1. **作業開始時に必ずstructure-mapを確認**
   - プロジェクト全体像を把握
   - 影響範囲を事前に理解

2. **小さな単位で頻繁にバージョン管理**
   - 問題が起きても戻しやすい
   - 変更履歴が明確

3. **トリガーフレーズを正確に使う**
   - AIが確実に認識できる
   - 自動化がスムーズに実行

4. **quick-refを積極的に活用**
   - 既存のパターンを再利用
   - 一貫性のあるコード

5. **changelogを定期的に確認**
   - 過去の変更を理解
   - 同じミスを繰り返さない

### ❌ DON'T（非推奨）

1. **structure-mapを確認せずに大規模変更**
   - 予期しない影響が発生
   - リファクタリングが必要に

2. **バージョン管理をせずに大量の変更**
   - 問題が起きた時に戻せない
   - 変更履歴が不明確

3. **既存のパターンを無視**
   - コードの一貫性が損なわれる
   - 保守性が低下

4. **ドキュメントの更新忘れ**
   - 次回の作業が困難に
   - AIが適切な提案をできない

---

## 🚀 まとめ

### SimpleWordプロジェクトでの作業フロー

```
1. 作業開始
   ↓
2. 「.copilot/structure-map.md を確認してください」
   ↓
3. 実装（quick-ref.md や prompts/ を参照）
   ↓
4. 「バージョン管理してください」
   ↓
5. 完了！
```

### 最も重要なこと

**「バージョン管理してください」と言うだけで、AIがすべてを自動化してくれます！**

---

## 📞 サポート

このガイドで解決できない問題がある場合：

1. `.copilot/README.md` を確認
2. `.copilot/AI-TRIGGER-GUIDE.md` を確認
3. `.copilot/changelog.md` で類似の変更を検索

---

**最終更新: 2025年10月20日**
**バージョン: 1.0.0**
