# Copilot Instructions - 🚨 CRITICAL RULES 🚨

## ⏱️ 作業管理ルール: MANDATORY

**全作業開始前に必読**: `docs/.copilot-work-management.md`

### 強制ルール

1. **15分ルール**: 15分以内にコミット可能な単位で作業
2. **段階的実施**: 大規模タスクは必ず分割（Step 1, 2, 3...）
3. **進捗記録**: 作業中は`docs/.copilot-work-management.md`の「作業履歴」に記録
4. **即座報告**: タスク完了時は即座にユーザーに報告（追加作業を探さない）

### 自動中断トリガー

- 15分でコミット未完了 → 中断して進捗記録
- 同一ツール3回連続失敗 → アプローチ変更
- ユーザー待機2分以上 → 代替タスク提案

---

## �️ 仕様書遵守ルール: CRITICAL

**詳細**: `.aitk/instructions/specification-enforcement.instructions.md`

### 絶対原則

**ユーザーの明示的な指示がない限り、既存の仕様・設定値を変更してはならない**

### 変更禁止の例

- 理由付きの設定値（「調整済み」「最適化済み」等のコメント）
- デフォルト値・定数
- レイアウト構造（flex, grid, gap, margin, padding等）
- スタイル値（border-radius, transition等）

### 質問 ≠ 変更指示

- 「流暢な音声はないか？」→ 速度変更ではなく、品質改善を提案
- 「見やすくできないか？」→ レイアウト変更ではなく、問題点を質問

---

## �🔒 強制作業ルール: 仕様確認プロトコル

**全ての作業において以下のプロトコルを厳守すること**

### 1. 変更前の必須確認手順

```
1. read_fileで現状のコードを必ず確認
2. 「〇〇と同じ」と指示された場合、その〇〇も必ずread_fileで確認
3. 変更内容を具体的に明示してから実行
4. 不明点は推測せず即座に質問
```

### 2. 禁止事項

- ❌ 推測や憶測による作業
- ❌ 記憶に基づく作業（必ず最新のコードを読む）
- ❌ 一部だけの確認（参照元も必ず確認）
- ❌ 説明なしの変更実行

### 3. 違反時のペナルティ

- トークン消費の増大
- ユーザーの信頼喪失
- 作業のやり直し

**このルールは全ての作業に優先して適用される**

---

## ⛔ 絶対禁止: ダークモードの使用禁止

**現在の方針: ダークモードは使用しない**

```tsx
// ❌ 絶対禁止 - dark:プレフィックスを使用してはいけない
<div className="bg-white dark:bg-gray-800">
<button className="text-gray-900 dark:text-gray-100">

// ✅ 正解 - ライトモードのみ
<div className="bg-white">
<button className="text-gray-900">
```

**理由:**

- ダークモード機能は再開発の余地として残しているが、現在は使用しない
- 将来的に必要になれば、ユーザーからの明示的な指示の下で再実装する

**違反時:**

- コミット前チェックでブロックされる
- 即座にrevertが必要

---

## ⚠️ 旧ルール（現在は無効）

以下のルールは**現在使用していません**。参考として残しています。

### 1. 旧原則（無効）

- ~~ライトモードの変更は dark: プレフィックスを含むクラスに絶対に影響させない~~
- ~~ダークモードの変更は dark: プレフィックスなしのクラスに絶対に影響させない~~
- ~~両モードは完全に独立したスタイル定義を持つ~~

### 2. Tailwind CSS クラス使用規則

#### ✅ 正しい記述方法

```tsx
// 背景色
className = 'bg-white dark:bg-gray-800';

// テキスト色
className = 'text-gray-900 dark:text-gray-100';

// 枠線
className = 'border-gray-300 dark:border-gray-600';
```

#### ❌ 禁止事項

```tsx
// インラインスタイルで固定値を使用
style={{ backgroundColor: 'white' }}
style={{ color: 'var(--text-color)' }}

// CSS変数だけに依存（モード分離不可）
style={{ backgroundColor: 'var(--bg-primary)' }}
```

### 3. CSSファイルでのダークモード定義

#### ✅ 正しい構造

```css
/* ライトモード（デフォルト） */
.my-component {
  background: var(--gray-100);
  color: var(--gray-900);
}

/* ダークモード（完全分離） */
.dark-mode .my-component {
  background: var(--gray-800);
  color: var(--gray-100);
}
```

#### ❌ 禁止構造

```css
/* 両モードで同じ変数を共有 */
.my-component {
  background: var(--bg-primary); /* モード間で値が変わる変数 */
}
```

### 4. 色の選択ガイドライン

#### ライトモード

- 背景: `bg-white`, `bg-gray-50`, `bg-gray-100`, `bg-blue-50`
- テキスト: `text-gray-700`, `text-gray-800`, `text-gray-900`
- 枠線: `border-gray-200`, `border-gray-300`

#### ダークモード

- 背景: `dark:bg-gray-800`, `dark:bg-gray-900`, `dark:bg-black`
- テキスト: `dark:text-gray-100`, `dark:text-gray-200`, `dark:text-gray-300`
- 枠線: `dark:border-gray-600`, `dark:border-gray-700`

### 5. 変更時のチェックリスト

#### ライトモード変更時

- [ ] `dark:` プレフィックスを含むクラスを変更していないか
- [ ] `.dark-mode` セレクタ内のCSSを変更していないか
- [ ] 変更がライトモードのみに影響することを確認

#### ダークモード変更時

- [ ] `dark:` プレフィックスなしのクラスを変更していないか
- [ ] ベースのCSSセレクタ（`.dark-mode`なし）を変更していないか
- [ ] 変更がダークモードのみに影響することを確認

### 6. コンポーネント作成時の必須パターン

```tsx
// 全てのコンポーネントは両モード対応必須
<div
  className="
  bg-white dark:bg-gray-800
  text-gray-900 dark:text-gray-100
  border-gray-300 dark:border-gray-600
"
>
  <p className="text-gray-700 dark:text-gray-300">Content</p>
</div>
```

### 7. インラインスタイル変換ルール

インラインスタイルを見つけた場合、即座にTailwindクラスに変換：

```tsx
// 変換前
<div style={{ backgroundColor: 'white', color: 'black' }}>

// 変換後
<div className="bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
```

### 8. レビュー時の確認項目

コード変更時は以下を必ず確認：

1. すべての背景色に `dark:` バリアントがあるか
1. すべてのテキスト色に `dark:` バリアントがあるか
1. すべての枠線色に `dark:` バリアントがあるか
1. インラインスタイルで色を固定していないか
1. CSS変数の使用が適切か（モード分離されているか）

### 9. 禁止される変更パターン

```tsx
// ❌ 片方のモードだけ変更
className="bg-white" // dark: がない

// ❌ 両モードに影響する変更
style={{ backgroundColor: 'var(--background)' }} // CSS変数で両モード共有

// ❌ モード分離されていないCSS
.component { background: white; } // .dark-mode セレクタがない
```

### 10. エラー防止のための自動チェック

変更前に必ず実行：

```bash
# dark: プレフィックスの対応を確認
grep -r "className=" src/ | grep -v "dark:"

# インラインスタイルの色指定を検出
grep -r "style={{" src/ | grep -E "color|background"
```

## まとめ

**すべての色関連のスタイルは、ライトモードとダークモードで完全に独立した定義を持つこと。**
**一方のモード変更が他方に影響することは絶対に許容されない。**
