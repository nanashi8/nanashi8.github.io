# 例示選択法（Pattern Selection Method）

## 概要

**例示選択法**は、抽象的な要件を具体例のパターン選択を通じて明確化する対話的な要件定義手法です。

AIアシスタントと開発者が協力して、曖昧な仕様を段階的に確定させることができます。

## なぜ必要か？

### 従来の問題点

- 抽象的な指示（「適切に分割して」など）では実装がブレる
- 開発者の意図とAIの解釈にズレが生じる
- 実装後の修正コストが高い

### 例示選択法の利点

✅ **具体例で意図が明確になる**  
✅ **選択式なので判断が簡単**  
✅ **パターンから自動的にルールが導出される**  
✅ **実装前に仕様が確定する**

## 手法の流れ

### 1. 問題の提示
開発者が抽象的な要件を提示する

**例:**
```
「/分割タブで適切に文を分割してください」
```

### 2. 具体例の生成（AI側）
AIが実データから複数のパターン例を作成

**例:**
```
例文1: "We can give food to them."

パターンA: We can give / food / to them.
パターンB: We can give food / to them.
パターンC: We can give food to them.

→ どれが良いですか？
```

### 3. パターン選択（開発者側）
開発者が好みのパターンを選択

**例:**
```
パターンBが良い
```

### 4. パターンの蓄積
複数の例文で選択を繰り返し、パターンを蓄積

**例:**
```
例文1 → パターンB
例文2 → パターンA
例文3 → パターンA
例文4 → パターンC
...
```

### 5. ルールの推定（AI側）
選択されたパターンから共通ルールを抽出

**例:**
```
推定されたルール:
- 短い文（5語以下）は分割しない
- 接続詞の前で分割する
- 前置詞句の前で分割する
- 感嘆詞は分割しない
```

### 6. 最終確認
推定されたルールで実例を生成し、開発者が確認

**例:**
```
確定したルールでの出力:
"In our city, / we have a good zoo, Smile Zoo."

→ OKなら実装します
```

### 7. 実装
確定したルールに基づいて実装

## 実践例: /分割タブの仕様確定

### 対話履歴

#### ステップ1: 短い文の扱い
```
Q: "Good! I love elephants."
   A) Good! / I love / elephants.
   B) Good! / I love elephants.
   C) Good! I love elephants.

A: パターンC → 短い文は分割しない
```

#### ステップ2: 接続詞の扱い
```
Q: "It will start at eleven in the morning, and we can enjoy it for thirty minutes."
   A) It will start / at eleven / in the morning, / and we can enjoy it / for thirty minutes.
   B) It will start at eleven / in the morning, / and we can enjoy it / for thirty minutes.
   C) It will start at eleven in the morning, / and we can enjoy it for thirty minutes.

A: パターンA → 接続詞の前で分割
```

#### ステップ3: 前置詞句の扱い
```
Q: "We can give food to them."
   A) We can give / food / to them.
   B) We can give food / to them.
   C) We can give food to them.

A: パターンB → 前置詞句の前で分割
```

### 推定されたルール

1. **短い文は分割しない**（5語程度以下）
2. **接続詞の前で分割**（and, but, or, so, because, if, when など）
3. **前置詞句の前で分割**（at, in, on, by + 時間・場所表現）
4. **動詞の目的語フレーズは分割しない**（give food, take ID cards など）
5. **感嘆詞は分割しない**（Oh, Well など）

### 実装コード例

```typescript
const splitIntoChunks = (text: string) => {
  let result = text;
  
  // 接続詞の前に/を挿入
  result = result.replace(
    /(\s+)(and|but|or|so|because|if|when)(\s+)/gi,
    ' / $2$3'
  );

  // 前置詞句の前に/を挿入
  result = result.replace(
    /(\s+)(at|in|on|by)(\s+)(the|a|an)/g,
    ' / $2$3$4'
  );

  return result;
};
```

## 使い方

### AIへの指示例

**基本形:**
```
「例示選択法で確認してください」
```

**詳細指定:**
```
「パターン選択法で、J_2020_4.txtとJ_2022_5.txtを教材に使って詰めましょう」
```

### 効果的な使い方

1. **実データを使う**: 実際のユースケースに近いデータで例示
2. **段階的に詰める**: 簡単なケースから複雑なケースへ
3. **境界ケースを確認**: 例外的なケースも必ず確認
4. **最終確認を忘れない**: 推定ルールで実例を生成して確認

## 応用例

### ケース1: UIレイアウトの調整
```
Q: ボタンの配置はどれが良い？
   A) 横並び
   B) 縦並び
   C) グリッド状
```

### ケース2: データフォーマットの決定
```
Q: 日付表示はどれが良い？
   A) 2024-01-10
   B) 2024/01/10
   C) Jan 10, 2024
```

### ケース3: エラーメッセージの文体
```
Q: エラーメッセージはどれが良い？
   A) "ファイルが見つかりませんでした"
   B) "エラー: ファイルが存在しません"
   C) "指定されたファイルを読み込めません"
```

## ベストプラクティス

### ✅ 良い例

- 実データに基づく例示
- 3つ程度の明確な選択肢
- 段階的な確認（5〜10例程度）
- 最終確認での実例生成

### ❌ 避けるべき例

- 架空のデータでの例示
- 選択肢が多すぎる（4つ以上）
- 一度の確認で終わらせる
- 曖昧な選択肢

## 他の手法との比較

| 手法 | メリット | デメリット | 適用場面 |
|------|----------|------------|----------|
| **例示選択法** | 意図が明確、判断が簡単 | 複数回の対話が必要 | 曖昧な要件の明確化 |
| **自然言語指示** | 一度で伝わる | 解釈のブレが大きい | 明確な要件 |
| **仕様書作成** | 詳細まで記述可能 | 作成コストが高い | 大規模プロジェクト |

## まとめ

例示選択法は、**具体例による対話**を通じて**曖昧な要件を段階的に明確化**する手法です。

### 重要なポイント

1. 抽象的な要件 → 具体的なパターン例
2. 選択の繰り返し → ルールの推定
3. 最終確認 → 実装

### 次のステップ

この手法を使って、他の機能（()分割、直訳表示など）の仕様も明確化していきましょう。

## 関連ドキュメント

- [開発プロセス](README.md)
- [AI開発ガイドライン](../references/AI_WORKFLOW_INSTRUCTIONS.md)
- [コミュニケーション手法](COMMUNICATION_METHODS.md)

## 更新履歴

- 2026-01-10: 初版作成（/分割タブの仕様確定プロセスを基に）
