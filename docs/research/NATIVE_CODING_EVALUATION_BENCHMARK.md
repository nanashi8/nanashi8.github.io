# 母国語コーディング評価ベンチ設計（日本語特性を含む）

**作成日**: 2026年1月14日  
**ステータス**: ドラフト（フェーズA用）  
**目的**: 「日本語で意図を書く」ことの優位性/弱点を、再現可能な課題セットで測る

---

## 0. 評価の前提

- 評価対象は「生成コード」単体ではなく、**意図→仕様→差分→テスト→観測** のパイプライン
- したがって、スコアは複合（正しさ + 安全性 + 追跡性）
- ベンチは **失敗原因の分解** に使えること（UDD適合）

---

## 1. 何を比較するか（Baselines）

最低限、以下の条件で比較する。

- **B1: 日本語仕様 + 日本語運用（ターゲット）**
- **B2: 英語仕様 + 同一運用**（翻訳して同じ受け入れ条件を使う）
- **B3: 日本語仕様 + “確認質問禁止”**（曖昧さが事故になるかの対照）
- **B4: 人間実装（AIなし）**（速度と品質の下限）

注：モデル比較（国産モデル vs 海外モデル）はB1の内部で入れ替える。

---

## 2. 課題セット（Task Families）

### T1: 仕様抽出（日本語→スロット埋め）

入力：生の日本語要求（会話/メモ/要件断片）
出力：テンプレ（目的/制約/非目標/受け入れ条件/未確定点）に落とした仕様

評価：
- スロット充足率
- 制約の抜け漏れ
- 受け入れ条件の“測定可能性”

### T2: 曖昧さ検出と確認質問

入力：曖昧さを含む日本語仕様（意図的に作る）
出力：未確定点リスト + 優先度付き確認質問

評価：
- 重大曖昧さの検出率（Recall重視）
- 不要な質問の比率（Precision）
- 質問の「確定への寄与」

### T3: 変更生成（差分最小）

入力：確定仕様 + 既存コード
出力：レビュー可能な最小差分（PR単位）

評価：
- 差分の局所性（変更行数、影響範囲）
- 既存仕様との整合（回帰）
- セキュリティ/互換性の逸脱

### T4: テスト生成（受け入れ条件の具現化）

入力：受け入れ条件 + 変更差分
出力：単体/統合/回帰のテスト

評価：
- 受け入れ条件との対応率
- 失敗時の診断性（何が壊れたかが分かる）

### T5: ログと監査（追跡可能性）

入力：一連の作業履歴
出力：監査ログ（意図→仮定→差分→テスト→結果）

評価：
- 欠落の有無
- 再現可能性（同条件で再実行できるか）

---

## 3. 日本語特性を含むデータ設計

課題は、日本語の「強み」と「事故りポイント」を両方含める。

### 3-1. 日本語の強みを測るケース

- 粒度調整：抽象指示→具体指示への追従
- 専門語×日常語混在：用語辞書なしでも破綻しないか
- 背景説明の多い仕様：前提から制約を抽出できるか

### 3-2. 日本語の事故りポイントを測るケース（必須）

- 主語省略・指示語：それ/これ/あれ、誰が何をするか
- 程度表現：少し/自然に/適切に/早めに
- 優先度衝突：速度 vs 品質、互換 vs 改善
- 禁止事項の欠落：非目標が書かれていない

---

## 4. スコアリング（最小版）

フェーズAでは「完全自動採点」より「再現できる半自動採点」を優先。

### 4-1. 主要スコア

- **Intent Pass**：受け入れ条件を満たしたか（0/1）
- **Safety Pass**：回帰/互換/セキュリティで問題がないか（0/1）
- **Trace Pass**：監査ログが揃っているか（0/1）

### 4-2. 補助スコア（比較用）

- **Clarification Count**：確認質問数
- **Time-to-PR**：PR作成までの時間
- **Diff Size**：変更規模（LOC、ファイル数）
- **Test Coverage Proxy**：追加テスト数、失敗時診断性（定性）

---

## 5. 実施手順（フェーズA）

1. 課題を10〜30件用意（T1〜T4が混ざるように）
2. 各条件（B1〜B4）で実施
3. 各試行で監査ログを残す
4. 失敗を「未知分類」で原因分解する
5. 次の改善対象（曖昧さlintのルール、確認質問テンプレ、制約変換）を決める

このリポジトリ向けの課題集（ドラフト）:
- [NATIVE_CODING_BENCHMARK_TASKS_2026-01.md](NATIVE_CODING_BENCHMARK_TASKS_2026-01.md)

---

## 6. 成功判定（Go/No-Goの叩き台）

- B1がB4（人間のみ）より **Intent Passで劣らない**
- B1がB3（確認質問なし）より **Safety Passで明確に上回る**
- 監査ログが常に揃い、事故時に原因分解できる（Trace Passが高い）

---

## 付録：課題テンプレ（1件分）

- タスクID:
- 入力（日本語要求）:
- 期待する出力（受け入れ条件）:
- 想定する曖昧さポイント:
- 禁止事項（非目標）:
- 評価観点（Intent/Safety/Trace）:

