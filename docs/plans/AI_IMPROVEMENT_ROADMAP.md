# AI学習システム改善ロードマップ
**策定日**: 2025年12月20日  
**目標**: 業界トップクラスから次世代へ - 学習AI能力レベル（LACL）L4を目指す

## 📊 現状評価サマリー

### LACL（Learning AI Capability Level）定義
- **L1 基礎**: ルールベース、基本統計、手動評価
- **L2 実運用**: データ駆動適応、継続学習、A/B、監視
- **L3 先進**: 個別最適、確率校正、説明可能性、バイアス対策
- **L4 次世代**: 予測最適化＋探索、多目的最適化、形式検証

### 各モジュールの現状

| モジュール | 現在レベル | 目標レベル | 優先度 |
|-----------|-----------|-----------|--------|
| MemoryAI | L3 | L4 | P0 |
| QuestionScheduler | L2-L3 | L4 | P0 |
| CognitiveLoadAI | L2 | L3 | P1 |
| ErrorPredictionAI | L2 | L3 | P1 |
| LinguisticAI | L1-L2 | L3 | P1 |
| ContextualAI | L2 | L3 | P2 |
| GamificationAI | L1-L2 | L3 | P2 |

---

## 🎯 Phase 1: 即効改善（P0）- 1-2週間

### 1.1 MemoryAI: 校正と可視化

#### 📌 目標
- 忘却リスク予測の過剰/過少を抑制（Calibration）
- 保持率カーブと半減期をユーザーに可視化

#### 🔧 実装タスク
1. **確率校正（Platt Scaling風）**
   - [ ] `ForgettingCurveModel.ts`に校正層を追加
   - [ ] 実績データから校正パラメータを学習（sigmoid transform）
   - [ ] 校正後の`forgettingRisk`を出力
   - [ ] オフライン評価: Expected Calibration Error (ECE) を計算

2. **保持率ダッシュボード**
   - [ ] `MemoryRetentionPanel.tsx`コンポーネント新規作成
   - [ ] 現在の保持率、半減期、最適復習時刻を表示
   - [ ] 直近30日の保持率推移をグラフ化（Chart.js軽量版）
   - [ ] `ScoreBoard.tsx`に統合

3. **データ収集基盤**
   - [ ] 予測保持率 vs 実際の正答をログ収集
   - [ ] `localStorage`に軽量集計用キャッシュ追加
   - [ ] 週次でECE/MAEを自動計算するバッチジョブ雛形

#### 📈 成功指標
- ECE < 0.10（業界標準）
- 保持率予測MAE < 15%
- ユーザー満足度（「復習タイミングが適切」）> 80%

---

### 1.2 QuestionScheduler: 説明可能性

#### 📌 目標
- 出題順序の根拠を透明化（「なぜこの単語？」に答える）
- デバッグ性・信頼性向上

#### 🔧 実装タスク
1. **優先度分解API**
   - [ ] `PrioritizedQuestion`に`priorityBreakdown`を追加
     ```typescript
     priorityBreakdown: {
       baseCategory: number;    // カテゴリ由来（incorrect=100等）
       dtaAdjustment: number;   // 忘却リスク調整
       timeBoost: number;       // 時間経過ブースト
       signalPenalty: number;   // メタAIシグナル（疲労等）
       antiVibration: number;   // 振動防止ペナルティ
       finalPriority: number;   // 最終優先度
     }
     ```
   - [ ] `calculatePriorities()`で分解値を計算・記録

2. **UI表示**
   - [ ] 開発モード限定で「優先度詳細」ボタン追加
   - [ ] モーダルで分解値を棒グラフ表示
   - [ ] 上位20問の優先度内訳をコンソールログ出力

3. **監査ログ**
   - [ ] `localStorage`に`scheduler_audit_log`を保存
   - [ ] 出題順序決定時のシグナル・パラメータを記録
   - [ ] 1週間分のログを保持、古いログは自動削除

#### 📈 成功指標
- 開発者がデバッグ時間50%削減
- ユーザーサポート問い合わせ（「順序がおかしい」）が減少
- 監査ログでエッジケースの早期検出

---

## 🚀 Phase 2: 実運用強化（P1）- 2-4週間

### 2.1 ErrorPredictionAI: 特徴量拡張＋校正

#### 🔧 実装タスク
1. **特徴量追加**
   - [ ] `confusionCount`, `avgResponseSpeed`, `forgettingRisk`を特徴量化
   - [ ] `phoneticDistance`（音韻近接度）計算関数追加
   - [ ] `editDistance`（レーベンシュタイン距離）追加

2. **モデル実装**
   - [ ] 軽量ロジスティック回帰（初期版）
   - [ ] 確率校正（Isotonic Regression）
   - [ ] オフライン評価: AUC-ROC, Brier Score

3. **活用**
   - [ ] 誤答確率上位語を出題前に軽ヒント表示
   - [ ] 難易度緩和（選択肢を減らす等）

#### 📈 成功指標
- AUC-ROC > 0.75
- Brier Score < 0.20
- 実際の誤答率と予測誤答率のMSE < 0.10

---

### 2.2 CognitiveLoadAI: 個人適応＋日内リズム

#### 🔧 実装タスク
1. **個人ベースライン**
   - [ ] ユーザー固有の`normalErrorRate`, `normalResponseTime`を学習
   - [ ] 偏差値化で疲労/最適状態を判定

2. **日内リズム**
   - [ ] `timeOfDay`ごとの最適負荷帯を統計学習
   - [ ] 朝型/夜型の自動判定

3. **フロー状態検知**
   - [ ] 高精度・短時間連続正解を「集中モード」判定
   - [ ] 疲労判定を一時猶予

#### 📈 成功指標
- 疲労検出の精度（F1-score）> 0.80
- フロー状態でのセッション継続率 +20%

---

### 2.3 LinguisticAI: 音韻難易度ペナルティ

#### 🔧 実装タスク
1. **音韻難易度**
   - [ ] L2音韻困難（/r-l/, /θ-ð/, 子音連結）のペナルティ定義
   - [ ] IPA発音記号から自動判定

2. **形態透明性**
   - [ ] 語根/接辞の学習進捗を保持
   - [ ] 透明性高い語（例: "unhappy" = "un" + "happy"）の難易度を下げる

#### 📈 成功指標
- 音韻困難語の初回正答率 +10%
- 形態透明語の学習時間 -15%

---

## 🌟 Phase 3: 高度統合（P2）- 1-2ヶ月

### 3.1 ContextualAI: 知識グラフ

#### 🔧 実装タスク
1. **軽量知識グラフ**
   - [ ] `relatedFields`から単語間の近接度を計算
   - [ ] 復習時に近接語を束ねて出題

2. **例文最適化**
   - [ ] 誤答語の文脈に近い例文へ差し替え

---

### 3.2 GamificationAI: 動的報酬＋マイクロ目標

#### 🔧 実装タスク
1. **動的報酬**
   - [ ] 認知負荷と誤答確率から報酬を調整

2. **マイクロ目標**
   - [ ] 「本日3語の長母音克服」等を自動生成

3. **ストリーク保険**
   - [ ] 疲労検出時はストリーク保護で離脱防止

---

### 3.3 QuestionScheduler: メタ学習

#### 🔧 実装タスク
1. **シグナル重み最適化**
   - [ ] バンディット（Thompson Sampling）でシグナル重みを学習
   - [ ] 週次で最適化

---

## 🔬 Phase 4: 次世代研究（P3）- 3ヶ月+

### 4.1 高度スケジューリング

#### 🔧 実装タスク
1. **DKT/FSRS比較実験**
   - [ ] Deep Knowledge Tracing実装
   - [ ] FSRS（Free Spaced Repetition Scheduler）統合
   - [ ] A/B比較

2. **Thompson Sampling出題**
   - [ ] 探索戦略の実装

---

## 📊 評価・検証フレームワーク

### オフライン評価指標

| 指標 | 目標値 | 測定方法 |
|------|--------|---------|
| 忘却保持率MAE | < 15% | 予測 vs 実測の平均絶対誤差 |
| ECE（校正誤差） | < 0.10 | 確率予測の校正評価 |
| 誤答予測AUC | > 0.75 | ROC曲線下面積 |
| 負荷検出F1 | > 0.80 | 疲労/最適状態の検出精度 |

### オンライン評価指標（A/B）

| 指標 | 改善目標 | 測定期間 |
|------|---------|---------|
| 7日定着率 | +15% | 学習後7日の保持率 |
| 30日定着率 | +20% | 学習後30日の保持率 |
| 再誤答率 | -25% | 既習語の再誤答発生率 |
| セッション維持時間 | +10% | 平均セッション長 |
| 離脱率 | -15% | 30日間の継続率 |

---

## 🛠️ 実装体制

### 必要リソース
- **Phase 1（P0）**: 1名 x 1-2週間
- **Phase 2（P1）**: 1-2名 x 2-4週間
- **Phase 3（P2）**: 1名 x 1-2ヶ月
- **Phase 4（P3）**: 研究者 x 3ヶ月+

### 技術スタック
- **既存**: TypeScript, React, localStorage
- **追加**: Chart.js（可視化）, 軽量ML（ロジスティック回帰）
- **検討**: TensorFlow.js（Phase 4 DKT）

---

## 📅 マイルストーン

- **Week 2**: P0完了（MemoryAI校正・可視化、Scheduler説明可能性）
- **Week 4**: P1-50%（ErrorPrediction, CognitiveLoad基盤）
- **Week 6**: P1完了
- **Week 10**: P2-50%（ContextualAI, GamificationAI）
- **Week 12**: P2完了
- **Month 4+**: P3研究開始

---

## 🎯 成功の定義

### L4到達基準
1. **技術**: 各AIがL3以上、全体統合がL4
2. **ユーザー**: 定着率+20%, 離脱率-15%
3. **運用**: 監査ログ・A/B・継続学習が自動化
4. **ガバナンス**: バイアス検査、説明可能性、倫理審査をパス

### ビジョン
「人間の記憶の科学的理解に基づき、一人ひとりに最適化された学習体験を提供し、教育の民主化を実現する」

---

## 📝 次のアクション

1. ✅ 本ロードマップのレビュー・承認
2. ⬜ P0タスクの詳細設計（Issue化）
3. ⬜ 評価メトリクス計測スクリプトのプロトタイプ
4. ⬜ Phase 1キックオフ

---

**更新履歴**
- 2025-12-20: 初版策定
