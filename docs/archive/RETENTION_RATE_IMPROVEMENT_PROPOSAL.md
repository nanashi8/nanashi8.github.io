# 定着率表示の改善提案

## 現状の問題点

### 1. 複雑すぎる定着判定

現在は**8つの異なるパターン**で定着を判定：

- 1発正解
- 連続正解（2〜7回以上）
- 高精度安定型
- 長期記憶型
- 中期記憶型
- 短期完璧型
- 高回数安定型
- 次回定着予測型

→ **ユーザーが理解しづらい**

### 2. 定着率が分かりにくい

現在の表示:

```text
定着率 50% (5/10)
```

問題:

- 「50%」が何を意味するのか不明確
- 学習中の単語と苦手な単語の区別がない
- 時間経過による記憶減衰を考慮していない

### 3. 補修モードの基準が不透明

- いつ補修モードに入るのか？
- いつ抜け出せるのか？
- 何をすれば定着するのか？

→ **モチベーション低下**

---

## 改善提案

### 提案1: 定着判定を3段階に簡素化 🎯

```typescript
🟢 定着（Mastered）
  ├─ 連続3回以上正解
  ├─ 連続2回正解 + 正答率80%以上
  └─ 1発正解（1回目で正解）

🟡 学習中（Learning）
  └─ 正答率50%以上（定着条件未達）

🔴 要復習（Struggling）
  └─ 正答率50%未満
```

#### メリット

- シンプルで分かりやすい
- 自分の状況が一目で分かる
- 次にすべきことが明確

### 提案2: 多角的な定着率表示 📊

#### 現在（シンプル）

```text
定着率 50% (5/10)
```

#### 改善後（詳細）

```text
━━━━━━━━━━━━━━━━━━━━━━━
📊 定着状況

基本定着率: 50%
  🟢 完全定着: 5語 (50%)
  🟡 学習中: 3語 (30%)
  🔴 要復習: 2語 (20%)

実効定着率: 42%
  ※時間経過による記憶減衰を考慮

加重定着率: 65%
  ※学習中の単語を半分評価

━━━━━━━━━━━━━━━━━━━━━━━
⚠️ アクション推奨
  緊急復習が必要: 2語
  復習推奨: 3語
━━━━━━━━━━━━━━━━━━━━━━━
```

#### 3つの定着率の意味

##### 1. 基本定着率（Main Rate）

```text
= (完全定着数 / 出題数) × 100%
= ユーザー様の想定通りの計算
```

- **最も直感的**
- 「10問中5問定着なら50%」
- 現在の表示と同じ

##### 2. 実効定着率（Effective Rate）

```text
= (時間減衰を考慮した定着スコア / 出題数) × 100%
```

- **長期的な記憶を評価**
- 最近学習した単語: 100%評価
- 30日前の単語: 約37%評価（e^-1）
- 忘却曲線を反映

##### 3. 加重定着率（Weighted Rate）

```text
= (完全定着 × 1.0 + 学習中 × 0.5 / 出題数) × 100%
```

- **学習の進捗を評価**
- 学習中の単語も部分的に評価
- モチベーション維持に有効

### 提案3: 補修モードの可視化 🎓

#### 現在

```text
🎯 補修モード - 要復習問題を繰り返し出題中
```

#### 改善後

```text
━━━━━━━━━━━━━━━━━━━━━━━
🎯 補修モード

対象単語: 5語
  🔴 緊急: 2語（正答率30%未満）
  🟡 注意: 3語（正答率30-50%）

脱出条件:
  ✅ 全単語で連続2回正解
  ✅ または正答率70%以上

現在の進捗:
  単語A: ○× → あと2回連続正解
  単語B: ×× → あと2回連続正解
  単語C: ○×○ → あと1回連続正解
  単語D: ×○× → あと2回連続正解
  単語E: ××× → あと2回連続正解

推定残り問題数: 8-12問
━━━━━━━━━━━━━━━━━━━━━━━
```

### 提案4: グラフィカルな進捗表示 📈

```text
━━━━━━━━━━━━━━━━━━━━━━━
📈 学習進捗（過去30日）

定着率の推移:
Week 1: ████████░░ 40%
Week 2: ██████████ 50%
Week 3: ████████░░ 45%
Week 4: ██████████ 50% ← 現在

カテゴリー別定着率:
動詞     : ████████████░░ 60%
名詞     : ██████████░░░░ 50%
形容詞   : ████████░░░░░░ 40%
副詞     : ██████░░░░░░░░ 30%

難易度別定着率:
初級     : ██████████████ 70%
中級     : ██████████░░░░ 50%
上級     : ████░░░░░░░░░░ 20%
━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 実装例

### UIコンポーネント（ScoreBoardの改善）

```tsx
// 現在
<span className="score-stat-large">
  定着率<strong className="mastered">{retentionRate}%</strong>
  <span className="score-stat-sub">({masteredCount}/{appearedCount})</span>
</span>

// 改善後
<div className="retention-stats-detailed">
  <div className="retention-main">
    <span className="label">定着率</span>
    <span className="value">{stats.basicRetentionRate}%</span>
  </div>
  
  <div className="retention-breakdown">
    <span className="tier-mastered">
      🟢 {stats.masteredPercentage}%
    </span>
    <span className="tier-learning">
      🟡 {stats.learningPercentage}%
    </span>
    <span className="tier-struggling">
      🔴 {stats.strugglingPercentage}%
    </span>
  </div>
  
  <div className="retention-sub">
    <span>実効: {stats.effectiveRetentionRate}%</span>
    <span>加重: {stats.weightedRetentionRate}%</span>
  </div>
  
  {stats.criticalCount > 0 && (
    <div className="retention-alert">
      ⚠️ 緊急復習: {stats.criticalCount}語
    </div>
  )}
</div>
```

---

## 期待される効果

### 1. 理解しやすさ向上 ✅

- 3段階の色分けで直感的に理解
- 複雑なパターン判定を廃止

### 2. モチベーション維持 💪

- 学習中の単語も部分評価（加重定着率）
- 進捗が可視化される
- 次のアクションが明確

### 3. 効率的な学習 🎯

- 補修が必要な単語が明確
- 優先順位が分かる
- 目標達成までの道筋が見える

### 4. データ駆動型改善 📊

- 複数の指標で多角的に評価
- 時間経過を考慮した実効定着率
- カテゴリー・難易度別の詳細分析

---

## 実装優先度

### Phase 1（即時実装可能）

- ✅ 3段階の定着判定
- ✅ 詳細な定着率統計
- ✅ ScoreBoardの表示改善

### Phase 2（中期）

- 補修モードの進捗表示
- グラフィカルな進捗可視化
- カテゴリー別・難易度別分析

### Phase 3（長期）

- 忘却曲線の詳細モデル化
- AIによる最適な復習タイミング提案
- 個人の学習パターン分析

---

## まとめ

**ユーザー様の理解は完全に正しいです** ✅

「10問中5問定着、5問未定着 → 定着率50%」

**ただし、現在のシステムは:**

- 定着判定が複雑すぎる（8パターン）
- 学習中と苦手の区別がない
- 時間経過を考慮していない

**改善提案:**

1. **3段階に簡素化**（🟢定着 🟡学習中 🔴要復習）
1. **3種類の定着率**（基本・実効・加重）
1. **補修モードの可視化**（脱出条件を明示）
1. **グラフィカルな進捗表示**

これにより、**直感的で分かりやすく、モチベーションが維持できる**学習体験を提供できます。
