<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å’Œè¨³ã‚¿ãƒ–æ­£è§£åˆ¤å®šãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-case {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
        }
        .passed {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        .failed {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        .test-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .test-details {
            font-size: 0.9em;
            color: #666;
        }
        h1 {
            color: #333;
        }
        .summary {
            padding: 20px;
            background: #e7f3ff;
            border-radius: 8px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª å’Œè¨³ã‚¿ãƒ–æ­£è§£åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ</h1>
    <div class="summary" id="summary"></div>
    <div id="test-results"></div>

    <script>
        // ãƒ†ã‚¹ãƒˆç”¨ã®å•é¡Œãƒ‡ãƒ¼ã‚¿
        const testQuestions = [
            {
                word: "apple",
                meaning: "ãƒªãƒ³ã‚´",
                reading: "ã‚¢ãƒƒãƒ—ãƒ«"
            },
            {
                word: "book",
                meaning: "æœ¬",
                reading: "ãƒ–ãƒƒã‚¯"
            },
            {
                word: "give up",
                meaning: "ã‚ãã‚‰ã‚ã‚‹",
                reading: "ã‚®ãƒ–ã‚¢ãƒƒãƒ—"
            }
        ];

        // é¸æŠè‚¢ç”Ÿæˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        function generateChoices(currentQuestion, allQuestions) {
            const wrongQuestions = allQuestions
                .filter(q => q.meaning !== currentQuestion.meaning)
                .slice(0, 2);
            
            const choices = [
                { text: currentQuestion.meaning, isCorrect: true },
                ...wrongQuestions.map(q => ({ text: q.meaning, isCorrect: false })),
                { text: "åˆ†ã‹ã‚‰ãªã„", isCorrect: false }
            ];
            
            // ã‚·ãƒ£ãƒƒãƒ•ãƒ«ï¼ˆæœ€åˆã®3ã¤ã®ã¿ï¼‰
            const first3 = choices.slice(0, 3);
            for (let i = first3.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [first3[i], first3[j]] = [first3[j], first3[i]];
            }
            
            return [...first3, choices[3]];
        }

        // æ­£è§£åˆ¤å®šã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        function checkAnswer(answer, correct) {
            return answer === correct;
        }

        // ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ
        function runTests() {
            const results = [];
            let passedCount = 0;
            let failedCount = 0;

            testQuestions.forEach((question, index) => {
                const choices = generateChoices(question, testQuestions);
                const correctChoice = choices.find(c => c.isCorrect);
                
                // ãƒ†ã‚¹ãƒˆ1: æ­£è§£ã‚’é¸æŠã—ãŸå ´åˆ
                const test1Result = checkAnswer(correctChoice.text, question.meaning);
                const test1 = {
                    title: `ãƒ†ã‚¹ãƒˆ ${index * 2 + 1}: "${question.word}" ã§æ­£è§£ã‚’é¸æŠ`,
                    passed: test1Result === true,
                    details: `é¸æŠ: "${correctChoice.text}", æ­£è§£: "${question.meaning}", åˆ¤å®š: ${test1Result ? "æ­£è§£" : "ä¸æ­£è§£"}`
                };
                results.push(test1);
                if (test1.passed) passedCount++; else failedCount++;

                // ãƒ†ã‚¹ãƒˆ2: èª¤ç­”ã‚’é¸æŠã—ãŸå ´åˆ
                const wrongChoice = choices.find(c => !c.isCorrect && c.text !== "åˆ†ã‹ã‚‰ãªã„");
                if (wrongChoice) {
                    const test2Result = checkAnswer(wrongChoice.text, question.meaning);
                    const test2 = {
                        title: `ãƒ†ã‚¹ãƒˆ ${index * 2 + 2}: "${question.word}" ã§èª¤ç­”ã‚’é¸æŠ`,
                        passed: test2Result === false,
                        details: `é¸æŠ: "${wrongChoice.text}", æ­£è§£: "${question.meaning}", åˆ¤å®š: ${test2Result ? "æ­£è§£" : "ä¸æ­£è§£"}`
                    };
                    results.push(test2);
                    if (test2.passed) passedCount++; else failedCount++;
                }
            });

            // ç‰¹æ®Šã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ
            const specialTests = [
                {
                    title: "ç©ºç™½ã®æ‰±ã„: å‰å¾Œã®ç©ºç™½ã‚’å«ã‚€æ­£è§£",
                    answer: "  ãƒªãƒ³ã‚´  ",
                    correct: "ãƒªãƒ³ã‚´",
                    expected: false
                },
                {
                    title: "å¤§æ–‡å­—å°æ–‡å­—: æ—¥æœ¬èªã¯å½±éŸ¿ãªã—",
                    answer: "ã‚Šã‚“ã”",
                    correct: "ãƒªãƒ³ã‚´",
                    expected: false
                },
                {
                    title: "å®Œå…¨ä¸€è‡´: æ­£ç¢ºãªä¸€è‡´",
                    answer: "ã‚ãã‚‰ã‚ã‚‹",
                    correct: "ã‚ãã‚‰ã‚ã‚‹",
                    expected: true
                }
            ];

            specialTests.forEach(test => {
                const result = checkAnswer(test.answer, test.correct);
                const passed = result === test.expected;
                results.push({
                    title: test.title,
                    passed: passed,
                    details: `é¸æŠ: "${test.answer}", æ­£è§£: "${test.correct}", æœŸå¾…: ${test.expected}, å®Ÿéš›: ${result}`
                });
                if (passed) passedCount++; else failedCount++;
            });

            return { results, passedCount, failedCount };
        }

        // çµæœã‚’è¡¨ç¤º
        const { results, passedCount, failedCount } = runTests();
        
        document.getElementById('summary').innerHTML = `
            <h2>ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼</h2>
            <p><strong>åˆè¨ˆ:</strong> ${results.length}ä»¶</p>
            <p><strong>âœ… æˆåŠŸ:</strong> ${passedCount}ä»¶</p>
            <p><strong>âŒ å¤±æ•—:</strong> ${failedCount}ä»¶</p>
            <p><strong>æˆåŠŸç‡:</strong> ${((passedCount / results.length) * 100).toFixed(1)}%</p>
        `;

        const resultsHtml = results.map(test => `
            <div class="test-case ${test.passed ? 'passed' : 'failed'}">
                <div class="test-title">${test.passed ? 'âœ…' : 'âŒ'} ${test.title}</div>
                <div class="test-details">${test.details}</div>
            </div>
        `).join('');

        document.getElementById('test-results').innerHTML = resultsHtml;
    </script>
</body>
</html>
