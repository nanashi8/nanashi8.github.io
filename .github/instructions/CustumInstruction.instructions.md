# SimpleWord プロジェクト基本方針

**最終更新**: 2025年11月6日  
**バージョン**: v1.17.0

---

## 基本方針

### コーディングスタイル
- インデントはスペース4つを基本とする
- 命名は説明的にし、必要な型情報を明示する
- ファイル冒頭やコードには日本語コメントで意図を補足する
- Viewファイルは項目の内容が分かる日本語コメントを付ける

### 命名規則
- View: `〇〇View.swift`
- ViewModel: `〇〇ViewModel.swift`
- Model: `〇〇Model.swift`

---

## アーキテクチャ原則

### Feature-First / Vertical Slice Architecture
- 各 Feature は `Features/` 配下に配置
- 機能ごとに垂直分割し、関連するすべての層（UI、ロジック、データ）を同一ディレクトリに配置
- View と ViewModel は責務を分離し、別ファイルで管理

### 設計原則
- オブジェクト指向を基本とし、責務分離を徹底する
- 過度なラッパーや多段継承は避け、単一の実装・単一路線・単一管理点に集約する
- オーバーエンジニアリングを避け、容易性・可読性・保守性・拡張性を優先する

### ディレクトリ構造
```
Features/〇〇/
├── 〇〇View.swift (メイン画面)
├── 〇〇ViewModel.swift (メインロジック)
├── Components/ (UI部品)
├── Services/ (ビジネスロジック)
└── Models/ (データ構造)
```

---

## 実装ガイドライン

### 変更の原則
- 変更は単一の実装・単一路線・単一管理点に集約する
- 既存の設計・コード・仕組み・パッケージを優先的に利用し、目的の達成に支障がない限り、書き換えや再発明を避ける
- 副作用は必要最小限に留める。テスタビリティを考慮する
- エラー修正や改修は、可能な限り短いセッションで完了できるメンテナンス性の高い構造とする

### ファイル分割基準
- View ファイル: 200〜300行を超えたら分割を検討
- ViewModel ファイル: 300〜400行を超えたら分割を検討
- 単一の構造体/クラス: 1つの責務に集中させる

### 注意事項
- 過度な分割は避ける（10行程度のファイルを大量に作らない）
- 密接に関連する処理は同じファイルに置く
- 分割後のファイル名で役割が明確に分かるようにする

---

## データ管理

### CSV仕様
- CSV ファイルからの読み込みを基本とする
- **CSV列は7列固定**（語句、読み/発音、意味/和訳/史実名、語源/解説、関連語、関連分野、難易度）
- **列3（意味/和訳/史実名）が選択肢として使用される**ため、この列のデータ品質が重要
- 列数の整合性チェックを必須とする
- パース失敗時は適切なエラーハンドリングを行う
- `QuestionItem.rawColumns` に生のCSVデータを保存し、固定列順でのアクセスを可能にする

### 選択肢生成ロジック
**重要**: 選択肢自体は**CSV固定列3（`rawColumns[2]`：意味/和訳/史実名）**から生成されます。これにより、ヘッダ駆動型パーサの影響を受けずに正確な選択肢が表示されます。

---

## 保守性

- エラー修正や改修は、可能な限り短いセッションで完了できる構造とする
- Viewファイルは項目の内容が分かる日本語コメントを付ける
- 既存の仕組みを最大限活用し、重複実装を避ける
