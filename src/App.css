/* ============================================
   共通スタイルのインポート
   ============================================ */
/* コンポーネント */
@import './styles/components/choices.css';
@import './styles/components/modals.css';
@import './styles/components/quiz-common.css';
@import './styles/components/spelling-view.css';

/* レイアウト */
@import './styles/layout/containers.css';

/* ユーティリティ */
@import './styles/utilities/animations.css';

.app {
  background: var(--background, var(--background));
  color: var(--text-color, var(--gray-900));
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  /* iPhone Safari対応 */
  padding-bottom: env(safe-area-inset-bottom);
  transition: background-color var(--transition-speed), color var(--transition-speed);
}

/* ============================================
   プログレスバー - data-width属性でwidthを設定
   ============================================
   JavaScriptでdata-width属性に応じてインラインstyleを設定する想定
   または、以下の個別ルールを使用
   
   推奨実装:
   - JavaScript: element.style.width = `${percentage}%`;
   - または: <div class="xp-fill" style="width: 75%"></div>
   ============================================ */

/* 12%から100%までの1%刻みのプログレスバー幅 */
.xp-fill[data-width="12"], .milestone-progress-fill[data-width="12"] { width: 12%; }
.xp-fill[data-width="13"], .milestone-progress-fill[data-width="13"] { width: 13%; }
.xp-fill[data-width="14"], .milestone-progress-fill[data-width="14"] { width: 14%; }
.xp-fill[data-width="15"], .milestone-progress-fill[data-width="15"] { width: 15%; }
.xp-fill[data-width="16"], .milestone-progress-fill[data-width="16"] { width: 16%; }
.xp-fill[data-width="17"], .milestone-progress-fill[data-width="17"] { width: 17%; }
.xp-fill[data-width="18"], .milestone-progress-fill[data-width="18"] { width: 18%; }
.xp-fill[data-width="19"], .milestone-progress-fill[data-width="19"] { width: 19%; }
.xp-fill[data-width="20"], .milestone-progress-fill[data-width="20"] { width: 20%; }
.xp-fill[data-width="21"], .milestone-progress-fill[data-width="21"] { width: 21%; }
.xp-fill[data-width="22"], .milestone-progress-fill[data-width="22"] { width: 22%; }
.xp-fill[data-width="23"], .milestone-progress-fill[data-width="23"] { width: 23%; }
.xp-fill[data-width="24"], .milestone-progress-fill[data-width="24"] { width: 24%; }
.xp-fill[data-width="25"], .milestone-progress-fill[data-width="25"] { width: 25%; }
.xp-fill[data-width="26"], .milestone-progress-fill[data-width="26"] { width: 26%; }
.xp-fill[data-width="27"], .milestone-progress-fill[data-width="27"] { width: 27%; }
.xp-fill[data-width="28"], .milestone-progress-fill[data-width="28"] { width: 28%; }
.xp-fill[data-width="29"], .milestone-progress-fill[data-width="29"] { width: 29%; }
.xp-fill[data-width="30"], .milestone-progress-fill[data-width="30"] { width: 30%; }
.xp-fill[data-width="31"], .milestone-progress-fill[data-width="31"] { width: 31%; }
.xp-fill[data-width="32"], .milestone-progress-fill[data-width="32"] { width: 32%; }
.xp-fill[data-width="33"], .milestone-progress-fill[data-width="33"] { width: 33%; }
.xp-fill[data-width="34"], .milestone-progress-fill[data-width="34"] { width: 34%; }
.xp-fill[data-width="35"], .milestone-progress-fill[data-width="35"] { width: 35%; }
.xp-fill[data-width="36"], .milestone-progress-fill[data-width="36"] { width: 36%; }
.xp-fill[data-width="37"], .milestone-progress-fill[data-width="37"] { width: 37%; }
.xp-fill[data-width="38"], .milestone-progress-fill[data-width="38"] { width: 38%; }
.xp-fill[data-width="39"], .milestone-progress-fill[data-width="39"] { width: 39%; }
.xp-fill[data-width="40"], .milestone-progress-fill[data-width="40"] { width: 40%; }
.xp-fill[data-width="41"], .milestone-progress-fill[data-width="41"] { width: 41%; }
.xp-fill[data-width="42"], .milestone-progress-fill[data-width="42"] { width: 42%; }
.xp-fill[data-width="43"], .milestone-progress-fill[data-width="43"] { width: 43%; }
.xp-fill[data-width="44"], .milestone-progress-fill[data-width="44"] { width: 44%; }
.xp-fill[data-width="45"], .milestone-progress-fill[data-width="45"] { width: 45%; }
.xp-fill[data-width="46"], .milestone-progress-fill[data-width="46"] { width: 46%; }
.xp-fill[data-width="47"], .milestone-progress-fill[data-width="47"] { width: 47%; }
.xp-fill[data-width="48"], .milestone-progress-fill[data-width="48"] { width: 48%; }
.xp-fill[data-width="49"], .milestone-progress-fill[data-width="49"] { width: 49%; }
.xp-fill[data-width="50"], .milestone-progress-fill[data-width="50"] { width: 50%; }
.xp-fill[data-width="51"], .milestone-progress-fill[data-width="51"] { width: 51%; }
.xp-fill[data-width="52"], .milestone-progress-fill[data-width="52"] { width: 52%; }
.xp-fill[data-width="53"], .milestone-progress-fill[data-width="53"] { width: 53%; }
.xp-fill[data-width="54"], .milestone-progress-fill[data-width="54"] { width: 54%; }
.xp-fill[data-width="55"], .milestone-progress-fill[data-width="55"] { width: 55%; }
.xp-fill[data-width="56"], .milestone-progress-fill[data-width="56"] { width: 56%; }
.xp-fill[data-width="57"], .milestone-progress-fill[data-width="57"] { width: 57%; }
.xp-fill[data-width="58"], .milestone-progress-fill[data-width="58"] { width: 58%; }
.xp-fill[data-width="59"], .milestone-progress-fill[data-width="59"] { width: 59%; }
.xp-fill[data-width="60"], .milestone-progress-fill[data-width="60"] { width: 60%; }
.xp-fill[data-width="61"], .milestone-progress-fill[data-width="61"] { width: 61%; }
.xp-fill[data-width="62"], .milestone-progress-fill[data-width="62"] { width: 62%; }
.xp-fill[data-width="63"], .milestone-progress-fill[data-width="63"] { width: 63%; }
.xp-fill[data-width="64"], .milestone-progress-fill[data-width="64"] { width: 64%; }
.xp-fill[data-width="65"], .milestone-progress-fill[data-width="65"] { width: 65%; }
.xp-fill[data-width="66"], .milestone-progress-fill[data-width="66"] { width: 66%; }
.xp-fill[data-width="67"], .milestone-progress-fill[data-width="67"] { width: 67%; }
.xp-fill[data-width="68"], .milestone-progress-fill[data-width="68"] { width: 68%; }
.xp-fill[data-width="69"], .milestone-progress-fill[data-width="69"] { width: 69%; }
.xp-fill[data-width="70"], .milestone-progress-fill[data-width="70"] { width: 70%; }
.xp-fill[data-width="71"], .milestone-progress-fill[data-width="71"] { width: 71%; }
.xp-fill[data-width="72"], .milestone-progress-fill[data-width="72"] { width: 72%; }
.xp-fill[data-width="73"], .milestone-progress-fill[data-width="73"] { width: 73%; }
.xp-fill[data-width="74"], .milestone-progress-fill[data-width="74"] { width: 74%; }
.xp-fill[data-width="75"], .milestone-progress-fill[data-width="75"] { width: 75%; }
.xp-fill[data-width="76"], .milestone-progress-fill[data-width="76"] { width: 76%; }
.xp-fill[data-width="77"], .milestone-progress-fill[data-width="77"] { width: 77%; }
.xp-fill[data-width="78"], .milestone-progress-fill[data-width="78"] { width: 78%; }
.xp-fill[data-width="79"], .milestone-progress-fill[data-width="79"] { width: 79%; }
.xp-fill[data-width="80"], .milestone-progress-fill[data-width="80"] { width: 80%; }
.xp-fill[data-width="81"], .milestone-progress-fill[data-width="81"] { width: 81%; }
.xp-fill[data-width="82"], .milestone-progress-fill[data-width="82"] { width: 82%; }
.xp-fill[data-width="83"], .milestone-progress-fill[data-width="83"] { width: 83%; }
.xp-fill[data-width="84"], .milestone-progress-fill[data-width="84"] { width: 84%; }
.xp-fill[data-width="85"], .milestone-progress-fill[data-width="85"] { width: 85%; }
.xp-fill[data-width="86"], .milestone-progress-fill[data-width="86"] { width: 86%; }
.xp-fill[data-width="87"], .milestone-progress-fill[data-width="87"] { width: 87%; }
.xp-fill[data-width="88"], .milestone-progress-fill[data-width="88"] { width: 88%; }
.xp-fill[data-width="89"], .milestone-progress-fill[data-width="89"] { width: 89%; }
.xp-fill[data-width="90"], .milestone-progress-fill[data-width="90"] { width: 90%; }
.xp-fill[data-width="91"], .milestone-progress-fill[data-width="91"] { width: 91%; }
.xp-fill[data-width="92"], .milestone-progress-fill[data-width="92"] { width: 92%; }
.xp-fill[data-width="93"], .milestone-progress-fill[data-width="93"] { width: 93%; }
.xp-fill[data-width="94"], .milestone-progress-fill[data-width="94"] { width: 94%; }
.xp-fill[data-width="95"], .milestone-progress-fill[data-width="95"] { width: 95%; }
.xp-fill[data-width="96"], .milestone-progress-fill[data-width="96"] { width: 96%; }
.xp-fill[data-width="97"], .milestone-progress-fill[data-width="97"] { width: 97%; }
.xp-fill[data-width="98"], .milestone-progress-fill[data-width="98"] { width: 98%; }
.xp-fill[data-width="99"], .milestone-progress-fill[data-width="99"] { width: 99%; }
.xp-fill[data-width="100"], .milestone-progress-fill[data-width="100"] { width: 100%; }

/* ストレージプログレスバー用 - data-progress属性で動的幅設定 */
[data-progress] {
  width: 0%;
}
[data-progress="0"] { width: 0%; }
[data-progress="10"] { width: 10%; }
[data-progress="20"] { width: 20%; }
[data-progress="30"] { width: 30%; }
[data-progress="40"] { width: 40%; }
[data-progress="50"] { width: 50%; }
[data-progress="60"] { width: 60%; }
[data-progress="70"] { width: 70%; }
[data-progress="80"] { width: 80%; }
[data-progress="90"] { width: 90%; }
[data-progress="100"] { width: 100%; }

/* ErrorLogPanel styles */
.error-log-panel {
  position: fixed;
  bottom: 20px;
  right: 20px;
  max-width: 500px;
  max-height: 400px;
  background-color: var(--background-light);
  border: 2px solid var(--error-red-dark);
  border-radius: 8px;
  box-shadow: 0 4px 12px var(--shadow-md);
  z-index: var(--z-error-log);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.error-log-header {
  background-color: var(--error-color);
  color: var(--text-color-light);
  padding: 12px 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.error-log-copy-btn {
  background-color: var(--text-color-light);
  color: var(--error-color);
  border: none;
  padding: 4px 12px;
  border-radius: 4px;
  margin-right: 8px;
  cursor: pointer;
  font-size: 12px;
}

.error-log-close-btn {
  background-color: transparent;
  color: var(--text-color-light);
  border: none;
  font-size: 20px;
  cursor: pointer;
  padding: 0 4px;
}

.error-log-content {
  padding: 12px;
  overflow-y: auto;
  font-size: 13px;
  font-family: monospace;
  background-color: var(--gray-100);
  flex: 1;
}

.error-log-item {
  margin-bottom: 12px;
  padding: 8px;
  background-color: var(--text-color-light);
  border-left: 3px solid var(--error-red-dark);
  border-radius: 4px;
}

.error-log-time {
  color: var(--gray-600);
  font-size: 11px;
  margin-bottom: 4px;
}

.error-log-message {
  color: var(--gray-900);
  white-space: pre-wrap;
  word-break: break-word;
}

.error-log-stack-details {
  margin-top: 8px;
  font-size: 11px;
}

.error-log-stack-summary {
  cursor: pointer;
  color: var(--gray-600);
}

.error-log-stack-pre {
  margin-top: 4px;
  padding: 8px;
  background-color: var(--gray-100);
  border-radius: 4px;
  overflow: auto;
  font-size: 10px;
}

.error-log-footer {
  padding: 8px 12px;
  background-color: var(--gray-100);
  border-top: 1px solid var(--gray-300);
  font-size: 11px;
  color: var(--gray-600);
  text-align: center;
}

.error-badge {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: var(--error-color);
  color: var(--text-color-light);
  border: none;
  border-radius: 50%;
  width: 56px;
  height: 56px;
  font-size: 24px;
  cursor: pointer;
  box-shadow: 0 4px 12px var(--shadow-md);
  z-index: var(--z-error-badge);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}

.error-badge-count {
  font-size: 12px;
  font-weight: bold;
}

/* ===== 長文読解のスタイル ===== */
.reading-sub-tabs {
  max-width: 1200px;
  margin: 0 auto;
  width: 100%;
}

.phrase-navigation {
  display: flex;
  gap: 12px;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.score-board-tabs {
  width: 100%;
  max-width: none;
  margin: 0;
  padding: 0 20px;
  box-sizing: border-box;
}

/* ===== モバイル版長文読解の最適化 ===== */
@media (width <= 600px) {
  .comprehensive-reading-view {
    font-size: 14px;
  }

  /* 読解タブ: 文法凡例が横にはみ出ないようにする */
  .grammar-legend {
    max-width: 100%;
    overflow-x: hidden;
  }

  .grammar-legend,
  .grammar-legend * {
    overflow-wrap: anywhere;
    word-break: break-word;
  }

  /* 読解タブ内部横幅統一 */
  .passage-content,
  .passage-body,
  .phrase-block,
  .phrase-english {
    max-width: 100%;
    box-sizing: border-box;
  }

  .phrase-english {
    width: 100%;
    overflow-wrap: anywhere;
  }

  .phrase-block {
    width: 100%;
    margin-left: 0;
    margin-right: 0;
  }

  .word-card,
  .word-card.phrase-card {
    max-width: 100%;
    overflow-wrap: anywhere;
    overflow-wrap: break-word;
  }

  .reading-header {
    padding: 8px;
  }

  .reading-header h2 {
    font-size: 1.2em;
    margin-bottom: 8px;
  }

  .reading-selectors {
    flex-direction: column;
    gap: 8px;
    margin-bottom: 8px;
  }

  .reading-selectors .filter-controls,
  .reading-selectors .passage-selector {
    flex: 1 1 100%;
    min-width: 0;
    width: 100%;
  }

  .passage-selector,
  .difficulty-selector {
    width: 100%;
  }

  .compact-select {
    font-size: 14px;
    padding: 10px 12px;
    width: 100%;
    min-width: 0;
  }

  .passage-list {
    gap: 8px;
    padding: 8px;
  }

  .passage-item {
    padding: 10px;
    font-size: 0.9em;
  }

  .passage-content {
    padding: 0;
  }

  .passage-title {
    font-size: 1.1em;
    margin: 10px;
    padding: 10px;
    background: var(--gray-100);
    border-radius: 6px;
  }

  .passage-body {
    margin-top: 0;
  }

  .phrase-block {
    margin: 0 0 12px 0;
    padding: 10px;
    border-radius: 6px;
  }

  .phrase-speaker-btn {
    width: 100%;
    justify-content: center;
    padding: 10px 12px;
    font-size: 0.95em;
    margin-bottom: 8px;
  }

  .phrase-english {
    gap: 4px;
    padding: 6px;
    margin-bottom: 8px;
  }

  .word-card {
    padding: 2px 5px;
    margin: 1px;
    font-size: 0.95em;
    min-width: auto;
  }

  .word-card-word {
    font-size: 1em;
  }

  .word-card-meaning {
    font-size: 0.75em;
    max-width: none;
    padding: 1px 3px;
  }

  .phrase-card {
    padding: 8px 12px;
  }

  .phrase-word {
    font-size: 1em;
  }

  .punctuation-card {
    padding: 4px 2px !important;
    min-width: 15px !important;
  }

  .phrase-translation {
    padding: 8px;
    font-size: 0.9em;
    margin-top: 6px;
  }

  .show-translation-btn {
    width: 100%;
    padding: 10px;
    font-size: 0.9em;
    margin-top: 8px;
  }

  .full-text-display,
  .full-translation-display {
    margin: 10px;
    padding: 12px;
  }

  .word-popup {
    max-width: 90vw;
    padding: 12px;
  }

  .popup-word {
    font-size: 1.2em;
  }

  .popup-meaning {
    font-size: 0.9em;
  }
}

/* ============================================
   ScoreBoard スタイル
   ============================================ */

/* ScoreBoard全体のコンテナに固定高さを設定 */
.score-board-compact {
  min-height: 180px;
}

/* タブコンテンツの固定高さ（プラン表示時の高さに統一） */
.score-board-content {
  min-height: 160px;
  max-height: 160px;
  overflow-y: auto;
}

/* プランタブ */
.plan-tab-compact {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 16px;
  background: var(--bg-secondary);
  border-radius: 8px;
  min-height: 120px;
}

.dark-mode .plan-tab-compact {
  background: var(--gray-900);
  color: var(--gray-200);
}

.plan-text-line {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
  justify-content: center;
  color: var(--text-color);
}

.dark-mode .plan-text-line {
  color: var(--gray-200);
}

.stat-text-label {
  font-size: 0.95rem;
  color: var(--gray-700);
}

.dark-mode .stat-text-label {
  color: var(--gray-300);
}

.stat-text-value {
  font-size: 1.1rem;
  color: var(--text-color);
}

.dark-mode .stat-text-value {
  color: var(--white);
}

.stat-text-divider {
  color: var(--gray-400);
}

.stat-text-sub {
  font-size: 0.85rem;
  color: var(--gray-500);
}

.dark-mode .stat-text-sub {
  color: var(--gray-400);
}

/* 学習状況タブ - 進捗バー */
.retention-breakdown-container {
  padding: 20px;
  min-height: 120px;
}

.retention-breakdown-header {
  margin-bottom: 20px;
}

.retention-title {
  font-size: 1.2rem;
  font-weight: bold;
  color: var(--text-color);
  margin-bottom: 8px;
}

.dark-mode .retention-title {
  color: var(--white);
}

.retention-subtitle {
  font-size: 0.95rem;
  color: var(--gray-600);
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.dark-mode .retention-subtitle {
  color: var(--gray-300);
}

/* 復習モード炎アイコン */
.review-mode-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 6px;
  transition: all 0.3s ease;
  background: var(--gray-200);
  margin-left: 8px;
}

.review-mode-icon:hover {
  background: var(--gray-300);
  transform: scale(1.1);
}

.review-mode-icon.active {
  background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
  box-shadow: 0 0 12px rgb(255, 107, 107, 0.6);
  animation: flame-pulse 1.5s ease-in-out infinite;
}

.dark-mode .review-mode-icon {
  background: var(--gray-700);
}

.dark-mode .review-mode-icon:hover {
  background: var(--gray-600);
}

@keyframes flame-pulse {
  0%, 100% {
    box-shadow: 0 0 12px rgb(255, 107, 107, 0.6);
  }
  50% {
    box-shadow: 0 0 20px rgb(255, 107, 107, 0.9);
  }
}

.retention-progress-bar {
  display: flex;
  width: 100%;
  height: 24px;
  background: var(--gray-200);
  border-radius: 6px;
  overflow: hidden;
  box-shadow: 0 1px 2px rgb(0, 0, 0, 0.1);
}

.dark-mode .retention-progress-bar {
  background: var(--gray-700);
}

.retention-segment {
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: bold;
  font-size: 0.7rem;
  transition: all 0.3s ease;
  cursor: help;
  flex-shrink: 0;
}

.retention-segment:hover {
  opacity: 0.9;
}

.retention-mastered {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.retention-mastered[data-width] {
  width: calc(var(--segment-width) * 1%);
}

.retention-learning {
  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
}

.retention-learning[data-width] {
  width: calc(var(--segment-width) * 1%);
}

.retention-struggling {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

.retention-struggling[data-width] {
  width: calc(var(--segment-width) * 1%);
}

.retention-breakdown-stats {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.stat-row {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.95rem;
}

.stat-label {
  color: var(--gray-600);
}

.dark-mode .stat-label {
  color: var(--gray-300);
}

.stat-value {
  font-size: 1.1rem;
  color: var(--text-color);
}

.dark-mode .stat-value {
  color: var(--white);
}

.stat-detail {
  font-size: 0.85rem;
  color: var(--gray-500);
}

.dark-mode .stat-detail {
  color: var(--gray-400);
}

/* 履歴タブ */
.history-compact,
.word-detail-container,
.word-detail-empty {
  padding: 16px;
  background: var(--bg-secondary);
  border-radius: 8px;
  min-height: 120px;
}

.dark-mode .history-compact,
.dark-mode .word-detail-container,
.dark-mode .word-detail-empty {
  background: var(--gray-800);
  color: var(--gray-200);
}

.word-detail-title {
  font-size: 1.1rem;
  font-weight: bold;
  margin-bottom: 12px;
  color: var(--text-color);
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.dark-mode .word-detail-title {
  color: var(--white);
}

.word-status-badge {
  font-size: 0.9rem;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  background: var(--gray-100);
  color: var(--gray-700);
  font-weight: 600;
}

.dark-mode .word-status-badge {
  background: var(--gray-800);
  color: var(--gray-300);
}

.plan-review-icon {
  margin-left: 0.25rem;
  cursor: pointer;
  font-size: 1.1rem;
  transition: transform 0.2s ease;
}

.plan-review-icon:hover {
  transform: scale(1.2);
}

.word-detail-stats {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}

.word-stat-label {
  font-size: 0.9rem;
  color: var(--gray-600);
}

.dark-mode .word-stat-label {
  color: var(--gray-300);
}

.word-stat-value {
  font-size: 1rem;
  color: var(--text-color);
}

.dark-mode .word-stat-value {
  color: var(--white);
}

.word-stat-divider {
  color: var(--gray-400);
}

/* 文法タブ - 単元別成績 */
.grammar-unit-stats {
  width: 100%;
}

.grammar-units-list {
  margin-top: 0.75rem;
}

.grammar-unit-card {
  padding: 0.75rem;
  margin-bottom: 0.5rem;
  background-color: var(--card-bg, #fff);
  border-radius: 8px;
  border: 1px solid var(--border-color, #e0e0e0);
}

.dark-mode .grammar-unit-card {
  background-color: var(--gray-700);
  border-color: var(--gray-600);
}

.grammar-unit-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
}

.grammar-unit-name {
  font-size: 0.95rem;
  color: var(--text-color);
}

.dark-mode .grammar-unit-name {
  color: var(--white);
}

.grammar-accuracy {
  font-size: 0.85rem;
  font-weight: bold;
}

.grammar-accuracy.high {
  color: var(--success-color, #10b981);
}

.grammar-accuracy.medium {
  color: var(--warning-color, #f59e0b);
}

.grammar-accuracy.low {
  color: var(--error-color, #ef4444);
}

.grammar-unit-stats-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.5rem;
  font-size: 0.85rem;
}

.grammar-unit-stat {
  display: flex;
  flex-direction: column;
  gap: 0.125rem;
}

.grammar-unit-stat .stat-label {
  color: var(--text-secondary, #6b7280);
}

.dark-mode .grammar-unit-stat .stat-label {
  color: var(--gray-400);
}

.grammar-unit-stat .stat-value {
  margin-left: 0.25rem;
}

.grammar-unit-stat .correct-count {
  color: var(--success-color, #10b981);
}

.grammar-unit-stat .mastered-count {
  color: var(--primary-color, #3b82f6);
}

/* ============================================
   設定タブスタイル
   ============================================ */
.settings-tab-container {
  padding: 20px;
  min-height: 120px;
}

.settings-section {
  margin-bottom: 24px;
}

.settings-section-title {
  font-size: 1.1rem;
  font-weight: bold;
  color: var(--text-color);
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.dark-mode .settings-section-title {
  color: var(--white);
}

.settings-item {
  margin-bottom: 16px;
}

.settings-checkbox-label {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  padding: 12px;
  border-radius: 8px;
  transition: background-color 0.2s ease;
}

.settings-checkbox-label:hover {
  background: var(--gray-100);
}

.dark-mode .settings-checkbox-label:hover {
  background: var(--gray-800);
}

.settings-checkbox-label input[type="checkbox"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: var(--primary);
}

.settings-checkbox-label span {
  font-size: 1rem;
  color: var(--text-color);
}

.dark-mode .settings-checkbox-label span {
  color: var(--gray-200);
}

.settings-help-text {
  font-size: 0.85rem;
  color: var(--gray-600);
  margin-top: 8px;
  margin-left: 32px;
}

.dark-mode .settings-help-text {
  color: var(--gray-400);
}

/* ============================================
   準備中画面のスタイル
   ============================================ */
.coming-soon-container {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 60vh;
  padding: 2rem;
}

.coming-soon-content {
  text-align: center;
  max-width: 600px;
  padding: 3rem 2rem;
  background: var(--background-secondary, var(--gray-50));
  border-radius: 12px;
  box-shadow: 0 4px 6px rgb(0, 0, 0, 0.1);
}

.dark-mode .coming-soon-content {
  background: var(--gray-800);
}

.coming-soon-content h2 {
  font-size: 2rem;
  margin-bottom: 1rem;
  color: var(--text-color);
}

.coming-soon-content > p {
  font-size: 1.1rem;
  color: var(--gray-600);
  margin-bottom: 2rem;
}

.dark-mode .coming-soon-content > p {
  color: var(--gray-400);
}

.feature-preview {
  text-align: left;
  margin: 2rem 0;
  padding: 1.5rem;
  background: var(--background, white);
  border-radius: 8px;
  border: 2px solid var(--border-color, var(--gray-300));
}

.dark-mode .feature-preview {
  background: var(--gray-900);
  border-color: var(--gray-700);
}

.feature-preview h3 {
  font-size: 1.2rem;
  margin-bottom: 1rem;
  color: var(--text-color);
}

.feature-preview ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.feature-preview li {
  font-size: 1rem;
  padding: 0.5rem 0;
  color: var(--text-color);
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.update-info {
  font-size: 0.9rem;
  color: var(--gray-500);
  margin-top: 1.5rem;
  font-style: italic;
}

.dark-mode .update-info {
  color: var(--gray-500);
}

.update-info code {
  background: var(--gray-200);
  padding: 2px 6px;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 0.85rem;
}

.dark-mode .update-info code {
  background: var(--gray-700);
  color: var(--gray-300);
}

/* ============================================
   全文読解 - 文選択スタイル
   ============================================ */
.sentences-container {
  line-height: 2;
  margin-bottom: 1rem;
}

.sentence-clickable {
  cursor: pointer;
  padding: 2px 4px;
  border-radius: 4px;
  background-color: transparent;
  transition: background-color 0.2s;
}

.sentence-clickable:hover {
  background-color: #f0f0f0;
}

.sentence-clickable.selected {
  background-color: #e3f2fd;
}

.sentence-clickable.selected-reading {
  background-color: #fff9c4;
  font-weight: 500;
}

.dark-mode .sentence-clickable:hover {
  background-color: var(--gray-700);
}

.dark-mode .sentence-clickable.selected {
  background-color: #1565c0;
  color: white;
}

.dark-mode .sentence-clickable.selected-reading {
  background-color: #f57f17;
  color: white;
}

.selected-sentence-analysis {
  margin-top: 20px;
  padding: 20px;
  border: 2px solid #2196f3;
  border-radius: 8px;
  background-color: #f5f5f5;
}

.dark-mode .selected-sentence-analysis {
  background-color: var(--gray-800);
  border-color: #1976d2;
}

.selected-sentence-analysis h4 {
  margin-bottom: 15px;
  color: #1976d2;
}

.dark-mode .selected-sentence-analysis h4 {
  color: #64b5f6;
}

.selected-sentence-text {
  font-size: 1.1rem;
  line-height: 1.8;
  margin-bottom: 15px;
  padding: 10px;
  background-color: white;
  border-radius: 4px;
}

.dark-mode .selected-sentence-text {
  background-color: var(--gray-700);
  color: var(--gray-100);
}

.selected-sentence-note {
  font-size: 0.95rem;
  color: #666;
  font-style: italic;
}

.dark-mode .selected-sentence-note {
  color: var(--gray-400);
}

/* ============================================
   文法構造表示スタイル
   ============================================ */
.grammar-structure {
  margin-top: 0.5rem;
}

.grammar-tag {
  display: inline-block;
  padding: 3px 6px;
  border-radius: 4px;
  font-size: 0.85rem;
  border-left-width: 3px;
  border-left-style: solid;
}

/* 文法タグの色設定 */
.grammar-tag[data-tag="S"] { background-color: #3b82f620; border-left-color: #3b82f6; }
.grammar-tag[data-tag="V"] { background-color: #ef444420; border-left-color: #ef4444; }
.grammar-tag[data-tag="O"] { background-color: #10b98120; border-left-color: #10b981; }
.grammar-tag[data-tag="C"] { background-color: #f59e0b20; border-left-color: #f59e0b; }
.grammar-tag[data-tag="M"] { background-color: #8b5cf620; border-left-color: #8b5cf6; }
.grammar-tag[data-tag="Prep"] { background-color: #6366f120; border-left-color: #6366f1; }
.grammar-tag[data-tag="Conj"] { background-color: #ec489920; border-left-color: #ec4899; }
.grammar-tag[data-tag="Det"] { background-color: #14b8a620; border-left-color: #14b8a6; }
.grammar-tag[data-tag="Adj"] { background-color: #f9731620; border-left-color: #f97316; }
.grammar-tag[data-tag="Adv"] { background-color: #a855f720; border-left-color: #a855f7; }
.grammar-tag[data-tag="Unknown"] { background-color: #6b728020; border-left-color: #6b7280; }

.grammar-tag-label[data-tag="S"] { color: #3b82f6; }
.grammar-tag-label[data-tag="V"] { color: #ef4444; }
.grammar-tag-label[data-tag="O"] { color: #10b981; }
.grammar-tag-label[data-tag="C"] { color: #f59e0b; }
.grammar-tag-label[data-tag="M"] { color: #8b5cf6; }
.grammar-tag-label[data-tag="Prep"] { color: #6366f1; }
.grammar-tag-label[data-tag="Conj"] { color: #ec4899; }
.grammar-tag-label[data-tag="Det"] { color: #14b8a6; }
.grammar-tag-label[data-tag="Adj"] { color: #f97316; }
.grammar-tag-label[data-tag="Adv"] { color: #a855f7; }
.grammar-tag-label[data-tag="Unknown"] { color: #6b7280; }

.grammar-tag-label {
  margin-left: 4px;
  font-size: 0.75rem;
  font-weight: 600;
}

/* 詳しい文法説明 */
.detailed-grammar-explanation {
  max-height: 400px;
  overflow-y: auto;
}

.explanation-section {
  padding: 0.75rem;
  background-color: #fff;
  border-radius: 6px;
  border: 1px solid #e5e7eb;
}

.dark-mode .explanation-section {
  background-color: #1f2937;
  border-color: #374151;
}

.explanation-item p {
  line-height: 1.6;
}

.explanation-item em {
  font-weight: 600;
  color: #1f2937;
  font-style: normal;
}

.dark-mode .explanation-item em {
  color: #f9fafb;
}

/* 単語カードコンテナ */
.word-cards-container {
  margin-top: 1rem;
}

.word-cards-container .word-card {
  min-width: 80px;
}

/* 句読点カード */
.punctuation-card {
  display: inline-flex;
  align-items: center;
  padding: 6px 12px;
  background-color: #f3f4f6;
  border-radius: 6px;
  border-left: 3px solid #6b7280;
}

.dark-mode .punctuation-card {
  background-color: #374151;
}

.punctuation-card .font-bold {
  color: #1f2937;
}

.dark-mode .punctuation-card .font-bold {
  color: #f9fafb;
}

/* 熟語カード */
.phrasal-expressions-section {
  margin-top: 0.75rem;
  padding: 0.5rem;
  background-color: #fef3c7;
  border-left: 4px solid #f59e0b;
  border-radius: 8px;
}

.dark-mode .phrasal-expressions-section {
  background-color: #451a03;
  border-left-color: #f59e0b;
}

.phrasal-expression-card {
  background-color: #fff;
  padding: 0.5rem;
  border-radius: 6px;
  border: 1px solid #fbbf24;
}

.dark-mode .phrasal-expression-card {
  background-color: #78350f;
  border-color: #92400e;
}

.phrasal-expression-words {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 0.4rem;
}

.phrasal-word-item {
  flex: 1;
  text-align: center;
  padding: 0.3rem;
  background-color: #fef3c7;
  border-radius: 4px;
}

.dark-mode .phrasal-word-item {
  background-color: #92400e;
}

.phrasal-word {
  font-size: 0.9rem;
  font-weight: 600;
  color: #92400e;
  margin-bottom: 0.15rem;
}

.dark-mode .phrasal-word {
  color: #fef3c7;
}

.phrasal-word-meaning {
  font-size: 0.7rem;
  color: #78350f;
}

.dark-mode .phrasal-word-meaning {
  color: #fde68a;
}

.phrasal-expression-divider {
  position: relative;
  margin: 0.4rem 0;
  text-align: center;
}

.phrasal-divider-line {
  border-top: 2px dashed #fbbf24;
}

.dark-mode .phrasal-divider-line {
  border-top-color: #d97706;
}

.phrasal-type-label {
  display: inline-block;
  padding: 0.15rem 0.5rem;
  background-color: #f59e0b;
  color: #fff;
  font-size: 0.65rem;
  font-weight: 600;
  border-radius: 10px;
  margin-top: -0.5rem;
}

.phrasal-expression-meaning {
  text-align: center;
  font-size: 0.95rem;
  font-weight: 700;
  color: #92400e;
  padding: 0.3rem;
  background-color: #fffbeb;
  border-radius: 4px;
}

.dark-mode .phrasal-expression-meaning {
  color: #fef3c7;
  background-color: #451a03;
}

/* 構文パターンカード */
.grammar-patterns-section {
  margin-top: 1rem;
  padding: 0.75rem;
  background-color: #dbeafe;
  border-left: 4px solid #3b82f6;
  border-radius: 8px;
}

.dark-mode .grammar-patterns-section {
  background-color: #1e3a8a;
  border-left-color: #60a5fa;
}

.grammar-pattern-card {
  background-color: #fff;
  padding: 0.75rem;
  border-radius: 8px;
  border: 1px solid #93c5fd;
}

.dark-mode .grammar-pattern-card {
  background-color: #1e40af;
  border-color: #3b82f6;
}

.pattern-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
  padding-bottom: 0.4rem;
  border-bottom: 2px solid #bfdbfe;
}

.dark-mode .pattern-header {
  border-bottom-color: #3b82f6;
}

.pattern-name {
  font-size: 1rem;
  font-weight: 700;
  color: #1e40af;
}

.dark-mode .pattern-name {
  color: #bfdbfe;
}

.pattern-meaning {
  font-size: 0.875rem;
  font-weight: 600;
  color: #3b82f6;
  background-color: #eff6ff;
  padding: 0.25rem 0.75rem;
  border-radius: 12px;
}

.dark-mode .pattern-meaning {
  color: #dbeafe;
  background-color: #1e3a8a;
}

.pattern-sentence {
  font-size: 0.95rem;
  font-weight: 500;
  color: #1f2937;
  padding: 0.5rem;
  background-color: #f0f9ff;
  border-radius: 6px;
  border-left: 3px solid #3b82f6;
  margin-bottom: 0.5rem;
  font-style: italic;
}

.dark-mode .pattern-sentence {
  color: #f3f4f6;
  background-color: #1e3a8a;
  border-left-color: #60a5fa;
}

.pattern-explanation {
  font-size: 0.75rem;
  color: #4b5563;
  line-height: 1.5;
  padding: 0.4rem;
  background-color: #f9fafb;
  border-radius: 4px;
}

.dark-mode .pattern-explanation {
  color: #d1d5db;
  background-color: #374151;
}

/* フレックスユーティリティ */
.flex {
  display: flex;
}

.flex-wrap {
  flex-wrap: wrap;
}

.justify-between {
  justify-content: space-between;
}

.items-center {
  align-items: center;
}

.gap-2 {
  gap: 0.5rem;
}

.gap-4 {
  gap: 1rem;
}

.grid {
  display: grid;
}

.grid-cols-2 {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

.mb-2 {
  margin-bottom: 0.5rem;
}

.mb-3 {
  margin-bottom: 0.75rem;
}

.mb-4 {
  margin-bottom: 1rem;
}

.mt-3 {
  margin-top: 0.75rem;
}

.mt-4 {
  margin-top: 1rem;
}

.m-0 {
  margin: 0;
}

.ml-1 {
  margin-left: 0.25rem;
}

.ml-2 {
  margin-left: 0.5rem;
}

.ml-6 {
  margin-left: 1.5rem;
}

.text-xs {
  font-size: 0.75rem;
}

.text-sm {
  font-size: 0.875rem;
}

.text-lg {
  font-size: 1.125rem;
}

.text-gray-600 {
  color: #4b5563;
}

.dark-mode .text-gray-400 {
  color: #9ca3af;
}

.font-semibold {
  font-weight: 600;
}

.font-bold {
  font-weight: 700;
}

.rounded {
  border-radius: 0.25rem;
}

.space-y-2 > * + * {
  margin-top: 0.5rem;
}

.space-y-3 > * + * {
  margin-top: 0.75rem;
}

.bg-blue-100 {
  background-color: #dbeafe;
}

.bg-blue-200:hover,
.hover\:bg-blue-200:hover {
  background-color: #bfdbfe;
}

.dark-mode .bg-blue-900 {
  background-color: #1e3a8a;
}

.dark-mode .hover\:bg-blue-800:hover {
  background-color: #1e40af;
}

.text-blue-700 {
  color: #1d4ed8;
}

.dark-mode .text-blue-200 {
  color: #bfdbfe;
}

.p-3 {
  padding: 0.75rem;
}

.px-2 {
  padding-left: 0.5rem;
  padding-right: 0.5rem;
}

.py-1 {
  padding-top: 0.25rem;
  padding-bottom: 0.25rem;
}

.bg-gray-50 {
  background-color: #f9fafb;
}

.bg-gray-200 {
  background-color: #e5e7eb;
}

.bg-gray-200:hover,
.hover\:bg-gray-300:hover {
  background-color: #d1d5db;
}

.dark-mode .bg-gray-700 {
  background-color: #374151;
}

.dark-mode .hover\:bg-gray-600:hover {
  background-color: #4b5563;
}

.dark-mode .bg-gray-800 {
  background-color: #1f2937;
}

/* ============================================
   読解タブ - 全文表示エリア
   ============================================ */
.reading-full-text-area {
  margin-bottom: 2rem;
  padding: 1.5rem;
  background-color: #f9fafb;
  border-radius: 8px;
}

.dark-mode .reading-full-text-area {
  background-color: var(--gray-800);
}

.reading-full-text-area h4 {
  color: var(--primary);
  margin-bottom: 1rem;
}

.dark-mode .reading-full-text-area h4 {
  color: #64b5f6;
}

.mt-6 {
  margin-top: 1.5rem;
}

.text-lg {
  font-size: 1.125rem;
}
