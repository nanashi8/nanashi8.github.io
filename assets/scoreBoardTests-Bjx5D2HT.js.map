{"version":3,"file":"scoreBoardTests-Bjx5D2HT.js","sources":["../../src/ai/adaptation/adaptiveLearningAI.ts","../../src/features/learning/forgettingAlert.ts","../../src/tests/scoreBoardTests.ts"],"sourcesContent":["/**\n * é©å¿œå‹å­¦ç¿’AI - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è„³ã®è¨˜æ†¶ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Œå…¨ã«æŠŠæ¡ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ \n *\n * ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š\n * 1. è¨˜æ†¶å®šç€åº¦ã®0-100%åˆ¤å®š\n * 2. æœ€é©ãªå¾©ç¿’é–“éš”ã®è‡ªå‹•è¨ˆç®—ï¼ˆé–“éš”åå¾©ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼‰\n * 3. å€‹äººã®å¿˜å´æ›²ç·šã®å­¦ç¿’\n * 4. å®šç€ãƒ«ãƒ¼ãƒˆã®æœ€é©åŒ–\n */\n\nimport { Question } from '@/types';\nimport { WordProgress } from '@/storage/progress/progressStorage';\n\n/**\n * è¨˜æ†¶å®šç€åº¦ï¼ˆ0-100%ï¼‰\n * - 0-20%: æœªå­¦ç¿’/å¿˜å´\n * - 21-40%: èªè­˜ãƒ¬ãƒ™ãƒ«\n * - 41-60%: æƒ³èµ·ãƒ¬ãƒ™ãƒ«\n * - 61-80%: ç†è§£ãƒ¬ãƒ™ãƒ«\n * - 81-95%: å®šç€ãƒ¬ãƒ™ãƒ«\n * - 96-100%: å®Œå…¨å®šç€ï¼ˆé•·æœŸè¨˜æ†¶ï¼‰\n */\nexport interface MemoryRetention {\n  word: string;\n  retentionScore: number; // 0-100\n  confidence: number; // åˆ¤å®šã®ç¢ºåº¦ï¼ˆ0-1ï¼‰\n  lastCalculated: number; // ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—\n  forgettingCurveParams: {\n    initialStrength: number; // åˆæœŸè¨˜æ†¶å¼·åº¦\n    decayRate: number; // å¿˜å´ç‡ï¼ˆå€‹äººå·®ï¼‰\n    reinforcementCount: number; // å¼·åŒ–å›æ•°\n  };\n  nextReviewTime: number; // æ¬¡å›å¾©ç¿’ã®æœ€é©ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼‰\n  reviewInterval: number; // ç¾åœ¨ã®å¾©ç¿’é–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰\n  reviewHistory: ReviewEvent[]; // å¾©ç¿’å±¥æ­´\n}\n\nexport interface ReviewEvent {\n  timestamp: number;\n  wasCorrect: boolean;\n  responseTime: number; // ãƒŸãƒªç§’\n  confidence: 'high' | 'medium' | 'low'; // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è‡ªä¿¡åº¦\n  retentionScoreBefore: number; // å¾©ç¿’å‰ã®å®šç€åº¦\n  retentionScoreAfter: number; // å¾©ç¿’å¾Œã®å®šç€åº¦\n}\n\n/**\n * é–“éš”åå¾©ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«\n * èª¤ç­” â†’ 2-3å•å¾Œã«å†å‡ºé¡Œ\n * æ­£ç­” â†’ è¨˜æ†¶å¼·åº¦ã«å¿œã˜ã¦5-15å•å¾Œã«å†å‡ºé¡Œ\n */\nexport interface SpacedRepetitionSchedule {\n  word: string;\n  priority: number; // å‡ºé¡Œå„ªå…ˆåº¦ï¼ˆé«˜ã„ã»ã©æ—©ãå‡ºé¡Œï¼‰\n  nextQuestionIndex: number; // ä½•å•å¾Œã«å‡ºé¡Œã™ã‚‹ã‹\n  reason: string; // å‡ºé¡Œç†ç”±ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰\n  estimatedDifficulty: number; // æ¨å®šé›£æ˜“åº¦ï¼ˆ0-1ï¼‰\n}\n\n/**\n * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å­¦ç¿’ç‰¹æ€§ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«\n */\nexport interface UserLearningCharacteristics {\n  avgForgettingRate: number; // å¹³å‡å¿˜å´ç‡\n  avgReinforcementEffect: number; // å¹³å‡å¼·åŒ–åŠ¹æœ\n  optimalReviewIntervals: number[]; // æœ€é©ãªå¾©ç¿’é–“éš”ï¼ˆãƒŸãƒªç§’ï¼‰\n  categorySpecificRates: { [category: string]: number }; // ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥å¿˜å´ç‡\n  timeOfDayEfficiency: { [hour: number]: number }; // æ™‚é–“å¸¯åˆ¥å­¦ç¿’åŠ¹ç‡\n  learningVelocity: number; // å­¦ç¿’é€Ÿåº¦ï¼ˆå˜èª/æ—¥ï¼‰\n  memoryCapacity: number; // çŸ­æœŸè¨˜æ†¶å®¹é‡ï¼ˆæ¨å®šï¼‰\n}\n\n/**\n * è¨˜æ†¶å®šç€åº¦ã‚’è¨ˆç®—\n * ã‚¨ãƒ“ãƒ³ã‚°ãƒã‚¦ã‚¹ã®å¿˜å´æ›²ç·š + å€‹äººã®å­¦ç¿’å±¥æ­´ã‚’çµ„ã¿åˆã‚ã›\n */\nexport function calculateMemoryRetention(\n  word: string,\n  wordProgress: WordProgress | undefined,\n  currentTime: number = Date.now()\n): MemoryRetention {\n  if (!wordProgress) {\n    // æœªå­¦ç¿’ã®å˜èª\n    return {\n      word,\n      retentionScore: 0,\n      confidence: 1.0,\n      lastCalculated: currentTime,\n      forgettingCurveParams: {\n        initialStrength: 0,\n        decayRate: 0.5, // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤\n        reinforcementCount: 0,\n      },\n      nextReviewTime: currentTime,\n      reviewInterval: 0,\n      reviewHistory: [],\n    };\n  }\n\n  // å­¦ç¿’å±¥æ­´ã‹ã‚‰å¿˜å´æ›²ç·šã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¨å®š\n  const totalAttempts = wordProgress.correctCount + wordProgress.incorrectCount;\n  const accuracy = totalAttempts > 0 ? wordProgress.correctCount / totalAttempts : 0;\n\n  // æœ€çµ‚å­¦ç¿’ã‹ã‚‰ã®çµŒéæ™‚é–“ï¼ˆæ—¥æ•°ï¼‰\n  const daysSinceLastStudy = (currentTime - wordProgress.lastStudied) / (1000 * 60 * 60 * 24);\n\n  // åˆæœŸè¨˜æ†¶å¼·åº¦ï¼ˆæ­£ç­”ç‡ã¨é€£ç¶šæ­£è§£ã‹ã‚‰ç®—å‡ºï¼‰\n  const initialStrength = Math.min(\n    100,\n    accuracy * 100 * 0.6 + wordProgress.consecutiveCorrect * 10\n  );\n\n  // å€‹äººã®å¿˜å´ç‡ã‚’æ¨å®šï¼ˆå¿œç­”æ™‚é–“ã¨èª¤ç­”ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰ï¼‰\n  const avgResponseTime = wordProgress.averageResponseTime || 3000;\n  const responseTimeFactor = Math.min(1, avgResponseTime / 5000); // é…ã„ã»ã©å¿˜å´ç‡é«˜ã„\n  const errorRate = totalAttempts > 0 ? wordProgress.incorrectCount / totalAttempts : 0.5;\n  const decayRate = 0.3 + errorRate * 0.4 + responseTimeFactor * 0.3;\n\n  // å¼·åŒ–å›æ•°ï¼ˆå¾©ç¿’ã®åŠ¹æœï¼‰\n  const reinforcementCount = wordProgress.correctCount;\n\n  // ã‚¨ãƒ“ãƒ³ã‚°ãƒã‚¦ã‚¹ã®å¿˜å´æ›²ç·šã‚’å€‹äººåŒ–\n  // R(t) = R0 * e^(-t * k / (1 + reinforcement))\n  // R0: åˆæœŸå¼·åº¦, t: çµŒéæ—¥æ•°, k: å¿˜å´ç‡, reinforcement: å¼·åŒ–å›æ•°\n  const reinforcementFactor = 1 + Math.log1p(reinforcementCount);\n  const retentionScore = Math.max(\n    0,\n    Math.min(\n      100,\n      initialStrength * Math.exp((-daysSinceLastStudy * decayRate) / reinforcementFactor)\n    )\n  );\n\n  // ä¿¡é ¼åº¦ï¼ˆãƒ‡ãƒ¼ã‚¿é‡ã«åŸºã¥ãï¼‰\n  const confidence = Math.min(1, totalAttempts / 10);\n\n  // æ¬¡å›å¾©ç¿’ã®æœ€é©ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¨ˆç®—\n  const { nextReviewTime, reviewInterval } = calculateOptimalReviewTime(\n    retentionScore,\n    reinforcementCount,\n    decayRate,\n    currentTime\n  );\n\n  return {\n    word,\n    retentionScore: Math.round(retentionScore * 10) / 10,\n    confidence,\n    lastCalculated: currentTime,\n    forgettingCurveParams: {\n      initialStrength,\n      decayRate,\n      reinforcementCount,\n    },\n    nextReviewTime,\n    reviewInterval,\n    reviewHistory: buildReviewHistory(wordProgress),\n  };\n}\n\n/**\n * æœ€é©ãªå¾©ç¿’ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¨ˆç®—\n * è¨˜æ†¶ãŒ70%ç¨‹åº¦ã«ä½ä¸‹ã™ã‚‹æ™‚ç‚¹ã‚’ç‹™ã†ï¼ˆåŠ¹ç‡çš„ãªè¨˜æ†¶å®šç€ï¼‰\n */\nfunction calculateOptimalReviewTime(\n  currentRetention: number,\n  reinforcementCount: number,\n  decayRate: number,\n  currentTime: number\n): { nextReviewTime: number; reviewInterval: number } {\n  const targetRetention = 70; // ç›®æ¨™å®šç€åº¦\n\n  if (currentRetention < targetRetention) {\n    // ã™ã§ã«ç›®æ¨™ã‚’ä¸‹å›ã£ã¦ã„ã‚‹ â†’ å³åº§ã«å¾©ç¿’\n    return {\n      nextReviewTime: currentTime,\n      reviewInterval: 0,\n    };\n  }\n\n  // ç›®æ¨™å®šç€åº¦ã«é”ã™ã‚‹ã¾ã§ã®æ—¥æ•°ã‚’è¨ˆç®—\n  // targetRetention = currentRetention * e^(-days * decayRate / reinforcementFactor)\n  const reinforcementFactor = 1 + Math.log1p(reinforcementCount);\n  const daysUntilTarget =\n    (Math.log(currentRetention / targetRetention) * reinforcementFactor) / decayRate;\n\n  // æœ€å°1æ™‚é–“ã€æœ€å¤§30æ—¥\n  const intervalDays = Math.max(0.04, Math.min(30, daysUntilTarget));\n  const intervalMs = intervalDays * 24 * 60 * 60 * 1000;\n\n  return {\n    nextReviewTime: currentTime + intervalMs,\n    reviewInterval: intervalMs,\n  };\n}\n\n/**\n * å¾©ç¿’å±¥æ­´ã‚’æ§‹ç¯‰ï¼ˆWordProgressã‹ã‚‰ï¼‰\n */\nfunction buildReviewHistory(wordProgress: WordProgress): ReviewEvent[] {\n  const events: ReviewEvent[] = [];\n\n  // ç°¡æ˜“çš„ãªå±¥æ­´æ§‹ç¯‰ï¼ˆå®Ÿéš›ã®è©³ç´°å±¥æ­´ãŒãªã„å ´åˆï¼‰\n  const totalAttempts = wordProgress.correctCount + wordProgress.incorrectCount;\n  if (totalAttempts === 0) return events;\n\n  // æœ€å¾Œã®å­¦ç¿’ã‚¤ãƒ™ãƒ³ãƒˆã®ã¿è¨˜éŒ²\n  const accuracy = wordProgress.correctCount / totalAttempts;\n  events.push({\n    timestamp: wordProgress.lastStudied,\n    wasCorrect: wordProgress.consecutiveCorrect > 0,\n    responseTime: wordProgress.averageResponseTime || 3000,\n    confidence: accuracy > 0.8 ? 'high' : accuracy > 0.5 ? 'medium' : 'low',\n    retentionScoreBefore: accuracy * 80,\n    retentionScoreAfter: accuracy * 100,\n  });\n\n  return events;\n}\n\n/**\n * é–“éš”åå¾©ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”Ÿæˆ\n * - èª¤ç­”ã—ãŸå˜èª: 2-3å•å¾Œã«å‡ºé¡Œ\n * - æ­£ç­”ã—ãŸå˜èª: è¨˜æ†¶å¼·åº¦ã«å¿œã˜ã¦5-15å•å¾Œã«å‡ºé¡Œ\n */\nexport function generateSpacedRepetitionSchedule(\n  recentAnswers: Array<{ word: string; wasCorrect: boolean; timestamp: number }>,\n  wordProgressMap: { [word: string]: WordProgress },\n  currentQuestionIndex: number,\n  totalQuestionsInSession: number\n): SpacedRepetitionSchedule[] {\n  const schedule: SpacedRepetitionSchedule[] = [];\n  const now = Date.now();\n\n  recentAnswers.forEach((answer) => {\n    const retention = calculateMemoryRetention(answer.word, wordProgressMap[answer.word], now);\n\n    let nextQuestionIndex: number;\n    let priority: number;\n    let reason: string;\n\n    if (!answer.wasCorrect) {\n      // èª¤ç­” â†’ 2-3å•å¾Œã«å†å‡ºé¡Œï¼ˆçŸ­æœŸè¨˜æ†¶ã¸ã®åˆ»å°ï¼‰\n      nextQuestionIndex = currentQuestionIndex + 2 + Math.floor(Math.random() * 2);\n      priority = 100; // æœ€é«˜å„ªå…ˆåº¦\n      reason = 'èª¤ç­”ç›´å¾Œã®çŸ­æœŸè¨˜æ†¶å¼·åŒ–';\n    } else {\n      // æ­£ç­” â†’ è¨˜æ†¶å®šç€åº¦ã«å¿œã˜ã¦é–“éš”ã‚’èª¿æ•´\n      if (retention.retentionScore > 90) {\n        // ååˆ†å®šç€ â†’ 15-20å•å¾Œ\n        nextQuestionIndex = currentQuestionIndex + 15 + Math.floor(Math.random() * 6);\n        priority = 20;\n        reason = 'é•·æœŸè¨˜æ†¶ã¸ã®ç§»è¡Œç¢ºèª';\n      } else if (retention.retentionScore > 70) {\n        // å®šç€ä¸­ â†’ 10-15å•å¾Œ\n        nextQuestionIndex = currentQuestionIndex + 10 + Math.floor(Math.random() * 6);\n        priority = 40;\n        reason = 'å®šç€å¼·åŒ–';\n      } else if (retention.retentionScore > 50) {\n        // ä¸å®‰å®š â†’ 5-8å•å¾Œ\n        nextQuestionIndex = currentQuestionIndex + 5 + Math.floor(Math.random() * 4);\n        priority = 60;\n        reason = 'è¨˜æ†¶ã®å®‰å®šåŒ–';\n      } else {\n        // å¼±ã„è¨˜æ†¶ â†’ 3-5å•å¾Œ\n        nextQuestionIndex = currentQuestionIndex + 3 + Math.floor(Math.random() * 3);\n        priority = 80;\n        reason = 'å¼±ã„è¨˜æ†¶ã®å†å¼·åŒ–';\n      }\n    }\n\n    // ã‚»ãƒƒã‚·ãƒ§ãƒ³å†…ã«åã¾ã‚‹ã‚ˆã†ã«èª¿æ•´\n    if (nextQuestionIndex >= totalQuestionsInSession) {\n      nextQuestionIndex = totalQuestionsInSession - 1;\n    }\n\n    schedule.push({\n      word: answer.word,\n      priority,\n      nextQuestionIndex,\n      reason,\n      estimatedDifficulty: 1 - retention.retentionScore / 100,\n    });\n  });\n\n  return schedule;\n}\n\n/**\n * å‡ºé¡Œã™ã‚‹å•é¡Œã‚’å‹•çš„ã«é¸æŠ\n * - é–“éš”åå¾©ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã«åŸºã¥ãå†å‡ºé¡Œ\n * - æ–°è¦å•é¡Œ\n * - å¾©ç¿’ãŒå¿…è¦ãªå•é¡Œ\n */\nexport function selectNextQuestions(\n  allQuestions: Question[],\n  wordProgressMap: { [word: string]: WordProgress },\n  spacedRepetitionSchedule: SpacedRepetitionSchedule[],\n  currentQuestionIndex: number,\n  batchSize: number = 1\n): Question[] {\n  const now = Date.now();\n  const selectedQuestions: Question[] = [];\n\n  // 1. é–“éš”åå¾©ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰ã®å‡ºé¡Œ\n  const dueForReview = spacedRepetitionSchedule\n    .filter((schedule) => schedule.nextQuestionIndex === currentQuestionIndex)\n    .sort((a, b) => b.priority - a.priority);\n\n  dueForReview.forEach((schedule) => {\n    const question = allQuestions.find((q) => q.word === schedule.word);\n    if (question && selectedQuestions.length < batchSize) {\n      selectedQuestions.push(question);\n    }\n  });\n\n  // 2. å¾©ç¿’ãŒå¿…è¦ãªå•é¡Œï¼ˆæ¬¡å›å¾©ç¿’æ™‚åˆ»ãŒéãã¦ã„ã‚‹ï¼‰\n  if (selectedQuestions.length < batchSize) {\n    const needsReview = allQuestions\n      .map((q) => ({\n        question: q,\n        retention: calculateMemoryRetention(q.word, wordProgressMap[q.word], now),\n      }))\n      .filter(({ retention }) => retention.nextReviewTime <= now)\n      .sort((a, b) => a.retention.retentionScore - b.retention.retentionScore); // å®šç€åº¦ãŒä½ã„é †\n\n    needsReview.forEach(({ question }) => {\n      if (\n        selectedQuestions.length < batchSize &&\n        !selectedQuestions.find((q) => q.word === question.word)\n      ) {\n        selectedQuestions.push(question);\n      }\n    });\n  }\n\n  // 3. æ–°è¦å•é¡Œï¼ˆã¾ã å‡ºé¡Œã•ã‚Œã¦ã„ãªã„ï¼‰\n  if (selectedQuestions.length < batchSize) {\n    const newQuestions = allQuestions\n      .filter((q) => !wordProgressMap[q.word])\n      .slice(0, batchSize - selectedQuestions.length);\n\n    selectedQuestions.push(...newQuestions);\n  }\n\n  return selectedQuestions;\n}\n\n/**\n * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å­¦ç¿’ç‰¹æ€§ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ§‹ç¯‰\n */\nexport function buildUserLearningCharacteristics(wordProgressMap: {\n  [word: string]: WordProgress;\n}): UserLearningCharacteristics {\n  const wordProgresses = Object.values(wordProgressMap);\n\n  if (wordProgresses.length === 0) {\n    return {\n      avgForgettingRate: 0.5,\n      avgReinforcementEffect: 1.2,\n      optimalReviewIntervals: [\n        1000 * 60 * 60 * 24, // 1æ—¥\n        1000 * 60 * 60 * 24 * 3, // 3æ—¥\n        1000 * 60 * 60 * 24 * 7, // 7æ—¥\n        1000 * 60 * 60 * 24 * 14, // 14æ—¥\n        1000 * 60 * 60 * 24 * 30, // 30æ—¥\n      ],\n      categorySpecificRates: {},\n      timeOfDayEfficiency: {},\n      learningVelocity: 20,\n      memoryCapacity: 7, // ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼7Â±2\n    };\n  }\n\n  // å¿˜å´ç‡ã®å¹³å‡ã‚’è¨ˆç®—\n  let totalDecayRate = 0;\n  let count = 0;\n\n  wordProgresses.forEach((wp) => {\n    const totalAttempts = wp.correctCount + wp.incorrectCount;\n    if (totalAttempts > 0) {\n      const errorRate = wp.incorrectCount / totalAttempts;\n      const responseTimeFactor = Math.min(1, (wp.averageResponseTime || 3000) / 5000);\n      const decayRate = 0.3 + errorRate * 0.4 + responseTimeFactor * 0.3;\n      totalDecayRate += decayRate;\n      count++;\n    }\n  });\n\n  const avgForgettingRate = count > 0 ? totalDecayRate / count : 0.5;\n\n  // ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥å¿˜å´ç‡\n  const categoryRates: { [category: string]: { sum: number; count: number } } = {};\n\n  wordProgresses.forEach((wp) => {\n    if (wp.category) {\n      if (!categoryRates[wp.category]) {\n        categoryRates[wp.category] = { sum: 0, count: 0 };\n      }\n      const totalAttempts = wp.correctCount + wp.incorrectCount;\n      if (totalAttempts > 0) {\n        const errorRate = wp.incorrectCount / totalAttempts;\n        categoryRates[wp.category].sum += errorRate;\n        categoryRates[wp.category].count++;\n      }\n    }\n  });\n\n  const categorySpecificRates: { [category: string]: number } = {};\n  Object.entries(categoryRates).forEach(([category, data]) => {\n    categorySpecificRates[category] = data.count > 0 ? data.sum / data.count : 0.5;\n  });\n\n  // å­¦ç¿’é€Ÿåº¦ï¼ˆéå»7æ—¥é–“ã®å¹³å‡ï¼‰\n  const now = Date.now();\n  const sevenDaysAgo = now - 7 * 24 * 60 * 60 * 1000;\n  const recentWords = wordProgresses.filter((wp) => wp.lastStudied >= sevenDaysAgo);\n  const learningVelocity = recentWords.length / 7;\n\n  // æœ€é©ãªå¾©ç¿’é–“éš”ï¼ˆå¿˜å´ç‡ã«åŸºã¥ã„ã¦èª¿æ•´ï¼‰\n  const baseIntervals = [1, 3, 7, 14, 30]; // æ—¥æ•°\n  const optimalReviewIntervals = baseIntervals.map(\n    (days) => days * 24 * 60 * 60 * 1000 * (1 / avgForgettingRate)\n  );\n\n  return {\n    avgForgettingRate,\n    avgReinforcementEffect: 1.2,\n    optimalReviewIntervals,\n    categorySpecificRates,\n    timeOfDayEfficiency: {},\n    learningVelocity,\n    memoryCapacity: 7,\n  };\n}\n\n/**\n * å®šç€ç‡ã‚’è¨ˆç®—ï¼ˆå…¨ä½“çµ±è¨ˆç”¨ï¼‰\n * å®šç€ = retentionScore >= 80%\n */\nexport function calculateRetentionRate(wordProgressMap: { [word: string]: WordProgress }): {\n  retentionRate: number;\n  masteredCount: number;\n  appearedCount: number;\n} {\n  const wordProgresses = Object.values(wordProgressMap);\n  const appearedWords = wordProgresses.filter((wp) => wp.correctCount + wp.incorrectCount > 0);\n\n  let masteredCount = 0;\n  const now = Date.now();\n\n  appearedWords.forEach((wp) => {\n    const retention = calculateMemoryRetention(wp.word, wp, now);\n    if (retention.retentionScore >= 80) {\n      masteredCount++;\n    }\n  });\n\n  const retentionRate = appearedWords.length > 0 ? (masteredCount / appearedWords.length) * 100 : 0;\n\n  // å®šç€ç‡ã¯0-100%ã®ç¯„å›²ã«åˆ¶é™\n  const normalizedRetentionRate = Math.min(100, Math.max(0, retentionRate));\n\n  return {\n    retentionRate: Math.round(normalizedRetentionRate),\n    masteredCount,\n    appearedCount: appearedWords.length,\n  };\n}\n","/**\n * å¿˜å´äºˆæ¸¬ã‚¢ãƒ©ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ \n * å˜èªåˆ¥ã¨ã‚°ãƒ«ãƒ¼ãƒ—åˆ¥ã®å¿˜å´ã‚’äºˆæ¸¬ã—ã€å¾©ç¿’ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’é€šçŸ¥\n */\n\nimport { calculateMemoryRetention } from '@/ai/adaptation/adaptiveLearningAI';\nimport { loadProgressSync, WordProgress } from '@/storage/progress/progressStorage';\nimport { analyzeConfusionPatterns, ConfusionGroup } from '@/features/analysis/confusionPairs';\n\n/**\n * å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ\n */\nexport interface ForgettingAlert {\n  type: 'word' | 'group';\n  word?: string; // å˜èªåˆ¥ã‚¢ãƒ©ãƒ¼ãƒˆ\n  group?: ConfusionGroup; // ã‚°ãƒ«ãƒ¼ãƒ—åˆ¥ã‚¢ãƒ©ãƒ¼ãƒˆ\n  currentRetention: number; // ç¾åœ¨ã®å®šç€åº¦ï¼ˆ0-100ï¼‰\n  predictedRetention24h: number; // 24æ™‚é–“å¾Œã®äºˆæ¸¬å®šç€åº¦\n  predictedRetention7d: number; // 7æ—¥å¾Œã®äºˆæ¸¬å®šç€åº¦\n  urgency: 'critical' | 'high' | 'medium' | 'low';\n  message: string;\n  recommendedAction: string;\n  daysUntilCritical: number; // å®šç€åº¦50%ã‚’ä¸‹å›ã‚‹ã¾ã§ã®æ—¥æ•°\n}\n\n/**\n * ã™ã¹ã¦ã®å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å–å¾—\n */\nexport function getAllForgettingAlerts(): ForgettingAlert[] {\n  const alerts: ForgettingAlert[] = [];\n\n  // å˜èªåˆ¥ã‚¢ãƒ©ãƒ¼ãƒˆ\n  const wordAlerts = getWordForgettingAlerts();\n  alerts.push(...wordAlerts);\n\n  // ã‚°ãƒ«ãƒ¼ãƒ—åˆ¥ã‚¢ãƒ©ãƒ¼ãƒˆ\n  const groupAlerts = getGroupForgettingAlerts();\n  alerts.push(...groupAlerts);\n\n  // ç·Šæ€¥åº¦é †ã«ã‚½ãƒ¼ãƒˆ\n  return alerts.sort((a, b) => {\n    const urgencyOrder = { critical: 0, high: 1, medium: 2, low: 3 };\n    return urgencyOrder[a.urgency] - urgencyOrder[b.urgency];\n  });\n}\n\n/**\n * å˜èªåˆ¥ã®å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ\n */\nfunction getWordForgettingAlerts(): ForgettingAlert[] {\n  const progress = loadProgressSync();\n  const alerts: ForgettingAlert[] = [];\n  const now = Date.now();\n\n  Object.entries(progress.wordProgress).forEach(([word, wp]) => {\n    // ä¸€åº¦ã‚‚å­¦ç¿’ã—ã¦ã„ãªã„å˜èªã¯ã‚¹ã‚­ãƒƒãƒ—\n    if (wp.correctCount + wp.incorrectCount === 0) return;\n\n    // è¨˜æ†¶å®šç€åº¦ã‚’è¨ˆç®—\n    const retention = calculateMemoryRetention(word, wp, now);\n\n    // 24æ™‚é–“å¾Œã®äºˆæ¸¬\n    const retention24h = predictRetentionAfterDays(wp, 1);\n\n    // 7æ—¥å¾Œã®äºˆæ¸¬\n    const retention7d = predictRetentionAfterDays(wp, 7);\n\n    // å®šç€åº¦50%ã‚’ä¸‹å›ã‚‹ã¾ã§ã®æ—¥æ•°\n    const daysUntilCritical = calculateDaysUntilCritical(wp, retention.retentionScore);\n\n    // ã‚¢ãƒ©ãƒ¼ãƒˆãŒå¿…è¦ã‹ãƒã‚§ãƒƒã‚¯\n    let urgency: 'critical' | 'high' | 'medium' | 'low' | null = null;\n    let message = '';\n    let recommendedAction = '';\n\n    if (retention.retentionScore < 50) {\n      urgency = 'critical';\n      message = `ã€Œ${word}ã€ã®å®šç€åº¦ãŒ${Math.round(retention.retentionScore)}%ã¾ã§ä½ä¸‹ã—ã¦ã„ã¾ã™ï¼`;\n      recommendedAction = 'ä»Šã™ãå¾©ç¿’ã—ã¦ãã ã•ã„';\n    } else if (retention24h < 50) {\n      urgency = 'high';\n      message = `ã€Œ${word}ã€ã¯æ˜æ—¥ã¾ã§ã«å¾©ç¿’ã—ãªã„ã¨å®šç€åº¦ãŒ50%ä»¥ä¸‹ã«ä½ä¸‹ã—ã¾ã™`;\n      recommendedAction = 'æœ¬æ—¥ä¸­ã«å¾©ç¿’ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™';\n    } else if (retention7d < 50) {\n      urgency = 'medium';\n      message = `ã€Œ${word}ã€ã¯${daysUntilCritical}æ—¥å¾Œã«å¾©ç¿’ãŒå¿…è¦ã«ãªã‚Šã¾ã™`;\n      recommendedAction = `${daysUntilCritical}æ—¥ä»¥å†…ã«å¾©ç¿’ã—ã¦ãã ã•ã„`;\n    } else if (retention.retentionScore < 70 && retention7d < 70) {\n      urgency = 'low';\n      message = `ã€Œ${word}ã€ã®å®šç€åº¦ã¯${Math.round(retention.retentionScore)}%ã§ã™`;\n      recommendedAction = 'ä»Šé€±ä¸­ã«å¾©ç¿’ã™ã‚‹ã¨åŠ¹æœçš„ã§ã™';\n    }\n\n    if (urgency) {\n      alerts.push({\n        type: 'word',\n        word,\n        currentRetention: Math.round(retention.retentionScore),\n        predictedRetention24h: Math.round(retention24h),\n        predictedRetention7d: Math.round(retention7d),\n        urgency,\n        message,\n        recommendedAction,\n        daysUntilCritical,\n      });\n    }\n  });\n\n  return alerts;\n}\n\n/**\n * ã‚°ãƒ«ãƒ¼ãƒ—åˆ¥ã®å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ\n */\nfunction getGroupForgettingAlerts(): ForgettingAlert[] {\n  const confusionGroups = analyzeConfusionPatterns();\n  const alerts: ForgettingAlert[] = [];\n  const progress = loadProgressSync();\n\n  confusionGroups\n    .filter((g) => g.needsReview)\n    .slice(0, 5) // ä¸Šä½5ã‚°ãƒ«ãƒ¼ãƒ—ã®ã¿\n    .forEach((group) => {\n      // ã‚°ãƒ«ãƒ¼ãƒ—å†…ã®å˜èªã®å¹³å‡å®šç€åº¦ã‚’è¨ˆç®—\n      let totalRetention = 0;\n      let count = 0;\n      let minRetention = 100;\n\n      group.words.forEach((word) => {\n        const wp = progress.wordProgress[word];\n        if (wp && wp.correctCount + wp.incorrectCount > 0) {\n          const retention = calculateMemoryRetention(word, wp);\n          totalRetention += retention.retentionScore;\n          minRetention = Math.min(minRetention, retention.retentionScore);\n          count++;\n        }\n      });\n\n      if (count === 0) return;\n\n      const avgRetention = totalRetention / count;\n\n      // ã‚°ãƒ«ãƒ¼ãƒ—ã®ç·Šæ€¥åº¦ã‚’åˆ¤å®š\n      let urgency: 'critical' | 'high' | 'medium' | 'low';\n      if (minRetention < 50 || avgRetention < 55) {\n        urgency = 'critical';\n      } else if (avgRetention < 65) {\n        urgency = 'high';\n      } else if (avgRetention < 75) {\n        urgency = 'medium';\n      } else {\n        urgency = 'low';\n      }\n\n      const message = `æ··åŒã—ã‚„ã™ã„å˜èªã‚°ãƒ«ãƒ¼ãƒ—ã€Œ${group.words.join(', ')}ã€ã®å®šç€åº¦ãŒä½ä¸‹ã—ã¦ã„ã¾ã™`;\n      const recommendedAction = 'åŒºåˆ¥ã‚’æ„è­˜ã—ãªãŒã‚‰é›†ä¸­çš„ã«å¾©ç¿’ã—ã¦ãã ã•ã„';\n\n      alerts.push({\n        type: 'group',\n        group,\n        currentRetention: Math.round(avgRetention),\n        predictedRetention24h: Math.round(avgRetention * 0.95), // ç°¡æ˜“äºˆæ¸¬\n        predictedRetention7d: Math.round(avgRetention * 0.85), // ç°¡æ˜“äºˆæ¸¬\n        urgency,\n        message,\n        recommendedAction,\n        daysUntilCritical: Math.max(1, Math.floor((avgRetention - 50) / 5)),\n      });\n    });\n\n  return alerts;\n}\n\n/**\n * Næ—¥å¾Œã®å®šç€åº¦ã‚’äºˆæ¸¬\n */\nfunction predictRetentionAfterDays(wp: WordProgress, days: number): number {\n  const totalAttempts = wp.correctCount + wp.incorrectCount;\n  if (totalAttempts === 0) return 0;\n\n  const accuracy = wp.correctCount / totalAttempts;\n  const initialStrength = accuracy * 100;\n\n  // å¿˜å´ç‡ã‚’æ¨å®š\n  const errorRate = wp.incorrectCount / totalAttempts;\n  const decayRate = 0.3 + errorRate * 0.4;\n\n  // å¼·åŒ–åŠ¹æœ\n  const reinforcementFactor = 1 + Math.log1p(wp.correctCount);\n\n  // ã‚¨ãƒ“ãƒ³ã‚°ãƒã‚¦ã‚¹ã®å¿˜å´æ›²ç·š\n  const predictedRetention = initialStrength * Math.exp((-days * decayRate) / reinforcementFactor);\n\n  return Math.max(0, Math.min(100, predictedRetention));\n}\n\n/**\n * å®šç€åº¦50%ã‚’ä¸‹å›ã‚‹ã¾ã§ã®æ—¥æ•°ã‚’è¨ˆç®—\n */\nfunction calculateDaysUntilCritical(wp: WordProgress, currentRetention: number): number {\n  if (currentRetention < 50) return 0;\n\n  const totalAttempts = wp.correctCount + wp.incorrectCount;\n  if (totalAttempts === 0) return 999;\n\n  const errorRate = wp.incorrectCount / totalAttempts;\n  const decayRate = 0.3 + errorRate * 0.4;\n  const reinforcementFactor = 1 + Math.log1p(wp.correctCount);\n\n  // currentRetention * e^(-days * decayRate / reinforcementFactor) = 50\n  // days = log(currentRetention / 50) * reinforcementFactor / decayRate\n  const days = (Math.log(currentRetention / 50) * reinforcementFactor) / decayRate;\n\n  return Math.max(1, Math.ceil(days));\n}\n\n/**\n * ç·Šæ€¥åº¦åˆ¥ã«ã‚¢ãƒ©ãƒ¼ãƒˆã‚’å–å¾—\n */\nexport function getAlertsByUrgency(\n  urgency: 'critical' | 'high' | 'medium' | 'low'\n): ForgettingAlert[] {\n  return getAllForgettingAlerts().filter((alert) => alert.urgency === urgency);\n}\n\n/**\n * ä»Šæ—¥å¾©ç¿’ã™ã¹ãå˜èªã‚’å–å¾—\n */\nexport function getTodayReviewWords(): string[] {\n  const criticalAlerts = getAlertsByUrgency('critical');\n  const highAlerts = getAlertsByUrgency('high');\n\n  const words = new Set<string>();\n\n  [...criticalAlerts, ...highAlerts].forEach((alert) => {\n    if (alert.type === 'word' && alert.word) {\n      words.add(alert.word);\n    } else if (alert.type === 'group' && alert.group) {\n      alert.group.words.forEach((w) => words.add(w));\n    }\n  });\n\n  return Array.from(words);\n}\n\n/**\n * ã‚¢ãƒ©ãƒ¼ãƒˆã‚µãƒãƒªãƒ¼ã‚’å–å¾—\n */\nexport function getAlertSummary(): {\n  total: number;\n  critical: number;\n  high: number;\n  medium: number;\n  low: number;\n  todayReviewCount: number;\n} {\n  const alerts = getAllForgettingAlerts();\n\n  return {\n    total: alerts.length,\n    critical: alerts.filter((a) => a.urgency === 'critical').length,\n    high: alerts.filter((a) => a.urgency === 'high').length,\n    medium: alerts.filter((a) => a.urgency === 'medium').length,\n    low: alerts.filter((a) => a.urgency === 'low').length,\n    todayReviewCount: getTodayReviewWords().length,\n  };\n}\n\n/**\n * ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã§1ã¤è¡¨ç¤ºï¼‰\n */\nexport function getRandomAlertMessage(): string | null {\n  const alerts = getAllForgettingAlerts();\n\n  if (alerts.length === 0) {\n    return null;\n  }\n\n  // ç·Šæ€¥åº¦ãŒé«˜ã„ã‚‚ã®ã‚’å„ªå…ˆ\n  const criticalAndHigh = alerts.filter((a) => a.urgency === 'critical' || a.urgency === 'high');\n  const targetAlerts = criticalAndHigh.length > 0 ? criticalAndHigh : alerts;\n\n  const randomAlert = targetAlerts[Math.floor(Math.random() * targetAlerts.length)];\n\n  return `â° ${randomAlert.message} ${randomAlert.recommendedAction}`;\n}\n","/**\n * ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰è¡¨ç¤ºå†…å®¹ã®ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£\n *\n * ä½¿ã„æ–¹ï¼š\n * ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œ:\n * import { runScoreBoardTests } from './tests/scoreBoardTests';\n * runScoreBoardTests();\n */\n\nimport { logger } from '@/utils/logger';\n\nimport {\n  getTodayStats,\n  getTotalAnsweredCount,\n  getUniqueQuestionedWordsCount,\n  getTotalMasteredWordsCount,\n  getRetentionRateWithAI,\n  getDetailedRetentionStats,\n  getNearMasteryStats,\n} from '../progressStorage';\nimport { calculateGoalProgress, generateGoalMessage } from '../goalSimulator';\nimport { getAlertSummary } from '../forgettingAlert';\n\ntype TestResult = {\n  name: string;\n  passed: boolean;\n  message: string;\n  data?: any;\n};\n\n/**\n * ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰ã®å…¨ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ\n */\nexport function runScoreBoardTests(): void {\n  logger.log('=== ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰è¡¨ç¤ºå†…å®¹ãƒ†ã‚¹ãƒˆé–‹å§‹ ===\\n');\n\n  const results: TestResult[] = [];\n\n  // ãƒ†ã‚¹ãƒˆ1: æœ¬æ—¥çµ±è¨ˆã®å–å¾—\n  results.push(testTodayStats());\n\n  // ãƒ†ã‚¹ãƒˆ2: ç´¯è¨ˆå›ç­”æ•°ã®å–å¾—\n  results.push(testTotalAnswered());\n\n  // ãƒ†ã‚¹ãƒˆ3: å®šç€æ•°ã®å–å¾—\n  results.push(testMasteredCount());\n\n  // ãƒ†ã‚¹ãƒˆ4: å®šç€ç‡ã®è¨ˆç®—\n  results.push(testRetentionRate());\n\n  // ãƒ†ã‚¹ãƒˆ5: è©³ç´°ãªå®šç€ç‡çµ±è¨ˆ\n  results.push(testDetailedRetentionStats());\n\n  // ãƒ†ã‚¹ãƒˆ6: å®šç€äºˆæ¸¬çµ±è¨ˆ\n  results.push(testNearMasteryStats());\n\n  // ãƒ†ã‚¹ãƒˆ7: ç›®æ¨™é”æˆæƒ…å ±\n  results.push(testGoalProgress());\n\n  // ãƒ†ã‚¹ãƒˆ8: å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ\n  results.push(testAlertSummary());\n\n  // ãƒ†ã‚¹ãƒˆ9: ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®ä¸€è²«æ€§ãƒã‚§ãƒƒã‚¯\n  results.push(testPercentageConsistency());\n\n  // ãƒ†ã‚¹ãƒˆ10: ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯\n  results.push(testDataRanges());\n\n  // çµæœã®ã‚µãƒãƒªãƒ¼\n  logger.log('\\n=== ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼ ===');\n  const passed = results.filter((r) => r.passed).length;\n  const failed = results.filter((r) => !r.passed).length;\n\n  logger.log(`âœ… æˆåŠŸ: ${passed}ä»¶`);\n  logger.log(`âŒ å¤±æ•—: ${failed}ä»¶`);\n  logger.log(`ğŸ“Š åˆè¨ˆ: ${results.length}ä»¶\\n`);\n\n  // å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆã®è©³ç´°\n  const failedTests = results.filter((r) => !r.passed);\n  if (failedTests.length > 0) {\n    logger.log('=== å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆ ===');\n    failedTests.forEach((test) => {\n      logger.error(`âŒ ${test.name}`);\n      logger.error(`   ${test.message}`);\n      if (test.data) {\n        logger.error('   ãƒ‡ãƒ¼ã‚¿:', test.data);\n      }\n    });\n  }\n\n  logger.log('\\n=== å…¨ãƒ‡ãƒ¼ã‚¿ãƒ€ãƒ³ãƒ— ===');\n  results.forEach((test) => {\n    if (test.data) {\n      logger.log(`${test.name}:`, test.data);\n    }\n  });\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ1: æœ¬æ—¥çµ±è¨ˆã®å–å¾—\n */\nfunction testTodayStats(): TestResult {\n  try {\n    const translationStats = getTodayStats('translation');\n    const spellingStats = getTodayStats('spelling');\n    const readingStats = getTodayStats('reading');\n\n    // ãƒ‡ãƒ¼ã‚¿ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯\n    const isValid =\n      translationStats.todayAccuracy >= 0 &&\n      translationStats.todayAccuracy <= 100 &&\n      translationStats.todayTotalAnswered >= 0 &&\n      spellingStats.todayAccuracy >= 0 &&\n      spellingStats.todayAccuracy <= 100 &&\n      spellingStats.todayTotalAnswered >= 0 &&\n      readingStats.todayAccuracy >= 0 &&\n      readingStats.todayAccuracy <= 100 &&\n      readingStats.todayTotalAnswered >= 0;\n\n    if (!isValid) {\n      return {\n        name: 'æœ¬æ—¥çµ±è¨ˆã®å–å¾—',\n        passed: false,\n        message: 'æ­£ç­”ç‡ãŒ0-100%ã®ç¯„å›²å¤–ã€ã¾ãŸã¯å›ç­”æ•°ãŒè² ã®å€¤',\n        data: { translationStats, spellingStats, readingStats },\n      };\n    }\n\n    return {\n      name: 'æœ¬æ—¥çµ±è¨ˆã®å–å¾—',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ',\n      data: { translationStats, spellingStats, readingStats },\n    };\n  } catch (error) {\n    return {\n      name: 'æœ¬æ—¥çµ±è¨ˆã®å–å¾—',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ2: ç´¯è¨ˆå›ç­”æ•°ã®å–å¾—\n */\nfunction testTotalAnswered(): TestResult {\n  try {\n    const translationCount = getTotalAnsweredCount('translation');\n    const spellingCount = getTotalAnsweredCount('spelling');\n    const readingCount = getTotalAnsweredCount('reading');\n\n    const isValid = translationCount >= 0 && spellingCount >= 0 && readingCount >= 0;\n\n    if (!isValid) {\n      return {\n        name: 'ç´¯è¨ˆå›ç­”æ•°ã®å–å¾—',\n        passed: false,\n        message: 'å›ç­”æ•°ãŒè² ã®å€¤',\n        data: { translationCount, spellingCount, readingCount },\n      };\n    }\n\n    return {\n      name: 'ç´¯è¨ˆå›ç­”æ•°ã®å–å¾—',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ',\n      data: { translationCount, spellingCount, readingCount },\n    };\n  } catch (error) {\n    return {\n      name: 'ç´¯è¨ˆå›ç­”æ•°ã®å–å¾—',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ3: å®šç€æ•°ã®å–å¾—\n */\nfunction testMasteredCount(): TestResult {\n  try {\n    const masteredCount = getTotalMasteredWordsCount();\n    const uniqueQuestionedCount = getUniqueQuestionedWordsCount();\n\n    const isValid =\n      masteredCount >= 0 && uniqueQuestionedCount >= 0 && masteredCount <= uniqueQuestionedCount; // å®šç€æ•°ã¯å‡ºé¡Œæ•°ä»¥ä¸‹\n\n    if (!isValid) {\n      return {\n        name: 'å®šç€æ•°ã®å–å¾—',\n        passed: false,\n        message: 'å®šç€æ•°ãŒå‡ºé¡Œæ•°ã‚’è¶…ãˆã¦ã„ã‚‹ã€ã¾ãŸã¯è² ã®å€¤',\n        data: { masteredCount, uniqueQuestionedCount },\n      };\n    }\n\n    return {\n      name: 'å®šç€æ•°ã®å–å¾—',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ',\n      data: { masteredCount, uniqueQuestionedCount },\n    };\n  } catch (error) {\n    return {\n      name: 'å®šç€æ•°ã®å–å¾—',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ4: å®šç€ç‡ã®è¨ˆç®—\n */\nfunction testRetentionRate(): TestResult {\n  try {\n    const { retentionRate, appearedCount } = getRetentionRateWithAI();\n    const masteredCount = getTotalMasteredWordsCount();\n\n    const isValid =\n      retentionRate >= 0 &&\n      retentionRate <= 100 &&\n      appearedCount >= 0 &&\n      masteredCount <= appearedCount;\n\n    if (!isValid) {\n      return {\n        name: 'å®šç€ç‡ã®è¨ˆç®—',\n        passed: false,\n        message: 'å®šç€ç‡ãŒ0-100%ã®ç¯„å›²å¤–ã€ã¾ãŸã¯å®šç€æ•°ãŒå‡ºç¾æ•°ã‚’è¶…ãˆã¦ã„ã‚‹',\n        data: { retentionRate, appearedCount, masteredCount },\n      };\n    }\n\n    // å®šç€ç‡ã®è¨ˆç®—ãŒæ­£ã—ã„ã‹ãƒã‚§ãƒƒã‚¯\n    const expectedRate = appearedCount > 0 ? Math.round((masteredCount / appearedCount) * 100) : 0;\n    if (Math.abs(retentionRate - expectedRate) > 1) {\n      // 1%ã®èª¤å·®ã¯è¨±å®¹\n      return {\n        name: 'å®šç€ç‡ã®è¨ˆç®—',\n        passed: false,\n        message: `å®šç€ç‡ã®è¨ˆç®—ãŒä¸æ­£ç¢º: æœŸå¾…å€¤=${expectedRate}%, å®Ÿéš›=${retentionRate}%`,\n        data: { retentionRate, expectedRate, appearedCount, masteredCount },\n      };\n    }\n\n    return {\n      name: 'å®šç€ç‡ã®è¨ˆç®—',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«è¨ˆç®—ã•ã‚Œã¾ã—ãŸ',\n      data: { retentionRate, appearedCount, masteredCount },\n    };\n  } catch (error) {\n    return {\n      name: 'å®šç€ç‡ã®è¨ˆç®—',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ5: è©³ç´°ãªå®šç€ç‡çµ±è¨ˆ\n */\nfunction testDetailedRetentionStats(): TestResult {\n  try {\n    const stats = getDetailedRetentionStats();\n\n    // ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®åˆè¨ˆãŒ100%ã«ãªã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n    const percentageSum =\n      stats.masteredPercentage + stats.learningPercentage + stats.strugglingPercentage;\n    const countSum = stats.masteredCount + stats.learningCount + stats.strugglingCount;\n\n    const isValid =\n      stats.appearedWords >= 0 &&\n      stats.masteredCount >= 0 &&\n      stats.learningCount >= 0 &&\n      stats.strugglingCount >= 0 &&\n      stats.basicRetentionRate >= 0 &&\n      stats.basicRetentionRate <= 100 &&\n      stats.weightedRetentionRate >= 0 &&\n      stats.weightedRetentionRate <= 100 &&\n      countSum === stats.appearedWords &&\n      Math.abs(percentageSum - 100) <= 1; // 1%ã®èª¤å·®ã¯è¨±å®¹ï¼ˆå››æ¨äº”å…¥ã®ãŸã‚ï¼‰\n\n    if (!isValid) {\n      return {\n        name: 'è©³ç´°ãªå®šç€ç‡çµ±è¨ˆ',\n        passed: false,\n        message: `ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚¨ãƒ©ãƒ¼: ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸åˆè¨ˆ=${percentageSum}%, ã‚«ã‚¦ãƒ³ãƒˆåˆè¨ˆ=${countSum}, å‡ºç¾å˜èª=${stats.appearedWords}`,\n        data: stats,\n      };\n    }\n\n    return {\n      name: 'è©³ç´°ãªå®šç€ç‡çµ±è¨ˆ',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ',\n      data: stats,\n    };\n  } catch (error) {\n    return {\n      name: 'è©³ç´°ãªå®šç€ç‡çµ±è¨ˆ',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ6: å®šç€äºˆæ¸¬çµ±è¨ˆ\n */\nfunction testNearMasteryStats(): TestResult {\n  try {\n    const stats = getNearMasteryStats();\n\n    const isValid =\n      stats.nearMasteryCount >= 0 && stats.longTermMemoryCount >= 0 && stats.superMemoryCount >= 0;\n\n    if (!isValid) {\n      return {\n        name: 'å®šç€äºˆæ¸¬çµ±è¨ˆ',\n        passed: false,\n        message: 'ã‚«ã‚¦ãƒ³ãƒˆå€¤ãŒè² ã®å€¤',\n        data: stats,\n      };\n    }\n\n    return {\n      name: 'å®šç€äºˆæ¸¬çµ±è¨ˆ',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ',\n      data: stats,\n    };\n  } catch (error) {\n    return {\n      name: 'å®šç€äºˆæ¸¬çµ±è¨ˆ',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ7: ç›®æ¨™é”æˆæƒ…å ±\n */\nfunction testGoalProgress(): TestResult {\n  try {\n    const progress = calculateGoalProgress();\n    const message = generateGoalMessage(false);\n\n    const isValid =\n      progress.overallProgress >= 0 &&\n      progress.overallProgress <= 100 &&\n      progress.estimatedDaysToAchieve >= 0 &&\n      progress.goal.name.length > 0 &&\n      message.length > 0;\n\n    if (!isValid) {\n      return {\n        name: 'ç›®æ¨™é”æˆæƒ…å ±',\n        passed: false,\n        message: 'é€²æ—ç‡ãŒ0-100%ã®ç¯„å›²å¤–ã€ã¾ãŸã¯æ¨å®šæ—¥æ•°ãŒè² ã®å€¤',\n        data: { progress, message },\n      };\n    }\n\n    return {\n      name: 'ç›®æ¨™é”æˆæƒ…å ±',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ',\n      data: { progress, message },\n    };\n  } catch (error) {\n    return {\n      name: 'ç›®æ¨™é”æˆæƒ…å ±',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ8: å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ\n */\nfunction testAlertSummary(): TestResult {\n  try {\n    const summary = getAlertSummary();\n\n    const isValid = summary.todayReviewCount >= 0 && summary.critical >= 0 && summary.total >= 0;\n\n    if (!isValid) {\n      return {\n        name: 'å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ',\n        passed: false,\n        message: 'ã‚«ã‚¦ãƒ³ãƒˆå€¤ãŒè² ã®å€¤',\n        data: summary,\n      };\n    }\n\n    return {\n      name: 'å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ',\n      passed: true,\n      message: 'âœ… æ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ',\n      data: summary,\n    };\n  } catch (error) {\n    return {\n      name: 'å¿˜å´ã‚¢ãƒ©ãƒ¼ãƒˆ',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ9: ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®ä¸€è²«æ€§ãƒã‚§ãƒƒã‚¯\n */\nfunction testPercentageConsistency(): TestResult {\n  try {\n    const detailedStats = getDetailedRetentionStats();\n    const { retentionRate, appearedCount } = getRetentionRateWithAI();\n    const masteredCount = getTotalMasteredWordsCount();\n\n    // åŸºæœ¬å®šç€ç‡ã¨è¨ˆç®—ã•ã‚ŒãŸå®šç€ç‡ãŒä¸€è‡´ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯\n    const calculatedRate =\n      appearedCount > 0 ? Math.round((masteredCount / appearedCount) * 100) : 0;\n    const isBasicRateConsistent = Math.abs(detailedStats.basicRetentionRate - calculatedRate) <= 1;\n    const isMainRateConsistent = Math.abs(retentionRate - calculatedRate) <= 1;\n\n    if (!isBasicRateConsistent || !isMainRateConsistent) {\n      return {\n        name: 'ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®ä¸€è²«æ€§',\n        passed: false,\n        message: `å®šç€ç‡ã®è¨ˆç®—ã«çŸ›ç›¾: åŸºæœ¬=${detailedStats.basicRetentionRate}%, ãƒ¡ã‚¤ãƒ³=${retentionRate}%, è¨ˆç®—å€¤=${calculatedRate}%`,\n        data: { detailedStats, retentionRate, calculatedRate, masteredCount, appearedCount },\n      };\n    }\n\n    return {\n      name: 'ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®ä¸€è²«æ€§',\n      passed: true,\n      message: 'âœ… ä¸€è²«æ€§ãŒç¢ºèªã•ã‚Œã¾ã—ãŸ',\n      data: {\n        basicRate: detailedStats.basicRetentionRate,\n        mainRate: retentionRate,\n        calculatedRate,\n      },\n    };\n  } catch (error) {\n    return {\n      name: 'ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ã®ä¸€è²«æ€§',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ãƒ†ã‚¹ãƒˆ10: ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯\n */\nfunction testDataRanges(): TestResult {\n  try {\n    const detailedStats = getDetailedRetentionStats();\n    const { appearedCount } = getRetentionRateWithAI();\n    const uniqueQuestionedCount = getUniqueQuestionedWordsCount();\n    const masteredCount = getTotalMasteredWordsCount();\n\n    // å…¨ã¦ã®å˜èªæ•°ãŒ4700ä»¥ä¸‹ï¼ˆå•é¡Œé›†ã®ç·æ•°ï¼‰ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª\n    const MAX_WORDS = 4700;\n    const isWithinRange =\n      appearedCount <= MAX_WORDS &&\n      uniqueQuestionedCount <= MAX_WORDS &&\n      masteredCount <= MAX_WORDS &&\n      detailedStats.appearedWords <= MAX_WORDS;\n\n    if (!isWithinRange) {\n      return {\n        name: 'ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã®å¦¥å½“æ€§',\n        passed: false,\n        message: `å˜èªæ•°ãŒä¸Šé™(${MAX_WORDS})ã‚’è¶…ãˆã¦ã„ã‚‹`,\n        data: {\n          appearedCount,\n          uniqueQuestionedCount,\n          masteredCount,\n          detailedAppearedWords: detailedStats.appearedWords,\n        },\n      };\n    }\n\n    // å®šç€æ•° <= å‡ºç¾æ•° <= å‡ºé¡Œæ•° ã®é–¢ä¿‚ãŒæˆã‚Šç«‹ã¤ã‹ãƒã‚§ãƒƒã‚¯\n    const isLogicalOrder = masteredCount <= appearedCount && appearedCount <= uniqueQuestionedCount;\n\n    if (!isLogicalOrder) {\n      return {\n        name: 'ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã®å¦¥å½“æ€§',\n        passed: false,\n        message: 'å®šç€æ•°ã€å‡ºç¾æ•°ã€å‡ºé¡Œæ•°ã®é–¢ä¿‚ãŒä¸æ­£',\n        data: { masteredCount, appearedCount, uniqueQuestionedCount },\n      };\n    }\n\n    return {\n      name: 'ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã®å¦¥å½“æ€§',\n      passed: true,\n      message: 'âœ… ãƒ‡ãƒ¼ã‚¿ç¯„å›²ãŒå¦¥å½“ã§ã™',\n      data: { masteredCount, appearedCount, uniqueQuestionedCount },\n    };\n  } catch (error) {\n    return {\n      name: 'ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã®å¦¥å½“æ€§',\n      passed: false,\n      message: `ã‚¨ãƒ©ãƒ¼: ${error}`,\n      data: null,\n    };\n  }\n}\n\n/**\n * ç°¡æ˜“ç‰ˆ: ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰ã®ç¾åœ¨ã®è¡¨ç¤ºå†…å®¹ã‚’ç¢ºèª\n */\nexport function checkCurrentScoreBoardDisplay(\n  mode: 'translation' | 'spelling' | 'reading' = 'translation'\n): void {\n  logger.log(`\\n=== ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰è¡¨ç¤ºå†…å®¹ç¢ºèª (${mode}ãƒ¢ãƒ¼ãƒ‰) ===\\n`);\n\n  const { todayAccuracy, todayTotalAnswered } = getTodayStats(mode);\n  const totalAnsweredCount = getTotalAnsweredCount(mode);\n  const masteredCount = getTotalMasteredWordsCount();\n  const { retentionRate, appearedCount } = getRetentionRateWithAI();\n  const detailedStats = getDetailedRetentionStats();\n  const nearMasteryStats = getNearMasteryStats();\n  const goalProgress = calculateGoalProgress();\n  const alertSummary = getAlertSummary();\n\n  logger.log('ğŸ“Š åŸºæœ¬çµ±è¨ˆã‚¿ãƒ–:');\n  logger.log(`  æœ¬æ—¥æ­£ç­”ç‡: ${todayAccuracy}% (${todayTotalAnswered}å•)`);\n  logger.log(`  å®šç€ç‡: ${retentionRate}% (${masteredCount}/${appearedCount})`);\n  logger.log(`  ç´¯è¨ˆå›ç­”: ${totalAnsweredCount}`);\n  logger.log('');\n\n  logger.log('ğŸ“Š å­¦ç¿’çŠ¶æ³ã®å†…è¨³:');\n  logger.log(\n    `  ğŸŸ¢ å®Œå…¨å®šç€: ${detailedStats.masteredCount}èª (${detailedStats.masteredPercentage}%)`\n  );\n  logger.log(\n    `  ğŸŸ¡ å­¦ç¿’ä¸­: ${detailedStats.learningCount}èª (${detailedStats.learningPercentage}%)`\n  );\n  logger.log(\n    `  ğŸ”´ è¦å¾©ç¿’: ${detailedStats.strugglingCount}èª (${detailedStats.strugglingPercentage}%)`\n  );\n  logger.log(`  ğŸ’¡ åŠ é‡å®šç€ç‡: ${detailedStats.weightedRetentionRate}%`);\n  logger.log('');\n\n  logger.log('ğŸ¯ ç›®æ¨™ãƒ»é€²æ—ã‚¿ãƒ–:');\n  if (nearMasteryStats.nearMasteryCount > 0) {\n    logger.log(`  ğŸ¯ å®šç€é–“è¿‘: ${nearMasteryStats.nearMasteryCount}å€‹`);\n  }\n  if (nearMasteryStats.longTermMemoryCount > 0) {\n    logger.log(`  ğŸ§  é•·æœŸè¨˜æ†¶: ${nearMasteryStats.longTermMemoryCount}å€‹`);\n  }\n  if (nearMasteryStats.superMemoryCount > 0) {\n    logger.log(`  âœ¨ å®Œå…¨å®šç€: ${nearMasteryStats.superMemoryCount}å€‹`);\n  }\n  logger.log(\n    `  ${goalProgress.goal.icon} ç›®æ¨™é€²æ—: ${goalProgress.overallProgress}% (${goalProgress.goal.name})`\n  );\n  if (alertSummary.todayReviewCount >= 1) {\n    logger.log(`  â° è¦å¾©ç¿’: ${alertSummary.todayReviewCount}å€‹`);\n  }\n  logger.log('');\n}\n\n// ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹\nif (typeof window !== 'undefined') {\n  (window as any).runScoreBoardTests = runScoreBoardTests;\n  (window as any).checkCurrentScoreBoardDisplay = checkCurrentScoreBoardDisplay;\n  logger.log('âœ… ãƒ†ã‚¹ãƒˆé–¢æ•°ã‚’å…¬é–‹ã—ã¾ã—ãŸ:');\n  logger.log('  - window.runScoreBoardTests()');\n  logger.log('  - window.checkCurrentScoreBoardDisplay(\"translation\")');\n}\n"],"names":["calculateMemoryRetention","word","wordProgress","currentTime","totalAttempts","accuracy","daysSinceLastStudy","initialStrength","avgResponseTime","responseTimeFactor","decayRate","reinforcementCount","reinforcementFactor","retentionScore","confidence","nextReviewTime","reviewInterval","calculateOptimalReviewTime","buildReviewHistory","currentRetention","daysUntilTarget","intervalMs","events","getAllForgettingAlerts","alerts","wordAlerts","getWordForgettingAlerts","groupAlerts","getGroupForgettingAlerts","b","urgencyOrder","progress","loadProgressSync","now","wp","retention","retention24h","predictRetentionAfterDays","retention7d","daysUntilCritical","calculateDaysUntilCritical","urgency","message","recommendedAction","confusionGroups","analyzeConfusionPatterns","g","group","totalRetention","count","minRetention","avgRetention","days","predictedRetention","getAlertsByUrgency","alert","getTodayReviewWords","criticalAlerts","highAlerts","words","w","getAlertSummary","a","runScoreBoardTests","logger","results","testTodayStats","testTotalAnswered","testMasteredCount","testRetentionRate","testDetailedRetentionStats","testNearMasteryStats","testGoalProgress","testAlertSummary","testPercentageConsistency","testDataRanges","passed","failed","failedTests","test","translationStats","getTodayStats","spellingStats","readingStats","error","translationCount","getTotalAnsweredCount","spellingCount","readingCount","masteredCount","getTotalMasteredWordsCount","uniqueQuestionedCount","getUniqueQuestionedWordsCount","retentionRate","appearedCount","getRetentionRateWithAI","expectedRate","stats","getDetailedRetentionStats","percentageSum","countSum","getNearMasteryStats","calculateGoalProgress","generateGoalMessage","summary","detailedStats","calculatedRate","isBasicRateConsistent","isMainRateConsistent","MAX_WORDS","checkCurrentScoreBoardDisplay","mode","todayAccuracy","todayTotalAnswered","totalAnsweredCount","nearMasteryStats","goalProgress","alertSummary"],"mappings":"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"}