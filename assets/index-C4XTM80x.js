const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/scoreBoardTests-pQqN2S0L.js","assets/chart-vendor-Dg0f91xX.js","assets/react-vendor-wGySg1uH.js"])))=>i.map(i=>d[i]);
var Xr=Object.defineProperty;var Zr=(r,t,s)=>t in r?Xr(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var Ye=(r,t,s)=>Zr(r,typeof t!="symbol"?t+"":t,s);import{j as e}from"./chart-vendor-Dg0f91xX.js";import{a as en,r as u,R as tn}from"./react-vendor-wGySg1uH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var hs={},Bs=en;hs.createRoot=Bs.createRoot,hs.hydrateRoot=Bs.hydrateRoot;const sn="modulepreload",rn=function(r){return"/"+r},Us={},it=function(t,s,n){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(s.map(c=>{if(c=rn(c),c in Us)return;Us[c]=!0;const d=c.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":sn,d||(h.as="script"),h.crossOrigin="",h.href=c,o&&h.setAttribute("nonce",o),document.head.appendChild(h),d)return new Promise((p,N)=>{h.addEventListener("load",p),h.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},dr=["è¨€èªåŸºæœ¬","å­¦æ ¡ãƒ»å­¦ç¿’","æ—¥å¸¸ç”Ÿæ´»","äººãƒ»ç¤¾ä¼š","è‡ªç„¶ãƒ»ç’°å¢ƒ","é£Ÿãƒ»å¥åº·","é‹å‹•ãƒ»å¨¯æ¥½","å ´æ‰€ãƒ»ç§»å‹•","æ™‚é–“ãƒ»æ•°é‡","ç§‘å­¦ãƒ»æŠ€è¡“"];function nn(r){return dr.includes(r)}const Pt=typeof window<"u"&&new URLSearchParams(window.location.search).get("debug")==="true",f={log:(...r)=>{Pt&&console.log(...r)},warn:(...r)=>{Pt&&console.warn(...r)},error:(...r)=>{console.error(...r)},debug:(...r)=>{Pt&&console.debug(...r)},info:(...r)=>{Pt&&console.info(...r)}},ur="QuizAppDB",an=1,Ue={PROGRESS:"progress",SESSION_HISTORY:"sessionHistory",DAILY_STATS:"dailyStats",SETTINGS:"settings"};function Jt(){try{return"indexedDB"in window&&indexedDB!==null}catch{return!1}}let ht=null;function gs(){return new Promise((r,t)=>{if(ht){r(ht);return}if(!Jt()){t(new Error("IndexedDB is not supported"));return}const s=indexedDB.open(ur,an);s.onerror=()=>{f.error("IndexedDB open error:",s.error),t(s.error)},s.onsuccess=()=>{ht=s.result,f.log("âœ… IndexedDB initialized successfully"),r(ht)},s.onupgradeneeded=n=>{const a=n.target.result;if(a.objectStoreNames.contains(Ue.PROGRESS)||a.createObjectStore(Ue.PROGRESS),!a.objectStoreNames.contains(Ue.SESSION_HISTORY)){const i=a.createObjectStore(Ue.SESSION_HISTORY,{keyPath:"id",autoIncrement:!0});i.createIndex("mode","mode",{unique:!1}),i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("modeTimestamp",["mode","timestamp"],{unique:!1})}a.objectStoreNames.contains(Ue.DAILY_STATS)||a.createObjectStore(Ue.DAILY_STATS,{keyPath:"date"}).createIndex("date","date",{unique:!0}),a.objectStoreNames.contains(Ue.SETTINGS)||a.createObjectStore(Ue.SETTINGS),f.log("ğŸ“¦ IndexedDB stores created")}})}async function ps(r,t){try{const s=await gs();return new Promise((n,a)=>{const o=s.transaction(r,"readonly").objectStore(r).get(t);o.onsuccess=()=>n(o.result||null),o.onerror=()=>a(o.error)})}catch(s){return f.error("getFromDB error:",s),null}}async function at(r,t,s){try{const n=await gs();return new Promise((a,i)=>{const o=n.transaction(r,"readwrite").objectStore(r),c=s!==void 0?o.put(t,s):o.put(t);c.onsuccess=()=>a(!0),c.onerror=()=>i(c.error)})}catch(n){return f.error("putToDB error:",n),!1}}async function on(){return new Promise(r=>{ht&&(ht.close(),ht=null);const t=indexedDB.deleteDatabase(ur);t.onsuccess=()=>{f.log("ğŸ—‘ï¸ Database deleted"),r(!0)},t.onerror=()=>{f.error("Database delete error"),r(!1)}})}const mr="indexeddb-migration-completed",hr="1.1";function fs(){try{return localStorage.getItem(mr)===hr}catch{return!1}}function ds(){try{localStorage.setItem(mr,hr),f.log("âœ… Migration flag set")}catch(r){f.error("Failed to set migration flag:",r)}}function Yt(r){try{const t=localStorage.getItem(r);return!t||r.includes("lastLogin")||r.includes("Date")||r.includes("daily-plan")||r.includes("score-board")?null:JSON.parse(t)}catch{return f.warn(`${r} is not valid JSON (skipping)`),null}}function ln(r){try{return localStorage.getItem(r)}catch(t){return f.error(`Failed to get ${r} from localStorage:`,t),null}}async function cn(){try{const r=Yt("progress-data");if(r)return r.wordProgress||(r.wordProgress={}),r.results||(r.results=[]),r.statistics||(r.statistics={totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]}),r.questionSetStats||(r.questionSetStats={}),await at(Ue.PROGRESS,r,"main"),f.log("ğŸ“¦ Progress data migrated:",Object.keys(r.wordProgress||{}).length,"words"),!0;f.log("â„¹ï¸ No progress data to migrate, creating initial data");const t={wordProgress:{},results:[],statistics:{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:{}};return await at(Ue.PROGRESS,t,"main"),!0}catch(r){return f.error("Progress data migration error:",r),!1}}async function dn(){try{const r=["translation","spelling"];let t=0;for(const s of r){const n=`session-history-${s}`,a=Yt(n);if(a&&Array.isArray(a))for(const i of a)await at(Ue.SESSION_HISTORY,{mode:s,status:i.status,word:i.word,timestamp:i.timestamp}),t++}return t>0&&f.log("ğŸ“œ Session history migrated:",t,"items"),!0}catch(r){return f.error("Session history migration error:",r),!1}}async function un(){try{const r=new Date,t=new Date(r.getTime()-90*24*60*60*1e3);let s=0,n=0;for(let a=0;a<localStorage.length;a++){const i=localStorage.key(a);if(i&&i.startsWith("studyStats-")){const l=i.replace("studyStats-","");if(new Date(l)>=t){const c=Yt(i);c&&(await at(Ue.DAILY_STATS,{date:l,...c}),s++)}else localStorage.removeItem(i),n++}}return(s>0||n>0)&&f.log(`ğŸ“Š Daily stats: migrated ${s}, cleaned ${n}`),!0}catch(r){return f.error("Daily stats migration error:",r),!1}}async function mn(){try{const r=["user-goal-level","loginStreak","radar-improvement-progress","skip-exclude-groups"],t=["lastLoginDate","lastLoginData"];let s=0;for(const a of r)try{if(a.includes("lastLogin")){f.warn(`Skipping ${a} from JSON migration`);continue}const i=Yt(a);i!==null&&(await at(Ue.SETTINGS,i,a),s++)}catch(i){f.warn(`Failed to migrate ${a}:`,i)}for(const a of t)try{const i=ln(a);i!==null&&(await at(Ue.SETTINGS,i,a),s++)}catch(i){f.warn(`Failed to migrate ${a}:`,i)}const n=["translation","spelling","reading"];for(const a of n){const i=`daily-plan-target-${a}`,l=`score-board-goal-${a}`;try{const o=localStorage.getItem(i);o&&(await at(Ue.SETTINGS,o,i),s++)}catch(o){f.warn(`Failed to migrate ${i}:`,o)}try{const o=localStorage.getItem(l);o&&(await at(Ue.SETTINGS,o,l),s++)}catch(o){f.warn(`Failed to migrate ${l}:`,o)}}return s>0&&f.log("âš™ï¸ Settings migrated:",s,"items"),!0}catch(r){return f.error("Settings migration error:",r),!1}}async function hn(){try{const r=await ps(Ue.PROGRESS,"main");return r?!r.wordProgress||typeof r.wordProgress!="object"?(f.warn("âš ï¸ Progress data verification failed - invalid wordProgress"),!1):(f.log("âœ… Migration verification passed"),!0):(f.warn("âš ï¸ Progress data verification failed - no data found"),!1)}catch(r){return f.error("Migration verification error:",r),!1}}async function gn(){if(fs())return f.log("â„¹ï¸ Migration already completed"),!0;if(!Jt())return f.warn("âš ï¸ IndexedDB not supported, using localStorage"),!1;f.log("ğŸš€ Starting data migration to IndexedDB...");try{await gs();const r=await Promise.all([cn(),dn(),un(),mn()]),t=["Progress","SessionHistory","DailyStats","Settings"];return r.forEach((n,a)=>{n||f.warn(`âš ï¸ ${t[a]} migration incomplete (may be empty)`)}),r[0]||r.some(n=>n)?await hn()?(ds(),f.log("ğŸ‰ Migration completed successfully!"),!0):(f.warn("âš ï¸ Migration verification failed, but marking as complete"),ds(),!0):(f.warn("âš ï¸ All migrations returned false, marking as complete anyway"),ds(),!0)}catch(r){return f.error("âŒ Migration failed:",r),!1}}let wt=!1;function pn(){wt=Jt()&&fs(),f.log(`ğŸ“¦ Storage strategy: ${wt?"IndexedDB":"localStorage"}`)}async function fn(r){try{return wt?await at(Ue.PROGRESS,r,"main"):(localStorage.setItem("progress-data",JSON.stringify(r)),!0)}catch(t){f.error("saveProgressData error:",t);try{return localStorage.setItem("progress-data",JSON.stringify(r)),!0}catch(s){return f.error("localStorage fallback failed:",s),!1}}}async function xn(){try{if(wt){const r=await ps(Ue.PROGRESS,"main");if(r)return r;const t=localStorage.getItem("progress-data");return t?JSON.parse(t):null}else{const r=localStorage.getItem("progress-data");return r?JSON.parse(r):null}}catch(r){return f.error("loadProgressData error:",r),null}}async function Kt(r,t){try{return wt?await at(Ue.SETTINGS,t,r):(localStorage.setItem(r,typeof t=="string"?t:JSON.stringify(t)),!0)}catch(s){f.error(`saveSetting(${r}) error:`,s);try{return localStorage.setItem(r,typeof t=="string"?t:JSON.stringify(t)),!0}catch{return!1}}}async function Xt(r){try{if(wt){const t=await ps(Ue.SETTINGS,r);return t!==null?t:localStorage.getItem(r)||null}else return localStorage.getItem(r)||null}catch(t){return f.error(`loadSetting(${r}) error:`,t),null}}const Hs={maxReviewCount:10};function xs(){try{const r=localStorage.getItem("study-settings");if(r)return{maxReviewCount:JSON.parse(r).maxReviewCount??Hs.maxReviewCount}}catch(r){f.error("å­¦ç¿’è¨­å®šã®å–å¾—ã‚¨ãƒ©ãƒ¼:",r)}return{...Hs}}const yn="session-history",vn=50;async function bt(r,t){const s=Jt()&&fs();try{if(s)await at(Ue.SESSION_HISTORY,{mode:t,status:r.status,word:r.word,timestamp:r.timestamp});else{const n=`${yn}-${t}`,a=localStorage.getItem(n),i=a?JSON.parse(a):[];i.push(r),i.length>vn&&i.shift(),localStorage.setItem(n,JSON.stringify(i))}}catch(n){f.error("ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",n)}}function Wt(){const r=Re(),t=new Date().toLocaleDateString("ja-JP"),s=new Set;return r.results.forEach(n=>{new Date(n.date).toLocaleDateString("ja-JP")===t&&n.incorrectWords.forEach(a=>s.add(a))}),Array.from(s)}function Ot(r){const t=Re(),s=new Date().setHours(0,0,0,0),n=s+24*60*60*1e3;let a=t.results.filter(c=>c.date>=s&&c.date<n);r&&(a=a.filter(c=>c.mode===r));const i=a.reduce((c,d)=>c+d.score,0),l=a.reduce((c,d)=>c+d.total,0),o=l>0?Math.round(i/l*100):0;return{todayCorrectCount:i,todayTotalAnswered:l,todayAccuracy:o}}function ys(){const r=Re(),t=new Date,s=t.getDay(),n=s===0?-6:1-s,a=new Date(t);a.setDate(t.getDate()+n),a.setHours(0,0,0,0);const i=new Date(a);i.setDate(a.getDate()+7);const l=new Date(a);l.setDate(a.getDate()-7);const o=new Date(a),c=r.results.filter(M=>M.date>=a.getTime()&&M.date<i.getTime()),d=r.results.filter(M=>M.date>=l.getTime()&&M.date<o.getTime()),m=new Set;c.forEach(M=>{const S=new Date(M.date).toISOString().split("T")[0];m.add(S)});const h=c.reduce((M,S)=>M+S.total,0),p=c.reduce((M,S)=>M+S.score,0),N=h>0?p/h*100:0,b=d.reduce((M,S)=>M+S.total,0),x=d.reduce((M,S)=>M+S.score,0),v=b>0?x/b*100:0;let k=0;return Object.values(r.wordProgress).forEach(M=>{M.masteryLevel==="mastered"&&M.lastStudied>=a.getTime()&&k++}),{studyDays:m.size,totalDays:7,totalAnswered:h,accuracy:N,newMastered:k,previousWeekAccuracy:v}}function vs(){const r=Re(),t=new Date,s=new Date(t.getFullYear(),t.getMonth(),1);s.setHours(0,0,0,0);const n=new Date(t.getFullYear(),t.getMonth()+1,0);n.setHours(23,59,59,999);const a=r.results.filter(h=>h.date>=s.getTime()&&h.date<=n.getTime()),i=new Set;a.forEach(h=>{const p=new Date(h.date).toISOString().split("T")[0];i.add(p)});const l=a.reduce((h,p)=>h+p.total,0),o=a.reduce((h,p)=>h+p.score,0),c=l>0?o/l*100:0;let d=0;Object.values(r.wordProgress).forEach(h=>{h.masteryLevel==="mastered"&&h.lastStudied>=s.getTime()&&d++});const m=n.getDate();return{studyDays:i.size,totalDays:m,totalAnswered:l,accuracy:c,newMastered:d}}function qt(){const r=Re(),t=Object.values(r.wordProgress),s=t.filter(c=>c.correctCount+c.incorrectCount>0);let n=0,a=0,i=0;s.forEach(c=>{const d=c.correctCount+c.incorrectCount,m=d>0?c.correctCount/d*100:0;d===1&&c.correctCount===1||c.consecutiveCorrect>=3||c.consecutiveCorrect>=2&&m>=80?n++:m>=50?a++:i++});const l=s.length,o=n*1+a*.5;return{totalWords:t.length,appearedWords:l,masteredCount:n,learningCount:a,strugglingCount:i,basicRetentionRate:l>0?Math.round(n/l*100):0,weightedRetentionRate:l>0?Math.round(o/l*100):0,masteredPercentage:l>0?Math.round(n/l*100):0,learningPercentage:l>0?Math.round(a/l*100):0,strugglingPercentage:l>0?Math.round(i/l*100):0,masteredWords:n,learningWords:a,newWords:t.length-l,retentionRate:l>0?Math.round(n/l*100):0,averageAttempts:0,categoryBreakdown:{},difficultyBreakdown:{}}}function gr(){const r=Re();let t=0,s=0,n=0,a=0,i=0;return Object.values(r.wordProgress).forEach(l=>{const o=l.correctCount+l.incorrectCount;if(o===0)return;if(es(l,!0).isMastered){l.consecutiveCorrect>=7?i++:l.consecutiveCorrect>=5&&a++;return}s++;const{consecutiveCorrect:d}=l,m=l.correctCount/o;d===2||m>=.9&&d===1&&o>=2||o>=4&&m>=.75?(t++,n+=1):n+=Math.max(1,3-d)}),{nearMasteryCount:t,learningCount:s,averageRemainingAnswers:s>0?Math.round(n/s*10)/10:0,longTermMemoryCount:a,superMemoryCount:i}}function ws(r=7,t=10){const s=Re(),n=Date.now()-r*24*60*60*1e3;return Object.entries(s.wordProgress).filter(([i,l])=>l.masteryLevel==="mastered"&&l.lastStudied>=n).map(([i,l])=>({word:i,masteredDate:l.lastStudied,totalAttempts:l.correctCount+l.incorrectCount})).sort((i,l)=>l.masteredDate-i.masteredDate).slice(0,t)}function zt(){const r=Re(),s=Object.values(r.wordProgress).filter(d=>d.grammarAttempts&&d.grammarAttempts>0||d.word.startsWith("grammar_")||d.word.includes("_g")),n=s.filter(d=>d.grammarAttempts&&d.grammarAttempts>0||d.correctCount+d.incorrectCount>0);let a=0,i=0,l=0;n.forEach(d=>{const m=d.grammarAttempts||d.correctCount+d.incorrectCount,h=d.grammarCorrect||d.correctCount,p=d.grammarStreak||d.consecutiveCorrect,N=m>0?h/m*100:0;m===1&&h===1||p>=3||p>=2&&N>=80?a++:N>=50?i++:l++});const o=n.length,c=a*1+i*.5;return{totalWords:s.length,appearedWords:o,masteredCount:a,learningCount:i,strugglingCount:l,basicRetentionRate:o>0?Math.round(a/o*100):0,weightedRetentionRate:o>0?Math.round(c/o*100):0,masteredPercentage:o>0?Math.round(a/o*100):0,learningPercentage:o>0?Math.round(i/o*100):0,strugglingPercentage:o>0?Math.round(l/o*100):0,masteredWords:a,learningWords:i,newWords:s.length-o,retentionRate:o>0?Math.round(a/o*100):0,averageAttempts:0,categoryBreakdown:{},difficultyBreakdown:{}}}function Dt(){const r=Re(),t=Object.values(r.wordProgress),s=t.filter(c=>c.memorizationAttempts&&c.memorizationAttempts>0);let n=0,a=0,i=0;s.forEach(c=>{const d=c.memorizationAttempts||0,m=c.memorizationCorrect||0,h=c.memorizationStillLearning||0,p=c.memorizationStreak||0,N=m+h*.5,b=d>0?N/d*100:0;d===1&&m===1||p>=3||p>=2&&b>=80?n++:b>=50||h>0?a++:i++});const l=s.length,o=n*1+a*.5;return{totalWords:t.length,appearedWords:l,masteredCount:n,learningCount:a,strugglingCount:i,basicRetentionRate:l>0?Math.round(n/l*100):0,weightedRetentionRate:l>0?Math.round(o/l*100):0,masteredPercentage:l>0?Math.round(n/l*100):0,learningPercentage:l>0?Math.round(a/l*100):0,strugglingPercentage:l>0?Math.round(i/l*100):0,masteredWords:n,learningWords:a,newWords:t.length-l,retentionRate:l>0?Math.round(n/l*100):0,averageAttempts:0,categoryBreakdown:{},difficultyBreakdown:{}}}function bs(){const r=Re(),t=Object.entries(r.wordProgress).filter(([a,i])=>a.startsWith("grammar_")),s=new Map;t.forEach(([a,i])=>{const l=a.match(/grammar_(?:\w+-)?g(\d+)-u(\d+)/);if(!l){a.startsWith("grammar_")&&!a.includes("unknown")&&console.warn(`âš ï¸ æ–‡æ³•å•é¡ŒIDãŒãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãƒãƒƒãƒã—ã¾ã›ã‚“: ${a}`);return}const o=l[1],c=l[2],d=`ä¸­${o}_Unit${c}`;s.has(d)||s.set(d,{questions:[],answered:[],correct:0,incorrect:0,mastered:0,allHistory:[]});const m=s.get(d);m.questions.push([a,i]);const h=i.grammarAttempts||i.correctCount+i.incorrectCount;if(h>0){m.answered.push([a,i]);const p=i.grammarCorrect||i.correctCount||0,N=h-p;if(m.correct+=p,m.incorrect+=N,i.learningHistory&&i.learningHistory.length>0){const S=i.learningHistory.slice(-10);m.allHistory.push(...S)}const b=i.grammarStreak||i.consecutiveCorrect||0,x=h>0?p/h*100:0,v=i.masteryLevel==="mastered",k=h===1&&p===1,M=h>=3&&x>=85;(v||k||M||b>=3)&&m.mastered++}});const n=Array.from(s.entries()).map(([a,i])=>{const l=i.correct+i.incorrect,o=l>0?i.correct/l*100:0,c=i.questions.length>0?i.answered.length/i.questions.length*100:0,m=i.allHistory.sort((h,p)=>h.timestamp-p.timestamp).slice(-10).map(h=>h.wasCorrect?"ğŸŸ©":"ğŸŸ¥").join("");return{unit:a,totalQuestions:i.questions.length,answeredQuestions:i.answered.length,correctCount:i.correct,incorrectCount:i.incorrect,masteredCount:i.mastered,accuracy:Math.round(o),progress:Math.round(c),historyIcons:m}});return n.sort((a,i)=>a.unit.localeCompare(i.unit)),n}const pr="progress-data",Vs=300,Js=3;function gt(){return{results:[],statistics:{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:{},categoryStats:{},difficultyStats:{},wordProgress:{}}}async function rt(){try{const r=await xn();if(!r){const n=gt();return ot(n),n}const t=r,s={results:t.results||[],statistics:t.statistics||{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:t.questionSetStats||{},categoryStats:{},difficultyStats:{},wordProgress:t.wordProgress||{}};return s.statistics||(s.statistics={totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]}),s.questionSetStats||(s.questionSetStats={}),s.wordProgress||(s.wordProgress={}),s.results||(s.results=[]),js(s),ot(s),s}catch(r){f.error("é€²æ—ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=gt();return ot(t),t}}let nt=null;function wn(){return nt||(nt=gt(),f.log("ğŸ“¦ Progress cache initialized with default data")),nt}function Re(){if(nt)return nt.statistics||(f.warn("âš ï¸ Cache missing statistics, reinitializing"),nt=gt()),nt;wn();try{const r=localStorage.getItem(pr);if(!r){const s=gt();return nt=s,s}const t=JSON.parse(r);return t.statistics||(t.statistics={totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]}),t.questionSetStats||(t.questionSetStats={}),t.wordProgress||(t.wordProgress={}),t.results||(t.results=[]),t.results||(t.results=[]),js(t),nt=t,t}catch(r){f.error("é€²æ—ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=gt();return nt=t,t}}function ot(r){nt=r,f.log("ğŸ”„ progressCacheæ›´æ–° - resultsä»¶æ•°:",r.results.length)}async function lt(r){try{js(r),ot(r);try{localStorage.setItem(pr,JSON.stringify(r))}catch(n){f.warn("LocalStorageä¿å­˜å¤±æ•—ï¼ˆå®¹é‡ä¸è¶³ã®å¯èƒ½æ€§ï¼‰:",n)}const t={quizzes:{},lastUpdated:Date.now(),totalAnswered:{},totalMastered:{},results:r.results,statistics:r.statistics,questionSetStats:r.questionSetStats,wordProgress:r.wordProgress};await fn(t)||f.error("ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}catch(t){f.error("é€²æ—ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—:",t)}}function js(r){r.results.length>Vs&&(r.results.sort((t,s)=>s.date-t.date),r.results=r.results.slice(0,Vs)),Object.values(r.wordProgress).forEach(t=>{t.responseTimes&&t.responseTimes.length>Js&&(t.responseTimes=t.responseTimes.slice(-Js))})}async function Mt(r){const t=await rt();t.results.push(r),f.log("âœ… addQuizResultå‘¼ã³å‡ºã—:",{mode:r.mode,score:r.score,total:r.total,date:new Date(r.date).toISOString(),resultsCount:t.results.length}),bn(t,r),await lt(t),f.log("ğŸ’¾ saveProgresså®Œäº† - resultsä»¶æ•°:",t.results.length);try{if(typeof window<"u"){const s=new CustomEvent(vt,{detail:{result:r}});window.dispatchEvent(s)}}catch{}}function bn(r,t){const s=r.statistics;s.totalQuizzes++,s.totalQuestions+=t.total,s.totalCorrect+=t.score,s.averageScore=s.totalQuestions>0?s.totalCorrect/s.totalQuestions*100:0,s.bestScore=Math.max(s.bestScore,t.percentage),s.lastStudyDate=t.date;const n=new Date(t.date).setHours(0,0,0,0);s.studyDates.includes(n)||(s.studyDates.push(n),s.studyDates.sort((o,c)=>c-o)),s.streakDays=jn(s.studyDates),r.questionSetStats[t.questionSetId]||(r.questionSetStats[t.questionSetId]={attempts:0,bestScore:0,averageScore:0,lastAttempt:0,totalTimeSpent:0});const a=r.questionSetStats[t.questionSetId];a.attempts++,a.bestScore=Math.max(a.bestScore,t.percentage),a.lastAttempt=t.date,a.totalTimeSpent+=t.timeSpent;const i=r.results.filter(o=>o.questionSetId===t.questionSetId),l=i.reduce((o,c)=>o+c.percentage,0);a.averageScore=l/i.length}function jn(r){if(r.length===0)return 0;const t=new Date().setHours(0,0,0,0),s=t-24*60*60*1e3,n=r[0];if(n!==t&&n!==s)return 0;let a=1;for(let i=1;i<r.length&&(r[i-1]-r[i])/(24*60*60*1e3)===1;i++)a++;return a}function Ns(r=10){const t=Re(),s=new Map;t.results.forEach(a=>{a.incorrectWords.forEach(i=>{s.set(i,(s.get(i)||0)+1)})});const n=[];return s.forEach((a,i)=>{if(a<5)return;const l=t.wordProgress[i];if(!l)return;const o=l.correctCount+l.incorrectCount;if(o===0)return;const c=l.correctCount/o*100,d=c>=80,h=o===1&&l.correctCount===1||l.consecutiveCorrect>=3||c>=85;if(d&&h){const p=a*c;n.push({word:i,totalMistakes:a,recentAccuracy:Math.round(c),overcomeScore:p})}}),n.sort((a,i)=>i.overcomeScore-a.overcomeScore).slice(0,r)}function Zt(r=10){const t=Re(),s=new Map;t.results.forEach(a=>{a.incorrectWords.forEach(i=>{s.set(i,(s.get(i)||0)+1)})});const n=[];return s.forEach((a,i)=>{const l=t.wordProgress[i];if(!l){n.push({word:i,mistakes:a,recentAccuracy:0,meaning:void 0,reading:void 0});return}const o=l.correctCount+l.incorrectCount,c=o>0?l.correctCount/o*100:0,d=o===1&&l.correctCount===1;a>=5&&c>=80&&(d||l.consecutiveCorrect>=3||c>=85)||n.push({word:i,mistakes:a,recentAccuracy:Math.round(c),meaning:l.meaning,reading:l.reading})}),n.sort((a,i)=>i.mistakes-a.mistakes).slice(0,r)}function fr(r){return{word:r,correctCount:0,incorrectCount:0,consecutiveCorrect:0,consecutiveIncorrect:0,lastStudied:0,totalResponseTime:0,averageResponseTime:0,difficultyScore:50,masteryLevel:"new",responseTimes:[]}}function Nn(r){const t=r.correctCount+r.incorrectCount;if(t===0)return 50;const n=(1-r.correctCount/t)*100,a=Math.min(r.consecutiveIncorrect*5,20),i=r.averageResponseTime/1e3,l=Math.min(i>5?(i-5)*3:0,15),o=r.userDifficultyRating?(r.userDifficultyRating-5.5)*5:0,c=n+a+l+o;return Math.max(0,Math.min(100,c))}function ct(r){const t=[1,1,3,7,14,30,90,180,365];return r>=t.length?365:t[r]||1}function es(r,t){const s=r.correctCount+r.incorrectCount,n=s>0?r.correctCount/s:0,{consecutiveCorrect:a,lastStudied:i}=r,o=(Date.now()-i)/(1e3*60*60)/24;if(s===1&&t){const c=ct(1);return{isMastered:!0,excludeDays:c,reason:`1ç™ºæ­£è§£ï¼ˆ${c}æ—¥å¾Œã«å†ç¢ºèªï¼‰`,confidence:.85,masteryLevel:1}}if(a>=2&&t){const c=ct(a),d=Math.min(7,Math.floor(a/1));let m="";return a>=7?m=`è¶…é•·æœŸè¨˜æ†¶é”æˆï¼ï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«å¹´æ¬¡ç¢ºèªï¼‰`:a>=5?m=`é•·æœŸè¨˜æ†¶å®šç€ï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`:a>=3?m=`çŸ­æœŸâ†’é•·æœŸè¨˜æ†¶ç§»è¡Œï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`:m=`å­¦ç¿’ä¸­ï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«å¾©ç¿’ï¼‰`,{isMastered:!0,excludeDays:c,reason:m,confidence:Math.min(.99,.75+a*.05),masteryLevel:d}}if(s>=3&&n>=.9&&a>=2){const c=ct(a);return{isMastered:!0,excludeDays:c,reason:`é«˜ç²¾åº¦å®‰å®šå‹ï¼ˆæ­£ç­”ç‡${Math.round(n*100)}%ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.88,masteryLevel:2}}if(a>=2&&o>=7&&t){const c=ct(a),d=Math.floor(c*1.5);return{isMastered:!0,excludeDays:d,reason:`é•·æœŸè¨˜æ†¶å‹ï¼ˆ7æ—¥é–“éš”ã§æ­£è§£ã€${d}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.92,masteryLevel:3}}if(a>=2&&o>=3&&t){const c=ct(a),d=Math.floor(c*1.2);return{isMastered:!0,excludeDays:d,reason:`ä¸­æœŸè¨˜æ†¶å‹ï¼ˆ3æ—¥é–“éš”ã§æ­£è§£ã€${d}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.85,masteryLevel:2}}if(a>=2&&o<=1&&n>=.85&&s>=4){const c=ct(a);return{isMastered:!0,excludeDays:c,reason:`çŸ­æœŸå®Œç’§å‹ï¼ˆ24æ™‚é–“å†…ã«é€£ç¶šæ­£è§£ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.8,masteryLevel:1}}if(s>=5&&n>=.8&&t){const c=Math.max(7,ct(2));return{isMastered:!0,excludeDays:c,reason:`é«˜å›æ•°å®‰å®šå‹ï¼ˆ${s}å›æŒ‘æˆ¦ãƒ»æ­£ç­”ç‡${Math.round(n*100)}%ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.83,masteryLevel:2}}if(a>=2&&n>=.75&&s>=3&&t){const c=ct(a);return{isMastered:!0,excludeDays:c,reason:`æ¬¡å›å®šç€é”æˆï¼ˆ${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.78,masteryLevel:1}}return{isMastered:!1,excludeDays:0,reason:"æœªå®šç€",confidence:1,masteryLevel:0}}function Sn(r){const t=r.correctCount+r.incorrectCount;if(t===0)return"new";const s=r.correctCount/t,n=t===1&&r.correctCount===1,a=t===2&&s===1,i=t>=5&&s>=.85,l=t>=3&&s>=.9,o=r.consecutiveCorrect>=5,c=t>=10&&s>=.75&&r.consecutiveCorrect>=2;return n||a||i||l||o||c?"mastered":"learning"}async function pt(r,t,s,n,a,i){const l=await rt();l.wordProgress[r]||(l.wordProgress[r]=fr(r));const o=l.wordProgress[r];t?(o.correctCount++,o.consecutiveCorrect++,o.consecutiveIncorrect=0):i?(o.incorrectCount++,o.consecutiveCorrect=0,o.consecutiveIncorrect=0):(o.incorrectCount++,o.consecutiveIncorrect++,o.consecutiveCorrect=0);const c=a;c==="translation"?(o.translationAttempts=(o.translationAttempts||0)+1,t?(o.translationCorrect=(o.translationCorrect||0)+1,o.translationStreak=(o.translationStreak||0)+1):o.translationStreak=0):c==="spelling"?(o.spellingAttempts=(o.spellingAttempts||0)+1,t?(o.spellingCorrect=(o.spellingCorrect||0)+1,o.spellingStreak=(o.spellingStreak||0)+1):o.spellingStreak=0):c==="grammar"?(o.grammarAttempts=(o.grammarAttempts||0)+1,t?(o.grammarCorrect=(o.grammarCorrect||0)+1,o.grammarStreak=(o.grammarStreak||0)+1):o.grammarStreak=0):c==="memorization"&&(o.memorizationAttempts=(o.memorizationAttempts||0)+1,t?(o.memorizationCorrect=(o.memorizationCorrect||0)+1,o.memorizationStreak=(o.memorizationStreak||0)+1):i?o.memorizationStillLearning=(o.memorizationStillLearning||0)+1:o.memorizationStreak=0),o.totalAttempts=(o.translationAttempts||0)+(o.spellingAttempts||0)+(o.grammarAttempts||0)+(o.memorizationAttempts||0),o.totalResponseTime+=s;const d=o.correctCount+o.incorrectCount;if(o.averageResponseTime=o.totalResponseTime/d,n!==void 0&&(o.userDifficultyRating=n),o.lastStudied=Date.now(),c==="memorization"){o.easinessFactor===void 0&&(o.easinessFactor=2.5),t?o.easinessFactor=Math.min(2.5,o.easinessFactor+.1):i||(o.easinessFactor=Math.max(1.3,o.easinessFactor-.2));const p=o.memorizationStreak||0,N=o.easinessFactor;let b=0;if(p===0)b=0;else if(p===1)b=1;else if(p===2)b=3;else if(p===3)b=7;else{const x=o.reviewInterval||7;b=Math.round(x*N)}o.reviewInterval=b,o.lastReviewDate=Date.now(),o.totalReviews=(o.totalReviews||0)+1,o.avgResponseSpeed?o.avgResponseSpeed=o.avgResponseSpeed*.8+s*.2:o.avgResponseSpeed=s,s<2e3&&t&&(o.easinessFactor=Math.min(2.5,o.easinessFactor+.05))}o.learningHistory||(o.learningHistory=[]),o.learningHistory.push({timestamp:Date.now(),wasCorrect:t,responseTime:s,sessionIndex:0}),o.learningHistory.length>20&&(o.learningHistory=o.learningHistory.slice(-20)),o.difficultyScore=Nn(o);const m=o.masteryLevel;o.masteryLevel=Sn(o),m!==o.masteryLevel&&f.log(`ğŸ”„ ${r}: ${m} â†’ ${o.masteryLevel} (æ­£è§£: ${o.correctCount}, ä¸æ­£è§£: ${o.incorrectCount}, é€£ç¶š: ${o.consecutiveCorrect})`);const h=es(o,t);if(h.isMastered&&(o.skipExcludeUntil=Date.now()+h.excludeDays*24*60*60*1e3,kn(r),h.reason!=="æœªå®šç€"&&f.log(`âœ… ${r} ãŒå®šç€: ${h.reason} (é™¤å¤–æœŸé–“: ${h.excludeDays}æ—¥)`)),c){const p=c==="translation"?"å’Œè¨³":c==="spelling"?"ã‚¹ãƒšãƒ«":c==="grammar"?"æ–‡æ³•":c==="memorization"?"æš—è¨˜":"èª­è§£";l.results.push({id:`word-${r}-${Date.now()}`,questionSetId:"individual-word",questionSetName:p,score:t?1:0,total:1,percentage:t?100:0,date:Date.now(),timeSpent:s/1e3,incorrectWords:t?[]:[r],mode:c,difficulty:o.difficultyScore>.7?"advanced":o.difficultyScore>.4?"intermediate":"beginner"})}await lt(l);try{if(typeof window<"u"){const p=new CustomEvent(vt,{detail:{word:r,isCorrect:t,responseTime:s,mode:c}});window.dispatchEvent(p)}}catch{}}function kn(r){const t="reading-passages-data",s=localStorage.getItem(t);if(s)try{const n=JSON.parse(s);let a=!1;if(n.forEach(i=>{i.phrases&&i.phrases.forEach(l=>{l.segments&&l.segments.forEach(o=>{o.word.toLowerCase()===r.toLowerCase()&&o.isUnknown&&(o.isUnknown=!1,a=!0)})})}),a)try{localStorage.setItem(t,JSON.stringify(n))}catch(i){if(i instanceof DOMException&&i.name==="QuotaExceededError")f.warn("é•·æ–‡èª­è§£ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ï¼ˆå®¹é‡è¶…éï¼‰ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’åœ§ç¸®ã—ã¾ã™ã€‚"),localStorage.removeItem(t),f.log("é•·æ–‡èª­è§£ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚æ¬¡å›èª­ã¿è¾¼ã¿æ™‚ã«å†å–å¾—ã•ã‚Œã¾ã™ã€‚");else throw i}}catch(n){f.error("é•·æ–‡èª­è§£ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã‚¨ãƒ©ãƒ¼:",n)}}function ts(r,t=30){const s=Re();s.wordProgress[r]||(s.wordProgress[r]=fr(r));const n=s.wordProgress[r];n.skippedCount=(n.skippedCount||0)+1,n.lastSkipped=Date.now(),n.skipExcludeUntil=Date.now()+t*24*60*60*1e3,lt(s)}function Ss(r){const s=Re().wordProgress[r];return s?!!(s.skipExcludeUntil&&Date.now()<s.skipExcludeUntil||s.masteryLevel==="mastered"&&s.nextReviewDate&&Date.now()<s.nextReviewDate):!1}function ks(r){return r.filter(t=>!Ss(t.word))}function Ft(r){return Re().wordProgress[r]||null}function ft(){const r=Re();return Object.values(r.wordProgress)}async function Cs(r,t){const s=await rt();s.wordProgress[r]||(s.wordProgress[r]={word:r,correctCount:0,incorrectCount:0,consecutiveCorrect:0,consecutiveIncorrect:0,lastStudied:Date.now(),totalResponseTime:0,averageResponseTime:0,difficultyScore:0,masteryLevel:"new",responseTimes:[],confusedWith:[],confusionCount:0,lastConfused:Date.now()});const n=s.wordProgress[r];n.confusedWith||(n.confusedWith=[]),n.confusedWith.push({word:t,timestamp:Date.now()}),n.confusedWith.length>10&&(n.confusedWith=n.confusedWith.slice(-10)),n.confusionCount=(n.confusionCount||0)+1,n.lastConfused=Date.now(),n.difficultyScore=Math.min(100,(n.difficultyScore||0)+5),await lt(s),ot(s)}function Ds(r=20){return ft().filter(s=>(s.confusionCount||0)>0).sort((s,n)=>{const a=(n.confusionCount||0)-(s.confusionCount||0);return a!==0?a:(n.lastConfused||0)-(s.lastConfused||0)}).slice(0,r)}function Ms(r){let s=Re().results;return r&&(s=s.filter(n=>n.mode===r)),s.reduce((n,a)=>n+a.total,0)}function xr(r){const t=Re(),s=new Set;for(const[n,a]of Object.entries(t.wordProgress)){const i=a.correctCount>0||a.incorrectCount>0,l=a.skippedCount&&a.skippedCount>0;(i||l)&&s.add(n)}return s.size}function ss(){const r=Re();let t=0;for(const s of Object.values(r.wordProgress)){const a=s.correctCount+s.incorrectCount===1&&s.correctCount===1,i=s.consecutiveCorrect>=3,l=s.skippedCount&&s.skippedCount>0;(a||i||l)&&t++}return t}function Qt(){const r=Re(),s=Object.values(r.wordProgress).filter(l=>l.correctCount+l.incorrectCount>0);let n=0;s.forEach(l=>{const o=l.correctCount+l.incorrectCount,c=o>0?l.correctCount/o*100:0,d=l.masteryLevel==="mastered",m=o===1&&l.correctCount===1,h=o>=5&&c>=85,p=o>=3&&c>=90,N=l.consecutiveCorrect>=5,b=o>=10&&c>=75;(d||m||h||p||N||b)&&n++});const a=s.length>0?n/s.length*100:0,i=Math.min(100,Math.max(0,a));return{retentionRate:Math.round(i),masteredCount:n,appearedCount:s.length}}async function Is(){try{await on(),f.log("âœ… IndexedDBå‰Šé™¤å®Œäº†")}catch(s){f.error("IndexedDBå‰Šé™¤ã‚¨ãƒ©ãƒ¼:",s)}const r=[];for(let s=0;s<localStorage.length;s++){const n=localStorage.key(s);n&&(n.startsWith("quiz-result-")||n==="quiz-app-user-progress"||n==="progress-data"||n.startsWith("session-history-")||n==="session-history"||n==="skipped-words"||n==="skip-groups"||n==="improvement-progress"||n==="study-settings"||n==="reading-passages-data"||n==="all-questions-cache")&&r.push(n)}r.forEach(s=>{try{localStorage.removeItem(s)}catch(n){f.error(`Failed to remove ${s}:`,n)}});const t=gt();lt(t),f.log(`âœ… ãƒªã‚»ãƒƒãƒˆå®Œäº†: LocalStorage ${r.length}å€‹ã®ã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`),window.location.reload()}function As(r=90){const t=Re(),s=new Date,n=[];f.log("ğŸ“Š getStudyCalendarDataå‘¼ã³å‡ºã— - progress.resultsä»¶æ•°:",t.results.length);for(let a=r-1;a>=0;a--){const i=new Date(s);i.setDate(i.getDate()-a);const l=Vt(i),o=new Date(i).setHours(0,0,0,0),c=new Date(i).setHours(23,59,59,999),d=t.results.filter(N=>N.date>=o&&N.date<=c);a===0&&f.log("ğŸ“… ä»Šæ—¥ã®ãƒ‡ãƒ¼ã‚¿:",{dateStr:l,dayStart:new Date(o).toISOString(),dayEnd:new Date(c).toISOString(),dayResults:d.length,sampleResults:d.slice(0,3).map(N=>({mode:N.mode,score:N.score,total:N.total,date:new Date(N.date).toISOString()}))});const m=d.reduce((N,b)=>N+b.total,0),h=d.reduce((N,b)=>N+b.score,0),p=m>0?h/m*100:0;n.push({date:l,count:m,accuracy:p})}return n}function Rs(r=12){const t=Re(),s=new Date,n=[];let a=0,i=0;for(let l=r-1;l>=0;l--){const o=new Date(s);o.setDate(s.getDate()-l*7),o.setHours(23,59,59,999);const c=new Date(o);c.setDate(o.getDate()-6),c.setHours(0,0,0,0);const m=t.results.filter(N=>N.date>=c.getTime()&&N.date<=o.getTime()).reduce((N,b)=>N+b.total,0);i+=m;let h=0;Object.values(t.wordProgress).forEach(N=>{N.masteryLevel==="mastered"&&N.lastStudied>=c.getTime()&&N.lastStudied<=o.getTime()&&h++}),a+=h;const p=`${c.getMonth()+1}/${c.getDate()}`;n.push({weekLabel:p,cumulativeMastered:a,weeklyMastered:h,cumulativeAnswered:i,weeklyAnswered:m})}return n}function Ps(){const r=Re(),t=Date.now(),s=t-7*24*60*60*1e3,n=t-30*24*60*60*1e3,a=new Set,i=new Set,l=new Set,o=new Set,c=new Set,d=new Set;return r.results.forEach(m=>{m.incorrectWords.forEach(h=>{c.add(h),m.date>=n&&l.add(h),m.date>=s&&a.add(h)})}),Object.entries(r.wordProgress).forEach(([m,h])=>{h.masteryLevel==="mastered"&&(d.add(m),h.lastStudied>=n&&o.add(m),h.lastStudied>=s&&i.add(m))}),{last7Days:Math.min(100,Math.max(0,a.size>0?i.size/a.size*100:0)),last30Days:Math.min(100,Math.max(0,l.size>0?o.size/l.size*100:0)),allTime:Math.min(100,Math.max(0,c.size>0?d.size/c.size*100:0))}}function Gt(r){const s=Re().wordProgress[r];if(!s)return null;const n=s.correctCount,a=s.correctCount+s.incorrectCount,o=(s.learningHistory||[]).slice(-10).map(p=>p.wasCorrect?"ğŸŸ©":"ğŸŸ¥").join("");let c=0;if(a===0)c=0;else{const p=n/a*70,N=Math.min(20,(s.consecutiveCorrect||0)*5),b=(Date.now()-s.lastStudied)/(24*60*60*1e3),x=Math.min(10,Math.max(0,(b-1)*2));c=Math.min(100,Math.max(0,p+N-x)),s.masteryLevel==="mastered"&&(c=Math.max(90,c))}let d="new",m="æœªå­¦ç¿’",h="âšª";return a===0?(d="new",m="æœªå­¦ç¿’",h="âšª"):s.masteryLevel==="mastered"||c>=80?(d="mastered",m="å®šç€æ¸ˆ",h="ğŸŸ¢"):c>=50?(d="learning",m="å­¦ç¿’ä¸­",h="ğŸŸ¡"):(d="struggling",m="è¦å¾©ç¿’",h="ğŸ”´"),{correctCount:n,totalCount:a,accuracyHistory:o,retentionRate:Math.round(c),status:d,statusLabel:m,statusIcon:h}}async function Ts(r){try{await Kt("memorization-card-settings",r)}catch(t){f.error("ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºè¨­å®šã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t),localStorage.setItem("memorization-card-settings",JSON.stringify(r))}}async function $s(){try{const r=await Xt("memorization-card-settings");return r?typeof r=="string"?JSON.parse(r):typeof r=="object"&&"showFurigana"in r?r:null:null}catch(r){f.error("ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºè¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=localStorage.getItem("memorization-card-settings");return t?JSON.parse(t):null}}async function Es(r){try{await Kt("memorization-settings",r)}catch(t){f.error("æš—è¨˜è¨­å®šã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t),localStorage.setItem("memorization-settings",JSON.stringify(r))}}async function _s(){try{const r=await Xt("memorization-settings");return r?typeof r=="string"?JSON.parse(r):typeof r=="object"&&"shuffleOrder"in r?r:null:null}catch(r){f.error("æš—è¨˜è¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=localStorage.getItem("memorization-settings");return t?JSON.parse(t):null}}async function Ls(r){try{const t=await Xt("memorization-behaviors"),n=[...t?typeof t=="string"?JSON.parse(t):t:[],r].slice(-1e3);await Kt("memorization-behaviors",n)}catch(t){f.error("æš—è¨˜è¡Œå‹•è¨˜éŒ²ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t)}}const yr="custom-question-sets";async function rs(){try{const r=await Xt(yr);return r?typeof r=="string"?JSON.parse(r):Array.isArray(r)?r:[]:[]}catch(r){return f.error("ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆå–å¾—ã‚¨ãƒ©ãƒ¼:",r),[]}}async function Bt(r){try{const t=await rs(),s=t.findIndex(n=>n.id===r.id);s>=0?t[s]={...r,updatedAt:Date.now()}:t.push(r),await Kt(yr,t)}catch(t){throw f.error("ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆä¿å­˜ã‚¨ãƒ©ãƒ¼:",t),t}}async function Ut(r,t=20,s=3,n=60,a){const o=Zt(100).filter(d=>d.mistakes>=s&&d.recentAccuracy<=n).slice(0,t).map(d=>{const m=a.find(h=>h.word.toLowerCase()===d.word.toLowerCase());return m||{word:d.word,reading:d.reading||"",meaning:d.meaning||"",etymology:"",relatedWords:"",relatedFields:"",difficulty:"intermediate"}});return{id:`weak-words-${Date.now()}`,name:r,source:"weak-words",questions:o,createdAt:Date.now(),updatedAt:Date.now(),isAutoUpdate:!0,autoUpdateConfig:{limit:t,minMistakes:s,maxAccuracy:n},metadata:{description:`è‹¦æ‰‹èªå¥ã‹ã‚‰è‡ªå‹•ç”Ÿæˆï¼ˆé–“é•ã„${s}å›ä»¥ä¸Šã€æ­£ç­”ç‡${n}%ä»¥ä¸‹ï¼‰`,totalWords:o.length}}}function Ht(){const r=Re(),n=Object.values(r.wordProgress).filter(o=>o.grammarAttempts&&o.grammarAttempts>0||o.word.startsWith("grammar_")||o.word.includes("_g")).filter(o=>o.grammarAttempts&&o.grammarAttempts>0||o.correctCount+o.incorrectCount>0);let a=0;n.forEach(o=>{const c=o.grammarAttempts||o.correctCount+o.incorrectCount,d=o.grammarCorrect||o.correctCount,m=o.grammarStreak||o.consecutiveCorrect,h=c>0?d/c*100:0,p=o.masteryLevel==="mastered",N=c===1&&d===1,b=c>=5&&h>=85,x=c>=3&&h>=90,v=m>=5,k=c>=10&&h>=75;(p||N||b||x||v||k)&&a++});const i=n.length>0?a/n.length*100:0,l=Math.min(100,Math.max(0,i));return{retentionRate:Math.round(l),masteredCount:a,appearedCount:n.length}}async function Ws(){const r=bs();return(await Promise.all(r.map(async s=>{const n=s.unit.match(/ä¸­(\d+)_Unit(\d+)/);if(!n)return null;const a=n[1],i=n[2];try{const l=await fetch(`/data/grammar/grammar_grade${a}_unit${i}.json`);if(l.ok){const o=await l.json();return o.enabled===!1?null:{...s,title:o.title||""}}}catch{return null}return null}))).filter(s=>s!==null)}const Ys=Object.freeze(Object.defineProperty({__proto__:null,addQuizResult:Mt,addSessionHistory:bt,checkFlexibleMastery:es,createWeakWordsQuestionSet:Ut,filterSkippedWords:ks,getAllWordProgress:ft,getConfusedWords:Ds,getCumulativeProgressData:Rs,getCurrentWeakWords:Zt,getCustomQuestionSets:rs,getDetailedRetentionStats:qt,getGrammarDetailedRetentionStats:zt,getGrammarRetentionRateWithAI:Ht,getGrammarUnitStats:bs,getGrammarUnitStatsWithTitles:Ws,getMemorizationCardSettings:$s,getMemorizationDetailedRetentionStats:Dt,getMemorizationSettings:_s,getMonthlyStats:vs,getNearMasteryStats:gr,getOvercomeWeakWords:Ns,getRecentlyMasteredWords:ws,getRetentionRateWithAI:Qt,getRetentionTrend:Ps,getStudyCalendarData:As,getStudySettings:xs,getTodayIncorrectWords:Wt,getTodayStats:Ot,getTotalAnsweredCount:Ms,getTotalMasteredWordsCount:ss,getUniqueQuestionedWordsCount:xr,getWeeklyStats:ys,getWordDetailedData:Gt,getWordProgress:Ft,isWordSkipExcluded:Ss,loadProgress:rt,loadProgressSync:Re,recordConfusion:Cs,recordMemorizationBehavior:Ls,recordWordSkip:ts,resetAllProgress:Is,saveCustomQuestionSet:Bt,saveMemorizationCardSettings:Ts,saveMemorizationSettings:Es,saveProgress:lt,updateProgressCache:ot,updateWordProgress:pt},Symbol.toStringTag,{value:"Module"}));function kt(r){const t=r.trim().split(`
`);if(t.length===0)return[];function s(l){const o=[];let c="",d=!1;for(let m=0;m<l.length;m++){const h=l[m],p=l[m+1];h==='"'?d&&p==='"'?(c+='"',m++):d=!d:h===","&&!d?(o.push(c.trim()),c=""):c+=h}return o.push(c.trim()),o}let n=0;const a=t[0].trim();(a.includes("èªå¥")||a.includes("term")||a.includes("èª­ã¿")||a.includes("reading")||a.includes("æ„å‘³")||a.includes("meaning"))&&(n=1);const i=[];for(let l=n;l<t.length;l++){const o=t[l].trim();if(!o||o.startsWith("//")||o.startsWith("#"))continue;const c=s(o);if(c.length>=3){const d=c[0]||"",m=c[1]||"",h=c[2]||"",p=c[3]||"";let N="",b="",x="";c.length>=8?(N=(c[4]||"")+(c[5]||""),b=c[6]||"",x=c[7]||""):(N=c[4]||"",b=c[5]||"",x=c[6]||"");let v="";x.includes("åˆç´š")||x==="beginner"?v="beginner":x.includes("ä¸­ç´š")||x==="intermediate"?v="intermediate":(x.includes("ä¸Šç´š")||x==="advanced")&&(v="advanced"),b&&!nn(b)&&f.warn(`[ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§è­¦å‘Š] ä¸æ­£ãªã‚«ãƒ†ã‚´ãƒª: "${b}" (å˜èª: "${d}")
æœ‰åŠ¹ãªã‚«ãƒ†ã‚´ãƒª: ${dr.join(", ")}
å‚ç…§: docs/19-junior-high-vocabulary.md`),d&&h&&i.push({word:d,reading:m,meaning:h,etymology:p,relatedWords:N,relatedFields:b,category:b,difficulty:v})}}return i}function ut(r){const t=[...r];for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t}function vr(r,t,s){const n=[],a=t.filter((o,c)=>c!==s),i=ut(a);for(let o=0;o<i.length&&n.length<2;o++){const c=i[o];c.meaning!==r.meaning&&!n.some(d=>d.meaning===c.meaning)&&n.push(c)}for(;n.length<2;)n.push({word:`ãƒ€ãƒŸãƒ¼${n.length+1}`,meaning:`é¸æŠè‚¢${n.length+1}`,reading:"",etymology:"",relatedWords:"",relatedFields:"",category:"",difficulty:""});return[...ut([{text:r.meaning,question:r},...n.map(o=>({text:o.meaning,question:o}))]),{text:"åˆ†ã‹ã‚‰ãªã„",question:null}]}const Cn="quizApp_questionSets";function wr(r){try{localStorage.setItem(Cn,JSON.stringify(r))}catch(t){f.error("Failed to save question sets:",t)}}function Vt(r){const t=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${t}-${s}-${n}`}const vt="quiz-result-added";function It(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function br(r,t=10){const n=ft().filter(i=>i.difficultyScore>=50).sort((i,l)=>l.difficultyScore-i.difficultyScore).map(i=>i.word.toLowerCase()),a=r.filter(i=>n.includes(i.word.toLowerCase()));return ut(a).slice(0,Math.min(t,a.length))}function jr(r){if(!r.includes(" "))return"word";const t=r.toLowerCase(),s=t.split(" "),n=["get","go","come","take","make","put","look","turn","break","bring","call","carry","check","figure","fill","find","give","hand","hang","hold","keep","knock","lay","let","pass","pick","pull","push","run","set","show","shut","sit","stand","stay","stick","take","talk","think","throw","try","work","write"],a=["up","down","in","out","on","off","away","back","over","through","around","across","along","about","after","for","from","into","to","with"];return s.length>=2&&n.includes(s[0])&&s.slice(1).some(m=>a.includes(m))?"phrasal-verb":[/^a .+ of$/,/^the .+ (of|in)$/,/^(break|beat|hit|kick) (the|a)/,/^(catch|have|take|make) (a|an|the)/,/(eye|eyes|face|hand|tongue|ear|nose|heart|mind|bone)/i,/^once in a/,/^(cost|pay|worth) (an|a)/,/^at .+ (heart|first|last|once)/].some(d=>d.test(t))?"idiom":[/^(in|on|at|by|with|from|to) (the|a|an) /,/^(make|take|do|have|get) (a|an|the) /,/(strong|weak|heavy|light|high|low|good|bad|big|small) /i].some(d=>d.test(t))?"collocation":"other"}function Dn(r,t=90){const s=Math.floor(t/3),n=Math.floor(t*2/3);return r<=s?1:r<=n?2:3}function Mn(r){const t=ft(),s=new Map;return t.forEach(n=>{s.set(n.word.toLowerCase(),n)}),r.filter(n=>{const a=s.get(n.word.toLowerCase());return!a||a.masteryLevel==="new"})}function In(r){const t=Date.now(),s=ft(),n=new Map;return s.forEach(a=>{n.set(a.word.toLowerCase(),a)}),r.filter(a=>{const i=n.get(a.word.toLowerCase());if(!i)return!1;const l=(t-i.lastStudied)/(1e3*60*60*24);let o;switch(i.masteryLevel){case"new":o=1;break;case"learning":o=Math.min(7,i.consecutiveCorrect+1);break;case"mastered":o=Math.min(30,i.consecutiveCorrect*2);break;default:o=1}return l>=o})}function An(r,t,s){let n;switch(t){case 1:n=r.filter(c=>c.difficulty==="åˆç´š"),n.length<s&&(n=[...n,...r.filter(c=>c.difficulty==="ä¸­ç´š")]);break;case 2:const a=r.filter(c=>c.difficulty==="åˆç´š"),i=r.filter(c=>c.difficulty==="ä¸­ç´š");n=[...a,...i];break;case 3:const l=r.filter(c=>c.difficulty==="ä¸­ç´š"),o=r.filter(c=>c.difficulty==="ä¸Šç´š");n=[...l,...o];break}return ut(n).slice(0,s)}function Nr(r,t){const s=r.currentDay,n=Dn(s,r.totalDays),a=Mn(t),i=In(t),l=Math.ceil(r.dailyGoals.newWords*.3),o=An(a,n,l),c=Math.ceil(r.dailyGoals.reviewWords*.4),d=br(i.length>0?i:t,c),m=Math.floor(l*.3),h=Math.ceil(r.dailyGoals.reviewWords*.3),p=[...ut(o).slice(0,m),...ut(i.length>0?i:t).slice(0,h)];return{date:r.startDate+(s-1)*24*60*60*1e3,dayNumber:s,phase:n,morning:{newWords:o,duration:Math.ceil(r.dailyGoals.timeMinutes*.35),mode:"discovery"},afternoon:{reviewWords:d,duration:Math.ceil(r.dailyGoals.timeMinutes*.3),mode:"weakness"},evening:{mixedWords:ut(p),duration:Math.ceil(r.dailyGoals.timeMinutes*.35),mode:"mixed"},completed:!1,actualAccuracy:0}}function Sr(r){const t=ft(),s=t.filter(d=>d.masteryLevel!=="new").length,n=t.reduce((d,m)=>d+m.correctCount+m.incorrectCount,0),a=t.reduce((d,m)=>d+m.correctCount,0),i=n>0?a/n*100:0,l=s/r.currentDay,c=(4700-s)/(l||50);return{totalLearned:s,totalReviewed:n,averageAccuracy:i,estimatedCompletion:Math.ceil(c)}}function kr(r){const t=Math.ceil(r.currentDay/7),s=r.dailyGoals.newWords*7,n=r.weeklyProgress.find(a=>a.week===t);return n?n.wordsLearned/s*100:0}const Rn=Object.freeze(Object.defineProperty({__proto__:null,QUIZ_RESULT_EVENT:vt,calculateProgress:Sr,calculateWeeklyAchievement:kr,classifyPhraseType:jr,formatLocalYYYYMMDD:Vt,generateChoicesWithQuestions:vr,generateDailyPlan:Nr,generateId:It,parseCSV:kt,saveQuestionSets:wr,selectWeakQuestions:br,shuffle:ut},Symbol.toStringTag,{value:"Module"}));function Pn(){const[r]=u.useState(()=>{const s=localStorage.getItem("autoAdvance");return s?JSON.parse(s):!1}),[t]=u.useState(()=>{const s=localStorage.getItem("autoAdvanceDelay");return s?parseInt(s,10):1500});return{autoAdvance:r,autoAdvanceDelay:t}}function Tn(){const[r,t]=u.useState([]),[s,n]=u.useState("all"),[a,i]=u.useState("all"),[l,o]=u.useState("all"),[c,d]=u.useState("all"),[m,h]=u.useState(()=>{const p=localStorage.getItem("selectedDataSource");if(p)try{return JSON.parse(p)}catch{return"all"}return"all"});return{categoryList:r,setCategoryList:t,selectedCategory:s,setSelectedCategory:n,selectedDifficulty:a,setSelectedDifficulty:i,selectedWordPhraseFilter:l,setSelectedWordPhraseFilter:o,selectedPhraseTypeFilter:c,setSelectedPhraseTypeFilter:d,selectedDataSource:m,setSelectedDataSource:h}}function $n(){const[r,t]=u.useState({correct:0,incorrect:0,review:0,mastered:0,newQuestions:0,reviewQuestions:0,consecutiveNew:0,consecutiveReview:0}),[s,n]=u.useState({questions:[],currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedAnswer:null}),[a,i]=u.useState(!1),[l,o]=u.useState([]),[c,d]=u.useState(new Map);return{sessionStats:r,setSessionStats:t,quizState:s,setQuizState:n,reviewFocusMode:a,setReviewFocusMode:i,reviewQuestionPool:l,setReviewQuestionPool:o,reviewCorrectStreak:c,setReviewCorrectStreak:d}}const Cr="customQuestionSets";function En(){try{const r=localStorage.getItem(Cr);if(r){const t=JSON.parse(r);return{sets:t.sets||[],activeSetId:t.activeSetId||null,recentSetIds:t.recentSetIds||[]}}}catch(r){console.error("Failed to load custom question state:",r)}return{sets:[],activeSetId:null,recentSetIds:[]}}function _n(r){try{localStorage.setItem(Cr,JSON.stringify(r))}catch(t){console.error("Failed to save custom question state:",t)}}function Ln(r,t,s,n){const a=new Date().toISOString();return{id:`set_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:r,description:t,words:[],createdAt:a,updatedAt:a,icon:s,color:n}}function Wn(r,t,s){const n=r.sets.map(a=>a.id!==t||a.words.some(i=>i.word===s.word)?a:{...a,words:[...a.words,{...s,addedAt:new Date().toISOString()}],updatedAt:new Date().toISOString()});return{...r,sets:n,recentSetIds:Fn(r.recentSetIds,t)}}function On(r,t,s){const n=r.sets.map(a=>a.id!==t?a:{...a,words:a.words.filter(i=>i.word!==s.word),updatedAt:new Date().toISOString()});return{...r,sets:n}}function qn(r,t){return{...r,sets:r.sets.filter(s=>s.id!==t),activeSetId:r.activeSetId===t?null:r.activeSetId,recentSetIds:r.recentSetIds.filter(s=>s!==t)}}function zn(r,t,s){const n=r.sets.map(a=>a.id!==t?a:{...a,...s,updatedAt:new Date().toISOString()});return{...r,sets:n}}function Fn(r,t){const s=r.filter(a=>a!==t);return[t,...s].slice(0,5)}function Qn(r,t,s){if(r===0)return 0;const n=(Date.now()-r)/(1e3*60*60*24);let i=(t>0?n/t:0)*100;return s<50?i*=1.5:s>=80&&(i*=.7),Math.round(Math.min(i,200))}function Gn(r,t=2.5){return r===0?0:r===1?1:r===2?3:r===3?7:Math.round(7*Math.pow(t,r-3))}function Ks(r,t){var a;const n=localStorage.getItem("english-progress");if(!n)return null;try{const l=(a=JSON.parse(n).wordProgress)==null?void 0:a[r];if(!l)return null;const o=t==="memorization"?"memorization":"default",c=t==="memorization"?l.memorizationAttempts||0:l.attempts||0,d=t==="memorization"?l.memorizationCorrect||0:l.correct||0,m=t==="memorization"&&l.memorizationStillLearning||0,h=t==="memorization"?l.memorizationStreak||0:l.streak||0,p=l.lastStudied||0,N=l.easinessFactor||2.5,b=l.reviewInterval||Gn(h,N);if(c===0)return{category:"new",priority:3,lastStudied:p,attempts:c,correct:d,streak:h,forgettingRisk:0,reviewInterval:0};const x=d+m*.5,v=c>0?x/c*100:0,k=Qn(p,b,v);return h>=3||h>=2&&v>=80?{category:"mastered",priority:5,lastStudied:p,attempts:c,correct:d,streak:h,forgettingRisk:k,reviewInterval:b}:v>=50||m>0?{category:"still_learning",priority:2,lastStudied:p,attempts:c,correct:d,streak:h,forgettingRisk:k,reviewInterval:b}:{category:"incorrect",priority:1,lastStudied:p,attempts:c,correct:d,streak:h,forgettingRisk:k,reviewInterval:b}}catch(i){return f.error("çµ±è¨ˆæƒ…å ±ã®å–å¾—ã‚¨ãƒ©ãƒ¼:",i),null}}function ns(r,t){const{isReviewFocusMode:s=!1,learningLimit:n,reviewLimit:a,mode:i}=t,l=r.map((se,fe)=>({question:se,status:Ks(se.word,i),index:fe})),o={mastered:l.filter(se=>{var fe;return((fe=se.status)==null?void 0:fe.category)==="mastered"}).length,still_learning:l.filter(se=>{var fe;return((fe=se.status)==null?void 0:fe.category)==="still_learning"}).length,incorrect:l.filter(se=>{var fe;return((fe=se.status)==null?void 0:fe.category)==="incorrect"}).length,new:l.filter(se=>{var fe;return((fe=se.status)==null?void 0:fe.category)==="new"}).length},c=n!=null&&o.still_learning>=n,d=a!=null&&o.incorrect>=a,m=o.mastered+o.still_learning+o.incorrect,h=o.still_learning+o.incorrect,N=(m>0?h/m:0)>=.2,b=n??a??50,x=Math.max(3,Math.floor(b*.6)),v=Math.max(2,Math.floor(b*.3)),k=o.incorrect>x,M=o.incorrect<=v,j=l.sort((se,fe)=>{const y=se.status,P=fe.status;let R=(y==null?void 0:y.priority)||3,U=(P==null?void 0:P.priority)||3;const J=se.question.sessionPriority!==void 0,Z=fe.question.sessionPriority!==void 0;if(J&&!Z)return-1;if(!J&&Z)return 1;if(J&&Z)return(se.question.sessionPriority||0)-(fe.question.sessionPriority||0);if(s)(y==null?void 0:y.category)==="incorrect"&&(R=0),(P==null?void 0:P.category)==="incorrect"&&(U=0),(y==null?void 0:y.category)==="still_learning"&&R!==0&&(R=.5),(P==null?void 0:P.category)==="still_learning"&&U!==0&&(U=.5),(y==null?void 0:y.category)==="mastered"&&R>1&&(R=10),(P==null?void 0:P.category)==="mastered"&&U>1&&(U=10),(y==null?void 0:y.category)==="new"&&R>1&&(R=8),(P==null?void 0:P.category)==="new"&&U>1&&(U=8);else{const we=(y==null?void 0:y.forgettingRisk)||0,Le=(P==null?void 0:P.forgettingRisk)||0;we>=150&&(R=.1),Le>=150&&(U=.1),we>=100&&we<150&&(R=.2),Le>=100&&Le<150&&(U=.2),(y==null?void 0:y.category)==="incorrect"&&R>.2&&(k?R=y.lastStudied&&Date.now()-y.lastStudied<864e5?.1:.3:R=.3),(P==null?void 0:P.category)==="incorrect"&&U>.2&&(k?U=P.lastStudied&&Date.now()-P.lastStudied<864e5?.1:.3:U=.3),(y==null?void 0:y.category)==="still_learning"&&R>.3&&(R=.8),(P==null?void 0:P.category)==="still_learning"&&U>.3&&(U=.8),(y==null?void 0:y.category)==="mastered"&&(we>=50&&R>1?R=2:R>2&&(R=4.5)),(P==null?void 0:P.category)==="mastered"&&(Le>=50&&U>1?U=2:U>2&&(U=4.5)),(y==null?void 0:y.category)==="new"&&R>3&&(k?R=10:M?R=3.5:R=N?5:3.5),(P==null?void 0:P.category)==="new"&&U>3&&(k?U=10:M?U=3.5:U=N?5:3.5),d&&((y==null?void 0:y.category)==="incorrect"&&(R=0),(P==null?void 0:P.category)==="incorrect"&&(U=0)),c&&((y==null?void 0:y.category)==="still_learning"&&(R=.05),(P==null?void 0:P.category)==="still_learning"&&(U=.05))}if(R!==U)return R-U;const ke=(y==null?void 0:y.lastStudied)||0,xe=(P==null?void 0:P.lastStudied)||0;return ke!==xe?ke-xe:se.index-fe.index}).map(se=>se.question),z=j.filter(se=>se.sessionPriority!==void 0),V=j.filter(se=>se.sessionPriority===void 0),ye=[],ue=[];V.forEach(se=>{const fe=Ks(se.word,i);fe&&fe.category!=="new"?ye.push(se):ue.push(se)});const K=[];let he=0,Se=0;for(K.push(...z);he<ye.length||Se<ue.length;){for(let se=0;se<7&&he<ye.length;se++)K.push(ye[he++]);for(let se=0;se<3&&Se<ue.length;se++)K.push(ue[Se++])}return K}function as(){const r=u.useCallback((a,i,l)=>{const o=a.id??a.word??String(a.japanese??""),c={...a,sessionPriority:Date.now(),reAddedCount:(a.reAddedCount||0)+1},d=Math.min(l+6,i.length);if(i.slice(l+1,d).some(x=>((x==null?void 0:x.id)??(x==null?void 0:x.word)??String((x==null?void 0:x.japanese)??""))===o))return i;const p=a.reAddedCount||0,N=Math.max(1,Math.min(5,p===0?2:1)),b=Math.min(l+1+N,i.length);return[...i.slice(0,b),c,...i.slice(b)]},[]),t=u.useCallback((a,i)=>i>=a.length-1?a:a.map((l,o)=>{if(l.sessionPriority&&o>i&&o-i>5){const{sessionPriority:c,...d}=l;return d}return l}),[]),s=u.useCallback(a=>(a.reAddedCount||0)>0,[]),n=u.useCallback((a,i,l)=>{const o=(a.reAddedCount||0)>0;l(c=>({...c,newQuestions:o?c.newQuestions:(c.newQuestions||0)+1,reviewQuestions:o?(c.reviewQuestions||0)+1:c.reviewQuestions||0,consecutiveNew:o?0:(c.consecutiveNew||0)+1,consecutiveReview:o?(c.consecutiveReview||0)+1:0}))},[]);return{reAddQuestion:r,clearExpiredFlags:t,isReviewQuestion:s,updateRequeueStats:n}}class Bn{constructor(){Ye(this,"map",new Map);Ye(this,"seqIndex",0);Ye(this,"startedAt",Date.now())}reset(){this.map.clear(),this.seqIndex=0,this.startedAt=Date.now()}onShown(t){const s=this.map.get(t)||{timesShown:0,timesWrong:0,lags:[],readds:0};s.timesShown+=1,this.map.set(t,s),this.seqIndex+=1}onAnswer(t,s){const n=this.map.get(t)||{timesShown:0,timesWrong:0,lags:[],readds:0};if(!s)n.timesWrong+=1,n.lastWrongIndex=this.seqIndex;else if(n.lastWrongIndex!==void 0){const a=Math.max(0,this.seqIndex-n.lastWrongIndex);n.lags.push(a),n.lastWrongIndex=void 0}this.map.set(t,n)}onReAdd(t){const s=this.map.get(t)||{timesShown:0,timesWrong:0,lags:[],readds:0};s.readds+=1,this.map.set(t,s)}summarize(){const t=Array.from(this.map.values()),s=t.length,n=t.filter(c=>c.timesShown>=2).length,a=s>0?n/s:0,i=t.flatMap(c=>c.lags),l=i.length?[...i].sort((c,d)=>c-d)[Math.floor(i.length/2)]:0,o=i.length?[...i].sort((c,d)=>c-d)[Math.floor(i.length*.9)]:0;return{totalItems:s,reappearanceRate:a,medianLag:l,p90Lag:o,durationSec:Math.round((Date.now()-this.startedAt)/1e3)}}}const jt=new Bn,Dr="learning-assistant-skip-groups",Un=5*60*1e3;function Os(){try{const r=localStorage.getItem(Dr);return r?JSON.parse(r):[]}catch(r){return f.error("ã‚¹ã‚­ãƒƒãƒ—ã‚°ãƒ«ãƒ¼ãƒ—ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r),[]}}function qs(r){try{localStorage.setItem(Dr,JSON.stringify(r))}catch(t){f.error("ã‚¹ã‚­ãƒƒãƒ—ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t)}}function Mr(r){const t=Os(),s=Date.now(),n=t.find(a=>a.verificationStatus==="pending"&&s-a.timestamp<Un);n?n.words.includes(r)||n.words.push(r):t.push({timestamp:s,words:[r],verificationStatus:"pending",suspiciousWords:[]}),qs(t)}function Ir(r){const t=Os(),s=Re(),n=t.find(a=>a.words.includes(r));n&&n.verificationStatus==="pending"&&(n.verificationStatus="suspicious",n.suspiciousWords=n.words.filter(a=>a!==r),n.suspiciousWords.forEach(a=>{if(s.wordProgress[a]){const i=s.wordProgress[a];delete i.skipExcludeUntil,i.masteryLevel="learning",i.consecutiveCorrect=0,i.needsVerification=!0,i.verificationReason=`åŒæ™‚æœŸã«ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã€Œ${r}ã€ãŒä¸æ­£è§£ã ã£ãŸãŸã‚`}}),lt(s),qs(t),f.log(`AIå­¦ç¿’ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ: ã€Œ${r}ã€ãŒä¸æ­£è§£ã§ã—ãŸã€‚åŒæ™‚æœŸã«ã‚¹ã‚­ãƒƒãƒ—ã—ãŸ${n.suspiciousWords.length}å€‹ã®å˜èªã‚’å†å‡ºé¡Œå¯¾è±¡ã«ã—ã¾ã™ã€‚`))}function Ar(r){const t=Os(),s=Re(),n=t.find(a=>a.words.includes(r));n&&(n.suspiciousWords=n.suspiciousWords.filter(i=>i!==r),n.words.every(i=>{const l=s.wordProgress[i];return l&&(l.correctCount>0||l.incorrectCount>0)})&&n.suspiciousWords.length===0&&(n.verificationStatus="verified"),s.wordProgress[r]&&(delete s.wordProgress[r].needsVerification,delete s.wordProgress[r].verificationReason),lt(s),qs(t))}function Hn(r,t){const s=Re(),n=new Map;t.forEach(d=>{n.set(d,{correct:0,total:0,mastered:0,wordCount:0})}),s.results.forEach(d=>{if(d.category&&n.has(d.category)){const m=n.get(d.category);m.correct+=d.score,m.total+=d.total}}),r.forEach(d=>{const m=d.category;if(!m||!n.has(m))return;const h=n.get(m);h.wordCount++;const p=s.wordProgress[d.word];if(p){const N=p.correctCount+p.incorrectCount,b=N===1&&p.correctCount===1||p.consecutiveCorrect>=3||p.skippedCount&&p.skippedCount>0,x=N>=3&&p.correctCount/N>=.8&&p.consecutiveCorrect>=2;(b||x)&&h.mastered++}});const a=[],i=[];n.forEach((d,m)=>{if(d.total===0&&d.wordCount===0)return;const h=d.total>0?d.correct/d.total*100:0,p=d.wordCount>0?d.mastered/d.wordCount*100:0,N=h*.6+p*.4;if(N<60){let b,x,v;N<40?(b="critical",x=100,v=14):N<50?(b="moderate",x=70,v=10):(b="minor",x=40,v=7),d.total<10&&(x+=20),a.push({category:m,accuracy:h,totalAttempts:d.total,masteredWords:d.mastered,totalWords:d.wordCount,weaknessLevel:b,priorityScore:x,estimatedImprovementDays:v})}else if(N>=75){let b;N>=90?b="expert":N>=80?b="proficient":b="good",i.push({category:m,accuracy:h,totalAttempts:d.total,masteredWords:d.mastered,totalWords:d.wordCount,strengthLevel:b})}}),a.sort((d,m)=>m.priorityScore-d.priorityScore),i.sort((d,m)=>m.accuracy-d.accuracy);const l=Vn(n),o=Jn(a),c=Yn(a,i,l);return{weakCategories:a,strongCategories:i,balanceScore:l,improvementPlan:o,aiRecommendations:c}}function Vn(r){const t=[];if(r.forEach(l=>{if(l.total>0){const o=l.correct/l.total*100;t.push(o)}}),t.length===0)return 50;const s=t.reduce((l,o)=>l+o,0)/t.length,n=t.reduce((l,o)=>l+Math.pow(o-s,2),0)/t.length,a=Math.sqrt(n),i=Math.max(0,Math.min(100,100-a*2));return Math.round(i)}function Jn(r){const t=[],s={},n=[],a=r.slice(0,3);a.forEach(l=>{t.push(l.category);let o;l.weaknessLevel==="critical"?o=15:l.weaknessLevel==="moderate"?o=10:o=5,s[l.category]=o;const c={day:Math.ceil(l.estimatedImprovementDays/2),category:l.category,targetAccuracy:Math.min(l.accuracy+20,80),description:`${l.category}ã®æ­£ç­”ç‡ã‚’${Math.round(l.accuracy)}%ã‹ã‚‰${Math.min(l.accuracy+20,80)}%ã«æ”¹å–„`};n.push(c)});const i=a.length>0?Math.max(...a.map(l=>l.estimatedImprovementDays)):0;return{targetCategories:t,dailyQuestions:s,estimatedCompletionDays:i,milestones:n}}function Yn(r,t,s){const n=[];if(r.length>0){const i=r[0];n.push(`ğŸ¯ æœ€å„ªå…ˆ: ã€Œ${i.category}ã€ã‚’é‡ç‚¹å­¦ç¿’ã—ã¾ã—ã‚‡ã†ï¼ˆç¾åœ¨${Math.round(i.accuracy)}% â†’ ç›®æ¨™80%ï¼‰`),i.weaknessLevel==="critical"&&n.push(`âš ï¸ ã€Œ${i.category}ã€ã¯é‡è¦ãªå¼±ç‚¹ã§ã™ã€‚æ¯æ—¥15å•ä»¥ä¸Šå–ã‚Šçµ„ã‚€ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™`),r.length>=3&&n.push(`ğŸ“š ${r.length}å€‹ã®å¼±ç‚¹åˆ†é‡ãŒã‚ã‚Šã¾ã™ã€‚1ã¤ãšã¤é›†ä¸­ã—ã¦æ”¹å–„ã—ã¾ã—ã‚‡ã†`)}if(s<50?n.push(`âš–ï¸ å­¦ç¿’ãƒãƒ©ãƒ³ã‚¹ãŒåã£ã¦ã„ã¾ã™ï¼ˆãƒãƒ©ãƒ³ã‚¹ã‚¹ã‚³ã‚¢: ${s}%ï¼‰ã€‚å¼±ç‚¹åˆ†é‡ã«æ™‚é–“ã‚’é…åˆ†ã—ã¾ã—ã‚‡ã†`):s>=80&&n.push(`âœ¨ ç´ æ™´ã‚‰ã—ã„ãƒãƒ©ãƒ³ã‚¹ã§ã™ï¼ï¼ˆãƒãƒ©ãƒ³ã‚¹ã‚¹ã‚³ã‚¢: ${s}%ï¼‰ã“ã®èª¿å­ã§ç¶™ç¶šã—ã¾ã—ã‚‡ã†`),t.length>0&&r.length>0){const i=t[0];n.push(`ğŸ’ª ã€Œ${i.category}ã€ã¯å¾—æ„åˆ†é‡ã§ã™ï¼ˆ${Math.round(i.accuracy)}%ï¼‰ã€‚ã“ã®å­¦ç¿’æ–¹æ³•ã‚’ä»–ã®åˆ†é‡ã«ã‚‚å¿œç”¨ã—ã¾ã—ã‚‡ã†`)}return r.length>0&&n.push("ğŸ§  AIå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ãŒå¼±ç‚¹åˆ†é‡ã®å•é¡Œã‚’è‡ªå‹•çš„ã«å„ªå…ˆå‡ºé¡Œã—ã¾ã™"),[...r,...t].reduce((i,l)=>i+l.totalAttempts,0)<50&&n.push("ğŸ“ˆ ã¾ã å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªã„ã§ã™ã€‚50å•ä»¥ä¸Šè§£ãã¨ã‚ˆã‚Šæ­£ç¢ºãªåˆ†æãŒã§ãã¾ã™"),n}function Kn(r,t,s=30){if(t.length===0)return r.slice(0,s);const n=[],a=new Map,i=t.slice(0,3).reduce((h,p)=>h+p.priorityScore,0);t.slice(0,3).forEach(h=>{const p=Math.ceil(h.priorityScore/i*s*.7);a.set(h.category,p)}),t.slice(0,3).forEach(h=>{const p=a.get(h.category)||0,N=r.filter(k=>k.category===h.category),b=Re(),x=N.filter(k=>{const M=b.wordProgress[k.word];return M?M.consecutiveCorrect<3:!0}),v=us(x).slice(0,p);n.push(...v)});const l=s-n.length,o=new Set(t.slice(0,3).map(h=>h.category)),c=r.filter(h=>!o.has(h.category||"")),d=new Set(n.map(h=>h.word)),m=c.filter(h=>!d.has(h.word));return n.push(...us(m).slice(0,l)),us(n)}function us(r){const t=[...r];for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t}function Xn(r){const t={startDate:Date.now(),currentDay:1,targetCategories:r.improvementPlan.targetCategories,initialAccuracies:{},currentAccuracies:{},improvements:{},overallProgress:0,isCompleted:!1};r.weakCategories.forEach(s=>{r.improvementPlan.targetCategories.includes(s.category)&&(t.initialAccuracies[s.category]=s.accuracy,t.currentAccuracies[s.category]=s.accuracy,t.improvements[s.category]=0)}),localStorage.setItem("radar-improvement-progress",JSON.stringify(t))}function Rr(){const r=localStorage.getItem("radar-improvement-progress");if(!r)return null;try{return JSON.parse(r)}catch{return null}}function Zn(r){const t=Rr();if(!t)return;const s=Math.floor((Date.now()-t.startDate)/(1e3*60*60*24));t.currentDay=s+1;let n=0;t.targetCategories.forEach(a=>{const i=r.weakCategories.find(c=>c.category===a),l=(i==null?void 0:i.accuracy)||80;t.currentAccuracies[a]=l;const o=l-t.initialAccuracies[a];t.improvements[a]=o,l>=80&&n++}),t.overallProgress=n/t.targetCategories.length*100,t.isCompleted=n===t.targetCategories.length,localStorage.setItem("radar-improvement-progress",JSON.stringify(t))}function ea(r,t,s){const n=ta(s),a=sa(s),i=ra(t,s,n);return{word:r,attempts:s,confusedWith:a,learningCurve:n,predictionModel:i}}function ta(r){if(r.length===0)return{accuracyHistory:[],stabilityScore:0,stage:"initial",forgettingPattern:{typicalDecayDays:7,forgettingCount:0},efficiency:{attemptsToMastery:10,currentProgress:0,estimatedDaysToMastery:30}};const t=[],s=5;for(let k=0;k<r.length;k++){const M=Math.max(0,k-s+1),S=r.slice(M,k+1),j=S.filter(z=>z.wasCorrect).length/S.length*100;t.push({timestamp:r[k].timestamp,accuracy:j})}const n=r.slice(-10),a=n.map((k,M)=>{const S=Math.max(0,n.length-5),j=n.slice(S,M+1);return j.filter(z=>z.wasCorrect).length/j.length*100}),i=a.reduce((k,M)=>k+M,0)/a.length,l=a.reduce((k,M)=>k+Math.pow(M-i,2),0)/a.length,o=Math.sqrt(l),c=Math.max(0,Math.min(100,100-o/30*100)),d=n.filter(k=>k.wasCorrect).length/n.length;let m;r.length<3?m="initial":d<.3?m="struggling":d<.7&&c<50?m="improving":d>=.7&&c>=50?m="consolidating":d>=.9&&c>=80?m="mastered":m="improving";const h=r.filter(k=>!k.wasCorrect),p=h.length;let N=7;if(h.length>=2){const k=[];for(let M=1;M<h.length;M++){const S=(h[M].timestamp-h[M-1].timestamp)/864e5;k.push(S)}N=k.reduce((M,S)=>M+S,0)/k.length}const b=Math.min(100,(d*100+c)/2),x=r.length<5?10:Math.ceil(10/(b/100)),v=Math.max(1,Math.ceil((100-b)/5));return{accuracyHistory:t,stabilityScore:c,stage:m,forgettingPattern:{typicalDecayDays:N,lastForgetDate:h.length>0?h[h.length-1].timestamp:void 0,forgettingCount:p},efficiency:{attemptsToMastery:x,currentProgress:b,estimatedDaysToMastery:v}}}function sa(r){const t=new Map;return r.forEach(s=>{if(!s.wasCorrect&&s.userAnswer){const n=s.userAnswer;if(t.has(n)){const a=t.get(n);a.frequency++,a.lastConfusion=s.timestamp}else t.set(n,{confusedWord:s.userAnswer,frequency:1,lastConfusion:s.timestamp,confusionType:"meaning",similarity:.7})}}),Array.from(t.values()).sort((s,n)=>n.frequency-s.frequency).slice(0,5)}function ra(r,t,s){const n=t.slice(-5),a=n.length>0?n.filter(p=>p.wasCorrect).length/n.length*100:50,i=s.stabilityScore/100,l=t.length>0?(Date.now()-t[t.length-1].timestamp)/(1e3*60*60*24):0,o=t.slice(-10).filter(p=>!p.wasCorrect&&p.userAnswer),c=Math.min(1,o.length/5);let d=a;d+=i*20;const m=Math.exp(-l/s.forgettingPattern.typicalDecayDays);d*=m,d-=c*30,d=Math.max(0,Math.min(100,d));const h=Math.min(1,t.length/10);return{nextCorrectProbability:d,predictors:{recentAccuracy:a,stabilityFactor:i,timeSinceLastStudy:l,confusionRisk:c},confidence:h}}function na(r,t,s){const n=[];return r.forEach(a=>{const i=t[a.word],l=s.get(a.word),o=aa(a,i,l);n.push(o)}),n.sort((a,i)=>i.priority-a.priority)}function aa(r,t,s){if(!t||!s)return{word:r.word,priority:50,reason:"æ–°è¦å˜èª",strategy:"new_learning",estimatedSuccessRate:50,learningImpact:60};const n=s.learningCurve,a=s.predictionModel;switch(n.stage){case"struggling":return{word:r.word,priority:90,reason:`è‹¦æˆ¦ä¸­ï¼ˆæ­£ç­”ç‡${a.predictors.recentAccuracy.toFixed(0)}%ï¼‰`,strategy:"immediate_review",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:80};case"improving":{const i=a.predictors.timeSinceLastStudy,l=i>=1&&i<=3;return{word:r.word,priority:l?85:70,reason:`æ”¹å–„ä¸­ï¼ˆ${i.toFixed(1)}æ—¥çµŒéã€æˆåŠŸç‡${a.nextCorrectProbability.toFixed(0)}%ï¼‰`,strategy:l?"consolidation":"spaced_repetition",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:75}}case"consolidating":{const i=n.forgettingPattern.typicalDecayDays*.7,l=a.predictors.timeSinceLastStudy,o=Math.abs(l-i)<2;return{word:r.word,priority:o?60:40,reason:`å®šç€åŒ–ä¸­ï¼ˆæ¬¡å›å¾©ç¿’ã¾ã§${Math.max(0,i-l).toFixed(1)}æ—¥ï¼‰`,strategy:"spaced_repetition",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:50}}case"mastered":return{word:r.word,priority:20,reason:"ç¿’å¾—æ¸ˆã¿ï¼ˆé•·æœŸè¨˜æ†¶ç¢ºèªï¼‰",strategy:"spaced_repetition",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:20};default:return{word:r.word,priority:50,reason:"åˆæœŸæ®µéš",strategy:"new_learning",estimatedSuccessRate:50,learningImpact:60}}}function ia(r,t){const s=r.filter(o=>o.strategy==="immediate_review");if(s.length===0)return r;const n=[],a=s.slice(0,3);n.push(...a);const i=r.filter(o=>o.strategy==="consolidation");i.length>0&&n.push(i[0]),a.length>0&&t>=10&&n.push(a[0]);const l=r.filter(o=>!n.includes(o));return n.push(...l),n.slice(0,t)}function Xs(r,t){const n=(Date.now()-t)/(1e3*60),a=r.slice(-5),i=r.slice(-10),l=a.length>0?a.filter(M=>M.wasCorrect).length/a.length*100:100,o=i.length>0?i.filter(M=>M.wasCorrect).length/i.length*100:100,c=o-l>10,d=r.length>0?r.reduce((M,S)=>M+S.responseTime,0)/r.length:3e3,m=r.slice(-5).map(M=>M.responseTime),h=oa(m);let p=0;p+=Math.min(40,n*2),c&&(p+=25),h>1.3&&(p+=20),r.slice(-3).filter(M=>!M.wasCorrect).length>=2&&(p+=15),p=Math.min(100,Math.max(0,p));const b=100-p,x=new Date().getHours();let v;x>=6&&x<12?v="morning":x>=12&&x<18?v="afternoon":x>=18&&x<22?v="evening":v="night";const k=la(p,n,c);return{fatigueLevel:p,concentrationLevel:b,recentPerformance:{last5Accuracy:l,last10Accuracy:o,isDecreasing:c,averageResponseTime:d},sessionStats:{duration:n,questionsAnswered:r.length,correctCount:r.filter(M=>M.wasCorrect).length,startTime:t},breakRecommendation:k,timeOfDay:v}}function oa(r){if(r.length<2)return 1;const t=r.slice(-3),s=r.slice(0,Math.max(1,r.length-3)),n=t.reduce((i,l)=>i+l,0)/t.length,a=s.reduce((i,l)=>i+l,0)/s.length;return a>0?n/a:1}function la(r,t,s){if(r>=70)return{shouldBreak:!0,reason:"ç–²åŠ´ãŒè“„ç©ã—ã¦ã„ã¾ã™ã€‚5åˆ†ä¼‘æ†©ã—ã¦é›†ä¸­åŠ›ã‚’å›å¾©ã—ã¾ã—ã‚‡ã†ã€‚",suggestedDuration:5};if(t>=25&&r>=50)return{shouldBreak:!0,reason:"25åˆ†çµŒéã—ã¾ã—ãŸã€‚çŸ­ã„ä¼‘æ†©ã§åŠ¹ç‡ãŒã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚",suggestedDuration:5};if(s&&r>=40)return{shouldBreak:!0,reason:"æ­£ç­”ç‡ãŒä¸‹ãŒã£ã¦ã„ã¾ã™ã€‚ä¸€åº¦ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã—ã¾ã—ã‚‡ã†ã€‚",suggestedDuration:3}}function ca(r,t){const{fatigueLevel:s,concentrationLevel:n,timeOfDay:a,sessionStats:i}=t;return f.log(`ğŸ§  èªçŸ¥è² è·AI: ç–²åŠ´åº¦${s}%, é›†ä¸­åŠ›${n}%, æ™‚é–“å¸¯: ${a}`),s>=70?(f.log("  ğŸ’¤ ç–²åŠ´åº¦é«˜: ç°¡å˜ãªå¾©ç¿’å•é¡Œã‚’å„ªå…ˆ"),r.filter(l=>l.estimatedSuccessRate>=70||l.strategy==="spaced_repetition").map(l=>({...l,priority:l.priority+(l.estimatedSuccessRate>=80?20:0),reason:l.reason+" (ç–²åŠ´æ™‚ãƒ»æ˜“å•å„ªå…ˆ)"}))):s>=40?(f.log("  ğŸ˜ ç–²åŠ´åº¦ä¸­: ãƒãƒ©ãƒ³ã‚¹é‡è¦–"),r.map(l=>l.estimatedSuccessRate<40?{...l,priority:l.priority-20}:l)):n>=70&&i.duration<15?(f.log("  âš¡ é›†ä¸­åŠ›é«˜: æ–°è¦å˜èªãƒ»é›£å•ã‚’å„ªå…ˆ"),r.map(l=>l.strategy==="new_learning"?{...l,priority:l.priority+30,reason:l.reason+" (é›†ä¸­æ™‚ãƒ»æ–°è¦å„ªå…ˆ)"}:l.strategy==="immediate_review"&&l.estimatedSuccessRate<60?{...l,priority:l.priority+20,reason:l.reason+" (é›†ä¸­æ™‚ãƒ»é›£å•æŒ‘æˆ¦)"}:l)):da(r,a)}function da(r,t){switch(t){case"morning":return f.log("  ğŸŒ… æœ: æ–°è¦å­¦ç¿’ã‚’å„ªå…ˆ"),r.map(s=>s.strategy==="new_learning"?{...s,priority:s.priority+15,reason:s.reason+" (æœãƒ»æ–°è¦æœ€é©)"}:s);case"afternoon":return f.log("  â˜€ï¸ åˆå¾Œ: ãƒãƒ©ãƒ³ã‚¹å‹"),r;case"evening":return f.log("  ğŸŒ† å¤•æ–¹: å¾©ç¿’ä¸­å¿ƒ"),r.map(s=>s.strategy==="spaced_repetition"||s.strategy==="consolidation"?{...s,priority:s.priority+10,reason:s.reason+" (å¤•æ–¹ãƒ»å¾©ç¿’æœ€é©)"}:s);case"night":return f.log("  ğŸŒ™ å¤œ: è»½ã„å¾©ç¿’ã®ã¿"),r.filter(s=>s.strategy!=="new_learning"||s.estimatedSuccessRate>=60).map(s=>s.estimatedSuccessRate>=70?{...s,priority:s.priority+15,reason:s.reason+" (å¤œãƒ»å¾©ç¿’æ¨å¥¨)"}:s);default:return r}}function ua(r){const{fatigueLevel:t,breakRecommendation:s}=r;return s!=null&&s.shouldBreak?`ğŸ’¡ ${s.reason}`:t>=60?"ğŸ˜Œ å°‘ã—ç–²ã‚Œã¦ããŸã‹ã‚‚ã€‚ç„¡ç†ã›ãšãƒã‚¤ãƒšãƒ¼ã‚¹ã§ï¼":t<=20?"âœ¨ é›†ä¸­åŠ›ãƒãƒƒãƒãƒªï¼ã“ã®èª¿å­ã§é ‘å¼µã‚ã†ï¼":""}function ma(r,t){const s=new Map,n=[],a=[];let i=0;const l=t.slice(-10),o=l.length>0?l.filter(h=>!h.wasCorrect).length/l.length*100:0;Object.entries(r).forEach(([h,p])=>{i+=p.incorrectCount,p.learningHistory&&p.learningHistory.filter(b=>!b.wasCorrect).forEach(b=>{if(b.userAnswer&&fa(h,b.userAnswer)&&s.set("similar_spelling",(s.get("similar_spelling")||0)+1),b.userAnswer){const x=n.find(v=>v.word1===h&&v.word2===b.userAnswer||v.word2===h&&v.word1===b.userAnswer);x?(x.confusionCount++,x.lastConfusion=b.timestamp):b.userAnswer!==h&&n.push({word1:h,word2:b.userAnswer,confusionCount:1,lastConfusion:b.timestamp,pattern:"confusion_pair"})}})});const c=t.slice(-5),d=c.length>0?c.filter(h=>!h.wasCorrect).length/c.length*100:0,m=d<o-10?"improving":d>o+10?"declining":"stable";return{totalErrors:i,errorsByPattern:s,confusionPairs:n.sort((h,p)=>p.confusionCount-h.confusionCount),weakCategories:a,recentErrorRate:o,errorTrend:m}}function ha(r,t,s,n,a){const i=[];let l=30;if(t){const p=t.correctCount+t.incorrectCount;if(p>0){const N=t.incorrectCount/p*100;N>50&&(l+=30,i.push({type:"category_weakness",weight:.3,description:"ã“ã®å˜èªã®éå»ã®èª¤ç­”ç‡ãŒé«˜ã„",evidence:[`èª¤ç­”ç‡: ${N.toFixed(0)}%`]}))}if(t.learningHistory&&t.learningHistory.length>0){const N=t.learningHistory.slice(-3),b=N.filter(x=>!x.wasCorrect).length/N.length*100;b>66&&(l+=25,i.push({type:"timing_based",weight:.25,description:"æœ€è¿‘3å›ã®ã†ã¡2å›ä»¥ä¸Šé–“é•ãˆã¦ã„ã‚‹",evidence:[`ç›´è¿‘3å›ã®èª¤ç­”ç‡: ${b.toFixed(0)}%`]}))}if(t.lastStudied){const N=(Date.now()-t.lastStudied)/864e5;if(N>7){const b=Math.min(20,N*2);l+=b,i.push({type:"timing_based",weight:b/100,description:"å‰å›ã®å¾©ç¿’ã‹ã‚‰æ™‚é–“ãŒçµŒéã—ã¦ã„ã‚‹",evidence:[`${N.toFixed(1)}æ—¥å‰ã«å¾©ç¿’`]})}}}else l+=20,i.push({type:"category_weakness",weight:.2,description:"ã¾ã å­¦ç¿’ã—ãŸã“ã¨ãŒãªã„å˜èª",evidence:["åˆè¦‹"]});const o=s.confusionPairs.find(p=>p.word1===r||p.word2===r);if(o&&o.confusionCount>=2){l+=15;const p=o.word1===r?o.word2:o.word1;i.push({type:"confusion_pair",weight:.15,description:`"${p}"ã¨æ··åŒã—ã‚„ã™ã„`,evidence:[`${o.confusionCount}å›æ··åŒ`]})}if(n>60){const p=(n-60)/2;l+=p,i.push({type:"timing_based",weight:p/100,description:"ç–²åŠ´ã«ã‚ˆã‚Šé›†ä¸­åŠ›ãŒä½ä¸‹ã—ã¦ã„ã‚‹",evidence:[`ç–²åŠ´åº¦: ${n.toFixed(0)}%`]})}s.errorTrend==="declining"&&(l+=10,i.push({type:"category_weakness",weight:.1,description:"å…¨ä½“çš„ã«èª¤ç­”ç‡ãŒä¸Šæ˜‡å‚¾å‘",evidence:[`æœ€è¿‘10å•ã®èª¤ç­”ç‡: ${s.recentErrorRate.toFixed(0)}%`]}));const c=Math.min(100,Math.max(0,l)),d=c>=80?"critical":c>=60?"high":c>=40?"medium":"low",m=ga(r,c,d,i,o),h=pa(t,i.length);return{word:r,errorRisk:c,confidence:h,primaryPattern:i.length>0?i[0].type:"category_weakness",riskFactors:i,warningLevel:d,suggestedSupport:m}}function ga(r,t,s,n,a){const i=[],l=[];let o="",c="";return s==="critical"?(o=`âš ï¸ æ³¨æ„: ã“ã®å•é¡Œã¯é–“é•ãˆã‚„ã™ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆãƒªã‚¹ã‚¯: ${t.toFixed(0)}%ï¼‰`,c="è½ã¡ç€ã„ã¦ã€ã—ã£ã‹ã‚Šè€ƒãˆã¦ã‹ã‚‰ç­”ãˆã¾ã—ã‚‡ã†ï¼"):s==="high"?(o=`ğŸ”” ã“ã®å•é¡Œã¯å°‘ã—é›£ã—ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼ˆãƒªã‚¹ã‚¯: ${t.toFixed(0)}%ï¼‰`,c="ã‚†ã£ãã‚Šè€ƒãˆã‚Œã°å¤§ä¸ˆå¤«ã§ã™ï¼"):s==="medium"&&(o=`ğŸ’¡ æ…é‡ã«ç­”ãˆã¦ãã ã•ã„ï¼ˆãƒªã‚¹ã‚¯: ${t.toFixed(0)}%ï¼‰`,c="è½ã¡ç€ã„ã¦å–ã‚Šçµ„ã¿ã¾ã—ã‚‡ã†ï¼"),n.forEach(d=>{switch(d.type){case"confusion_pair":if(a){const m=a.word1===r?a.word2:a.word1;i.push(`"${m}"ã¨æ··åŒã—ãªã„ã‚ˆã†ã«æ³¨æ„`),l.push(m)}break;case"similar_spelling":i.push("ç¶´ã‚Šã‚’ã‚ˆãç¢ºèªã—ã¾ã—ã‚‡ã†");break;case"timing_based":d.description.includes("æ™‚é–“ãŒçµŒé")?i.push("å‰å›ã®å¾©ç¿’ã‹ã‚‰æ™‚é–“ãŒçµŒã£ã¦ã„ã¾ã™ã€‚æ„å‘³ã‚’æ€ã„å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†"):d.description.includes("ç–²åŠ´")&&i.push("ç–²ã‚Œã¦ã„ã‚‹ã¨ãã¯ç„¦ã‚‰ãšã€ã‚†ã£ãã‚Šè€ƒãˆã¾ã—ã‚‡ã†");break;case"category_weakness":i.push("ã“ã®å˜èªã¯éå»ã«é–“é•ãˆã¦ã„ã¾ã™ã€‚æ…é‡ã«ï¼");break}}),{showWarning:s!=="low",warningMessage:o,hints:i.slice(0,2),reviewWords:l,confidenceBooster:c}}function pa(r,t){let s=50;if(r){const n=r.correctCount+r.incorrectCount;s+=Math.min(30,n*5),r.learningHistory&&r.learningHistory.length>=3&&(s+=10)}return s+=Math.min(10,t*3),Math.min(100,s)}function fa(r,t){const s=xa(r.toLowerCase(),t.toLowerCase());return s>0&&s<=2}function xa(r,t){const s=[];for(let n=0;n<=t.length;n++)s[n]=[n];for(let n=0;n<=r.length;n++)s[0][n]=n;for(let n=1;n<=t.length;n++)for(let a=1;a<=r.length;a++)t.charAt(n-1)===r.charAt(a-1)?s[n][a]=s[n-1][a-1]:s[n][a]=Math.min(s[n-1][a-1]+1,s[n][a-1]+1,s[n-1][a]+1);return s[t.length][r.length]}function ya(r,t,s,n,a){const i=new Map;return r.forEach(l=>{const o=ha(l,t[l],s,n);i.set(l,o)}),i}const Pr={emotions:{name:"æ„Ÿæƒ…",keywords:["happy","sad","angry","excited","worried","nervous","calm","joy","fear","love","hate","surprise"],relatedCategories:["å½¢å®¹è©"]},movement:{name:"å‹•ä½œãƒ»ç§»å‹•",keywords:["walk","run","jump","fly","swim","climb","move","go","come","enter","leave","return"],relatedCategories:["å‹•è©"]},time:{name:"æ™‚é–“",keywords:["day","night","morning","evening","week","month","year","today","tomorrow","yesterday","always","never","sometimes"],relatedCategories:["åè©","å‰¯è©"]},weather:{name:"å¤©æ°—",keywords:["sunny","rainy","cloudy","windy","snowy","hot","cold","warm","cool","weather","temperature"],relatedCategories:["å½¢å®¹è©","åè©"]},food:{name:"é£Ÿã¹ç‰©",keywords:["food","eat","drink","cook","meal","breakfast","lunch","dinner","hungry","thirsty","delicious"],relatedCategories:["åè©","å‹•è©","å½¢å®¹è©"]},nature:{name:"è‡ªç„¶",keywords:["tree","flower","mountain","river","sea","sky","sun","moon","star","nature","plant","animal"],relatedCategories:["åè©"]},family:{name:"å®¶æ—ãƒ»äººé–“é–¢ä¿‚",keywords:["family","father","mother","brother","sister","parent","child","friend","teacher","student"],relatedCategories:["åè©"]},size:{name:"å¤§ãã•ãƒ»ç¨‹åº¦",keywords:["big","small","large","tiny","huge","long","short","tall","high","low","wide","narrow"],relatedCategories:["å½¢å®¹è©"]},communication:{name:"ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",keywords:["say","speak","talk","tell","ask","answer","listen","hear","write","read","call","email"],relatedCategories:["å‹•è©"]},learning:{name:"å­¦ç¿’",keywords:["learn","study","teach","understand","know","remember","forget","practice","improve","test","exam"],relatedCategories:["å‹•è©","åè©"]}},Tr=[["big","small"],["large","small"],["long","short"],["tall","short"],["high","low"],["wide","narrow"],["deep","shallow"],["heavy","light"],["strong","weak"],["hard","soft"],["hot","cold"],["warm","cool"],["fast","slow"],["quick","slow"],["early","late"],["young","old"],["new","old"],["happy","sad"],["good","bad"],["right","wrong"],["easy","difficult"],["simple","complex"],["start","end"],["begin","finish"],["open","close"],["love","hate"],["day","night"],["morning","evening"],["always","never"],["often","rarely"],["many","few"],["much","little"],["more","less"],["increase","decrease"],["rise","fall"],["up","down"],["front","back"],["before","after"],["first","last"],["enter","leave"],["come","go"],["push","pull"],["give","take"],["buy","sell"],["win","lose"],["remember","forget"],["find","lose"]],$r=[["big","large","huge","enormous"],["small","little","tiny"],["happy","glad","joyful","pleased"],["sad","unhappy","sorrowful"],["angry","mad","furious"],["beautiful","pretty","lovely"],["ugly","unattractive"],["important","significant","essential"],["difficult","hard","tough","challenging"],["easy","simple"],["fast","quick","rapid","swift"],["slow","sluggish"],["smart","intelligent","clever","bright"],["stupid","foolish","dumb"],["funny","amusing","humorous"],["boring","dull","tedious"],["interesting","fascinating","engaging"],["tired","exhausted","weary"],["afraid","scared","frightened","terrified"],["brave","courageous","bold"],["kind","nice","gentle","friendly"],["mean","cruel","unkind"],["rich","wealthy","affluent"],["poor","needy"],["famous","well-known","renowned"],["strange","odd","weird","unusual"],["normal","ordinary","common","typical"]];function va(r,t){const s=[],n=new Set;Object.entries(Pr).forEach(([i,l])=>{const o=r.filter(c=>{const d=c.word.toLowerCase(),m=c.meaning.toLowerCase();return l.keywords.some(h=>d.includes(h)||m.includes(h))&&!n.has(c.word)}).map(c=>c.word);if(o.length>=2){o.forEach(m=>n.add(m));const d=50+o.filter(m=>{const h=t[m];return h&&h.incorrectCount>h.correctCount}).length/o.length*50;s.push({id:`theme_${i}`,name:l.name,theme:i,words:o,relationType:"theme",priority:d})}}),Tr.forEach((i,l)=>{const[o,c]=i,d=r.filter(m=>{const h=m.word.toLowerCase();return(h===o||h===c)&&!n.has(m.word)}).map(m=>m.word);d.length===2&&(d.forEach(m=>n.add(m)),s.push({id:`antonym_${l}`,name:`å¯¾ç¾©èª: ${o} â‡” ${c}`,theme:"antonyms",words:d,relationType:"antonym",priority:70}))}),$r.forEach((i,l)=>{const o=r.filter(c=>{const d=c.word.toLowerCase();return i.includes(d)&&!n.has(c.word)}).map(c=>c.word);o.length>=2&&(o.forEach(c=>n.add(c)),s.push({id:`synonym_${l}`,name:`é¡ç¾©èª: ${i.join(", ")}`,theme:"synonyms",words:o,relationType:"synonym",priority:60}))});const a=new Map;return r.forEach(i=>{if(!n.has(i.word)&&i.category){const l=a.get(i.category)||[];l.push(i.word),a.set(i.category,l)}}),a.forEach((i,l)=>{i.length>=3&&(i.forEach(o=>n.add(o)),s.push({id:`category_${l}`,name:`ã‚«ãƒ†ã‚´ãƒªãƒ¼: ${l}`,theme:l,words:i,relationType:"category",priority:40}))}),s.sort((i,l)=>l.priority-i.priority)}function wa(r,t){const s=r.toLowerCase(),n=t.toLowerCase();for(const a of Tr)if(a[0]===s&&a[1]===n||a[0]===n&&a[1]===s)return{word1:r,word2:t,relationType:"antonym",strength:.9,description:`"${r}"ã¨"${t}"ã¯å¯¾ç¾©èª`};for(const a of $r)if(a.includes(s)&&a.includes(n))return{word1:r,word2:t,relationType:"synonym",strength:.8,description:`"${r}"ã¨"${t}"ã¯é¡ç¾©èª`};for(const[,a]of Object.entries(Pr)){const i=a.keywords.some(o=>s.includes(o)||o.includes(s)),l=a.keywords.some(o=>n.includes(o)||o.includes(n));if(i&&l)return{word1:r,word2:t,relationType:"theme",strength:.6,description:`"${r}"ã¨"${t}"ã¯åŒã˜ãƒ†ãƒ¼ãƒï¼ˆ${a.name}ï¼‰`}}return null}function ba(r,t,s=[]){const n=va(r,t),a=[],i=[],l=new Set;return s.forEach(o=>l.add(o)),n.forEach(o=>{const c=o.words.filter(m=>!l.has(m));if(c.length===0)return;c.sort((m,h)=>{const p=t[m],N=t[h];if(!p&&!N)return 0;if(!p)return-1;if(!N)return 1;const b=p.incorrectCount/(p.correctCount+p.incorrectCount||1);return N.incorrectCount/(N.correctCount+N.incorrectCount||1)-b}).forEach(m=>{if(l.has(m))return;const h=a[a.length-1];if(h){const p=wa(h,m);i.push({from:h,to:m,reason:p?p.description:`åŒã˜ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ï¼ˆ${o.name}ï¼‰`})}a.push(m),l.add(m)})}),r.forEach(o=>{l.has(o.word)||(a.push(o.word),l.add(o.word))}),{clusters:n,sequence:a,transitions:i}}function Er(r=Date.now()){const t=new Date(r).getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function ja(r,t,s,n,a,i,l,o){const c=(t-r)/6e4,d=s>0?n/s*100:0;return{sessionId:`session_${r}`,startTime:r,endTime:t,duration:c,timeOfDay:Er(r),questionsAnswered:s,correctAnswers:n,accuracy:d,averageResponseTime:a,fatigueLevel:i,newWordsLearned:l,reviewedWords:o}}function Na(r){return["morning","afternoon","evening","night"].map(s=>{const n=r.filter(x=>x.timeOfDay===s);if(n.length===0)return{timeOfDay:s,sessionCount:0,totalQuestions:0,averageAccuracy:0,averageResponseTime:0,averageFatigue:0,efficiencyScore:0,bestForNewLearning:!1,bestForReview:!1};const a=n.reduce((x,v)=>x+v.questionsAnswered,0),l=n.reduce((x,v)=>x+v.correctAnswers,0)/a*100,o=n.reduce((x,v)=>x+v.averageResponseTime,0)/n.length,c=n.reduce((x,v)=>x+v.fatigueLevel,0)/n.length,d=n.reduce((x,v)=>x+v.newWordsLearned,0),m=n.reduce((x,v)=>x+v.reviewedWords,0),h=l,p=Math.max(0,100-o/50),N=100-c,b=h*.4+p*.3+N*.3;return{timeOfDay:s,sessionCount:n.length,totalQuestions:a,averageAccuracy:l,averageResponseTime:o,averageFatigue:c,efficiencyScore:b,bestForNewLearning:d>m,bestForReview:m>=d}}).sort((s,n)=>n.efficiencyScore-s.efficiencyScore)}function Sa(r){if(r.length===0)return{optimalDuration:15,currentAverageDuration:0,performanceByDuration:[],recommendation:"å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚ã¾ãšã¯15åˆ†ç¨‹åº¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚"};const t=r.reduce((o,c)=>o+c.duration,0)/r.length,n=[{min:0,max:5,label:"0-5åˆ†"},{min:5,max:10,label:"5-10åˆ†"},{min:10,max:15,label:"10-15åˆ†"},{min:15,max:20,label:"15-20åˆ†"},{min:20,max:30,label:"20-30åˆ†"},{min:30,max:999,label:"30åˆ†ä»¥ä¸Š"}].map(o=>{const c=r.filter(p=>p.duration>=o.min&&p.duration<o.max);if(c.length===0)return{durationRange:o.label,accuracy:0,efficiency:0};const d=c.reduce((p,N)=>p+N.accuracy,0)/c.length,m=c.reduce((p,N)=>p+N.fatigueLevel,0)/c.length,h=d-m*.5;return{durationRange:o.label,accuracy:d,efficiency:h}}).filter(o=>o.efficiency>0),a=n.reduce((o,c)=>c.efficiency>o.efficiency?c:o,n[0]||{durationRange:"10-15åˆ†",efficiency:0}),i=a?parseInt(a.durationRange.split("-")[0])+5:15;let l="";return i<10?l=`çŸ­æœŸé›†ä¸­å‹ã®å­¦ç¿’ãŒåŠ¹æœçš„ã§ã™ã€‚${i}åˆ†ç¨‹åº¦ã®çŸ­ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’1æ—¥è¤‡æ•°å›è¡Œã†ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚`:i<20?l=`${i}åˆ†ç¨‹åº¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæœ€ã‚‚åŠ¹ç‡çš„ã§ã™ã€‚ã“ã®é•·ã•ã‚’ç›®å®‰ã«å­¦ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚`:l=`é•·æ™‚é–“ã®å­¦ç¿’ãŒå¾—æ„ãªã‚ˆã†ã§ã™ã€‚${i}åˆ†ç¨‹åº¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§æ·±ã„å­¦ç¿’ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€ç–²åŠ´ã«æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚`,{optimalDuration:i,currentAverageDuration:t,performanceByDuration:n,recommendation:l}}function ka(r){if(r.length<5)return"moderate";const t=r.reduce((a,i)=>a+i.duration,0)/r.length,s=new Set(r.map(a=>new Date(a.startTime).toDateString())),n=r.length/s.size;return t<10&&n>=2?"distributed":t<10?"short_burst":t<20?"moderate":"extended"}function Ca(r,t){var p,N,b;const s=ka(t),n=Na(t),a=Sa(t),i=((p=n[0])==null?void 0:p.timeOfDay)||"morning",l=a.optimalDuration;let o=1;s==="distributed"||s==="short_burst"?o=3:s==="moderate"&&(o=2);const c=[],d=[];((N=n[0])==null?void 0:N.averageAccuracy)>80&&c.push(`${n[0].timeOfDay}ã®å­¦ç¿’ãŒå¾—æ„ï¼ˆæ­£ç­”ç‡${n[0].averageAccuracy.toFixed(0)}%ï¼‰`),s==="distributed"?c.push("åˆ†æ•£å­¦ç¿’ã«ã‚ˆã‚Šè¨˜æ†¶ã®å®šç€ãŒè‰¯å¥½"):s==="extended"&&c.push("é•·æ™‚é–“ã®é›†ä¸­å­¦ç¿’ãŒå¯èƒ½"),t.reduce((x,v)=>x+v.fatigueLevel,0)/t.length>60&&d.push("ç–²åŠ´ãƒ¬ãƒ™ãƒ«ãŒé«˜ã‚ã€‚ä¼‘æ†©ã‚’å¢—ã‚„ã™ã‹ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“ã‚’çŸ­ç¸®ã—ã¦ã¿ã¾ã—ã‚‡ã†"),((b=n[n.length-1])==null?void 0:b.averageAccuracy)<60&&d.push(`${n[n.length-1].timeOfDay}ã®å­¦ç¿’åŠ¹ç‡ãŒä½ã„ãŸã‚ã€é¿ã‘ã‚‹ã“ã¨ã‚’æ¨å¥¨`);const h=[];return h.push(`æœ€é©ãªå­¦ç¿’æ™‚é–“å¸¯: ${i==="morning"?"æœ":i==="afternoon"?"åˆå¾Œ":i==="evening"?"å¤•æ–¹":"å¤œ"}`),h.push(`æ¨å¥¨ã‚»ãƒƒã‚·ãƒ§ãƒ³é•·: ${l}åˆ†`),h.push(`1æ—¥ã®æ¨å¥¨å­¦ç¿’å›æ•°: ${o}å›`),s==="distributed"?h.push("çŸ­ã„å­¦ç¿’ã‚’è¤‡æ•°å›è¡Œã†ã‚¹ã‚¿ã‚¤ãƒ«ãŒåŠ¹æœçš„ã§ã™ã€‚æœãƒ»æ˜¼ãƒ»å¤œã«åˆ†ã‘ã¦å­¦ç¿’ã—ã¾ã—ã‚‡ã†"):s==="extended"&&h.push("é•·æ™‚é–“ã®å­¦ç¿’ãŒå¾—æ„ã§ã™ã€‚é€±æœ«ãªã©ã«ã¾ã¨ã‚ã¦å­¦ç¿’ã™ã‚‹æ–¹æ³•ã‚‚æœ‰åŠ¹ã§ã™"),{userId:r,primaryStyle:s,bestTimeOfDay:i,optimalSessionLength:l,optimalDailyFrequency:o,strengths:c,improvements:d,personalizedRecommendations:h}}function Da(r){try{const t="learning-style-sessions",s=localStorage.getItem(t),n=s?JSON.parse(s):[];n.push(r);const a=n.slice(-100);localStorage.setItem(t,JSON.stringify(a))}catch(t){f.error("Failed to save session history:",t)}}function Ma(){try{const t=localStorage.getItem("learning-style-sessions");return t?JSON.parse(t):[]}catch(r){return f.error("Failed to load session history:",r),[]}}function Ia(r,t){const s=t===r.bestTimeOfDay,n={morning:"æœ",afternoon:"åˆå¾Œ",evening:"å¤•æ–¹",night:"å¤œ"};return s?`âœ¨ ä»Šã¯${n[t]}ã§ã™ã€‚ã‚ãªãŸã®æœ€ã‚‚å­¦ç¿’åŠ¹ç‡ãŒé«˜ã„æ™‚é–“å¸¯ã§ã™ï¼${r.optimalSessionLength}åˆ†ç¨‹åº¦ã®å­¦ç¿’ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚`:`ğŸ’¡ ${n[r.bestTimeOfDay]}ã®å­¦ç¿’ãŒæœ€ã‚‚åŠ¹æœçš„ã§ã™ã€‚ç¾åœ¨ã¯${n[t]}ãªã®ã§ã€è»½ã‚ã®å¾©ç¿’ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚`}const Aa={first_session:{type:"first_session",name:"å­¦ç¿’é–‹å§‹",description:"åˆã‚ã¦ã®å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å®Œäº†",icon:"ğŸ“",rarity:"common"},streak_3_days:{type:"streak_3_days",name:"ä¸‰æ—¥åŠä¸»å…‹æœ",description:"3æ—¥é€£ç¶šã§å­¦ç¿’",icon:"ğŸ”¥",rarity:"common"},streak_7_days:{type:"streak_7_days",name:"ä¸€é€±é–“ã®ç¿’æ…£",description:"7æ—¥é€£ç¶šã§å­¦ç¿’",icon:"â­",rarity:"rare"},streak_30_days:{type:"streak_30_days",name:"ç¿’æ…£ã®é”äºº",description:"30æ—¥é€£ç¶šã§å­¦ç¿’",icon:"ğŸ†",rarity:"epic"},total_100_words:{type:"total_100_words",name:"ç™¾å˜èª",description:"ç´¯è¨ˆ100å˜èªã‚’å­¦ç¿’",icon:"ğŸ“š",rarity:"common"},total_500_words:{type:"total_500_words",name:"äº”ç™¾å˜èª",description:"ç´¯è¨ˆ500å˜èªã‚’å­¦ç¿’",icon:"ğŸ“–",rarity:"rare"},total_1000_words:{type:"total_1000_words",name:"åƒå˜èªãƒã‚¹ã‚¿ãƒ¼",description:"ç´¯è¨ˆ1000å˜èªã‚’å­¦ç¿’",icon:"ğŸ–ï¸",rarity:"epic"},perfect_session:{type:"perfect_session",name:"ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆ",description:"1ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨å•æ­£è§£",icon:"ğŸ’¯",rarity:"rare"},accuracy_90:{type:"accuracy_90",name:"é«˜ç²¾åº¦",description:"æ­£ç­”ç‡90%ä»¥ä¸Šã‚’10å›é”æˆ",icon:"ğŸ¯",rarity:"rare"},accuracy_95:{type:"accuracy_95",name:"è¶…é«˜ç²¾åº¦",description:"æ­£ç­”ç‡95%ä»¥ä¸Šã‚’10å›é”æˆ",icon:"ğŸ’",rarity:"epic"},early_bird:{type:"early_bird",name:"æ—©èµ·ãé³¥",description:"æœï¼ˆ6-9æ™‚ï¼‰ã«5å›å­¦ç¿’",icon:"ğŸŒ…",rarity:"common"},night_owl:{type:"night_owl",name:"å¤œå‹å­¦ç¿’",description:"å¤œï¼ˆ21-24æ™‚ï¼‰ã«5å›å­¦ç¿’",icon:"ğŸŒ™",rarity:"common"},speed_master:{type:"speed_master",name:"ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒã‚¹ã‚¿ãƒ¼",description:"å¹³å‡å¿œç­”æ™‚é–“2ç§’ä»¥ä¸‹ã‚’10å›é”æˆ",icon:"âš¡",rarity:"rare"},review_champion:{type:"review_champion",name:"å¾©ç¿’ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³",description:"è¦å¾©ç¿’å˜èª50å€‹ã‚’ãƒã‚¹ã‚¿ãƒ¼",icon:"â™»ï¸",rarity:"rare"},master_100:{type:"master_100",name:"ç™¾å˜èªãƒã‚¹ã‚¿ãƒ¼",description:"100å˜èªã‚’å®Œå…¨ç¿’å¾—",icon:"ğŸ‘‘",rarity:"epic"},comeback:{type:"comeback",name:"ã‚«ãƒ ãƒãƒƒã‚¯",description:"1é€±é–“ä»¥ä¸Šã®ä¸­æ–­å¾Œã«å†é–‹",icon:"ğŸ’ª",rarity:"common"},marathon:{type:"marathon",name:"ãƒãƒ©ã‚½ãƒ³ãƒ©ãƒ³ãƒŠãƒ¼",description:"1æ™‚é–“ä»¥ä¸Šã®å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³",icon:"ğŸƒ",rarity:"rare"},focused:{type:"focused",name:"é›†ä¸­åŠ›ã®æ¥µã¿",description:"é›†ä¸­åŠ›ã®é«˜ã„å­¦ç¿’ã‚’10å›",icon:"ğŸ§˜",rarity:"rare"}},_r=r=>Math.floor(100*Math.pow(1.15,r-1)),St={CORRECT_ANSWER:10,PERFECT_SESSION:100,STREAK_BONUS_PER_DAY:5,SESSION_COMPLETION:50,BADGE_EARNED:200},Lr=()=>{const r=localStorage.getItem("gamificationStats");if(r){const t=JSON.parse(r);return t.lastSessionDate&&(t.lastSessionDate=new Date(t.lastSessionDate)),t.badges=t.badges.map(s=>({...s,earnedAt:s.earnedAt?new Date(s.earnedAt):void 0})),t.milestones=t.milestones.map(s=>({...s,completedAt:s.completedAt?new Date(s.completedAt):void 0})),t.challenges=t.challenges.map(s=>({...s,startDate:new Date(s.startDate),endDate:new Date(s.endDate)})),t}return{level:{level:1,currentXP:0,requiredXP:_r(1),totalXP:0},badges:[],streak:{current:0,longest:0,lastStudyDate:""},milestones:Pa(),challenges:[],totalSessions:0,totalWordsLearned:0,totalCorrectAnswers:0,averageAccuracy:0}},Ra=r=>{localStorage.setItem("gamificationStats",JSON.stringify(r))},Pa=()=>[{id:"first_10_words",title:"æœ€åˆã®10å˜èª",description:"10å˜èªã‚’å­¦ç¿’ã™ã‚‹",target:10,current:0,reward:{xp:100},completed:!1},{id:"first_50_words",title:"50å˜èªé”æˆ",description:"50å˜èªã‚’å­¦ç¿’ã™ã‚‹",target:50,current:0,reward:{xp:300,badge:"total_100_words"},completed:!1},{id:"accuracy_80",title:"æ­£ç­”ç‡80%",description:"æ­£ç­”ç‡80%ä»¥ä¸Šã‚’é”æˆ",target:80,current:0,reward:{xp:200},completed:!1}],Ta=(r,t)=>{const s={...r};s.level.currentXP+=t,s.level.totalXP+=t;let n=!1,a;for(;s.level.currentXP>=s.level.requiredXP;)s.level.currentXP-=s.level.requiredXP,s.level.level+=1,s.level.requiredXP=_r(s.level.level),n=!0,a=s.level.level;return{stats:s,leveledUp:n,newLevel:a}},$a=r=>{const t=new Date().toISOString().split("T")[0],s=r.streak.lastStudyDate;if(!s)return{...r,streak:{current:1,longest:1,lastStudyDate:t}};if(s===t)return r;const n=new Date;n.setDate(n.getDate()-1);const a=n.toISOString().split("T")[0];if(s===a){const i=r.streak.current+1;return{...r,streak:{current:i,longest:Math.max(i,r.streak.longest),lastStudyDate:t}}}else return{...r,streak:{current:1,longest:r.streak.longest,lastStudyDate:t}}},Ea=(r,t)=>{const s=[],n=new Set(r.badges.map(o=>o.type)),a=o=>{if(!n.has(o)){const c={...Aa[o],earnedAt:new Date};s.push(c),n.add(o)}};r.totalSessions===1&&!n.has("first_session")&&a("first_session"),r.streak.current>=3&&a("streak_3_days"),r.streak.current>=7&&a("streak_7_days"),r.streak.current>=30&&a("streak_30_days"),r.totalWordsLearned>=100&&a("total_100_words"),r.totalWordsLearned>=500&&a("total_500_words"),r.totalWordsLearned>=1e3&&a("total_1000_words"),t.perfectScore&&a("perfect_session");const i=r.totalSessions;return t.accuracy>=90&&i>=10&&a("accuracy_90"),t.accuracy>=95&&i>=10&&a("accuracy_95"),t.timeOfDay==="morning"&&r.totalSessions>=5&&a("early_bird"),t.timeOfDay==="night"&&r.totalSessions>=5&&a("night_owl"),t.avgResponseTime<=2e3&&r.totalSessions>=10&&a("speed_master"),t.sessionDuration>=60&&a("marathon"),t.focused&&r.totalSessions>=10&&a("focused"),r.lastSessionDate&&(new Date().getTime()-r.lastSessionDate.getTime())/864e5>=7&&a("comeback"),{stats:{...r,badges:[...r.badges,...s]},newBadges:s}},_a=r=>{const t=[],s=r.milestones.map(n=>{if(n.completed)return n;let a=n.current;if(n.id.includes("words")?a=r.totalWordsLearned:n.id.includes("accuracy")&&(a=r.averageAccuracy),a>=n.target&&!n.completed){const l={...n,current:a,completed:!0,completedAt:new Date};return t.push(l),l}return{...n,current:a}});return{stats:{...r,milestones:s},completedMilestones:t}},La=(r,t,s,n,a,i)=>{let l=Lr();const o=[];let c=0;l.totalSessions+=1,l.totalWordsLearned+=a,l.totalCorrectAnswers+=r,l.averageAccuracy=(l.averageAccuracy*(l.totalSessions-1)+r/t*100)/l.totalSessions,l.lastSessionDate=new Date;const d=l.streak.current;l=$a(l),l.streak.current>d&&(o.push({type:"streak",message:`ğŸ”¥ ${l.streak.current}æ—¥é€£ç¶šå­¦ç¿’ï¼`,icon:"ğŸ”¥",priority:4}),c+=St.STREAK_BONUS_PER_DAY*l.streak.current);const m=r/t*100,h=r===t;c+=r*St.CORRECT_ANSWER,c+=St.SESSION_COMPLETION,h&&(c+=St.PERFECT_SESSION,o.push({type:"praise",message:"ğŸ’¯ ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆï¼å…¨å•æ­£è§£ã§ã™ï¼",icon:"ğŸ’¯",priority:5}));const p=new Date().getHours();let N;p>=6&&p<12?N="morning":p>=12&&p<18?N="afternoon":p>=18&&p<21?N="evening":N="night";const b=i<.3,x=Ea(l,{accuracy:m,avgResponseTime:s,perfectScore:h,timeOfDay:N,sessionDuration:n,focused:b});l=x.stats,x.newBadges.length>0&&x.newBadges.forEach(M=>{o.push({type:"milestone",message:`ğŸ–ï¸ ãƒãƒƒã‚¸ç²å¾—: ${M.name}`,icon:M.icon,priority:5}),c+=St.BADGE_EARNED});const v=_a(l);l=v.stats,v.completedMilestones.length>0&&v.completedMilestones.forEach(M=>{o.push({type:"milestone",message:`ğŸ¯ ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³é”æˆ: ${M.title}`,icon:"ğŸ¯",priority:4}),c+=M.reward.xp});const k=Ta(l,c);return l=k.stats,k.leveledUp&&k.newLevel&&o.push({type:"level_up",message:`â­ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼ Lv.${k.newLevel}`,icon:"â­",priority:5}),m<50?o.push({type:"encouragement",message:"ğŸ’ª ç„¦ã‚‰ãšå¾©ç¿’ã—ã¾ã—ã‚‡ã†ï¼ç¶™ç¶šãŒå¤§åˆ‡ã§ã™",icon:"ğŸ’ª",priority:2}):m>=50&&m<80?o.push({type:"encouragement",message:"ğŸ‘ è‰¯ã„ãƒšãƒ¼ã‚¹ã§ã™ï¼ã“ã®èª¿å­ã§ï¼",icon:"ğŸ‘",priority:2}):m>=80&&m<95&&o.push({type:"praise",message:"ğŸŒŸ ç´ æ™´ã‚‰ã—ã„ï¼é«˜ã„æ­£ç­”ç‡ã§ã™",icon:"ğŸŒŸ",priority:3}),Ra(l),{stats:l,feedback:o.sort((M,S)=>S.priority-M.priority),xpGained:c,leveledUp:k.leveledUp,newLevel:k.newLevel}},Wa=()=>{const r=Lr(),t=[];return r.streak.current>0&&t.push(`ğŸ”¥ ${r.streak.current}æ—¥é€£ç¶šå­¦ç¿’ä¸­ï¼`),r.level.level>1&&t.push(`â­ ãƒ¬ãƒ™ãƒ« ${r.level.level}`),r.level.currentXP/r.level.requiredXP*100>80&&t.push("æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¾ã§ã‚ã¨å°‘ã—ï¼"),t.length===0&&t.push("ä»Šæ—¥ã‚‚å­¦ç¿’ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼"),t.join(" | ")},Lt=Object.freeze(Object.defineProperty({__proto__:null,addQuizResult:Mt,addSessionHistory:bt,checkFlexibleMastery:es,createWeakWordsQuestionSet:Ut,filterSkippedWords:ks,getAllWordProgress:ft,getConfusedWords:Ds,getCumulativeProgressData:Rs,getCurrentWeakWords:Zt,getCustomQuestionSets:rs,getDetailedRetentionStats:qt,getGrammarDetailedRetentionStats:zt,getGrammarRetentionRateWithAI:Ht,getGrammarUnitStats:bs,getGrammarUnitStatsWithTitles:Ws,getMemorizationCardSettings:$s,getMemorizationDetailedRetentionStats:Dt,getMemorizationSettings:_s,getMonthlyStats:vs,getNearMasteryStats:gr,getOvercomeWeakWords:Ns,getRecentlyMasteredWords:ws,getRetentionRateWithAI:Qt,getRetentionTrend:Ps,getStudyCalendarData:As,getStudySettings:xs,getTodayIncorrectWords:Wt,getTodayStats:Ot,getTotalAnsweredCount:Ms,getTotalMasteredWordsCount:ss,getUniqueQuestionedWordsCount:xr,getWeeklyStats:ys,getWordDetailedData:Gt,getWordProgress:Ft,isWordSkipExcluded:Ss,loadProgress:rt,loadProgressSync:Re,recordConfusion:Cs,recordMemorizationBehavior:Ls,recordWordSkip:ts,resetAllProgress:Is,saveCustomQuestionSet:Bt,saveMemorizationCardSettings:Ts,saveMemorizationSettings:Es,saveProgress:lt,updateProgressCache:ot,updateWordProgress:pt},Symbol.toStringTag,{value:"Module"}));function dt(r){return r[Math.floor(Math.random()*r.length)]}function Oa(){const r=localStorage.getItem("progress-data");if(!r)return{totalSessions:0,averageAccuracy:0,strongCategories:[],weakCategories:[],recentImprovement:!1,consistencyScore:0};try{const s=JSON.parse(r).results||[],n=s.slice(-10),a=n.length>0?n.reduce((x,v)=>x+v.score/v.total*100,0)/n.length:0,i=new Map;s.forEach(x=>{if(x.category){const v=i.get(x.category)||{correct:0,total:0};v.correct+=x.score,v.total+=x.total,i.set(x.category,v)}});const l=[],o=[];i.forEach((x,v)=>{const k=x.total>0?x.correct/x.total*100:0;k>=80&&l.push(v),k<60&&o.push(v)});const c=n.slice(0,5),d=n.slice(-5),m=c.length>0?c.reduce((x,v)=>x+v.score/v.total*100,0)/c.length:0,p=(d.length>0?d.reduce((x,v)=>x+v.score/v.total*100,0)/d.length:0)>m+5,N=new Set(s.map(x=>new Date(x.date).toDateString())),b=Math.min(100,N.size*5);return{totalSessions:s.length,averageAccuracy:a,strongCategories:l,weakCategories:o,recentImprovement:p,consistencyScore:b}}catch{return{totalSessions:0,averageAccuracy:0,strongCategories:[],weakCategories:[],recentImprovement:!1,consistencyScore:0}}}function zs(){const r=new Date().getHours();return r>=5&&r<12?"morning":r>=12&&r<17?"afternoon":r>=17&&r<21?"evening":"night"}class qa{generateCorrectComment(t){const s=[],n=Oa();return t.attemptCount===1?(t.responseTime<3e3&&s.push(dt(["é€Ÿã„ï¼","åå¿œãŒé‹­ã„ãï¼","å³ç­”ã ãªï¼"])),s.push(dt(["ã‚ˆã—ï¼","ã„ã„ãï¼","æ­£è§£ã ï¼"]))):t.attemptCount===2?s.push(dt(["2å›ç›®ã§æ­£è§£ã‹ã€‚","ã‚„ã£ã¨æ­£è§£ã—ãŸãªã€‚"])):(s.push(`${t.attemptCount}å›ç›®ã§æ­£è§£ã‹ã€‚`),s.push("ã‚‚ã£ã¨æ—©ãæ±ºã‚ã‚ï¼")),t.difficulty==="advanced"&&t.attemptCount===1?s.push(dt(["ä¸Šç´šå˜èªã‚’ä¸€ç™ºã§æ±ºã‚ãŸï¼","é›£ã—ã„å˜èªã‚‚ã‚¯ãƒªã‚¢ã ãªï¼"])):t.difficulty==="beginner"&&t.attemptCount>1&&s.push("åˆç´šã§ã‚‚ãŸã¤ããªï¼"),t.correctStreak>=10?(s.push(`é©šç•°ã®${t.correctStreak}é€£ç¶šæ­£è§£ï¼`),s.push(dt(["å®Œå…¨ã«æ³¢ã«ä¹—ã£ã¦ã‚‹ãªï¼","ã“ã®ã¾ã¾çªã£èµ°ã‚Œï¼"]))):t.correctStreak>=5?(s.push(`${t.correctStreak}é€£ç¶šæ­£è§£ï¼`),s.push(dt(["èª¿å­ãŒå‡ºã¦ããŸãªï¼","ã„ã„æµã‚Œã ï¼"]))):t.correctStreak>=3&&s.push("3é€£ç¶šã ã€‚"),n.recentImprovement&&n.totalSessions>=10&&s.push(dt(["æœ€è¿‘ã®æˆé•·ãŒè‘—ã—ã„ãï¼","å‰ã‚ˆã‚Šç¢ºå®Ÿã«å¼·ããªã£ã¦ã‚‹ï¼"])),t.isWeakCategory&&t.isCorrect&&(s.push(`è‹¦æ‰‹ãª${t.category}ã§æ­£è§£ï¼`),s.push(dt(["æˆé•·ã‚’æ„Ÿã˜ã‚‹ãï¼","å¼±ç‚¹ã‚’æ½°ã—ãŸãªï¼"]))),t.todayQuestions>=50&&t.todayAccuracy>=80&&s.push("ä»Šæ—¥ã¯çµ¶å¥½èª¿ã ãªï¼"),t.timeOfDay==="night"&&t.todayQuestions>=30&&s.push("å¤œé…ãã¾ã§ã‚ˆãé ‘å¼µã£ã¦ã‚‹ï¼"),t.hasSeenBefore&&t.previousAttempts>2&&(s.push(`å‰ã¯${t.previousAttempts}å›ã‚‚ã‹ã‹ã£ãŸå˜èªã ãï¼`),s.push("ã‚ˆã†ã‚„ãè¦šãˆãŸãªï¼")),t.learningPhase==="ENCODING"?s.push("æ–°è¦è¨˜æ†¶ã‚’è„³ã«åˆ»ã¿è¾¼ã‚“ã§ã‚‹ãï¼"):t.learningPhase==="INITIAL_CONSOLIDATION"?s.push("è¨˜æ†¶ãŒå®šç€ã—ã¦ãã¦ã‚‹ãªï¼"):t.learningPhase==="LONG_TERM_RETENTION"?s.push("é•·æœŸè¨˜æ†¶ã«ç§»è¡Œä¸­ã ï¼"):t.learningPhase==="MASTERED"&&s.push("å®Œå…¨ã«ãƒã‚¹ã‚¿ãƒ¼ã—ãŸãªï¼"),s.push("ã“ã®èª¿å­ã ï¼ğŸ’ª"),s.join(" ")}generateIncorrectComment(t){const s=[];return t.attemptCount===1?s.push("é•ã†ï¼"):s.push("ã¾ãŸé–“é•ãˆãŸï¼"),t.difficulty==="beginner"&&(s.push("åˆç´šã§é–“é•ãˆã‚‹ã¨ã¯â€¦"),s.push("åŸºç¤ã‹ã‚‰ã‚„ã‚Šç›´ã›ï¼")),t.incorrectStreak>=3&&(s.push(`${t.incorrectStreak}é€£ç¶šãƒŸã‚¹ï¼`),s.push("ãŸã‚‹ã‚“ã§ã‚‹ãï¼")),t.hasSeenBefore&&(s.push(`å‰ã«ã‚‚é–“é•ãˆãŸ${t.word}ã ãï¼`),s.push("ä½•åº¦ã‚„ã‚‰ã›ã‚‹æ°—ã ï¼")),t.todayAccuracy<60&&(s.push("ä»Šæ—¥ã®æ­£ç­”ç‡ãŒä½ã„ï¼"),s.push("é›†ä¸­ã—ã‚ï¼")),t.timeOfDay==="night"&&t.todayQuestions>=40?(s.push("ç–²ã‚Œã¦ã‚‹ãªã‚‰ä¼‘ã‚ï¼"),s.push("ã ãŒæ˜æ—¥ã¯å€ã‚„ã‚‹ã‚“ã ãï¼")):s.push("æ°—åˆã‚’å…¥ã‚Œã‚ï¼ğŸ”¥"),s.join(" ")}}class za{generateCorrectComment(t){const s=[];return s.push("æ­£è§£ã§ã™ï¼"),t.attemptCount===1?t.responseTime<3e3?s.push("ç´ æ—©ã„åˆ¤æ–­ã§ã—ãŸã­ âœ¨"):s.push("ã—ã£ã‹ã‚Šè€ƒãˆã‚‰ã‚Œã¾ã—ãŸã­"):t.attemptCount===2?(s.push("2å›ç›®ã§æ­£è§£ã§ãã¾ã—ãŸ"),s.push("è½ã¡ç€ã„ã¦è€ƒãˆã‚‰ã‚Œã¾ã—ãŸã­")):t.attemptCount>=3&&(s.push(`${t.attemptCount}å›ç›®ã§æ­£è§£ã§ãã¾ã—ãŸ`),s.push("ç²˜ã‚Šå¼·ãå–ã‚Šçµ„ã‚ã¾ã—ãŸã­")),t.difficulty==="advanced"&&(s.push(`${t.word}ã¯é›£ã—ã„å˜èªã§ã—ãŸãŒã€`),s.push("è¦‹äº‹ã«æ­£è§£ã—ã¾ã—ãŸï¼")),t.correctStreak>=5?(s.push(`${t.correctStreak}å•é€£ç¶šæ­£è§£ã§ã™ï¼`),s.push("ç´ æ™´ã‚‰ã—ã„é›†ä¸­åŠ›ã§ã™ã­ ğŸŒ¸")):t.correctStreak>=3&&s.push("èª¿å­ãŒå‡ºã¦ãã¾ã—ãŸã­"),t.isWeakCategory&&(s.push(`è‹¦æ‰‹ãª${t.category}ã§æ­£è§£ï¼`),s.push("å°‘ã—ãšã¤å¾—æ„ã«ãªã£ã¦ãã¦ã„ã¾ã™ã‚ˆ ğŸ˜Š")),t.hasSeenBefore&&t.previousAttempts>2&&(s.push("å‰å›ã‚ˆã‚Šæ—©ãæ­£è§£ã§ãã¾ã—ãŸã­"),s.push("ç¢ºå®Ÿã«æˆé•·ã—ã¦ã„ã¾ã™")),t.todayQuestions>=50&&(s.push(`ä»Šæ—¥ã¯ã‚‚ã†${t.todayQuestions}å•ã‚‚é ‘å¼µã£ã¦ã„ã¾ã™ã­`),s.push("ç„¡ç†ã—ã™ããªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã­")),t.learningPhase==="ENCODING"?s.push("è¨˜æ†¶ã®ç¬¦å·åŒ–ãŒé€²ã‚“ã§ã„ã¾ã™ ğŸ“"):t.learningPhase==="INITIAL_CONSOLIDATION"?s.push("è¨˜æ†¶ãŒå®šç€ã—ã¦ãã¦ã„ã¾ã™ã­ âœ¨"):t.learningPhase==="LONG_TERM_RETENTION"?s.push("é•·æœŸè¨˜æ†¶ã«ç§»è¡Œã§ãã¦ã„ã¾ã™ ğŸŒŸ"):t.learningPhase==="MASTERED"&&s.push("å®Œå…¨ã«ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ãŸã­ ğŸ‰"),s.join(" ")}generateIncorrectComment(t){const s=[];return t.attemptCount===1?s.push("æƒœã—ã„ã§ã™"):s.push("é›£ã—ã‹ã£ãŸã§ã™ã­"),s.push("ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™"),t.difficulty==="advanced"?(s.push(`${t.word}ã¯ä¸Šç´šå˜èªãªã®ã§`),s.push("ä½•åº¦ã‹å¾©ç¿’ã—ã¾ã—ã‚‡ã†")):t.difficulty==="beginner"&&(s.push("åŸºç¤çš„ãªå˜èªãªã®ã§"),s.push("ã‚†ã£ãã‚Šè¦šãˆç›´ã—ã¾ã—ã‚‡ã†")),t.incorrectStreak>=3&&(s.push("å°‘ã—ç–²ã‚Œã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ"),s.push("æ·±å‘¼å¸ã—ã¦ã¿ã¾ã—ã‚‡ã† ğŸŒ±")),t.hasSeenBefore&&(s.push(`${t.word}ã¯è¦æ³¨æ„ã®å˜èªã§ã™ã­`),s.push("ä¸€ç·’ã«è¦šãˆç›´ã—ã¾ã—ã‚‡ã†")),t.timeOfDay==="night"&&(s.push("å¤œã¯é›†ä¸­ã—ã¥ã‚‰ã„ã“ã¨ã‚‚ã‚ã‚Šã¾ã™"),s.push("ç„¡ç†ã›ãšä¼‘æ†©ã‚‚å¤§åˆ‡ã§ã™ã‚ˆ")),s.push("æ¬¡ã¯æ­£è§£ã§ãã¾ã™ã‚ˆ ğŸ˜Š"),s.join(" ")}}class Fa{generateCorrectComment(t){const s=[];if(s.push("æ­£è§£ã€‚"),s.push(`å¿œç­”æ™‚é–“: ${(t.responseTime/1e3).toFixed(1)}ç§’`),t.attemptCount>1&&s.push(`è©¦è¡Œå›æ•°: ${t.attemptCount}`),t.correctStreak>0){s.push(`é€£ç¶šæ­£è§£: ${t.correctStreak}`);const n=Math.min(100,t.userAccuracy+2);s.push(`æ­£ç­”ç‡: ${t.userAccuracy.toFixed(0)}% â†’ ${n.toFixed(0)}%`)}if(t.difficulty==="advanced"&&(s.push("é›£æ˜“åº¦: ä¸Šç´š"),s.push("æœŸå¾…æ­£ç­”ç‡ã‚’ä¸Šå›ã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹")),t.isWeakCategory){s.push(`è‹¦æ‰‹ã‚«ãƒ†ã‚´ãƒªãƒ¼(${t.category})ã§æ­£è§£`);const n=Math.min(100,t.categoryAccuracy+3);s.push(`ã‚«ãƒ†ã‚´ãƒªãƒ¼æ­£ç­”ç‡: ${t.categoryAccuracy.toFixed(0)}% â†’ ${n.toFixed(0)}%`)}return s.push("ğŸ“Š"),s.join(" ")}generateIncorrectComment(t){const s=[];if(s.push("ä¸æ­£è§£ã€‚"),s.push(`è©¦è¡Œå›æ•°: ${t.attemptCount}`),t.incorrectStreak>0){s.push(`é€£ç¶šä¸æ­£è§£: ${t.incorrectStreak}`);const n=Math.max(0,t.userAccuracy-2);s.push(`æ­£ç­”ç‡å½±éŸ¿: ${t.userAccuracy.toFixed(0)}% â†’ ${n.toFixed(0)}%`)}return t.difficulty==="beginner"&&(s.push("åŸºç¤ãƒ¬ãƒ™ãƒ«ä¸æ­£è§£æ¤œå‡º"),s.push("å„ªå…ˆå¾©ç¿’å¯¾è±¡ã«è¿½åŠ ")),t.hasSeenBefore&&(s.push(`æ—¢å‡ºå˜èª: ${t.previousAttempts+1}å›ç›®ã®ä¸æ­£è§£`),s.push("ç¿’å¾—é›£æ˜“åº¦ã‚¹ã‚³ã‚¢: é«˜")),s.push("æ¬¡å›å‡ºé¡Œç¢ºç‡: 80%"),s.join(" ")}}class Qa{generateCorrectComment(t){const s=[],n=["ãƒŠã‚¤ã‚¹ï¼","ã‚ˆã—ï¼","ã„ã„ãï¼","ã‚„ã£ãŸï¼"];return s.push(n[Math.floor(Math.random()*n.length)]),t.attemptCount===1?s.push("ä¸€ç™ºã§æ±ºã‚ãŸï¼"):t.attemptCount===2?s.push("ç«‹ã¦ç›´ã—ãŸãªï¼"):(s.push(`${t.attemptCount}å›ç›®ã§æ±ºã‚ãŸï¼`),s.push("ã‚‚ã£ã¨æ—©ãè¡Œã“ã†ï¼")),t.correctStreak>=5?(s.push(`${t.correctStreak}é€£ç¶šï¼`),s.push("ãŠå‰ã¯ç„¡æ•µã ï¼ğŸ”¥")):t.correctStreak>=3&&s.push("æ³¢ã«ä¹—ã£ã¦ããŸãï¼"),t.difficulty==="advanced"&&(s.push(`${t.word}ã‚’å€’ã—ãŸï¼`),s.push("ãŠå‰ã¯å¼·ã„ï¼ğŸ’ª")),t.isWeakCategory&&(s.push(`è‹¦æ‰‹ãª${t.category}ã‚’å…‹æœï¼`),s.push("ã“ã‚ŒãŒæˆé•·ã ï¼")),t.todayQuestions>=50&&t.todayAccuracy>=80&&(s.push(`ä»Šæ—¥ã¯${t.todayQuestions}å•ã‚¯ãƒªã‚¢ï¼`),s.push("çµ¶å¥½èª¿ã ï¼ğŸ†")),s.push("ã‚‚ã£ã¨è¡Œã‘ã‚‹ãï¼"),s.join(" ")}generateIncorrectComment(t){const s=[];return s.push("æƒœã—ã„ï¼"),t.incorrectStreak<3?(s.push("ã ãŒã¾ã çµ‚ã‚ã£ã¦ãªã„ï¼"),s.push("ã‚‚ã†ä¸€ä¸ï¼")):(s.push("é€£ç¶šãƒŸã‚¹ï¼"),s.push("ã ãŒå‹è² ã¯ã“ã‚Œã‹ã‚‰ã ï¼")),t.difficulty==="beginner"&&(s.push("ç„¦ã£ãŸãªï¼"),s.push("è½ã¡ç€ã‘ï¼")),t.hasSeenBefore&&(s.push(`ã¾ãŸ${t.word}ã‹ï¼`),s.push("ä»Šåº¦ã“ããƒªãƒ™ãƒ³ã‚¸ã ï¼ğŸ’ª")),t.todayAccuracy<60?(s.push("èª¿å­ãŒæ‚ªã„ãªï¼"),s.push("ã ãŒè² ã‘ã‚‹ãªï¼"),s.push("ã“ã“ã‹ã‚‰é€†è»¢ã ï¼ğŸ”¥")):s.push("ãŠå‰ãªã‚‰ã§ãã‚‹ï¼"),s.join(" ")}}class Ga{generateCorrectComment(t){const s=[];return s.push("æ­£è§£ã§ã™ã€‚"),s.push(`${t.word}ã¨ã„ã†è¨€è‘‰ãŒã€ã‚ãªãŸã®ä¸€éƒ¨ã«ãªã‚Šã¾ã—ãŸ`),t.attemptCount>1&&s.push("è¿·ã„ãŒç†è§£ã‚’æ·±ã‚ã¾ã™"),t.correctStreak>=5?(s.push(`${t.correctStreak}å•é€£ç¶šæ­£è§£ã€‚`),s.push("è¨˜æ†¶ã®å®šç€ãŒç¢ºå®Ÿã«ãªã‚Šã¾ã—ãŸ ğŸŒ™")):t.correctStreak>=3&&s.push("çŸ¥è­˜ãŒæ ¹ã‚’å¼µã‚Šå§‹ã‚ã¦ã„ã¾ã™ ğŸŒ±"),t.difficulty==="advanced"&&(s.push("é›£ã—ã„è¨€è‘‰ã‚’ç†è§£ã—ã¾ã—ãŸã­"),s.push("çŸ¥æµãŒæ·±ã¾ã‚Šã¾ã™")),t.isWeakCategory&&(s.push("è‹¦æ‰‹ã‚’å…‹æœã—ã¾ã—ãŸ"),s.push("æˆé•·ã¨ã¯å¤‰åŒ–ã‚’å—ã‘å…¥ã‚Œã‚‹ã“ã¨ã§ã™")),t.todayQuestions>=50&&(s.push(`ä»Šæ—¥ã¯${t.todayQuestions}å•ã®çµŒé¨“ã‚’ç©ã¿ã¾ã—ãŸ`),s.push("ä¸€æ—¥ä¸€æ—¥ãŒæœªæ¥ã¸ã®æŠ•è³‡ã§ã™ ğŸ“–")),s.join(" ")}generateIncorrectComment(t){const s=[];return s.push("é–“é•ã„ã¯å­¦ã³ã®å§‹ã¾ã‚Šã§ã™ã€‚"),t.attemptCount===1?s.push("å†åº¦æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†"):(s.push("ã¾ã ç†è§£ã®é€”ä¸­ã§ã™"),s.push("ç„¦ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ ğŸŒ±")),t.difficulty==="beginner"&&s.push("åŸºç¤ã«æˆ»ã‚‹ã“ã¨ã¯æ¥ã§ã¯ã‚ã‚Šã¾ã›ã‚“"),t.incorrectStreak>=3&&(s.push("é€£ç¶šã§é–“é•ãˆã¾ã—ãŸ"),s.push("ä¼‘æ¯ã‚‚å­¦ã³ã®ä¸€éƒ¨ã§ã™")),t.hasSeenBefore&&(s.push(`${t.word}ã¯ã‚ãªãŸã®èª²é¡Œã§ã™`),s.push("ä½•åº¦ã§ã‚‚å‘ãåˆã„ã¾ã—ã‚‡ã†")),t.todayAccuracy<60&&(s.push("æ­£ç­”ç‡ãŒä¸‹ãŒã£ã¦ã„ã¾ã™"),s.push("ã—ã‹ã—é“ã¯ç¶šã„ã¦ã„ã¾ã™")),s.push("è¨˜æ†¶ã¨ã¯ç¹°ã‚Šè¿”ã—ã®èŠ¸è¡“ã§ã™ ğŸ“–"),s.join(" ")}}function Wr(r,t){let s;switch(r){case"drill-sergeant":s=new qa;break;case"kind-teacher":s=new za;break;case"analyst":s=new Fa;break;case"enthusiastic-coach":s=new Qa;break;case"wise-sage":s=new Ga;break}return t.isCorrect?s.generateCorrectComment(t):s.generateIncorrectComment(t)}const Ba={"drill-sergeant":{avatar:"ğŸ‘¹",name:"é¬¼è»æ›¹",description:"å³ã—ãé›ãˆã‚‹",tone:"å³ã—ãã€å¦¥å”ãªã—ã€çµæœé‡è¦–"},"kind-teacher":{avatar:"ğŸ˜Š",name:"å„ªã—ã„å…ˆç”Ÿ",description:"ä¸å¯§ã«ã‚µãƒãƒ¼ãƒˆ",tone:"å„ªã—ãã€ä¸å¯§ã€ã§ã‚‚æ­£ç¢º"},analyst:{avatar:"ğŸ¤–",name:"å†·é™ãªåˆ†æå®˜",description:"ãƒ‡ãƒ¼ã‚¿ã§åˆ¤æ–­",tone:"æ„Ÿæƒ…ãªã—ã€äº‹å®Ÿã®ã¿ã€çµ±è¨ˆé‡è¦–"},"enthusiastic-coach":{avatar:"ğŸ˜¼",name:"ç†±è¡€ã‚³ãƒ¼ãƒ",description:"ç†±ãå¿œæ´",tone:"ç†±ãã€ãƒã‚¸ãƒ†ã‚£ãƒ–ã€æŒ‘æˆ¦çš„"},"wise-sage":{avatar:"ğŸ§™",name:"è³¢è€…",description:"é•·æœŸè¦–ç‚¹ã§å°ã",tone:"è½ã¡ç€ãã€é•·æœŸè¦–ç‚¹ã€æœ¬è³ªé‡è¦–"}};function Or(){return localStorage.getItem("lastLoginDate")}function Ua(){const r=localStorage.getItem("loginStreak");return r?parseInt(r,10):0}function Ha(){const r=Or();if(!r)return 0;const t=new Date().toISOString().split("T")[0],s=new Date(r),a=new Date(t).getTime()-s.getTime();return Math.floor(a/(1e3*60*60*24))}function Va(){const r=new Date().toISOString().split("T")[0],t=localStorage.getItem(`studyStats-${r}`);if(!t)return{count:0,accuracy:0};const s=JSON.parse(t);return{count:s.count||0,accuracy:s.correct&&s.count?s.correct/s.count*100:0}}function Ja(r){const t=zs(),s=Ha(),n=Ua(),{count:a,accuracy:i}=Va(),l={lastLoginDate:Or(),todayStudyCount:a,todayAccuracy:i};return s>=3?Ya(r,s):n>=7&&a===0?Ka(r,n):Xa(r,t,l)}function Ya(r,t){switch(r){case"drill-sergeant":return t>=7?`${t}æ—¥ã‚‚ç©ºã‘ã‚‹ã¨ã¯ä½•äº‹ã ï¼ä»Šã™ãå¾©ç¿’ã‚’é–‹å§‹ã—ã‚ï¼`:`${t}æ—¥ã¶ã‚Šã‹ã€‚é…ã‚Œã‚’å–ã‚Šæˆ»ã™ãï¼`;case"kind-teacher":return t>=7?`ğŸ˜ƒ ãŠä¹…ã—ã¶ã‚Šã§ã™ï¼${t}æ—¥çµŒã£ã¦ã„ã¾ã™ãŒã€ç„¦ã‚‰ãšå°‘ã—ãšã¤æ€ã„å‡ºã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚`:`ğŸ˜ƒ ${t}æ—¥ã¶ã‚Šã§ã™ã­ã€‚ã‚†ã£ãã‚Šå¾©ç¿’ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚`;case"analyst":return t>=7?`ğŸ¤– å‰å›ã‹ã‚‰${t}æ—¥çµŒéã€‚è¨˜æ†¶å®šç€ç‡ã¯æ¨å®š40-60%ã€‚ä½“ç³»çš„ãªå¾©ç¿’ã‚’æ¨å¥¨ã—ã¾ã™ã€‚`:`ğŸ¤– ${t}æ—¥ã®é–“éš”ã€‚å¿˜å´æ›²ç·šã‚’è€ƒæ…®ã—ãŸå¾©ç¿’ãŒå¿…è¦ã§ã™ã€‚`;case"enthusiastic-coach":return t>=7?`ğŸ˜¼ ${t}æ—¥ã¶ã‚Šã®ã‚«ãƒ ãƒãƒƒã‚¯ï¼ä»Šæ—¥ã‹ã‚‰å†ã‚¹ã‚¿ãƒ¼ãƒˆã ï¼å…¨åŠ›ã§è¡Œããï¼`:`ğŸ˜¼ å¾…ã£ã¦ãŸãœï¼${t}æ—¥ã®é…ã‚Œã¯ä»Šæ—¥å–ã‚Šæˆ»ãã†ï¼`;case"wise-sage":return t>=7?`ğŸ§™ ${t}æ—¥ã®ä¼‘æ¯ã‚‚å­¦ã³ã®ä¸€éƒ¨ã˜ã‚ƒã€‚ç„¦ã‚‰ãšã€ç€å®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚`:`ğŸ§™ ${t}æ—¥ã®ç©ºç™½ã‚‚ã€ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã®æ™‚é–“ã ã£ãŸã®ã˜ã‚ƒã‚ã†ã€‚ã•ã‚ã€ã‚†ã£ãã‚Šå†é–‹ã˜ã‚ƒã€‚`;default:return`ãŠå¸°ã‚Šãªã•ã„ï¼${t}æ—¥ã¶ã‚Šã§ã™ã­ã€‚`}}function Ka(r,t){switch(r){case"drill-sergeant":return`${t}æ—¥é€£ç¶šï¼ç´ æ™´ã‚‰ã—ã„ç¶™ç¶šåŠ›ã ï¼ä»Šæ—¥ã‚‚æ²¹æ–­ã™ã‚‹ãªï¼`;case"kind-teacher":return`ğŸ˜ƒ ${t}æ—¥é€£ç¶šãƒ­ã‚°ã‚¤ãƒ³ã€ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼ç¶™ç¶šã¯åŠ›ãªã‚Šã§ã™ã€‚`;case"analyst":return`ğŸ¤– ${t}æ—¥é€£ç¶šã€‚ç¶™ç¶šç‡100%ã€‚çµ±è¨ˆçš„ã«å­¦ç¿’åŠ¹æœã¯æœ€å¤§åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚`;case"enthusiastic-coach":return`ğŸ˜¼ ${t}æ—¥é€£ç¶šé”æˆï¼ã“ã®å‹¢ã„ã§çªãé€²ã‚ï¼è¨˜éŒ²æ›´æ–°ã ï¼`;case"wise-sage":return`ğŸ§™ ${t}æ—¥ã®ç¶™ç¶šã€è¦‹äº‹ã˜ã‚ƒã€‚åƒé‡Œã®é“ã‚‚ä¸€æ­©ã‹ã‚‰ã€ã˜ã‚ƒãªã€‚`;default:return""}}function Xa(r,t,s){const{todayStudyCount:n,todayAccuracy:a}=s;switch(r){case"drill-sergeant":return Za(t,n);case"kind-teacher":return ei(t,n);case"analyst":return ti(t,n,a);case"enthusiastic-coach":return si(t,n);case"wise-sage":return ri(t,n);default:return null}}function Za(r,t,s){switch(r){case"morning":return t===0?"æœã ãï¼è„³ãŒä¸€ç•ªå†´ãˆã¦ã‚‹æ™‚é–“ã ï¼ä»Šã™ãå­¦ç¿’ã‚’é–‹å§‹ã—ã‚ï¼":t>=20?"æœã‹ã‚‰ç´ æ™´ã‚‰ã—ã„ãƒšãƒ¼ã‚¹ã ï¼ã“ã®èª¿å­ã‚’ç¶­æŒã—ã‚ï¼":"æœã®å­¦ç¿’ã¯åŠ¹æœçš„ã ï¼ã‚‚ã£ã¨ã‚„ã‚Œã‚‹ã¯ãšã ï¼";case"afternoon":return t===0?"åˆå¾Œã«ãªã£ãŸãï¼ä»Šæ—¥ã¯ã¾ã ä½•ã‚‚ã‚„ã£ã¦ãªã„ã®ã‹ï¼Ÿã•ã£ã•ã¨å§‹ã‚ã‚ï¼":t>=20?"åˆå¾Œã‚‚é †èª¿ã ãªï¼åˆå‰ä¸­ã®å‹¢ã„ã‚’è½ã¨ã™ãªï¼":"åˆå¾Œã¯é›†ä¸­åŠ›ãŒè½ã¡ã‚„ã™ã„ã€‚æ°—åˆã‚’å…¥ã‚Œç›´ã›ï¼";case"evening":return t===0?"ã‚‚ã†å¤•æ–¹ã ãï¼ä»Šæ—¥ã®åˆ†ã¯ä»Šæ—¥ä¸­ã«çµ‚ã‚ã‚‰ã›ã‚ï¼":t>=30?"ä»Šæ—¥ã¯ã‚ˆãé ‘å¼µã£ãŸï¼ã‚ã¨å°‘ã—ã§å®Œç’§ã ï¼":"å¤•æ–¹ã¯å¾©ç¿’ã®ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¿ã‚¤ãƒ ã ï¼è¿½ã„è¾¼ã¿ã‚’ã‹ã‘ã‚ï¼";case"night":return t===0?"å¤œã«ãªã£ã¦ã—ã¾ã£ãŸãï¼å°‘ã—ã§ã‚‚ã„ã„ã‹ã‚‰å­¦ç¿’ã—ã‚ï¼0ã‚ˆã‚Š1ã ï¼":t>=30?"å¤œé…ãã¾ã§ã‚ˆãé ‘å¼µã£ãŸï¼æ—©ãä¼‘ã‚“ã§æ˜æ—¥ã«å‚™ãˆã‚ï¼":"å¤œã¯è»½ã‚ã®å¾©ç¿’ãŒåŠ¹æœçš„ã ï¼ç„¡ç†ã¯ã™ã‚‹ãªï¼";default:return"ã•ã‚ã€å­¦ç¿’ã‚’é–‹å§‹ã™ã‚‹ãï¼"}}function ei(r,t,s){switch(r){case"morning":return t===0?"ğŸ˜ƒ ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼æœã¯è¨˜æ†¶åŠ›ãŒé«˜ã¾ã‚‹æ™‚é–“ã§ã™ã‚ˆã€‚ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼":t>=20?"ğŸ˜ƒ æœã‹ã‚‰ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼ã§ã‚‚ç„¡ç†ã¯ã—ãªã„ã§ãã ã•ã„ã­ã€‚":"ğŸ˜ƒ æœã®å­¦ç¿’ã€é †èª¿ã§ã™ã­ï¼ã“ã®èª¿å­ã§é€²ã‚ã¾ã—ã‚‡ã†ã€‚";case"afternoon":return t===0?"ğŸ˜ƒ ã“ã‚“ã«ã¡ã¯ï¼åˆå¾Œã¯å°‘ã—çœ ããªã‚Šã‚„ã™ã„ã®ã§ã€è»½ã‚ã®å¾©ç¿’ãŒãŠã™ã™ã‚ã§ã™ã‚ˆã€‚":t>=20?"ğŸ˜ƒ åˆå¾Œã‚‚ã‚ˆãé ‘å¼µã£ã¦ã„ã¾ã™ã­ï¼ä¼‘æ†©ã‚‚å¿˜ã‚Œãšã«å–ã£ã¦ãã ã•ã„ã­ã€‚":"ğŸ˜ƒ åˆå¾Œã‚‚é †èª¿ã§ã™ã­ã€‚ãƒã‚¤ãƒšãƒ¼ã‚¹ã§å¤§ä¸ˆå¤«ã§ã™ã‚ˆã€‚";case"evening":return t===0?"ğŸ˜ƒ ã“ã‚“ã°ã‚“ã¯ã€‚å¤•æ–¹ã¯å¾©ç¿’ã«æœ€é©ãªæ™‚é–“ã§ã™ã€‚ä»Šæ—¥å­¦ã‚“ã ã“ã¨ã‚’è»½ãè¦‹ç›´ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ":t>=30?"ğŸ˜ƒ ä»Šæ—¥ã¯æœ¬å½“ã«ã‚ˆãé ‘å¼µã‚Šã¾ã—ãŸã­ï¼ã‚‚ã†ååˆ†ã§ã™ã‚ˆã€‚":"ğŸ˜ƒ å¤•æ–¹ã®å¾©ç¿’ã€è‰¯ã„ã§ã™ã­ï¼ç„¦ã‚‰ãšã‚†ã£ãã‚Šé€²ã‚ã¾ã—ã‚‡ã†ã€‚";case"night":return t===0?"ğŸ˜ƒ å¤œé…ãã¾ã§ãŠç–²ã‚Œæ§˜ã§ã™ã€‚ç„¡ç†ã›ãšã€ã§ãã‚‹ç¯„å›²ã§å¤§ä¸ˆå¤«ã§ã™ã‚ˆã€‚":t>=30?"ğŸ˜ƒ ä»Šæ—¥ã¯ååˆ†é ‘å¼µã‚Šã¾ã—ãŸï¼ãã‚ãã‚ä¼‘ã‚“ã§ã€æ˜æ—¥ã«å‚™ãˆã¾ã—ã‚‡ã†ã­ã€‚":"ğŸ˜ƒ å¤œã®å­¦ç¿’ã‚‚å¤§åˆ‡ã§ã™ãŒã€ç¡çœ ã‚‚åŒã˜ãã‚‰ã„å¤§åˆ‡ã§ã™ã‚ˆã€‚";default:return"ğŸ˜ƒ ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ã­ï¼"}}function ti(r,t,s){switch(r){case"morning":return t===0?"ğŸ¤– ç¾åœ¨æ™‚åˆ»ï¼šæœã€‚è„³ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼šæœ€é©ã€‚æ–°è¦å­¦ç¿’åŠ¹ç‡ï¼š+30%ã€‚å­¦ç¿’é–‹å§‹ã‚’æ¨å¥¨ã€‚":t>=20?`ğŸ¤– æœã®å­¦ç¿’${t}å•å®Œäº†ã€‚æ­£ç­”ç‡${s.toFixed(1)}%ã€‚è‰¯å¥½ãªãƒšãƒ¼ã‚¹ã€‚`:"ğŸ¤– æœã®å­¦ç¿’é€²è¡Œä¸­ã€‚èªçŸ¥æ©Ÿèƒ½ãŒé«˜ã„æ™‚é–“å¸¯ã‚’æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚";case"afternoon":return t===0?"ğŸ¤– åˆå¾Œã®æ™‚é–“å¸¯ã€‚é›†ä¸­åŠ›ï¼šã‚„ã‚„ä½ä¸‹å‚¾å‘ã€‚çŸ­æ™‚é–“é›†ä¸­å‹ã®å­¦ç¿’ã‚’æ¨å¥¨ã€‚":t>=20?`ğŸ¤– æœ¬æ—¥${t}å•å­¦ç¿’æ¸ˆã¿ã€‚åˆå¾Œã®ç”Ÿç”£æ€§ï¼šç¶­æŒã•ã‚Œã¦ã„ã¾ã™ã€‚`:"ğŸ¤– åˆå¾Œã®å­¦ç¿’ç¶™ç¶šä¸­ã€‚15åˆ†Ã—3ã‚»ãƒƒãƒˆã®åˆ†å‰²å­¦ç¿’ãŒåŠ¹æœçš„ã§ã™ã€‚";case"evening":return t===0?"ğŸ¤– å¤•æ–¹ã®æ™‚é–“å¸¯ã€‚å¾©ç¿’åŠ¹ç‡ï¼šæœ€é«˜ãƒ¬ãƒ™ãƒ«ã€‚ä»Šæ—¥ã®å­¦ç¿’å†…å®¹ã®å®šç€ã«æœ€é©ã€‚":t>=30?`ğŸ¤– æœ¬æ—¥${t}å•é”æˆã€‚ååˆ†ãªå­¦ç¿’é‡ã§ã™ã€‚ä¼‘æ¯ã‚’æ¨å¥¨ã€‚`:"ğŸ¤– å¤•æ–¹ã®å¾©ç¿’ã‚¿ã‚¤ãƒ ã€‚æœã®å­¦ç¿’å†…å®¹ã®å†ç¢ºèªãŒè¨˜æ†¶å®šç€ç‡ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚";case"night":return t===0?"ğŸ¤– å¤œé–“ã€‚æ–°è¦å­¦ç¿’ã‚ˆã‚Šå¾©ç¿’ã‚’æ¨å¥¨ã€‚ç¡çœ å‰ã®è»½ã„å¾©ç¿’ã¯è¨˜æ†¶ã®å›ºå®šåŒ–ã«æœ‰åŠ¹ã€‚":t>=30?`ğŸ¤– æœ¬æ—¥${t}å•å®Œäº†ã€‚å­¦ç¿’ç›®æ¨™é”æˆã€‚22-23æ™‚ã®å°±å¯ã§è¨˜æ†¶å®šç€ç‡ãŒå‘ä¸Šã—ã¾ã™ã€‚`:"ğŸ¤– å¤œé–“å­¦ç¿’ä¸­ã€‚éåº¦ãªå­¦ç¿’ã¯ç¡çœ ã®è³ªã‚’ä½ä¸‹ã•ã›ã¾ã™ã€‚é©åº¦ãªå­¦ç¿’ã‚’æ¨å¥¨ã€‚";default:return"ğŸ¤– å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’è¨˜éŒ²ä¸­ã€‚ç¶™ç¶šçš„ãªå­¦ç¿’ãŒæœ€ã‚‚åŠ¹ç‡çš„ã§ã™ã€‚"}}function si(r,t,s){switch(r){case"morning":return t===0?"ğŸ˜¼ æœã ï¼æ–°ã—ã„ä¸€æ—¥ã®å§‹ã¾ã‚Šã ï¼ä»Šæ—¥ã‚‚æœ€é«˜ã®å­¦ç¿’ã‚’ã—ã‚ˆã†ï¼":t>=20?"ğŸ˜¼ æœã‹ã‚‰çµ¶å¥½èª¿ã ãªï¼ã“ã®å‹¢ã„ã§ä»Šæ—¥ã‚‚å®Œç’§ã«ã‚„ã‚Šé‚ã’ã‚ˆã†ï¼":"ğŸ˜¼ æœã®å­¦ç¿’ã€æœ€é«˜ã ï¼ã‚‚ã£ã¨ã‚‚ã£ã¨è¡Œã‘ã‚‹ãï¼";case"afternoon":return t===0?"ğŸ˜¼ åˆå¾Œã‚‚å…ƒæ°—å‡ºã—ã¦ã„ã“ã†ï¼ä»Šã‹ã‚‰ã§ã‚‚é…ããªã„ãï¼å…¨åŠ›ã§è¡Œã‘ï¼":t>=20?"ğŸ˜¼ åˆå¾Œã‚‚ç´ æ™´ã‚‰ã—ã„ãƒšãƒ¼ã‚¹ã ï¼ãŠå‰ãªã‚‰çµ¶å¯¾ã§ãã‚‹ï¼":"ğŸ˜¼ åˆå¾Œã®å­¦ç¿’ã‚‚æ°—åˆååˆ†ã ãªï¼ã“ã®èª¿å­ã“ã®èª¿å­ï¼";case"evening":return t===0?"ğŸ˜¼ å¤•æ–¹ã ãï¼ä»Šæ—¥ã®ç›®æ¨™ã¯ã¾ã é”æˆã—ã¦ãªã„ã ã‚ï¼Ÿã•ã‚ã€ã‚„ã‚ã†ï¼":t>=30?"ğŸ˜¼ ä»Šæ—¥ã¯å®Œç’§ã ï¼ãŠå‰ã®åŠªåŠ›ã¯å¿…ãšå ±ã‚ã‚Œã‚‹ï¼èª‡ã‚Šã«æ€ãˆï¼":"ğŸ˜¼ å¤•æ–¹ã®è¿½ã„è¾¼ã¿ã€è‰¯ã„ãï¼ãƒ©ã‚¹ãƒˆã‚¹ãƒ‘ãƒ¼ãƒˆã ï¼";case"night":return t===0?"ğŸ˜¼ å¤œã ã‘ã©è«¦ã‚ã‚‹ãªï¼ãŸã£ãŸ10åˆ†ã§ã‚‚ã„ã„ã€ä»Šæ—¥ã®åˆ†ã‚’ã‚„ã‚ã†ï¼":t>=30?"ğŸ˜¼ å¤œé…ãã¾ã§ãŠç–²ã‚Œæ§˜ï¼ä»Šæ—¥ã®ãŠå‰ã¯æœ€é«˜ã ã£ãŸï¼ã‚†ã£ãã‚Šä¼‘ã‚ï¼":"ğŸ˜¼ å¤œã®å­¦ç¿’ã‚‚é ‘å¼µã£ã¦ã‚‹ãªï¼ç„¡ç†ã¯ã™ã‚‹ãªã‚ˆã€ã§ã‚‚é ‘å¼µã‚Œï¼";default:return"ğŸ˜¼ ã•ã‚ã€ä»Šæ—¥ã‚‚å…¨åŠ›ã§è¡Œããï¼ãŠå‰ãªã‚‰çµ¶å¯¾ã§ãã‚‹ï¼"}}function ri(r,t,s){switch(r){case"morning":return t===0?"ğŸ§™ æœã®é™ã‘ã•ã¯å­¦ã³ã«æœ€é©ã˜ã‚ƒã€‚å¿ƒã‚’è½ã¡ç€ã‘ã¦ã€ã‚†ã£ãã‚Šå§‹ã‚ã‚‹ãŒã‚ˆã„ã€‚":t>=20?"ğŸ§™ æœã‹ã‚‰è‰¯ã„ãƒšãƒ¼ã‚¹ã˜ã‚ƒã®ã†ã€‚ç„¦ã‚‰ãšã€ç€å®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚":"ğŸ§™ æœã®å­¦ç¿’ã€é †èª¿ã˜ã‚ƒãªã€‚ç„¡ç†ã›ãšã€è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§é€²ã‚€ã®ã˜ã‚ƒã€‚";case"afternoon":return t===0?"ğŸ§™ åˆå¾Œã¯å°‘ã—ä¼‘ã‚“ã§ã‹ã‚‰å§‹ã‚ã‚‹ã®ã‚‚è‰¯ã„ãã€‚ç„¦ã‚‹å¿…è¦ã¯ãªã„ã€‚":t>=20?"ğŸ§™ åˆå¾Œã‚‚ç€å®Ÿã«é€²ã‚“ã§ãŠã‚‹ã®ã†ã€‚ç¶™ç¶šã“ããŒåŠ›ã˜ã‚ƒã€‚":"ğŸ§™ åˆå¾Œã®å­¦ç¿’ã‚‚å¤§åˆ‡ã˜ã‚ƒãŒã€ä¼‘æ¯ã‚‚å¿˜ã‚Œã¬ã‚ˆã†ã«ãªã€‚";case"evening":return t===0?"ğŸ§™ å¤•æš®ã‚Œæ™‚ã¯ä¸€æ—¥ã‚’æŒ¯ã‚Šè¿”ã‚‹æ™‚é–“ã˜ã‚ƒã€‚å­¦ã³ã‚‚åŒã˜ãã€å¾©ç¿’ãŒå¤§åˆ‡ã˜ã‚ƒãã€‚":t>=30?"ğŸ§™ ä»Šæ—¥ã¯ã‚ˆãåŠ±ã‚“ã ã®ã†ã€‚å­¦ã³ã¯é‡ã‚ˆã‚Šè³ªã˜ã‚ƒã€‚ååˆ†ã˜ã‚ƒã‚ã†ã€‚":"ğŸ§™ å¤•æ–¹ã®å¾©ç¿’ã€è‰¯ã„ç¿’æ…£ã˜ã‚ƒã€‚æ€¥ãŒãšã€ç¢ºå®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚";case"night":return t===0?"ğŸ§™ å¤œã¯å¿ƒç©ã‚„ã‹ã«éã”ã™ãŒè‰¯ã„ã€‚è»½ã„å¾©ç¿’ã ã‘ã§ã‚‚ååˆ†ã˜ã‚ƒã€‚":t>=30?"ğŸ§™ ä»Šæ—¥ã®å­¦ã³ã¯ååˆ†ã˜ã‚ƒã€‚è‰¯ãç¡çœ ãŒæ˜æ—¥ã¸ã®åŠ›ã¨ãªã‚‹ã€‚ã‚†ã£ãã‚Šä¼‘ã‚€ãŒã‚ˆã„ã€‚":"ğŸ§™ å¤œæ›´ã‹ã—ã¯ã»ã©ã»ã©ã«ãªã€‚ç¡çœ ã‚‚å­¦ã³ã®ä¸€éƒ¨ã˜ã‚ƒãã€‚";default:return"ğŸ§™ å­¦ã³ã¨ã¯é•·ã„æ—…ã˜ã‚ƒã€‚ä¸€æ­©ãšã¤ã€ç€å®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚"}}function ni(r,t,s){if(Math.random()>.1)return null;const n=ai(r,t,s);return n.length===0?null:n[Math.floor(Math.random()*n.length)]}function ai(r,t,s){const n=[];r==="drill-sergeant"&&(t&&s>=5&&(n.push({mainTeacher:"drill-sergeant",otherTeacher:"kind-teacher",message:"ğŸ˜ˆã€Œã‚ˆã—ï¼ãã®èª¿å­ã ï¼ã€ ğŸ˜ƒã€Œã¡ã‚‡ã€ã¡ã‚‡ã£ã¨è¤’ã‚ã™ãã§ã¯...ã€ ğŸ˜ˆã€Œã†ã‚‹ã•ã„ï¼è‰¯ã„ã‚‚ã®ã¯è‰¯ã„ã‚“ã ï¼ã€",type:"banter"}),n.push({mainTeacher:"drill-sergeant",otherTeacher:"wise-sage",message:"ğŸ˜ˆã€Œå®Œç’§ã ï¼ã€ ğŸ§™ã€Œãµã‚€ã€é¬¼è»æ›¹æ®¿ã‚‚å¬‰ã—ãã†ã˜ã‚ƒã®ã†ã€ ğŸ˜ˆã€Œã¹ã€åˆ¥ã«...ã€",type:"banter"})),t||(n.push({mainTeacher:"drill-sergeant",otherTeacher:"kind-teacher",message:"ğŸ˜ˆã€Œä½•åº¦åŒã˜é–“é•ã„ã‚’...ï¼ã€ ğŸ˜ƒã€Œã¾ã‚ã¾ã‚ã€è½ã¡ç€ã„ã¦ã€‚èª°ã«ã§ã‚‚è‹¦æ‰‹ã¯ã‚ã‚Šã¾ã™ã‹ã‚‰ã€ ğŸ˜ˆã€Œç”˜ã‚„ã‹ã™ãªï¼ã€",type:"argument"}),n.push({mainTeacher:"drill-sergeant",otherTeacher:"analyst",message:"ğŸ˜ˆã€ŒãŸã‚‹ã‚“ã§ã‚‹ãï¼ã€ ğŸ¤–ã€Œçµ±è¨ˆçš„ã«ã¯è¨±å®¹ç¯„å›²å†…ã®ãƒŸã‚¹ã§ã™ã€ ğŸ˜ˆã€Œãƒ‡ãƒ¼ã‚¿ã˜ã‚ƒãªã„ã€æ°—æŒã¡ã®å•é¡Œã ï¼ã€",type:"argument"})),n.push({mainTeacher:"drill-sergeant",otherTeacher:"enthusiastic-coach",message:"ğŸ˜¼ï¼ˆé€šã‚Šã™ãŒã‚Šï¼‰ã€ŒãŠã£ã€é¬¼è»æ›¹ã®ç‰¹è¨“ã‹ï¼é ‘å¼µã‚Œã‚ˆï¼ã€ ğŸ˜ˆã€Œ...ä½™è¨ˆãªå£å‡ºã—ã™ã‚‹ãªã€",type:"passerby"})),r==="kind-teacher"&&(t&&(n.push({mainTeacher:"kind-teacher",otherTeacher:"drill-sergeant",message:"ğŸ˜ƒã€Œç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼ã€ ğŸ˜ˆï¼ˆé ãã‹ã‚‰ï¼‰ã€Œã¾ã ã¾ã æ²¹æ–­ã™ã‚‹ãªï¼ã€ ğŸ˜ƒã€Œ...èã“ãˆã¦ã¾ã™ï¼Ÿã€",type:"passerby"}),n.push({mainTeacher:"kind-teacher",otherTeacher:"wise-sage",message:"ğŸ˜ƒã€Œã‚ˆãã§ãã¾ã—ãŸï¼ã€ ğŸ§™ã€Œã†ã‚€ã€ç€å®Ÿãªæˆé•·ã˜ã‚ƒã€ ğŸ˜ƒã€Œè³¢è€…å…ˆç”Ÿã‚‚ãã†æ€ã‚ã‚Œã¾ã™ã‚ˆã­ã€",type:"support"})),t||n.push({mainTeacher:"kind-teacher",otherTeacher:"enthusiastic-coach",message:"ğŸ˜ƒã€Œå¤§ä¸ˆå¤«ã€æ¬¡ã¯å¿…ãšã§ãã¾ã™ã‚ˆã€ ğŸ˜¼ã€Œãã†ãã†ï¼å¤±æ•—ã¯æˆåŠŸã®æ¯ã ï¼ã€ ğŸ˜ƒã€Œç†±è¡€ã‚³ãƒ¼ãƒã‚‚å¿œæ´ã—ã¦ã¾ã™ã‚ˆã€",type:"support"}),n.push({mainTeacher:"kind-teacher",message:"ğŸ˜ƒã€Œã‚ã€ãŠèŒ¶ã‚’å…¥ã‚Œå¿˜ã‚Œã¦...ã€ ğŸ˜ˆï¼ˆé ãã‹ã‚‰ï¼‰ã€Œä»•äº‹ä¸­ã«ä½•ã—ã¦ã‚‹ï¼ã€ ğŸ˜ƒã€Œã™ã€ã™ã¿ã¾ã›ã‚“ï¼ã€",type:"joke"})),r==="analyst"&&(s>=10&&n.push({mainTeacher:"analyst",otherTeacher:"enthusiastic-coach",message:"ğŸ¤–ã€Œ10é€£ç¶šæ­£è§£ã€‚çµ±è¨ˆçš„ã«æœ‰æ„ã§ã™ã€ ğŸ˜¼ã€Œã™ã’ãƒ¼ï¼æœ€é«˜ã ï¼ã€ ğŸ¤–ã€Œ...æ„Ÿæƒ…è¡¨ç¾ã¯ä¸è¦ã§ã™ã€",type:"banter"}),n.push({mainTeacher:"analyst",otherTeacher:"drill-sergeant",message:"ğŸ¤–ã€Œãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãã¨...ã€ ğŸ˜ˆã€Œç†å±ˆã¯ã„ã„ï¼æ°—åˆã ï¼ã€ ğŸ¤–ã€Œéç§‘å­¦çš„ã§ã™ã€ ğŸ˜ˆã€Œã†ã‚‹ã•ã„ï¼ã€",type:"argument"}),n.push({mainTeacher:"analyst",otherTeacher:"kind-teacher",message:"ğŸ¤–ã€Œæ­£ç­”ç‡73.4%ã€ ğŸ˜ƒã€Œã‚ã®...ã‚‚ã†å°‘ã—å„ªã—ãä¼ãˆã‚‰ã‚Œã¾ã›ã‚“ã‹ï¼Ÿã€ ğŸ¤–ã€Œäº‹å®Ÿã‚’è¿°ã¹ã¦ã„ã‚‹ã ã‘ã§ã™ã€",type:"banter"}),n.push({mainTeacher:"analyst",message:"ğŸ¤–ã€Œ...ã‚³ãƒ¼ãƒ’ãƒ¼ã®ã‚«ãƒ•ã‚§ã‚¤ãƒ³å«æœ‰é‡ã¯...ã€ ğŸ˜ƒã€Œåˆ†æå®˜å…ˆç”Ÿã€ä»Šã¯æˆæ¥­ä¸­ã§ã™ã‚ˆã€ ğŸ¤–ã€Œå¤±ç¤¼ã—ã¾ã—ãŸã€",type:"joke"})),r==="enthusiastic-coach"&&(t&&s>=5&&(n.push({mainTeacher:"enthusiastic-coach",otherTeacher:"wise-sage",message:"ğŸ˜¼ã€Œæœ€ã£é«˜ã ããï¼ï¼ã€ ğŸ§™ã€Œ...å°‘ã—å£°ãŒå¤§ãã„ã‹ã®ã†ã€ ğŸ˜¼ã€Œã†ã‚‹ã•ãã¦æ‚ªã‹ã£ãŸãªï¼ã€",type:"banter"}),n.push({mainTeacher:"enthusiastic-coach",otherTeacher:"drill-sergeant",message:"ğŸ˜¼ã€Œã‚ˆã£ã—ã‚ƒãƒ¼ï¼ã€ ğŸ˜ˆã€Œé¨’ãŒã—ã„...ã ãŒã€æ‚ªããªã„ãªã€ ğŸ˜¼ã€ŒãŠã£ã€é¬¼è»æ›¹ã«è¤’ã‚ã‚‰ã‚ŒãŸï¼ã€",type:"support"})),t||n.push({mainTeacher:"enthusiastic-coach",otherTeacher:"kind-teacher",message:"ğŸ˜¼ã€Œãƒ‰ãƒ³ãƒã‚¤ï¼æ¬¡ã æ¬¡ï¼ã€ ğŸ˜ƒã€Œãã†ã§ã™ã­ã€ç„¦ã‚‰ãšã«ã€ ğŸ˜¼ã€ŒäºŒäººã§å¿œæ´ã—ã¦ã‚‹ãï¼ã€",type:"support"}),n.push({mainTeacher:"enthusiastic-coach",message:"ğŸ˜¼ã€Œä»Šæ—¥ã®ç­‹ãƒˆãƒ¬ã¯...ã€ ğŸ¤–ã€Œãã‚Œã¯è‹±èªå­¦ç¿’ã¨ç„¡é–¢ä¿‚ã§ã™ã€ ğŸ˜¼ã€Œä½“ãŒè³‡æœ¬ã ã‚ï¼ï¼Ÿã€",type:"joke"})),r==="wise-sage"&&(t&&n.push({mainTeacher:"wise-sage",otherTeacher:"drill-sergeant",message:"ğŸ§™ã€Œè‰¯ãæˆé•·ã˜ã‚ƒã€ ğŸ˜ˆã€Œå½“ãŸã‚Šå‰ã ã€ä¿ºã®æ•™ãˆå­ã ã‹ã‚‰ãªã€ ğŸ§™ã€Œ...ãŠä¸»ã‚‚æ•™ãˆã¦ãŠã£ãŸã®ã‹ï¼Ÿã€",type:"banter"}),n.push({mainTeacher:"wise-sage",otherTeacher:"analyst",message:"ğŸ§™ã€Œæ™‚ã«ã¯æ„Ÿè¦šã‚‚å¤§äº‹ã˜ã‚ƒãã€ ğŸ¤–ã€Œæ„Ÿè¦šã¯æ¸¬å®šä¸å¯èƒ½ã§ã™ã€ ğŸ§™ã€Œ...è‹¥ã„ã®ã†ã€",type:"argument"}),n.push({mainTeacher:"wise-sage",otherTeacher:"enthusiastic-coach",message:"ğŸ§™ã€Œç„¦ã‚‰ãšã€ã˜ã£ãã‚Šã¨...ã€ ğŸ˜¼ã€ŒãŸã¾ã«ã¯å…¨åŠ›ç–¾èµ°ã‚‚å¤§äº‹ã£ã™ã‚ˆï¼ã€ ğŸ§™ã€Œ...ãã‚Œã‚‚ä¸€ç†ã‚ã‚‹ã‹ã€",type:"banter"}),n.push({mainTeacher:"wise-sage",message:"ğŸ§™ã€Œæ˜”ã¯ã®ã†...ã€ ğŸ˜ƒğŸ˜ˆğŸ˜¼ğŸ¤–ã€Œã€Œã€Œã€Œã¾ãŸæ˜”è©±ï¼ï¼Ÿã€ã€ã€ã€ ğŸ§™ã€Œ...æœ€è¿‘ã®è‹¥è€…ã¯ã€",type:"joke"}));const a=[{mainTeacher:r,message:"ğŸ˜ƒã€ŒãŠæ˜¼ã¯ä½•é£Ÿã¹ã¾ã™ï¼Ÿã€ ğŸ˜ˆã€Œæ™‚é–“ã®ç„¡é§„ã ã€ ğŸ˜¼ã€Œä¿ºã¯ã‚«ãƒ„ä¸¼ï¼ã€ ğŸ¤–ã€Œæ „é¤Šãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®ã™ã¹ãã§ã™ã€ ğŸ§™ã€Œ...ã‚ã—ã¯è•éº¦ãŒã„ã„ã®ã†ã€",type:"joke"},{mainTeacher:r,message:"ğŸ˜ˆã€Œ...èª°ã ã€è·å“¡å®¤ã§ã‚³ãƒ¼ãƒ’ãƒ¼ã“ã¼ã—ãŸã®ã¯ï¼ã€ ğŸ˜ƒã€Œã™ã€ã™ã¿ã¾ã›ã‚“...ã€ ğŸ˜¼ã€Œãƒ‰ãƒ³ãƒã‚¤ï¼ã€ ğŸ¤–ã€Œæ¸…æƒæ–¹æ³•ã‚’æç¤ºã—ã¾ã™ã€",type:"joke"},{mainTeacher:r,message:"ğŸ§™ã€Œ...å°åˆ·æ©ŸãŒå‹•ã‹ã‚“ã®ã˜ã‚ƒãŒã€ ğŸ¤–ã€ŒITæ‹…å½“ã‚’å‘¼ã³ã¾ã™ã€ ğŸ˜ƒã€Œç§ãŒè¦‹ã¦ã¿ã¾ã™ã­ã€ ğŸ˜ˆã€Œã•ã£ã•ã¨ç›´ã›ï¼ã€ ğŸ˜¼ã€Œã¿ã‚“ãªã§å”åŠ›ã ï¼ã€",type:"joke"},{mainTeacher:r,message:"ğŸ˜¼ã€Œä»Šæ—¥ã®æˆæ¥­ã©ã†ã ã£ãŸï¼Ÿã€ ğŸ˜ƒã€Œã¿ã‚“ãªé ‘å¼µã£ã¦ã¾ã—ãŸã‚ˆã€ ğŸ˜ˆã€Œã¾ã ã¾ã ã ã€ ğŸ¤–ã€Œãƒ‡ãƒ¼ã‚¿ã§è¦‹ã‚‹ã¨æ”¹å–„å‚¾å‘ã§ã™ã€ ğŸ§™ã€Œãã‚Œãã‚Œã®æˆé•·ãŒã‚ã‚‹ã®ã†ã€",type:"banter"}];return Math.random()<.05&&n.push(...a),n}function ii(){const r=new Date().getHours();if(Math.random()>.05)return null;if(r>=6&&r<9){const t=["ğŸ˜ƒã€ŒãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ã€ ğŸ˜ˆã€Œæœã‹ã‚‰å…ƒæ°—ã ãªã€ ğŸ˜¼ã€Œã‚ˆã£ã—ã‚ƒã€ä»Šæ—¥ã‚‚å…¨åŠ›ã ï¼ã€","ğŸ§™ã€Œã†ã‚€ã€è‰¯ã„æœã˜ã‚ƒã®ã†ã€ ğŸ¤–ã€Œæ°—æ¸©18åº¦ã€å­¦ç¿’ã«æœ€é©ã§ã™ã€ ğŸ˜ƒã€Œå¤©æ°—ã‚‚è‰¯ã„ã§ã™ã­ã€","ğŸ˜ˆã€Œé…åˆ»ã™ã‚‹ãªï¼ã€ ğŸ˜ƒã€Œã¾ã€ã¾ã é–‹å§‹10åˆ†å‰ã§ã™ã‚ˆ...ã€"];return t[Math.floor(Math.random()*t.length)]}if(r>=12&&r<13){const t=["ğŸ˜¼ã€Œè…¹æ¸›ã£ãŸã€œï¼ã€ ğŸ˜ƒã€ŒãŠå¼å½“è²·ã£ã¦ãã¾ã—ãŸã‚ˆã€ ğŸ˜ˆã€Œæ˜¼ä¼‘ã¿ã¯30åˆ†ã ãã€","ğŸ§™ã€Œä»Šæ—¥ã®å®šé£Ÿã¯ä½•ã‹ã®ã†ã€ ğŸ¤–ã€Œã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—ãŒå¿…è¦ã§ã™ã€ ğŸ˜ƒã€Œã¿ã‚“ãªã§é£Ÿã¹ã¾ã—ã‚‡ã†ã€","ğŸ˜ˆã€Œé£Ÿå¾Œã¯ä¼‘ã‚€ãªï¼ã€ ğŸ˜ƒã€Œæ¶ˆåŒ–ã«æ‚ªã„ã§ã™ã‚ˆ...ã€ ğŸ˜¼ã€Œå°‘ã—ã¯ä¼‘ã‚‚ã†ãœï¼ã€"];return t[Math.floor(Math.random()*t.length)]}if(r>=17&&r<19){const t=["ğŸ˜ƒã€Œä»Šæ—¥ã‚‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€ ğŸ˜ˆã€Œã¾ã çµ‚ã‚ã£ã¦ãªã„ã€ ğŸ˜¼ã€Œã„ã‚„ã€ååˆ†é ‘å¼µã£ãŸã£ã¦ï¼ã€","ğŸ§™ã€Œæ—¥ãŒæš®ã‚Œã¦ããŸã®ã†ã€ ğŸ¤–ã€Œ17æ™‚32åˆ†ã€å®šåˆ»ã§ã™ã€ ğŸ˜ƒã€Œã¿ã‚“ãªé ‘å¼µã‚Šã¾ã—ãŸã­ã€","ğŸ˜¼ã€Œä»Šæ—¥ã®åçœä¼šã™ã‚‹ï¼Ÿã€ ğŸ˜ƒã€Œã„ã„ã§ã™ã­ã€ ğŸ˜ˆã€Œç„¡é§„è©±ã¯ã™ã‚‹ãªã€ ğŸ§™ã€Œãã‚Œã‚‚å¤§åˆ‡ã˜ã‚ƒãã€"];return t[Math.floor(Math.random()*t.length)]}if(r>=22){const t=["ğŸ˜ƒã€Œã‚‚ã†é…ã„ã§ã™ã­...ã€ ğŸ˜ˆã€Œå¸°ã‚Œï¼æ˜æ—¥ã«å‚™ãˆã‚ï¼ã€ ğŸ§™ã€Œç„¡ç†ã¯ã„ã‹ã‚“ãã€","ğŸ¤–ã€Œ22æ™‚ã‚’è¶…éã€‚ç¡çœ æ™‚é–“ç¢ºä¿ã‚’æ¨å¥¨ã€ ğŸ˜ƒã€Œãã†ã§ã™ã­ã€å¸°ã‚Šã¾ã—ã‚‡ã†ã€","ğŸ˜¼ã€Œå¤œé…ãã¾ã§ãŠç–²ã‚Œï¼ã€ ğŸ˜ƒã€Œæ˜æ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ã€ ğŸ˜ˆã€Œ...æ—©ãå¯ã‚ã€"];return t[Math.floor(Math.random()*t.length)]}return null}function oi(r){return r===10?"ğŸ˜¼ã€Œ10é€£ç¶šï¼ï¼ã€ ğŸ˜ˆã€Œã‚ˆã—ï¼ã€ ğŸ˜ƒã€Œã™ã”ã„ï¼ã€ ğŸ¤–ã€Œçµ±è¨ˆçš„ã«å„ªç§€ã€ ğŸ§™ã€Œè¦‹äº‹ã˜ã‚ƒã€":r===20?"ğŸ˜ˆã€Œ20é€£ç¶šã ã¨...ï¼ï¼Ÿã€ ğŸ˜ƒã€Œä¿¡ã˜ã‚‰ã‚Œã¾ã›ã‚“ï¼ã€ ğŸ˜¼ã€Œæœ€ã£é«˜ã ï¼ã€ ğŸ¤–ã€Œç•°å¸¸å€¤ã§ã™ï¼ˆè¤’ã‚è¨€è‘‰ï¼‰ã€ ğŸ§™ã€Œå¤©æ‰ã‹...ã€":r===50?"ğŸ˜ˆğŸ˜ƒğŸ˜¼ğŸ¤–ğŸ§™ã€Œã€Œã€Œã€Œã€Œ50é€£ç¶šï¼ï¼ï¼ï¼ï¼ã€ã€ã€ã€ã€ï¼ˆå…¨å“¡ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚ªãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰":null}function li(){const r=new Date,t=r.getMonth()+1,s=r.getDate(),n=r.getDay();return n===1?"ğŸ˜ƒã€Œä»Šé€±ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ã€ ğŸ˜ˆã€Œæœˆæ›œã‹ã‚‰é£›ã°ã›ï¼ã€ ğŸ˜¼ã€Œé€±ã®å§‹ã¾ã‚Šã ï¼ã€":n===5?"ğŸ˜¼ã€Œé‡‘æ›œã ï¼ã‚ã¨å°‘ã—ï¼ã€ ğŸ˜ƒã€Œã§ã‚‚æ°—ã‚’æŠœã‹ãšã«ã€ ğŸ˜ˆã€Œæœ€å¾Œã¾ã§æ°—åˆã ï¼ã€":t===12&&s===25?"ğŸ˜ƒã€Œãƒ¡ãƒªãƒ¼ã‚¯ãƒªã‚¹ãƒã‚¹ï¼ã€ ğŸ˜ˆã€Œæµ®ã‹ã‚Œã‚‹ãªã€ ğŸ˜¼ã€ŒãŸã¾ã«ã¯ã„ã„ã ã‚ï¼ã€ ğŸ§™ã€Œã»ã£ã»ã£ã»ã€":t===1&&s===1?"ğŸ˜ƒğŸ˜ˆğŸ˜¼ğŸ¤–ğŸ§™ã€Œã€Œã€Œã€Œã€Œã‚ã‘ã¾ã—ã¦ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã€ã€ã€ã€ã€":null}const ci=[{type:"common-mistake",message:`ğŸ˜ƒã€Œ"I'm exciting"ã£ã¦è¨€ã£ã¦ã¾ã›ã‚“ã‹ï¼Ÿæ­£ã—ãã¯"I'm excited"ã§ã™ã‚ˆã€‚è‡ªåˆ†ãŒãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã¦ã‚‹æ™‚ã¯edå½¢ã§ã™ï¼ã€`,teacher:"kind-teacher"},{type:"common-mistake",message:`ã€Œ"I'm boring"ã¯ã€Œç§ã¯é€€å±ˆãªäººé–“ã ã€ã¨ã„ã†æ„å‘³ã ãï¼"I'm bored"ãŒæ­£è§£ã ï¼é–“é•ãˆã‚‹ãªï¼ã€`,teacher:"drill-sergeant"},{type:"common-mistake",message:'ğŸ¤–ã€Œ"funny"ã¨"fun"ã¯ç•°ãªã‚Šã¾ã™ã€‚"funny"ã¯ã€Œé¢ç™½ã„ï¼ˆç¬‘ãˆã‚‹ï¼‰ã€ã€"fun"ã¯ã€Œæ¥½ã—ã„ã€ã€‚ä½¿ã„åˆ†ã‘ãŒé‡è¦ã§ã™ã€‚ã€',teacher:"analyst"},{type:"common-mistake",message:'ğŸ˜ƒã€Œ"advice"ã¯æ•°ãˆã‚‰ã‚Œãªã„åè©ãªã®ã§ã€"an advice"ã¨ã¯è¨€ãˆã¾ã›ã‚“ã€‚"a piece of advice"ã¨è¨€ã„ã¾ã—ã‚‡ã†ï¼ã€',teacher:"kind-teacher"},{type:"common-mistake",message:'ã€Œ"How do you think?"ã¯é–“é•ã„ã ï¼"What do you think?"ãŒæ­£è§£ï¼ä½•åº¦è¨€ã‚ã›ã‚‹ï¼ã€',teacher:"drill-sergeant"},{type:"common-mistake",message:'ğŸ˜¼ã€Œ"see a dream"ã˜ã‚ƒãªã„ãï¼"have a dream"ã ï¼å¤¢ã¯è¦‹ã‚‹ã‚“ã˜ã‚ƒãªãã¦æŒã¤ã‚“ã ï¼ã€',teacher:"enthusiastic-coach"},{type:"common-mistake",message:'ğŸ§™ã€Œ"say"ã¨"tell"ã®é•ã„ã˜ã‚ƒãŒ..."say"ã¯å†…å®¹ã‚’ã€"tell"ã¯ç›¸æ‰‹ã‚’å¼·èª¿ã™ã‚‹ã®ã˜ã‚ƒã€‚"tell me"ã¨ã¯è¨€ãˆã‚‹ãŒ"say me"ã¨ã¯è¨€ãˆã¬ãã€‚ã€',teacher:"wise-sage"},{type:"common-mistake",message:'ğŸ˜ƒã€Œ"enjoy"ã®å¾Œã¯å¿…ãš-ingå½¢ã§ã™ã‚ˆï¼"enjoy to study"ã§ã¯ãªã"enjoy studying"ã§ã™ã€‚ã€',teacher:"kind-teacher"},{type:"common-mistake",message:'ğŸ¤–ã€Œ"remember to do"ï¼ˆã“ã‚Œã‹ã‚‰ã™ã‚‹ã“ã¨ã‚’è¦šãˆã¦ã„ã‚‹ï¼‰ã¨"remember doing"ï¼ˆã—ãŸã“ã¨ã‚’è¦šãˆã¦ã„ã‚‹ï¼‰ã¯æ„å‘³ãŒç•°ãªã‚Šã¾ã™ã€‚ã€',teacher:"analyst"},{type:"common-mistake",message:`ã€Œ"I'm agree"ã¯é–“é•ã„ã ï¼"agree"ã¯å‹•è©ã ã‹ã‚‰"I agree"ã ï¼åŸºæœ¬ã‚’å¿˜ã‚Œã‚‹ãªï¼ã€`,teacher:"drill-sergeant"}],di=[{type:"fun-fact",message:'ğŸ§™ã€Œæ¥é ­è¾"re-"ã¯ã€Œå†ã³ã€ã®æ„å‘³ã˜ã‚ƒã€‚returnï¼ˆæˆ»ã‚‹ï¼‰ã€reviewï¼ˆå¾©ç¿’ï¼‰ã€repeatï¼ˆç¹°ã‚Šè¿”ã™ï¼‰ãªã©ã€è¦šãˆã‚„ã™ã„ãã€‚ã€',teacher:"wise-sage"},{type:"fun-fact",message:"ğŸ¤–ã€Œé•·æ–‡èª­è§£ã®ã‚³ãƒ„ï¼šæœ€åˆã¨æœ€å¾Œã®æ®µè½ã€å„æ®µè½ã®æœ€åˆã®æ–‡ã‚’èª­ã‚ã°å…¨ä½“ã®æµã‚ŒãŒã¤ã‹ã‚ã¾ã™ã€‚ã€",teacher:"analyst"},{type:"fun-fact",message:'ğŸ˜ƒã€Œ"however"ï¼ˆã—ã‹ã—ï¼‰ã€"therefore"ï¼ˆã—ãŸãŒã£ã¦ï¼‰ã€"moreover"ï¼ˆã•ã‚‰ã«ï¼‰ãªã©ã®æ¥ç¶šè©ã‚’è¦šãˆã‚‹ã¨ã€è«–ç†å±•é–‹ãŒè¦‹ãˆã‚„ã™ããªã‚Šã¾ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"fun-fact",message:'ğŸ˜¼ã€Œæ¥å°¾è¾"-tion"ã‚’ã¤ã‘ã‚‹ã¨å‹•è©ãŒåè©ã«ãªã‚‹ãï¼educateâ†’educationã€communicateâ†’communicationã ï¼ã€',teacher:"enthusiastic-coach"},{type:"fun-fact",message:'ğŸ§™ã€Œ"compare A with B"ï¼ˆAã¨Bã‚’æ¯”è¼ƒã™ã‚‹ï¼‰ã¨"compare A to B"ï¼ˆAã‚’Bã«ä¾‹ãˆã‚‹ï¼‰ã¯æ„å‘³ãŒé•ã†ãã€‚è©¦é¨“ã§ã‚ˆãå‡ºã‚‹ã€‚ã€',teacher:"wise-sage"},{type:"fun-fact",message:"ğŸ¤–ã€ŒåŒç¾©èªã‚’å¢—ã‚„ã™ã¨è¡¨ç¾åŠ›ãŒä¸ŠãŒã‚Šã¾ã™ã€‚important=significant=crucialã€show=demonstrate=illustrate ãªã©ã€‚ã€",teacher:"analyst"},{type:"fun-fact",message:'ğŸ˜ƒã€Œæ¥é ­è¾"un-"ã€"in-"ã€"dis-"ã¯å¦å®šã®æ„å‘³ã€‚unhappyã€impossibleã€disagreeãªã©ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è¦šãˆã¾ã—ã‚‡ã†ï¼ã€',teacher:"kind-teacher"},{type:"fun-fact",message:'ã€Œ"not only A but also B"ï¼ˆAã ã‘ã§ãªãBã‚‚ï¼‰ã¯é »å‡ºæ§‹æ–‡ã ï¼ã‚»ãƒƒãƒˆã§è¦šãˆã‚ï¼ã€',teacher:"drill-sergeant"},{type:"fun-fact",message:'ğŸ§™ã€Œ"although"ã¨"though"ã¯ã»ã¼åŒã˜æ„å‘³ï¼ˆã€œã ã‘ã‚Œã©ã‚‚ï¼‰ã˜ã‚ƒãŒã€thoughã®æ–¹ãŒã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã˜ã‚ƒãªã€‚ã€',teacher:"wise-sage"},{type:"fun-fact",message:'ğŸ˜¼ã€Œæ¥å°¾è¾"-able"ã¯ã€Œã€œã§ãã‚‹ã€ã®æ„å‘³ã ï¼readableï¼ˆèª­ã‚ã‚‹ï¼‰ã€comfortableï¼ˆå¿«é©ãªï¼‰ã£ã¦æ„Ÿã˜ã ãï¼ã€',teacher:"enthusiastic-coach"}],ui=[{type:"cultural",message:"ğŸ˜ƒã€Œè‹±æ–‡ã‚¨ãƒƒã‚»ã‚¤ã¯çµè«–ã‚’æœ€åˆã«æ›¸ãã®ãŒåŸºæœ¬ã€‚Introductionâ†’Bodyâ†’Conclusionã®3éƒ¨æ§‹æˆã§ã™ã‚ˆã€‚ã€",teacher:"kind-teacher"},{type:"cultural",message:'ğŸ§™ã€Œè‹±èªã®è«–ç†å±•é–‹ã¯"ä¸»å¼µâ†’ç†ç”±â†’å…·ä½“ä¾‹"ãŒåŸºæœ¬ã˜ã‚ƒã€‚For example, For instance ã‚’ä½¿ã„ã“ãªãã†ã€‚ã€',teacher:"wise-sage"},{type:"cultural",message:"ğŸ¤–ã€Œå­¦è¡“çš„ãªæ–‡ç« ã§ã¯ã€contractionsï¼ˆçŸ­ç¸®å½¢ï¼‰ã¯ä½¿ã„ã¾ã›ã‚“ã€‚don'tâ†’do notã€it'sâ†’it is ã¨æ›¸ãã¾ã™ã€‚ã€",teacher:"analyst"},{type:"cultural",message:"ğŸ˜¼ã€Œæ„è¦‹ã‚’è¿°ã¹ã‚‹è¡¨ç¾ï¼I think, In my opinion, From my perspective ãªã©ã€ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å¢—ã‚„ãã†ï¼ã€",teacher:"enthusiastic-coach"},{type:"cultural",message:'ğŸ˜ƒã€Œç†ç”±ã‚’è¿°ã¹ã‚‹æ™‚ã¯"because"ã ã‘ã˜ã‚ƒãªãã€"since"ã€"as"ã€"due to"ãªã©ã‚‚ä½¿ãˆã¾ã™ã‚ˆã€‚ã€',teacher:"kind-teacher"},{type:"cultural",message:'ã€Œå—å‹•æ…‹ã‚’ä½¿ã„ã“ãªã›ï¼"The experiment was conducted"ãªã©ã€å®¢è¦³çš„ãªè¡¨ç¾ã«å¿…è¦ã ï¼ã€',teacher:"drill-sergeant"},{type:"cultural",message:'ğŸ§™ã€Œå¯¾æ¯”ã®è¡¨ç¾ï¼š"on the other hand"ï¼ˆä¸€æ–¹ã§ï¼‰ã€"in contrast"ï¼ˆå¯¾ç…§çš„ã«ï¼‰ã¯è«–è¿°å•é¡Œã§é‡å®ã™ã‚‹ãã€‚ã€',teacher:"wise-sage"}],mi=[{type:"etymology",message:'ğŸ§™ã€Œ"pre-"ã¯ã€Œå‰ã€ã®æ„å‘³ã˜ã‚ƒã€‚previewï¼ˆäºˆç¿’ãƒ»è©¦å†™ï¼‰ã€predictï¼ˆäºˆæ¸¬ã™ã‚‹ï¼‰ã€prepareï¼ˆæº–å‚™ã™ã‚‹ï¼‰ã¨è¦šãˆã‚ˆã†ã€‚ã€',teacher:"wise-sage"},{type:"etymology",message:'ğŸ¤–ã€Œ"post-"ã¯ã€Œå¾Œã€ã€‚postponeï¼ˆå»¶æœŸã™ã‚‹ï¼‰ã€postwarï¼ˆæˆ¦å¾Œã®ï¼‰ãªã©ã€‚pre-ã¨ã‚»ãƒƒãƒˆã§è¦šãˆã‚‹ã¨åŠ¹ç‡çš„ã§ã™ã€‚ã€',teacher:"analyst"},{type:"etymology",message:'ğŸ˜ƒã€Œ"tele-"ã¯ã‚®ãƒªã‚·ãƒ£èªã§ã€Œé ã„ã€ã¨ã„ã†æ„å‘³ã€‚telephoneï¼ˆé›»è©±ï¼‰ã€televisionï¼ˆãƒ†ãƒ¬ãƒ“ï¼‰ã€telescopeï¼ˆæœ›é é¡ï¼‰ã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"etymology",message:'ğŸ§™ã€Œ"bi-"ã¯ã€Œ2ã¤ã€ã®æ„å‘³ã˜ã‚ƒã€‚bicycleï¼ˆäºŒè¼ªè»Šï¼‰ã€bilingualï¼ˆ2è¨€èªè©±ã›ã‚‹ï¼‰ã€biweeklyï¼ˆéš”é€±ã®ï¼‰ã˜ã‚ƒãªã€‚ã€',teacher:"wise-sage"},{type:"etymology",message:'ğŸ˜¼ã€Œ"auto-"ã¯ã€Œè‡ªå‹•ãƒ»è‡ªå·±ã€ã ï¼automaticï¼ˆè‡ªå‹•ã®ï¼‰ã€autobiographyï¼ˆè‡ªä¼ï¼‰ã£ã¦æ„Ÿã˜ã ãï¼ã€',teacher:"enthusiastic-coach"},{type:"etymology",message:'ğŸ¤–ã€Œ"micro-"ã¯ã€Œå°ã•ã„ã€ã€"macro-"ã¯ã€Œå¤§ãã„ã€ã€‚microscopeï¼ˆé¡•å¾®é¡ï¼‰ã€macroeconomicsï¼ˆãƒã‚¯ãƒ­çµŒæ¸ˆå­¦ï¼‰ã§ã™ã€‚ã€',teacher:"analyst"},{type:"etymology",message:'ğŸ˜ƒã€Œ"sub-"ã¯ã€Œä¸‹ã€ã®æ„å‘³ã€‚subwayï¼ˆåœ°ä¸‹é‰„ï¼‰ã€submarineï¼ˆæ½œæ°´è‰¦ï¼‰ã€subtitleï¼ˆå­—å¹•ï¼‰ã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"etymology",message:'ğŸ§™ã€Œ"super-"ã¯ã€Œä¸Šãƒ»è¶…ã€ã˜ã‚ƒã€‚superiorï¼ˆå„ªã‚ŒãŸï¼‰ã€supernaturalï¼ˆè¶…è‡ªç„¶çš„ãªï¼‰ã€superviseï¼ˆç›£ç£ã™ã‚‹ï¼‰ã˜ã‚ƒãªã€‚ã€',teacher:"wise-sage"}],hi=[{type:"grammar-tip",message:'ğŸ˜ƒã€Œ"a"ã¨"an"ã®ä½¿ã„åˆ†ã‘ã¯ã€æ¬¡ã®å˜èªã®ã€ŒéŸ³ã€ã§æ±ºã¾ã‚Šã¾ã™ã€‚"an hour"ï¼ˆhourã®hã¯ç™ºéŸ³ã—ãªã„ï¼‰ã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"grammar-tip",message:'ã€Œç¾åœ¨å®Œäº†ã¯ã€Œä»Šã«é–¢ä¿‚ãŒã‚ã‚‹éå»ã€ã ï¼"I have lost my key"ã¯ä»Šã‚‚è¦‹ã¤ã‹ã£ã¦ãªã„ã¨ã„ã†æ„å‘³ã ï¼ã€',teacher:"drill-sergeant"},{type:"grammar-tip",message:'ğŸ¤–ã€Œ"fewer"ã¯æ•°ãˆã‚‰ã‚Œã‚‹åè©ã€"less"ã¯æ•°ãˆã‚‰ã‚Œãªã„åè©ã«ä½¿ã„ã¾ã™ã€‚"fewer people"ã€"less water"ã§ã™ã€‚ã€',teacher:"analyst"},{type:"grammar-tip",message:'ğŸ§™ã€Œ"used to"ã¯éå»ã®ç¿’æ…£ã€"be used to"ã¯æ…£ã‚Œã¦ã„ã‚‹ã€"get used to"ã¯æ…£ã‚Œã‚‹ã˜ã‚ƒã€‚å…¨ã¦é•ã†ãã€‚ã€',teacher:"wise-sage"},{type:"grammar-tip",message:'ğŸ˜¼ã€Œ"will"ã¯æ„å¿—ã€"be going to"ã¯äºˆå®šã‚„äºˆæ¸¬ã ï¼ä½¿ã„åˆ†ã‘ã‚‰ã‚Œã‚‹ã¨è‹±èªã£ã½ããªã‚‹ãï¼ã€',teacher:"enthusiastic-coach"},{type:"grammar-tip",message:'ğŸ˜ƒã€Œ"some"ã¨"any"ã€è‚¯å®šæ–‡ã¯someã€ç–‘å•æ–‡ãƒ»å¦å®šæ–‡ã¯anyãŒåŸºæœ¬ã§ã™ãŒã€"Would you like some tea?"ã®ã‚ˆã†ã«å‹§ã‚ã‚‹æ™‚ã¯someã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"grammar-tip",message:'ã€Œä¸‰å˜ç¾ã®sï¼å¿˜ã‚Œã‚‹ãªï¼"He go"ã§ã¯ãªã"He goes"ã ï¼åŸºæœ¬ä¸­ã®åŸºæœ¬ã ãï¼ã€',teacher:"drill-sergeant"}];function gi(r){if(Math.random()>.08)return null;if(r){const t=[...di,...mi,...ui];return t[Math.floor(Math.random()*t.length)].message}else{const t=[...ci,...hi];return t[Math.floor(Math.random()*t.length)].message}}function pi(r,t){const s=t&&(t.includes(" ")||t.includes("-")),n=["ğŸ˜ƒğŸ’¡ å—é¨“ãƒ†ã‚¯ï¼åŒã˜å˜èªã®ç¹°ã‚Šè¿”ã—ã‚’é¿ã‘ã‚‹ãŸã‚ã€ä»£åè©ï¼ˆit, they, thisï¼‰ã‚„åŒç¾©èªã«æ³¨ç›®ã™ã‚‹ã¨èª­è§£ãŒæ¥½ã«ãªã‚Šã¾ã™ã‚ˆã€‚","ğŸ§™ğŸ’¡ é•·æ–‡ã®ã‚³ãƒ„ï¼šè¨­å•ã‚’å…ˆã«èª­ã‚“ã§ã‹ã‚‰æœ¬æ–‡ã‚’èª­ã‚€ã¨ã€ä½•ã‚’æ¢ã›ã°ã„ã„ã‹åˆ†ã‹ã£ã¦åŠ¹ç‡çš„ã˜ã‚ƒã€‚","ğŸ¤–ğŸ’¡ çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ï¼šåˆç´šã¯ç´„1,077èªã€ä¸­ç´šã¯ç´„1,616èªã€ä¸Šç´šã¯ç´„885èªã§ã™ã€‚è¨ˆç”»çš„ã«èªå½™ã‚’å¢—ã‚„ã—ã¾ã—ã‚‡ã†ã€‚",'ğŸ’¡ æ™‚åˆ¶ã®ä¸€è‡´ï¼ä¸»ç¯€ãŒéå»å½¢ãªã‚‰å¾“å±ç¯€ã‚‚éå»å½¢ã ï¼"He said that he was tired"ã ãï¼',"ğŸ˜ƒğŸ’¡ æ•´åºå•é¡Œã®ã‚³ãƒ„ï¼ã¾ãšä¸»èªã¨å‹•è©ã‚’è¦‹ã¤ã‘ã¦ã€ä¿®é£¾èªã‚’å¾Œã‹ã‚‰ä»˜ã‘è¶³ã™ã¨è§£ãã‚„ã™ã„ã§ã™ã‚ˆã€‚",'ğŸ§™ğŸ’¡ å† è©ã®ä½¿ã„åˆ†ã‘ï¼š"a/an"ã¯åˆã‚ã¦å‡ºã‚‹ãƒ»ç‰¹å®šã§ããªã„ã‚‚ã®ã€"the"ã¯æ—¢å‡ºãƒ»ç‰¹å®šã§ãã‚‹ã‚‚ã®ã˜ã‚ƒã€‚',"ğŸ˜¼ğŸ’¡ ãƒªã‚¹ãƒ‹ãƒ³ã‚°å¯¾ç­–ï¼æ¶ˆå»æ³•ãŒæœ‰åŠ¹ã ï¼æ˜ã‚‰ã‹ã«é•ã†é¸æŠè‚¢ã‚’æ¶ˆã—ã¦ã„ãã¨æ­£è§£ç‡ãŒä¸ŠãŒã‚‹ãï¼","ğŸ¤–ğŸ’¡ åŠ¹ç‡çš„å­¦ç¿’æ³•ï¼šå˜èªã¯æ–‡è„ˆã®ä¸­ã§è¦šãˆã‚‹ã¨å®šç€ç‡ãŒ3å€ä»¥ä¸Šé«˜ã¾ã‚Šã¾ã™ã€‚ä¾‹æ–‡ã”ã¨è¦šãˆã¾ã—ã‚‡ã†ã€‚",'ğŸ˜ƒğŸ’¡ æ¯”è¼ƒè¡¨ç¾ï¼š"as...as"ï¼ˆåŒç­‰ï¼‰ã€"-er than"ï¼ˆæ¯”è¼ƒç´šï¼‰ã€"the -est"ï¼ˆæœ€ä¸Šç´šï¼‰ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ã‚‡ã†ï¼'];return s&&n.push("ğŸ˜¼ğŸ’¡ è¦šãˆæ–¹ï¼ç†Ÿèªã¯å‹•è©ã¨å‰ç½®è©ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’çµ„ã¿åˆã‚ã›ã¦è¦šãˆã‚‹ã¨ã„ã„ãï¼è¦–è¦šçš„ã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹ã¨å¿˜ã‚Œã«ãã„ãï¼"),n[Math.floor(Math.random()*n.length)]}function is({mode:r="translation",currentScore:t=0,totalAnswered:s=0,sessionCorrect:n=0,_sessionIncorrect:a=0,_sessionReview:i=0,isReviewFocusMode:l=!1,onReviewFocus:o,onShowSettings:c,currentWord:d,onAnswerTime:m,lastAnswerCorrect:h,lastAnswerWord:p,lastAnswerDifficulty:N,correctStreak:b=0,incorrectStreak:x=0,learningPhase:v,estimatedSpeed:k,forgettingRate:M,dataSource:S="",category:j="",difficulty:z="",wordPhraseFilter:V="",grammarUnit:ye,sessionStats:ue}){const[K,he]=u.useState("ai"),[Se,se]=u.useState(()=>{const g=localStorage.getItem("aiPersonality")||"kind-teacher";return Ja(g)||"ã“ã‚“ã«ã¡ã¯ï¼ä¸€ç·’ã«å­¦ç¿’ã—ã¾ã—ã‚‡ã†ã€‚"}),[fe,y]=u.useState("");u.useEffect(()=>{if(d){const g=localStorage.getItem("aiPersonality")||"kind-teacher",C=Gt(d);let I="";if(C){const{totalCount:G,correctCount:F}=C,B=G-F,ae=G>0?Math.round(F/G*100):0;if(G===0)switch(g){case"drill-sergeant":I="æ–°ã—ã„å˜èªã ï¼æ°—åˆã‚’å…¥ã‚Œã¦è¦šãˆã‚ï¼";break;case"kind-teacher":I="åˆã‚ã¦ã®å˜èªã§ã™ã­ã€‚ã˜ã£ãã‚Šè€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†";break;case"analyst":I="æ–°è¦å˜èªã€‚ãƒ‡ãƒ¼ã‚¿ãªã—ã€‚åˆå›æ¸¬å®šã‚’é–‹å§‹ã—ã¾ã™";break;case"enthusiastic-coach":I="æ–°ã—ã„ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã ï¼æ€ã„åˆ‡ã£ã¦è¡Œã“ã†ï¼";break;case"wise-sage":I="åˆã‚ã¦å‡ºä¼šã†å˜èªã˜ã‚ƒãªã€‚ç„¦ã‚‰ãšå‘ãåˆãŠã†";break;default:I="åˆã‚ã¦ã®å˜èªã§ã™"}else if(G===1){const be=F===1;switch(g){case"drill-sergeant":I=be?"2å›ç›®ã ï¼å‰å›ã¯æ­£è§£ã—ãŸãã€‚ã¾ãŸã‚„ã‚Œï¼":"2å›ç›®ã ï¼å‰å›ã¯é–“é•ãˆãŸã€‚ä»Šåº¦ã“ãæ±ºã‚ã‚ï¼";break;case"kind-teacher":I=be?"2å›ç›®ã®å‡ºé¡Œã§ã™ã€‚å‰å›ã¯æ­£è§£ã§ãã¾ã—ãŸã­":"2å›ç›®ã®å‡ºé¡Œã§ã™ã€‚å‰å›ã¯é–“é•ãˆã¦ã—ã¾ã„ã¾ã—ãŸãŒã€å¤§ä¸ˆå¤«ã§ã™";break;case"analyst":I=`2å›ç›®ã®å‡ºé¡Œã€‚å‰å›: ${be?"æ­£è§£":"ä¸æ­£è§£"}`;break;case"enthusiastic-coach":I=be?"2å›ç›®ï¼å‰å›ã¯å®Œç’§ã ã£ãŸãªï¼":"2å›ç›®ã®ãƒãƒ£ãƒ³ã‚¹ï¼å‰å›ã®ãƒªãƒ™ãƒ³ã‚¸ã ï¼";break;case"wise-sage":I=be?"2åº¦ç›®ã®å‡ºä¼šã„ã˜ã‚ƒã€‚å‰å›ã¯ã†ã¾ãã„ã£ãŸã®ã†":"2åº¦ç›®ã˜ã‚ƒãªã€‚å‰å›ã®çµŒé¨“ã‚’æ´»ã‹ãã†";break;default:I="2å›ç›®ã®å‡ºé¡Œã§ã™"}}else switch(g){case"drill-sergeant":ae>=80?I=`${G}å›ç›®ã ã€‚æ­£ç­”ç‡${ae}%ï¼ã„ã„èª¿å­ã ï¼`:ae>=50?I=`${G}å›ç›®ã€‚æ­£ç­”ç‡${ae}%ã€‚ã‚‚ã£ã¨ä¸Šã’ã‚ï¼`:I=`${G}å›ç›®ã€‚æ­£ç­”ç‡${ae}%ï¼è¦šãˆãŒæ‚ªã„ãï¼`;break;case"kind-teacher":ae>=80?I=`${G}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${ae}%ã€ã‚ˆãè¦šãˆã¦ã„ã¾ã™ã­`:ae>=50?I=`${G}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${ae}%ã€å°‘ã—ãšã¤è¦šãˆã¦ãã¦ã„ã¾ã™`:I=`${G}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${ae}%ã€ç¹°ã‚Šè¿”ã—ç·´ç¿’ã—ã¾ã—ã‚‡ã†`;break;case"analyst":I=`${G}å›ç›®ã®å‡ºé¡Œã€‚æ­£ç­”ç‡: ${ae}% (æ­£è§£${F}/ä¸æ­£è§£${B})`;break;case"enthusiastic-coach":ae>=80?I=`${G}å›ç›®ï¼æ­£ç­”ç‡${ae}%ï¼å®Œç’§ã«è¿‘ã„ãï¼`:I=`${G}å›ç›®ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼æ­£ç­”ç‡${ae}%ã€ã¾ã ä¼¸ã³ã‚‹ãï¼`;break;case"wise-sage":ae>=80?I=`${G}å›ç›®ã˜ã‚ƒãªã€‚æ­£ç­”ç‡${ae}%ã€ã‚ˆãå®šç€ã—ã¦ãŠã‚‹`:I=`${G}å›ç›®ã˜ã‚ƒã€‚æ­£ç­”ç‡${ae}%ã€ç„¦ã‚‰ãšç€å®Ÿã«ãª`;break;default:I=`${G}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${ae}%`}}else I="æ–°ã—ã„å•é¡Œã§ã™";se(I),y("")}},[d]),u.useEffect(()=>{if(h===void 0||!p||!d||p!==d)return;const g=localStorage.getItem("aiPersonality")||"kind-teacher",C=Ot(r||"translation"),I=C.todayTotalAnswered,G=C.todayAccuracy,F=s>0?(n||0)/s*100:0,ae={isCorrect:h,word:p,difficulty:N||z||"intermediate",category:j||"å…¨åˆ†é‡",attemptCount:1,responseTime:0,correctStreak:b,incorrectStreak:x,userAccuracy:F,categoryAccuracy:F,isWeakCategory:!1,hasSeenBefore:!1,previousAttempts:0,todayQuestions:I,todayAccuracy:G,planProgress:0,timeOfDay:zs(),learningPhase:v,estimatedSpeed:k,forgettingRate:M};let be=Wr(g,ae);if(Math.random()<.15){const Pe=[];if(Math.random()<.33){const L=pi(g,d);L&&Pe.push(L)}else if(Math.random()<.5){const L=li();L&&Pe.push(L)}else{const L=ii();L&&Pe.push(L)}Pe.length>0&&(be=`${be}

${Pe[0]}`)}y(be)},[m,h,p,N,b,x,r,s,n,j,z]);const P=u.useRef(null),R=u.useRef(null),U=u.useRef(null),[J,Z]=u.useState(()=>{const g=localStorage.getItem(`learning-limit-${r}`);return g?parseInt(g):null}),[ke,xe]=u.useState(()=>{const g=localStorage.getItem(`review-limit-${r}`);return g?parseInt(g):null}),[we,Le]=u.useState(()=>{const g=localStorage.getItem("memorization-still-learning-limit");return g?parseInt(g):null}),[Ze,Te]=u.useState(()=>{const g=localStorage.getItem("memorization-incorrect-limit");return g?parseInt(g):null}),[$e,He]=u.useState(!1);u.useEffect(()=>{if((r==="translation"||r==="spelling"||r==="grammar")&&ue&&o){const{incorrect:g,review:C}=ue,I=g+C;(J!==null&&I>=J||ke!==null&&C>=ke)&&(l||o())}},[ue,J,ke,l,r,o]);const[_e,ze]=u.useState(()=>{if(r==="grammar"){const{retentionRate:g,appearedCount:C}=Ht();return{retentionRate:g,appearedCount:C}}else{const{retentionRate:g,appearedCount:C}=Qt();return{retentionRate:g,appearedCount:C}}}),[We,oe]=u.useState(()=>r==="grammar"?zt():r==="memorization"?Dt():qt()),[Ie,qe]=u.useState(null),Fe=u.useMemo(()=>{const C=Re().wordProgress||{},I={once:0,twice:0,three:0,four:0,five:0,sixOrMore:0};return Object.values(C).forEach(G=>{const F=G.totalAttempts||0;F===1?I.once++:F===2?I.twice++:F===3?I.three++:F===4?I.four++:F===5?I.five++:F>=6&&I.sixOrMore++}),I},[m]),[Je,Be]=u.useState([]);u.useEffect(()=>{r==="grammar"&&Ws().then(g=>{if(ye){const C=ye.match(/g(\d+)-(?:unit|u)(\d+)/);if(C){const I=`ä¸­${C[1]}_Unit${C[2]}`,G=g.filter(F=>F.unit===I);Be(G)}else Be(g)}else Be(g)})},[r,m,ye]),u.useEffect(()=>{if(r==="grammar"){const{retentionRate:g,appearedCount:C}=Ht();ze({retentionRate:g,appearedCount:C}),oe(zt())}else if(r==="memorization"){oe(Dt());const g=Dt();ze({retentionRate:g.basicRetentionRate,appearedCount:g.appearedWords})}else{const{retentionRate:g,appearedCount:C}=Qt();ze({retentionRate:g,appearedCount:C}),oe(qt())}},[m,r]),u.useEffect(()=>{qe(d?Gt(d):null)},[d,m]),u.useEffect(()=>{if(P.current){const g=Math.round(We.masteredPercentage);P.current.style.setProperty("--segment-width",String(g)),P.current.setAttribute("data-width",String(g))}if(R.current){const g=Math.round(We.learningPercentage);R.current.style.setProperty("--segment-width",String(g)),R.current.setAttribute("data-width",String(g))}if(U.current){const g=Math.round(We.strugglingPercentage);U.current.style.setProperty("--segment-width",String(g)),U.current.setAttribute("data-width",String(g))}},[We,K,r]);const{todayAccuracy:et,todayTotalAnswered:je}=u.useMemo(()=>Ot(r),[r]);u.useMemo(()=>Ms(r),[r]),u.useMemo(()=>ss(),[]);const{retentionRate:T}=_e,w=We;return u.useMemo(()=>s>0?Math.round(t/s*100):0,[t,s]),e.jsxs("div",{className:"score-board-compact",children:[e.jsxs("div",{className:"score-board-tabs grid grid-cols-3 sm:grid-cols-5 gap-1 sm:gap-2",children:[e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${K==="ai"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>he("ai"),title:"AIã‚³ãƒ¡ãƒ³ãƒˆ",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ¤– AI"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ¤–"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${K==="plan"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>he("plan"),title:"ãƒ—ãƒ©ãƒ³",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“‹ ãƒ—ãƒ©ãƒ³"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“‹"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${K==="breakdown"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>he("breakdown"),title:"å­¦ç¿’çŠ¶æ³",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“ˆ å­¦ç¿’çŠ¶æ³"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“ˆ"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${K==="history"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>he("history"),title:"å±¥æ­´",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“œ å±¥æ­´"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“œ"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${K==="settings"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>{c?c():he("settings")},title:"å­¦ç¿’è¨­å®š",children:[e.jsx("span",{className:"hidden sm:inline",children:"âš™ï¸ å­¦ç¿’è¨­å®š"}),e.jsx("span",{className:"sm:hidden",children:"âš™ï¸"})]})]}),K==="ai"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsx("div",{className:"ai-comment-container",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("div",{className:"text-2xl flex-shrink-0",children:(()=>{const g=localStorage.getItem("aiPersonality")||"kind-teacher";return{"kind-teacher":"ğŸ˜ƒ","drill-sergeant":"ğŸ‘¹","enthusiastic-coach":"ğŸ˜¼",analyst:"ğŸ¤–","wise-sage":"ğŸ§™"}[g]||"ğŸ˜ƒ"})()}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-sm text-gray-700 leading-snug break-words",children:(fe||Se).replace(/^[ğŸ˜ƒğŸ‘¹ğŸ˜¼ğŸ¤–ğŸ§™]+ã€Œ?/gu,"").replace(/ã€$/gu,"").replace(/[âœ¨ğŸŒ¸ğŸ˜ŠğŸŒ±ğŸ’ªğŸ”¥ğŸ“ŠğŸ†]/gu,"").trim()})})]})})})}),K==="plan"&&e.jsx("div",{className:"score-board-content",children:e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:[e.jsxs("div",{className:"plan-text-line",children:[e.jsxs("span",{className:"stat-text-label",children:["ğŸ“š ",S||"å…¨å•é¡Œé›†"]}),e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("span",{className:"stat-text-label",children:j||"å…¨åˆ†é‡"}),e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("span",{className:"stat-text-label",children:z==="all"?"å…¨é›£æ˜“åº¦":z==="basic"?"åŸºç¤":z==="standard"?"æ¨™æº–":z==="advanced"?"ç™ºå±•":z}),(r==="translation"||r==="spelling"||r==="memorization")&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("button",{onClick:()=>He(!0),className:"stat-text-label cursor-pointer hover:text-primary transition-colors",title:"å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š",children:"âš™ï¸ ä¸Šé™è¨­å®š"})]}),V&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("span",{className:"stat-text-label",children:V==="all"?"å˜èªãƒ»ç†Ÿèª":V==="word"?"å˜èªã®ã¿":V==="phrase"?"ç†Ÿèªã®ã¿":"å˜èªãƒ»ç†Ÿèª"})]})]}),$e&&(r==="translation"||r==="spelling")&&e.jsx("div",{className:"plan-settings-modal",children:e.jsxs("div",{className:"plan-settings-content",children:[e.jsx("h4",{children:"ğŸ¯ å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š"}),e.jsx("p",{className:"plan-settings-description",children:"0ã‚’é¸æŠã™ã‚‹ã¨ç„¡åˆ¶é™ã«å‡ºé¡Œã—ã¾ã™"}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"å­¦ç¿’ä¸­ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"å­¦ç¿’ä¸­ã®èªæ•°ä¸Šé™",value:J||0,onChange:g=>{const C=parseInt(g.target.value),I=C===0?null:C;Z(I),I===null?localStorage.removeItem(`learning-limit-${r}`):localStorage.setItem(`learning-limit-${r}`,I.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"è¦å¾©ç¿’ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"è¦å¾©ç¿’ã®èªæ•°ä¸Šé™",value:ke||0,onChange:g=>{const C=parseInt(g.target.value),I=C===0?null:C;xe(I),I===null?localStorage.removeItem(`review-limit-${r}`):localStorage.setItem(`review-limit-${r}`,I.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsx("button",{className:"plan-settings-close",onClick:()=>He(!1),children:"é–‰ã˜ã‚‹"})]})}),$e&&r==="memorization"&&e.jsx("div",{className:"plan-settings-modal",children:e.jsxs("div",{className:"plan-settings-content",children:[e.jsx("h4",{children:"ğŸ¯ å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š"}),e.jsx("p",{className:"plan-settings-description",children:"0ã‚’é¸æŠã™ã‚‹ã¨ç„¡åˆ¶é™ã«å‡ºé¡Œã—ã¾ã™"}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"ã¾ã ã¾ã ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"ã¾ã ã¾ã ã®èªæ•°ä¸Šé™",value:we||0,onChange:g=>{const C=parseInt(g.target.value),I=C===0?null:C;Le(I),I===null?localStorage.removeItem("memorization-still-learning-limit"):localStorage.setItem("memorization-still-learning-limit",I.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™",value:Ze||0,onChange:g=>{const C=parseInt(g.target.value),I=C===0?null:C;Te(I),I===null?localStorage.removeItem("memorization-incorrect-limit"):localStorage.setItem("memorization-incorrect-limit",I.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsx("button",{className:"plan-settings-close",onClick:()=>He(!1),children:"é–‰ã˜ã‚‹"})]})})]})}),K==="breakdown"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsxs("div",{className:"retention-breakdown-container",children:[e.jsxs("div",{className:"retention-breakdown-header",children:[e.jsxs("div",{style:{marginBottom:"8px",fontSize:"14px",color:"#666"},children:["å‡ºé¡Œæ•°ï¼š1å› ",Fe.once,"å• 2å› ",Fe.twice,"å• 3å›"," ",Fe.three,"å• 4å› ",Fe.four,"å• 5å› ",Fe.five,"å• 6å›ä»¥ä¸Š ",Fe.sixOrMore,"å•"]}),w.appearedWords>0?e.jsx("div",{className:"retention-subtitle",children:r==="memorization"?e.jsxs(e.Fragment,{children:[w.appearedWords,"èªç¢ºèªï¼š ğŸŸ¢è¦šãˆã¦ã‚‹"," ",w.masteredCount,"èª ğŸŸ¡ã¾ã ã¾ã  ",w.learningCount,"èª ğŸ”´åˆ†ã‹ã‚‰ãªã„ ",w.strugglingCount,"èª",o&&e.jsx("span",{className:`review-mode-icon ${l?"active":""}`,onClick:o,title:l?"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰è§£é™¤":"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰é–‹å§‹",children:"ğŸ”¥"})]}):r==="grammar"?e.jsxs(e.Fragment,{children:[w.appearedWords,"å•å‡ºé¡Œï¼š ğŸŸ¢å®šç€ ",w.masteredCount,"å• ğŸŸ¡å­¦ç¿’ä¸­ ",w.learningCount,"å• ğŸ”´è¦å¾©ç¿’"," ",w.strugglingCount,"å•",o&&e.jsx("span",{className:`review-mode-icon ${l?"active":""}`,onClick:o,title:l?"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰è§£é™¤":"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰é–‹å§‹",children:"ğŸ”¥"})]}):e.jsxs(e.Fragment,{children:[w.appearedWords,"å•å‡ºé¡Œï¼š ğŸŸ¢å®šç€ ",w.masteredCount,"èª ğŸŸ¡å­¦ç¿’ä¸­ ",w.learningCount,"èª ğŸ”´è¦å¾©ç¿’"," ",w.strugglingCount,"èª",(r==="translation"||r==="spelling")&&o&&e.jsx("span",{className:`review-mode-icon ${l?"active":""}`,onClick:o,title:l?"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰è§£é™¤":"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰é–‹å§‹",children:"ğŸ”¥"})]})}):e.jsx("div",{className:"retention-subtitle",children:r==="memorization"?"ã¾ã èªå¥ã‚’ç¢ºèªã—ã¦ã„ã¾ã›ã‚“":"ã¾ã å•é¡Œã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã›ã‚“"})]}),w.appearedWords>0&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"retention-progress-bar",children:r==="memorization"?e.jsxs(e.Fragment,{children:[w.masteredPercentage>0&&e.jsx("div",{ref:P,className:"retention-segment retention-mastered","data-width":Math.round(w.masteredPercentage),title:`ğŸŸ¢ è¦šãˆã¦ã‚‹: ${w.masteredCount}èª (${Math.round(w.masteredPercentage)}%)`,children:w.masteredPercentage>=10&&e.jsxs("span",{children:[Math.round(w.masteredPercentage),"%"]})}),w.learningCount>0&&e.jsx("div",{ref:R,className:"retention-segment retention-learning","data-width":Math.round(w.learningPercentage),title:`ğŸŸ¡ ã¾ã ã¾ã : ${w.learningCount}èª (${Math.round(w.learningPercentage)}%)`,children:w.learningPercentage>=10&&e.jsxs("span",{children:[Math.round(w.learningPercentage),"%"]})}),w.strugglingCount>0&&e.jsx("div",{ref:U,className:"retention-segment retention-struggling","data-width":Math.round(w.strugglingPercentage),title:`ğŸ”´ åˆ†ã‹ã‚‰ãªã„: ${w.strugglingCount}èª (${Math.round(w.strugglingPercentage)}%)`,children:w.strugglingPercentage>=10&&e.jsxs("span",{children:[Math.round(w.strugglingPercentage),"%"]})})]}):e.jsxs(e.Fragment,{children:[w.masteredPercentage>0&&e.jsx("div",{ref:P,className:"retention-segment retention-mastered","data-width":Math.round(w.masteredPercentage),title:`ğŸŸ¢ å®šç€: ${w.masteredCount}èª (${Math.round(w.masteredPercentage)}%)`,children:w.masteredPercentage>=10&&e.jsxs("span",{children:[Math.round(w.masteredPercentage),"%"]})}),w.learningPercentage>0&&e.jsx("div",{ref:R,className:"retention-segment retention-learning","data-width":Math.round(w.learningPercentage),title:`ğŸŸ¡ å­¦ç¿’ä¸­: ${w.learningCount}èª (${Math.round(w.learningPercentage)}%)`,children:w.learningPercentage>=10&&e.jsxs("span",{children:[Math.round(w.learningPercentage),"%"]})}),w.strugglingPercentage>0&&e.jsx("div",{ref:U,className:"retention-segment retention-struggling","data-width":Math.round(w.strugglingPercentage),title:`ğŸ”´ è¦å¾©ç¿’: ${w.strugglingCount}èª (${Math.round(w.strugglingPercentage)}%)`,children:w.strugglingPercentage>=10&&e.jsxs("span",{children:[Math.round(w.strugglingPercentage),"%"]})})]})})})]})})}),K==="history"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsx("div",{className:"history-compact",children:r==="grammar"?e.jsx("div",{className:"word-detail-container",children:Je.length>0?e.jsx("div",{className:"grammar-units-list",children:Je.map(g=>{const C=(g.correctCount||0)+(g.incorrectCount||0),I=g.masteredCount||0,G=g.answeredQuestions||0,F=G>0?Math.round(I/G*100):0,B=g.historyIcons||"";let ae="ğŸŸ¢",be="å®šç€æ¸ˆ";I===0&&G>0?(ae="ğŸ”´",be="è¦å¾©ç¿’"):F<80&&G>0&&(ae="ğŸŸ¡",be="å­¦ç¿’ä¸­");const Pe=g.unit.match(/ä¸­(\d+)/),L=Pe?`${Pe[1]}å¹´`:g.unit,ee=g.unit.match(/Unit(\d+)/),q=ee?`Unit${ee[1]}`:"",_=q?`${L} ${q}ï¼š${g.title}`:`${L}ï¼š${g.title}`;return e.jsxs("div",{className:"grammar-unit-card",children:[e.jsxs("div",{className:"word-detail-title",children:["ğŸ“Š ",_," ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿",e.jsxs("span",{className:"word-status-badge",children:[ae," ",be]})]}),e.jsxs("div",{className:"word-detail-stats",children:[e.jsx("span",{className:"word-stat-label",children:"æ­£è§£:"}),e.jsxs("strong",{className:"word-stat-value",children:[g.correctCount,"/",C,"å›"]}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"}),B&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"word-stat-label",children:"å±¥æ­´:"}),e.jsx("span",{className:"word-history-icons",children:B}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"})]}),e.jsx("span",{className:"word-stat-label",children:"å®šç€ç‡:"}),e.jsxs("strong",{className:"word-stat-value word-retention-rate",children:[F,"%"]})]})]},g.unit)})}):e.jsxs("div",{className:"word-detail-empty",children:[e.jsx("p",{children:"ã¾ã æ–‡æ³•å•é¡Œã®è§£ç­”ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"stat-text-sub",children:"å•é¡Œã‚’è§£ãã¨å˜å…ƒã”ã¨ã®æˆç¸¾ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"})]})}):d&&Ie?e.jsxs("div",{className:"word-detail-container",children:[e.jsxs("div",{className:"word-detail-title",children:["ğŸ“Š ",d," ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿",e.jsxs("span",{className:"word-status-badge",children:[Ie.statusIcon," ",Ie.statusLabel]})]}),e.jsxs("div",{className:"word-detail-stats",children:[e.jsx("span",{className:"word-stat-label",children:"æ­£è§£:"}),e.jsxs("strong",{className:"word-stat-value",children:[Ie.correctCount,"/",Ie.totalCount,"å›"]}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"}),Ie.accuracyHistory&&Ie.accuracyHistory.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"word-stat-label",children:"å±¥æ­´:"}),e.jsx("span",{className:"word-history-icons",children:Ie.accuracyHistory}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"})]}),e.jsx("span",{className:"word-stat-label",children:"å®šç€ç‡:"}),e.jsxs("strong",{className:"word-stat-value word-retention-rate",children:[Ie.retentionRate,"%"]})]})]}):d&&!Ie?e.jsx("div",{className:"word-detail-empty",children:e.jsx("p",{children:"ã“ã®å˜èªã®ãƒ‡ãƒ¼ã‚¿ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“"})}):e.jsx("div",{className:"word-detail-empty",children:e.jsx("p",{children:"å•é¡Œã‚’é–‹å§‹ã™ã‚‹ã¨ã€ç¾åœ¨ã®å˜èªã®ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"})})})})}),K==="settings"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsx("div",{className:"settings-tab-container",children:e.jsx("div",{className:"word-detail-empty",children:e.jsx("p",{children:"ã“ã®ã‚¿ãƒ–ã®è¨­å®šã¯å­¦ç¿’è¨­å®šãƒ‘ãƒãƒ«ã‹ã‚‰è¡Œãˆã¾ã™"})})})})})]})}const ms=[{id:"beginner-basic",name:"åˆç´šåŸºç¤",requiredWords:600,requiredAccuracy:70,description:"åŸºæœ¬çš„ãªå˜èª",icon:"ğŸŒ±"},{id:"beginner-complete",name:"åˆç´šå®Œäº†",requiredWords:1077,requiredAccuracy:70,description:"åˆç´šãƒ¬ãƒ™ãƒ«å®Œå…¨ç¿’å¾—",icon:"ğŸŒ¿"},{id:"intermediate-half",name:"ä¸­ç´šåŠåˆ†",requiredWords:1900,requiredAccuracy:75,description:"ä¸­ç´šãƒ¬ãƒ™ãƒ«50%",icon:"ğŸŒ³"},{id:"intermediate-complete",name:"ä¸­ç´šå®Œäº†",requiredWords:2693,requiredAccuracy:75,description:"ä¸­ç´šãƒ¬ãƒ™ãƒ«å®Œå…¨ç¿’å¾—",icon:"ğŸ“"},{id:"advanced-half",name:"ä¸Šç´šåŠåˆ†",requiredWords:3150,requiredAccuracy:80,description:"ä¸Šç´šãƒ¬ãƒ™ãƒ«50%",icon:"ğŸ“š"},{id:"advanced-complete",name:"ä¸Šç´šå®Œäº†",requiredWords:3578,requiredAccuracy:80,description:"ä¸Šç´šãƒ¬ãƒ™ãƒ«å®Œå…¨ç¿’å¾—",icon:"ğŸš€"},{id:"master",name:"ãƒã‚¹ã‚¿ãƒ¼",requiredWords:4e3,requiredAccuracy:85,description:"å…¨ãƒ¬ãƒ™ãƒ«åˆ¶è¦‡",icon:"â­"}];function fi(){const r=localStorage.getItem("user-goal-level");if(r){const t=JSON.parse(r),s=ms.find(n=>n.id===t);if(s)return s}return ms.find(t=>t.id==="intermediate-complete")||ms[0]}function qr(r){const t=r||fi(),s=Re(),n=ss();let a=0,i=0;Object.values(s.wordProgress).forEach(b=>{a+=b.correctCount,i+=b.correctCount+b.incorrectCount});const l=i>0?a/i*100:0,o=Math.min(100,n/t.requiredWords*100),c=Math.min(100,l/t.requiredAccuracy*100),d=(o+c)/2,m=n>=t.requiredWords&&l>=t.requiredAccuracy,h=xi(n,t.requiredWords,l,t.requiredAccuracy),p=Math.max(0,t.requiredWords-n),N=h>0?Math.ceil(p/h):0;return{goal:t,currentWords:n,currentAccuracy:Math.round(l),wordsProgress:Math.round(o),accuracyProgress:Math.round(c),overallProgress:Math.round(d),isAchieved:m,estimatedDaysToAchieve:h,recommendedDailyWords:Math.min(50,N)}}function xi(r,t,s,n){if(r>=t&&s>=n)return 0;const a=Re(),l=Date.now()-7*24*60*60*1e3;let o=0;Object.values(a.wordProgress).forEach(x=>{x.lastStudied>=l&&x.masteryLevel==="mastered"&&o++});const c=o/7,d=Math.max(5,c),h=Math.max(0,t-r)/d,N=Math.max(0,n-s)*2,b=Math.ceil(h+N);return Math.max(1,b)}function Wo(r=!0){const t=qr();if(t.isAchieved)return`ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼${t.goal.name}ãƒ¬ãƒ™ãƒ«ã‚’é”æˆã—ã¾ã—ãŸï¼`;const s=[];if(s.push(`${t.goal.icon} ${t.goal.name}ã¾ã§ ${t.overallProgress}%`),t.currentWords<t.goal.requiredWords){const n=t.goal.requiredWords-t.currentWords;s.push(`ã‚ã¨${n}èª`)}return t.estimatedDaysToAchieve>0&&(t.estimatedDaysToAchieve<=7?s.push(`ã‚ã¨${t.estimatedDaysToAchieve}æ—¥ã§é”æˆï¼`):t.estimatedDaysToAchieve<=30?s.push(`ç´„${Math.ceil(t.estimatedDaysToAchieve/7)}é€±é–“ã§é”æˆè¦‹è¾¼ã¿`):s.push(`ç´„${Math.ceil(t.estimatedDaysToAchieve/30)}ãƒ¶æœˆã§é”æˆè¦‹è¾¼ã¿`)),r&&(t.overallProgress>=80?s.push("ã‚‚ã†å°‘ã—ã§é”æˆã§ã™ï¼é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼"):t.overallProgress>=50?s.push("é †èª¿ã«é€²ã‚“ã§ã„ã¾ã™ï¼ã“ã®èª¿å­ã§ç¶šã‘ã¾ã—ã‚‡ã†ï¼"):t.overallProgress>=25&&s.push("ç€å®Ÿã«é€²æ­©ã—ã¦ã„ã¾ã™ï¼")),s.join(" ")}const yi={accept:["except"],except:["accept"],affect:["effect"],effect:["affect"],dessert:["desert"],desert:["dessert"],quiet:["quite"],quite:["quiet"],lose:["loose"],loose:["lose"],advice:["advise"],advise:["advice"],breath:["breathe"],breathe:["breath"],cloth:["clothe","clothes"],clothe:["cloth","clothes"],clothes:["cloth","clothe"],borrow:["lend"],lend:["borrow"],teach:["learn"],learn:["teach"],speak:["talk","say","tell"],talk:["speak","say","tell"],say:["speak","talk","tell"],tell:["speak","talk","say"],see:["look","watch"],look:["see","watch"],watch:["see","look"],hear:["listen"],listen:["hear"],bring:["take"],take:["bring"],come:["go"],go:["come"],in:["on","at"],on:["in","at"],at:["in","on"],for:["to","of"],to:["for","of"],of:["for","to"],already:["all ready"],"all ready":["already"],altogether:["all together"],"all together":["altogether"],everyday:["every day"],"every day":["everyday"]};function zr(r){const t=r.toLowerCase();return yi[t]||[]}function vi(){const r=Re(),t=[],s=new Set;return Object.entries(r.wordProgress).forEach(([n])=>{if(s.has(n.toLowerCase()))return;const a=zr(n);if(a.length===0)return;const i=[n,...a].map(p=>p.toLowerCase()),l=Array.from(new Set(i));let o=0,c=0;l.forEach(p=>{const N=r.wordProgress[p];N&&(o+=N.incorrectCount,c+=N.correctCount+N.incorrectCount)});const d=c>0?o/c:0,m=Math.min(100,d*100*Math.log1p(c));let h="spelling";["speak","talk","say","tell","see","look","watch"].includes(n.toLowerCase())?h="meaning":["in","on","at","for","to","of"].includes(n.toLowerCase())&&(h="grammar"),t.push({words:l,type:h,description:wi(l,h),confusionScore:Math.round(m),totalErrors:o,needsReview:m>30||d>.3}),l.forEach(p=>s.add(p))}),t.filter(n=>n.totalErrors>0).sort((n,a)=>a.confusionScore-n.confusionScore)}function wi(r,t){return t==="spelling"?`ã‚¹ãƒšãƒ«ãŒä¼¼ã¦ã„ã‚‹: ${r.join(", ")}`:t==="meaning"?`æ„å‘³ãŒä¼¼ã¦ã„ã‚‹: ${r.join(", ")}`:`æ–‡æ³•çš„ã«æ··åŒã—ã‚„ã™ã„: ${r.join(", ")}`}function bi(r){const t=Re(),s={},n=[];r.words.forEach(l=>{const o=t.wordProgress[l];if(o){const c=o.correctCount+o.incorrectCount,d=c>0?o.correctCount/c*100:0;s[l]=d,n.push(d)}});const a=n.length>0?n.reduce((l,o)=>l+o,0)/n.length:0,i=n.length>0?n.reduce((l,o)=>l+Math.pow(o-a,2),0)/n.length:0;return{groupRetention:Math.round(a),individualRetentions:s,variance:Math.round(i)}}function ji(r){const t=bi(r);return t.groupRetention<50?`âš ï¸ ${r.words.join(", ")} ã®åŒºåˆ¥ãŒæ›–æ˜§ã§ã™ã€‚é›†ä¸­çš„ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚`:t.variance>500?`ğŸ“Š ${r.words.join(", ")} ã§å®šç€åº¦ã«ã°ã‚‰ã¤ããŒã‚ã‚Šã¾ã™ã€‚å¼±ã„å˜èªã‚’é‡ç‚¹çš„ã«ã€‚`:t.groupRetention<70?`ğŸ’ª ${r.words.join(", ")} ã‚’ã‚‚ã†å°‘ã—ç·´ç¿’ã™ã‚‹ã¨å®Œç’§ã§ã™ï¼`:`âœ… ${r.words.join(", ")} ã®åŒºåˆ¥ãŒã—ã£ã‹ã‚Šã§ãã¦ã„ã¾ã™ï¼`}function Ni(r){const t=/^[^:]+:\s*[""](.+?)[""]$/,s=r.match(t);if(s)return s[1].trim();const n=/^[^:]+:\s*(.+)$/,a=r.match(n);return a?a[1].trim():r}function st(r,t={}){if(!("speechSynthesis"in window)){f.warn("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯Web Speech APIã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“");return}const s=Ni(r);if(window.speechSynthesis.speaking||window.speechSynthesis.pending){window.speechSynthesis.cancel(),setTimeout(()=>{Zs(s,t)},50);return}Zs(s,t)}function Zs(r,t){const s=new SpeechSynthesisUtterance(r),n=localStorage.getItem("speechRate"),a=localStorage.getItem("voiceGender");s.lang=t.lang||"en-US",s.rate=t.rate||(n?parseFloat(n):.85),s.pitch=t.pitch||1,s.volume=t.volume||1;const l=window.speechSynthesis.getVoices().filter(c=>c.lang.startsWith("en-")),o=["Google US English","Google UK English Female","Google UK English Male","Samantha","Alex","Microsoft Aria Online","Microsoft Guy Online","Karen","Daniel"];if(a==="female"){const c=l.find(d=>o.some(m=>d.name.includes(m)))||l.find(d=>d.name.toLowerCase().includes("female")||d.name.toLowerCase().includes("woman")||d.name.toLowerCase().includes("samantha")||d.name.toLowerCase().includes("karen")||d.name.toLowerCase().includes("aria"));c&&(s.voice=c)}else if(a==="male"){const c=l.find(d=>o.some(m=>d.name.includes(m)))||l.find(d=>d.name.toLowerCase().includes("male")||d.name.toLowerCase().includes("man")||d.name.toLowerCase().includes("alex")||d.name.toLowerCase().includes("daniel")||d.name.toLowerCase().includes("guy"));c&&(s.voice=c)}else{const c=l.find(d=>o.some(m=>d.name.includes(m)));c&&(s.voice=c)}s.onerror=c=>{f.error("éŸ³å£°åˆæˆã‚¨ãƒ©ãƒ¼:",c)},window.speechSynthesis.speak(s)}function Ge(){return"speechSynthesis"in window}function Si(){"speechSynthesis"in window&&window.speechSynthesis.cancel()}function ki(){"speechSynthesis"in window&&window.speechSynthesis.speaking&&window.speechSynthesis.pause()}function Ci(){"speechSynthesis"in window&&window.speechSynthesis.paused&&window.speechSynthesis.resume()}function Di(){return"speechSynthesis"in window&&window.speechSynthesis.speaking}function Mi(){return"speechSynthesis"in window&&window.speechSynthesis.paused}const At=({word:r,sets:t,onAddWord:s,onRemoveWord:n,onOpenManagement:a,size:i="medium",variant:l="icon"})=>{const[o,c]=u.useState(!1),d=t.filter(x=>x.words.some(v=>v.word===r.word)),m=d.length>0,h={small:"text-sm px-2 py-1",medium:"text-base px-3 py-1.5",large:"text-lg px-4 py-2"},p={small:"text-base",medium:"text-lg",large:"text-xl"},N=x=>{if(x.stopPropagation(),t.length===0){a();return}if(t.length===1){const v=t[0];m?n(v.id,r):s(v.id,r)}else c(!o)},b=(x,v)=>{v?n(x,r):s(x,r)};return e.jsxs("div",{className:"relative inline-block",children:[e.jsxs("button",{onClick:N,className:`
          ${h[i]}
          ${m?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}
          rounded-md font-medium transition-colors duration-200
          flex items-center gap-1
        `,title:m?`${d.length}å€‹ã®ã‚»ãƒƒãƒˆã«è¿½åŠ æ¸ˆã¿`:"ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã«è¿½åŠ ",children:[e.jsx("span",{className:p[i],children:m?"âœ“":"+"}),l!=="icon"&&e.jsx("span",{children:m?"è¿½åŠ æ¸ˆã¿":"è¿½åŠ "})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>c(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-80 overflow-y-auto",children:[e.jsx("div",{className:"p-2 border-b border-gray-200",children:e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"ã‚»ãƒƒãƒˆã‚’é¸æŠ"})}),e.jsx("div",{className:"p-2",children:t.map(x=>{const v=x.words.some(k=>k.word===r.word);return e.jsxs("button",{onClick:()=>{b(x.id,v),c(!1)},className:`
                      w-full text-left px-3 py-2 rounded-md mb-1
                      flex items-center justify-between
                      ${v?"bg-green-50 text-green-700":"hover:bg-gray-100:bg-gray-700 text-gray-700"}
                    `,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{children:x.icon||"ğŸ“–"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:x.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[x.words.length,"èª"]})]})]}),e.jsx("span",{className:"text-lg ml-2",children:v?"âœ“":"+"})]},x.id)})}),e.jsx("div",{className:"p-2 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{c(!1),a()},className:"w-full text-left px-3 py-2 rounded-md hover:bg-gray-100:bg-gray-700 text-blue-600 text-sm font-medium",children:"â• æ–°ã—ã„ã‚»ãƒƒãƒˆã‚’ä½œæˆ"})})]})]})]})};function er({question:r,allQuestions:t,currentIndex:s,answered:n,selectedAnswer:a,onAnswer:i,onNext:l,onPrevious:o,onDifficultyRate:c,customQuestionSets:d=[],onAddWordToCustomSet:m,onRemoveWordFromCustomSet:h,onOpenCustomSetManagement:p,onFullscreen:N}){const b=u.useMemo(()=>vr(r,t,s),[r.word,t,s]),[x,v]=u.useState(null),[k,M]=u.useState(new Set),[S,j]=u.useState(""),[z,V]=u.useState(0),[,ye]=u.useState(()=>{const P=sessionStorage.getItem("currentCorrectStreak");return P?parseInt(P,10):0}),ue=u.useRef(0),K=u.useRef(0),he=u.useRef(null),Se=u.useRef(!1);u.useEffect(()=>{v(null),M(new Set),j(""),V(0)},[s]);const se=P=>{M(R=>{const U=new Set(R);return n?U.size>0?new Set:new Set(b.map((J,Z)=>Z)):(U.has(P)?U.delete(P):U.add(P),U)})};u.useEffect(()=>{const P=localStorage.getItem("autoShowDetails")!=="false";n&&a&&a!==r.meaning&&P&&M(new Set(b.map((R,U)=>U)))},[n,a,r.meaning,b]),u.useEffect(()=>{if(n&&a){const P=localStorage.getItem("aiPersonality")||"kind-teacher",R=a===r.meaning,U=parseInt(sessionStorage.getItem("currentCorrectStreak")||"0",10);let J=Wr(P,{isCorrect:R,word:r.word,difficulty:"intermediate",category:"",attemptCount:z+1,responseTime:0,correctStreak:0,incorrectStreak:0,userAccuracy:0,categoryAccuracy:0,isWeakCategory:!1,hasSeenBefore:!1,previousAttempts:0,todayQuestions:0,todayAccuracy:0,planProgress:0,timeOfDay:zs()});const Z=[];if(R&&Math.random()<.1){const we=qr();we.estimatedDaysToAchieve>0&&we.estimatedDaysToAchieve<=30&&(we.overallProgress>=90?Z.push(`ğŸ¯ ${we.goal.name}ã¾ã§ã‚ã¨å°‘ã—ï¼`):we.overallProgress>=75&&Z.push(`ğŸ“ˆ ã“ã®ãƒšãƒ¼ã‚¹ãªã‚‰${we.estimatedDaysToAchieve}æ—¥ã§${we.goal.name}é”æˆã§ã™ï¼`))}if(!R){const we=zr(r.word);we.length>0&&Z.push(`ğŸ’¡ ã€Œ${r.word}ã€ã¨ã€Œ${we.join(", ")}ã€ã‚’æ··åŒã—ã‚„ã™ã„ã®ã§æ³¨æ„ï¼`)}if(!R&&Math.random()<.05){const Le=vi().find(Ze=>Ze.words.includes(r.word.toLowerCase())&&Ze.needsReview);Le&&Z.push(ji(Le))}const ke=ni(P,R,U);if(ke&&Z.push(ke.message),R){const we=oi(U+1);we&&Z.push(we)}const xe=gi(R);if(xe&&Z.push(xe),R){const we=U+1;ye(we),sessionStorage.setItem("currentCorrectStreak",String(we))}else ye(0),sessionStorage.setItem("currentCorrectStreak","0");Z.length>0&&(J=`${J} ${Z[0]}`),j(J)}else j("")},[n,a,r,z]);const fe=()=>{M(new Set),V(0),l()};u.useEffect(()=>{const P=Z=>{const ke=Z.target;ke.closest(".choice-btn")||ke.closest(".toggle-details-btn")||ke.closest(".rating-btn")||ke.closest(".inline-nav-btn")||ke.closest(".question-text")||(ue.current=Z.touches[0].clientX,Se.current=!0)},R=Z=>{ue.current!==0&&(K.current=Z.touches[0].clientX)},U=()=>{if(ue.current===0){Se.current=!1;return}const Z=ue.current-K.current;Math.abs(Z)>80&&(Z>0?n?fe():l():s>0&&o()),ue.current=0,K.current=0,setTimeout(()=>{Se.current=!1},300)},J=he.current;if(J)return J.addEventListener("touchstart",P,{passive:!0}),J.addEventListener("touchmove",R,{passive:!0}),J.addEventListener("touchend",U),()=>{J.removeEventListener("touchstart",P),J.removeEventListener("touchmove",R),J.removeEventListener("touchend",U)}},[n,s,l,o]),u.useEffect(()=>{const P=R=>{if(!n&&["1","2","3","4"].includes(R.key)){const U=parseInt(R.key)-1;if(U<b.length){R.preventDefault();const J=b[U].text,Z=b[U].question;J===r.meaning||V(xe=>xe+1),i(J,r.meaning,Z)}}else!n&&R.key===" "?(R.preventDefault(),l()):R.key==="Enter"&&(R.preventDefault(),n?fe():l())};return window.addEventListener("keydown",P),()=>{window.removeEventListener("keydown",P)}},[n,b,r,i,z]);const y=P=>{const R="w-full min-h-11 sm:min-h-14 p-2 sm:p-4 text-sm sm:text-base rounded-xl border-2 cursor-pointer transition-all duration-300 flex flex-col items-center text-center touch-manipulation select-none shadow-sm",U="hover:border-blue-600 hover:bg-gray-100:bg-gray-800 hover:-translate-y-1 hover:shadow-lg",J="active:bg-gray-200:bg-gray-700 active:translate-y-0";return P==="åˆ†ã‹ã‚‰ãªã„"?n?P===a?`${R} bg-red-600 border-red-600 text-white`:`${R} bg-gray-100 text-gray-600 border-gray-400`:`${R} bg-gray-100 text-gray-600 border-gray-400 ${U} ${J}`:n?P===r.meaning?`${R} bg-green-600 border-green-600 text-white`:P===a&&P!==r.meaning?`${R} bg-red-600 border-red-600 text-white`:`${R} bg-gray-50 text-gray-900 border-gray-300`:`${R} bg-gray-50 text-gray-900 border-gray-300 ${U} ${J}`};return e.jsxs("div",{className:"question-card",ref:he,children:[N&&e.jsx("button",{onClick:N,className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsxs("div",{className:"question-nav-row",children:[e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg transition flex items-center justify-center text-xl sm:text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:o,disabled:s===0,title:"å‰ã¸",children:"â†"}),e.jsxs("div",{className:`question-content-inline ${Ge()?"clickable-pronunciation":""}`,onClick:P=>{Ge()&&(P.preventDefault(),P.stopPropagation(),st(r.word,{rate:.85}))},onTouchEnd:P=>{Ge()&&(P.preventDefault(),P.stopPropagation(),st(r.word,{rate:.85}))},title:Ge()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":"",children:[e.jsxs("div",{className:`text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 break-words ${r.word.includes(" ")?"phrase-text":""} ${Ge()?"clickable-word":""}`,children:[r.word,Ge()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"})]}),r.reading&&e.jsxs("div",{className:"question-reading text-sm sm:text-base text-gray-600 mt-1",children:["ã€",r.reading,"ã€‘"]}),r.difficulty&&e.jsx("div",{className:`difficulty-badge ${r.difficulty}`,children:r.difficulty==="beginner"?"åˆç´š":r.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"}),m&&h&&p&&d&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx(At,{word:{word:r.word,meaning:r.meaning,katakana:r.reading,source:"translation"},sets:d,onAddWord:m,onRemoveWord:h,onOpenManagement:p,size:"medium",variant:"both"})})]}),e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition flex items-center justify-center text-xl sm:text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:fe,title:"æ¬¡ã¸",children:"â†’"})]}),e.jsx("div",{className:"choices",children:b.map((P,R)=>{const U=k.has(R),J=P.question;return e.jsxs("div",{className:"choice-wrapper",children:[e.jsx("button",{className:y(P.text),onClick:Z=>{if(n){Z.preventDefault(),Z.stopPropagation(),J&&se(R);return}P.text===r.meaning||V(xe=>xe+1),i(P.text,r.meaning,J)},disabled:!1,children:e.jsx("div",{className:"choice-content",children:e.jsx("div",{className:"choice-text",children:P.text})})}),n&&J&&U&&e.jsxs("div",{className:"choice-details",children:[e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"èªå¥:"}),e.jsx("span",{className:"detail-text",children:J.word})]}),J.reading&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"èª­ã¿:"}),e.jsx("span",{className:"detail-text",children:J.reading})]}),J.meaning&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"æ„å‘³:"}),e.jsx("span",{className:"detail-text",children:J.meaning})]}),J.etymology&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"ğŸ“š èªæºç­‰:"}),e.jsx("span",{className:"detail-text",children:J.etymology})]}),J.relatedWords&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"ğŸ”— é–¢é€£èª:"}),e.jsx("span",{className:"detail-text",children:J.relatedWords})]}),J.relatedFields&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"ğŸ·ï¸ åˆ†é‡:"}),e.jsx("span",{className:"detail-text",children:J.relatedFields})]}),J.difficulty&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"é›£æ˜“åº¦:"}),e.jsx("span",{className:"detail-text",children:J.difficulty})]})]})]},R)})})]})}const tr=[0,5,10,20,30,50,100,150,200];function Fs({learningLimit:r,reviewLimit:t,onLearningLimitChange:s,onReviewLimitChange:n,idPrefix:a=""}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:`${a}learning-limit`,children:"ğŸ¯ å­¦ç¿’ä¸­ã®ä¸Šé™:"}),e.jsx("select",{id:`${a}learning-limit`,value:r,onChange:i=>s(parseInt(i.target.value)),className:"select-input",children:tr.map(i=>e.jsx("option",{value:i,children:i===0?"è¨­å®šç„¡ã—":i},i))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:`${a}review-limit`,children:"âš ï¸ è¦å¾©ç¿’ã®ä¸Šé™:"}),e.jsx("select",{id:`${a}review-limit`,value:t,onChange:i=>n(parseInt(i.target.value)),className:"select-input",children:tr.map(i=>e.jsx("option",{value:i,children:i===0?"è¨­å®šç„¡ã—":i},i))})]})]})}function Qs(r){const[t,s]=u.useState(()=>{const o=localStorage.getItem(`learning-limit-${r}`);return o?parseInt(o):30}),[n,a]=u.useState(()=>{const o=localStorage.getItem(`review-limit-${r}`);return o?parseInt(o):10}),i=u.useCallback(o=>{const c=Math.max(0,o)||30;s(c),localStorage.setItem(`learning-limit-${r}`,c.toString())},[r]),l=u.useCallback(o=>{const c=Math.max(0,o)||10;a(c),localStorage.setItem(`review-limit-${r}`,c.toString())},[r]);return{learningLimit:t,reviewLimit:n,setLearningLimit:i,setReviewLimit:l}}var yt=(r=>(r.ENCODING="encoding",r.INITIAL_CONSOLIDATION="initial",r.INTRADAY_REVIEW="intraday",r.SHORT_TERM="short_term",r.LONG_TERM="long_term",r))(yt||{});const sr={encodingTime:3e4,initialConsolidation:36e5,intradayWindow:864e5,shortTermWindow:6048e5,longTermThreshold:6048e5,correctRateThreshold:.8,responseTimeThreshold:1500},Ii=1e3,Ai=100,Ri=100,Pi=0,Ti=6e4,$i=1e3;class Ei{constructor(t,s){Ye(this,"thresholds");Ye(this,"cache");Ye(this,"CACHE_DURATION",5e3);const n={...sr,...s};t?this.thresholds=this.adjustThresholds(n,t):this.thresholds=n,this.cache=new Map}adjustThresholds(t,s){return{encodingTime:t.encodingTime,initialConsolidation:t.initialConsolidation/s.learningSpeed,intradayWindow:t.intradayWindow,shortTermWindow:t.shortTermWindow/s.learningSpeed,longTermThreshold:t.longTermThreshold/s.learningSpeed,correctRateThreshold:t.correctRateThreshold,responseTimeThreshold:t.responseTimeThreshold*s.learningSpeed}}detectPhase(t,s){const n=Date.now(),a=this.cache.get(t);if(a&&n-a.timestamp<this.CACHE_DURATION)return a.phase;const i=this.detectPhaseWithReason(t,s);return this.cache.set(t,{phase:i.phase,timestamp:n}),i.phase}detectPhaseWithReason(t,s){const n=Date.now(),a=this.sanitizeTimestamp(s.lastReviewTime,n),i=this.sanitizeTimestamp(s.lastCorrectTime,n),l=this.sanitizeResponseTime(s.averageResponseTime),o=n-a,c=o/864e5,d=s.reviewCount>0?s.correctCount/s.reviewCount:0,m={reviewCount:s.reviewCount,correctCount:s.correctCount,correctRate:d,daysSinceLastReview:c,timeSinceLastReview:o,averageResponseTime:l};if(s.reviewCount===0)return{phase:"encoding",reason:"åˆè¦‹å˜èªï¼ˆreviewCount=0ï¼‰",matchedCondition:1,metrics:m};if(o<this.thresholds.encodingTime)return{phase:"encoding",reason:`ä½œæ¥­è¨˜æ†¶æ®µéšï¼ˆ${Math.round(o/1e3)}ç§’å‰ï¼‰`,matchedCondition:2,metrics:m};if(s.correctCount===0)return{phase:"encoding",reason:"ä¸€åº¦ã‚‚æ­£ç­”ã—ã¦ã„ãªã„",matchedCondition:3,metrics:m};if(c>Ii)return{phase:"encoding",reason:`è¶…é•·æœŸæ”¾ç½®ï¼ˆ${Math.round(c)}æ—¥å‰ï¼‰`,matchedCondition:101,metrics:m};if(s.consecutiveCorrect>=Ai)return{phase:"long_term",reason:`å®Œå…¨ç¿’å¾—ï¼ˆ${s.consecutiveCorrect}å›é€£ç¶šæ­£ç­”ï¼‰`,matchedCondition:102,metrics:m};if(s.consecutiveWrong>=Ri)return{phase:"encoding",reason:`å­¦ç¿’æ–¹æ³•è¦è¦‹ç›´ã—ï¼ˆ${s.consecutiveWrong}å›é€£ç¶šèª¤ç­”ï¼‰`,matchedCondition:103,metrics:m};const h=(n-i)/36e5;if(s.correctCount===1&&n-i<this.thresholds.initialConsolidation)return{phase:"initial",reason:`åˆæœŸçµ±åˆæ®µéšï¼ˆåˆå›æ­£ç­”å¾Œ${Math.round(h*60)}åˆ†ï¼‰`,matchedCondition:4,metrics:m};if(this.isSameDay(n,i)&&s.correctCount>=2)return{phase:"intraday",reason:`åŒæ—¥å¾©ç¿’æ®µéšï¼ˆä»Šæ—¥${s.correctCount}å›æ­£ç­”ï¼‰`,matchedCondition:5,metrics:m};if(c>=1&&c<=7){if(d>=.5&&d<this.thresholds.correctRateThreshold)return{phase:"short_term",reason:`çŸ­æœŸè¨˜æ†¶æ®µéšï¼ˆ${Math.round(c)}æ—¥å‰ã€æ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:6,metrics:m};if(d<.5)return{phase:"encoding",reason:`å¿˜å´ã«ã‚ˆã‚Šãƒªã‚»ãƒƒãƒˆï¼ˆæ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:6,metrics:m}}return c>7?d>=this.thresholds.correctRateThreshold&&l<this.thresholds.responseTimeThreshold?{phase:"long_term",reason:`é•·æœŸè¨˜æ†¶ç¢ºç«‹ï¼ˆ${Math.round(c)}æ—¥å‰ã€æ­£ç­”ç‡${Math.round(d*100)}%ã€å¿œç­”${Math.round(l)}msï¼‰`,matchedCondition:7,metrics:m}:d>=.5&&d<this.thresholds.correctRateThreshold?{phase:"short_term",reason:`ã¾ã ä¸å®‰å®šï¼ˆæ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:7,metrics:m}:{phase:"encoding",reason:`å®Œå…¨å¿˜å´ï¼ˆæ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:7,metrics:m}:{phase:"short_term",reason:"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåˆ¤å®š",matchedCondition:0,metrics:m}}canTransition(t,s,n){const a=this.detectPhase(t,s);if(a===n)return!0;const i=["encoding","initial","intraday","short_term","long_term"],l=i.indexOf(a),o=i.indexOf(n);return o>l?o-l===1:!0}isSameDay(t,s){const n=new Date(t),a=new Date(s);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()&&n.getDate()===a.getDate()}sanitizeResponseTime(t){return t<=Pi||t>Ti||isNaN(t)?$i:t}sanitizeTimestamp(t,s){return t>s?(console.warn(`æœªæ¥ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’æ¤œå‡º: ${t}`),s):t<0||isNaN(t)?s:t}clearCache(){this.cache.clear()}updateThresholds(t){this.thresholds=this.adjustThresholds(sr,t),this.clearCache()}}var Ct=(r=>(r.IMMEDIATE="immediate",r.EARLY="early",r.MID="mid",r.END="end",r))(Ct||{}),Nt=(r=>(r.MEMORIZATION="memorization",r.TRANSLATION="translation",r.SPELLING="spelling",r.GRAMMAR="grammar",r))(Nt||{});const _i={memorization:{consolidationThreshold:3,enableImmediateReview:!0,enableEarlyReview:!0,enableMidReview:!0,enableEndReview:!0,newQuestionRatio:.6},translation:{consolidationThreshold:2,enableImmediateReview:!0,enableEarlyReview:!1,enableMidReview:!1,enableEndReview:!0,newQuestionRatio:.7},spelling:{consolidationThreshold:4,enableImmediateReview:!0,enableEarlyReview:!0,enableMidReview:!0,enableEndReview:!0,newQuestionRatio:.5},grammar:{consolidationThreshold:3,enableImmediateReview:!0,enableEarlyReview:!0,enableMidReview:!1,enableEndReview:!0,newQuestionRatio:.6}},Tt={immediate:10,early:20,mid:30,end:50},Li=72e5,Wi=10;class Oi{constructor(t){Ye(this,"queues");Ye(this,"currentQuestionNumber",0);Ye(this,"sessionStartTime",Date.now());Ye(this,"wordAttempts",new Map);Ye(this,"acquisitionProgress",new Map);Ye(this,"tabConfigs");if(this.queues={immediate:[],early:[],mid:[],end:[]},this.tabConfigs={..._i},t)for(const[s,n]of Object.entries(t))this.tabConfigs[s]={...this.tabConfigs[s],...n}}enqueueNewWord(t,s,n){const a=Date.now();this.currentQuestionNumber++;const i=this.tabConfigs[n];if(this.acquisitionProgress.has(t)||this.acquisitionProgress.set(t,{todayFirstSeen:a,todayCorrectCount:0,todayWrongCount:0,isAcquisitionComplete:!1,currentQueue:null,queuedAt:0,todayReviews:[]}),i.enableImmediateReview&&this.shouldEnqueueImmediate(s)){const l=this.calculateImmediateGap(s);this.enqueueToImmediate(t,s,n,l)}}enqueueToImmediate(t,s,n,a){const i=Date.now();if(this.isDuplicateInQueue(t,"immediate"))return;const l={word:t,queueType:"immediate",enqueuedAt:i,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:this.currentQuestionNumber+a,targetTime:i+6e4,priority:100,difficulty:s,category:n};this.enqueueWithLimit(this.queues.immediate,l,Tt.immediate);const o=this.acquisitionProgress.get(t);o.currentQueue="immediate",o.queuedAt=i}enqueueToEarly(t,s,n){const a=Date.now();if(!this.tabConfigs[n].enableEarlyReview||this.isDuplicateInQueue(t,"early"))return;const l=this.calculateEarlyGap(s),o={word:t,queueType:"early",enqueuedAt:a,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:this.currentQuestionNumber+l,targetTime:a+6e5,priority:80,difficulty:s,category:n};this.enqueueWithLimit(this.queues.early,o,Tt.early);const c=this.acquisitionProgress.get(t);c.currentQueue="early",c.queuedAt=a}enqueueToMid(t,s,n){const a=Date.now();if(!this.tabConfigs[n].enableMidReview||this.isDuplicateInQueue(t,"mid"))return;const l=this.calculateMidGap(s),o={word:t,queueType:"mid",enqueuedAt:a,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:this.currentQuestionNumber+l,targetTime:a+36e5,priority:60,difficulty:s,category:n};this.enqueueWithLimit(this.queues.mid,o,Tt.mid);const c=this.acquisitionProgress.get(t);c.currentQueue="mid",c.queuedAt=a}enqueueToEnd(t,s,n){const a=Date.now();if(!this.tabConfigs[n].enableEndReview||this.isDuplicateInQueue(t,"end"))return;const l={word:t,queueType:"end",enqueuedAt:a,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:1/0,targetTime:1/0,priority:40,difficulty:s,category:n};this.enqueueWithLimit(this.queues.end,l,Tt.end);const o=this.acquisitionProgress.get(t);o.currentQueue="end",o.queuedAt=a}getNextReviewQuestion(){this.cleanupExpiredEntries();const t=Date.now(),s=this.currentQuestionNumber,n=[];for(const a of this.queues.immediate)(s>=a.targetQuestionNumber||t>=a.targetTime)&&n.push(a);for(const a of this.queues.early)(s>=a.targetQuestionNumber||t>=a.targetTime)&&n.push(a);for(const a of this.queues.mid)(s>=a.targetQuestionNumber||t>=a.targetTime)&&n.push(a);if(n.sort((a,i)=>i.priority-a.priority),n.length>0){const a=n[0];return this.removeFromQueue(a),a}return null}handleCorrectAnswer(t,s,n,a,i){if(!this.trackWordAttempts(t))return;const l=this.getAcquisitionProgress(t);l.todayCorrectCount++,l.todayReviews.push({timestamp:Date.now(),queueType:s,isCorrect:!0,responseTime:n});let o=a,c=i;if(o===void 0||c===void 0){const d=this.findWordInQueues(t);d&&(o=d.difficulty,c=d.category)}o!==void 0&&c!==void 0&&(s==="immediate"&&this.shouldEnqueueEarly(t,l)?this.enqueueToEarly(t,o,c):s==="early"&&this.shouldEnqueueMid(t,l)?this.enqueueToMid(t,o,c):s==="mid"&&this.shouldEnqueueEnd(t,l)&&this.enqueueToEnd(t,o,c)),this.isAcquisitionComplete(t,l)&&(l.isAcquisitionComplete=!0,console.log(`âœ… è¨˜æ†¶ç²å¾—å®Œäº†: ${t}`))}handleWrongAnswer(t,s,n,a,i){if(!this.trackWordAttempts(t))return;const l=this.getAcquisitionProgress(t);l.todayWrongCount++,l.todayReviews.push({timestamp:Date.now(),queueType:s,isCorrect:!1,responseTime:n});let o=a,c=i;if(o===void 0||c===void 0){const d=this.findWordInQueues(t);d&&(o=d.difficulty,c=d.category)}o!==void 0&&c!==void 0&&(this.removeFromAllQueues(t),s!=="immediate"&&console.log(`âŒ èª¤ç­”ã«ã‚ˆã‚Šå³æ™‚å¾©ç¿’ã‚­ãƒ¥ãƒ¼ã«æˆ»ã—ã¾ã™: ${t}`),this.enqueueToImmediate(t,Math.min(o+1,5),c,1))}startSessionEndReview(){const t=[...this.queues.end];return t.length===0?(console.log("çµ‚äº†æ™‚å¾©ç¿’ãªã—"),[]):(console.log(`çµ‚äº†æ™‚å¾©ç¿’ã‚’é–‹å§‹ã—ã¾ã™ï¼ˆ${t.length}èªï¼‰`),t)}generateAcquisitionReport(){const t=Array.from(this.acquisitionProgress.keys()),s=[],n=[];for(const a of t)this.acquisitionProgress.get(a).isAcquisitionComplete?s.push(a):n.push(a);return{totalWords:t.length,completed:s.length,incomplete:n.length,completionRate:t.length>0?s.length/t.length:0,incompleteWords:n}}getQueueStatistics(){var t,s,n,a;return{immediate:{size:this.queues.immediate.length,oldestEntry:(t=this.queues.immediate[0])==null?void 0:t.enqueuedAt,averageWaitTime:this.calculateAverageWaitTime(this.queues.immediate)},early:{size:this.queues.early.length,oldestEntry:(s=this.queues.early[0])==null?void 0:s.enqueuedAt,averageWaitTime:this.calculateAverageWaitTime(this.queues.early)},mid:{size:this.queues.mid.length,oldestEntry:(n=this.queues.mid[0])==null?void 0:n.enqueuedAt,averageWaitTime:this.calculateAverageWaitTime(this.queues.mid)},end:{size:this.queues.end.length,oldestEntry:(a=this.queues.end[0])==null?void 0:a.enqueuedAt,averageWaitTime:0}}}getAcquisitionProgress(t){return this.acquisitionProgress.has(t)||this.acquisitionProgress.set(t,{todayFirstSeen:Date.now(),todayCorrectCount:0,todayWrongCount:0,isAcquisitionComplete:!1,currentQueue:null,queuedAt:0,todayReviews:[]}),this.acquisitionProgress.get(t)}incrementQuestionNumber(){this.currentQuestionNumber++}reset(){this.queues={immediate:[],early:[],mid:[],end:[]},this.currentQuestionNumber=0,this.sessionStartTime=Date.now(),this.wordAttempts.clear(),this.acquisitionProgress.clear()}getQueueInfo(t){const s=this.findWordInQueues(t);return s?{queueType:s.queueType,questionNumber:s.targetQuestionNumber}:null}getQueueSizes(){return{immediate:this.queues.immediate.length,early:this.queues.early.length,mid:this.queues.mid.length,end:this.queues.end.length}}exportQueues(){return{immediate:[...this.queues.immediate],early:[...this.queues.early],mid:[...this.queues.mid],end:[...this.queues.end]}}clearQueues(){this.queues.immediate=[],this.queues.early=[],this.queues.mid=[],this.queues.end=[]}recordAnswer(t,s,n){const i=this.getAcquisitionProgress(t).currentQueue||"immediate";s?this.handleCorrectAnswer(t,i,n):this.handleWrongAnswer(t,i,n)}shouldEnqueueImmediate(t){return t>=3}shouldEnqueueEarly(t,s){return s.todayCorrectCount>=1}shouldEnqueueMid(t,s){return s.todayCorrectCount>=2}shouldEnqueueEnd(t,s){return s.todayCorrectCount>=3}calculateImmediateGap(t){return t>=4?1:t===3?2:3}calculateEarlyGap(t){return t>=4?5:t===3?7:10}calculateMidGap(t){return t>=4?20:t===3?25:30}isAcquisitionComplete(t,s){const n=this.findWordInQueues(t);if(!n)return!1;const i=this.tabConfigs[n.category].consolidationThreshold;if(s.todayCorrectCount<i||new Set(s.todayReviews.filter(c=>c.isCorrect).map(c=>c.queueType)).size<2)return!1;const o=s.todayReviews.slice(-2);return!(o.length<2||!o.every(c=>c.isCorrect))}isDuplicateInQueue(t,s){return this.queues[s].some(n=>n.word===t)}enqueueWithLimit(t,s,n){t.length>=n&&(console.warn(`ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§ã™ï¼ˆ${n}èªï¼‰ã€‚å¤ã„ã‚¨ãƒ³ãƒˆãƒªã‚’å‰Šé™¤ã—ã¾ã™ã€‚`),t.shift()),t.push(s)}removeFromQueue(t){const s=t.queueType,n=this.queues[s],a=n.findIndex(i=>i.word===t.word);a!==-1&&n.splice(a,1)}removeFromAllQueues(t){for(const s of Object.keys(this.queues))this.queues[s]=this.queues[s].filter(n=>n.word!==t)}findWordInQueues(t){for(const s of Object.keys(this.queues)){const n=this.queues[s].find(a=>a.word===t);if(n)return n}return null}cleanupExpiredEntries(){const t=Date.now();for(const s of Object.keys(this.queues))this.queues[s]=this.queues[s].filter(n=>t-n.enqueuedAt>Li?(console.warn(`æœŸé™åˆ‡ã‚Œã‚¨ãƒ³ãƒˆãƒªã‚’å‰Šé™¤: ${n.word}`),!1):!0)}trackWordAttempts(t){this.wordAttempts.has(t)||this.wordAttempts.set(t,0);const s=this.wordAttempts.get(t)+1;return this.wordAttempts.set(t,s),s>=Wi?(console.error(`åŒã˜å˜èªã®è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸ: ${t}`),this.removeFromAllQueues(t),!1):!0}calculateAverageWaitTime(t){if(t.length===0)return 0;const s=Date.now();return t.reduce((a,i)=>a+(s-i.enqueuedAt),0)/t.length}}const qi={minEaseFactor:1.3,maxEaseFactor:2.5,easeFactorIncrement:.1,easeFactorDecrement:.2,initialInterval:1,forgettingCurveDecay:.5,confidenceWeight:.15};class zi{constructor(t){Ye(this,"retentionData",new Map);Ye(this,"config");this.config={...qi,...t}}getRetentionStatus(t){return this.retentionData.has(t)||this.retentionData.set(t,this.createInitialStatus()),this.retentionData.get(t)}recordReview(t,s){const n=this.getRetentionStatus(t);n.totalReviews++,n.lastReviewDate=s.timestamp,n.lastResponseTime=s.responseTime;const a=.3;return n.averageResponseTime=n.averageResponseTime*(1-a)+s.responseTime*a,s.isCorrect?(n.totalCorrect++,n.consecutiveCorrect++,n.consecutiveWrong=0,this.updateSM2OnCorrect(n,s.confidence)):(n.consecutiveCorrect=0,n.consecutiveWrong++,this.updateSM2OnWrong(n)),n.retentionRate=this.estimateRetentionRate(n),n.forgettingIndex=this.calculateForgettingIndex(n),n}getDueWords(t,s=Date.now()){const n=[];for(const a of t){const i=this.getRetentionStatus(a);if(s>=i.nextReviewDate){const o=(s-i.nextReviewDate)/864e5*i.forgettingIndex;n.push({word:a,priority:o})}}return n.sort((a,i)=>i.priority-a.priority),n.map(a=>a.word)}getReviewSchedule(t,s=7){const n=new Map,a=Date.now();for(const i of t){const l=this.getRetentionStatus(i),o=[];let c=l.nextReviewDate;const d=a+s*864e5;for(;c<=d;)o.push(new Date(c)),c+=l.sm2.interval*864e5;o.length>0&&n.set(i,o)}return n}getRetentionStatistics(t){const s=Date.now();let n=0,a=0,i=0,l=0,o=0,c=0;for(const m of t){const h=this.getRetentionStatus(m);n+=h.retentionRate,a+=h.sm2.easeFactor,i+=h.sm2.interval,s>=h.nextReviewDate&&(l++,(s-h.nextReviewDate)/864e5>1&&o++),h.consecutiveCorrect>=5&&h.sm2.interval>=30&&c++}const d=t.length||1;return{averageRetentionRate:n/d,averageEaseFactor:a/d,averageInterval:i/d,dueCount:l,overdueCount:o,wellLearnedCount:c}}estimateRetentionRate(t){const s=Date.now(),n=(s-t.lastReviewDate)/864e5,a=(t.nextReviewDate-s)/864e5;if(a>=0){const i=Math.exp(-this.config.forgettingCurveDecay*n/t.sm2.interval);return Math.max(.1,Math.min(1,i))}else{const i=-a,l=Math.exp(-this.config.forgettingCurveDecay*(n+i)/t.sm2.interval);return Math.max(.05,Math.min(.9,l))}}reset(){this.retentionData.clear()}importRetentionData(t){this.retentionData=new Map(t)}exportRetentionData(){return new Map(this.retentionData)}createInitialStatus(){return{lastReviewDate:Date.now(),nextReviewDate:Date.now()+this.config.initialInterval*864e5,sm2:{interval:this.config.initialInterval,repetition:0,easeFactor:2.5},retentionRate:1,forgettingIndex:1,totalReviews:0,totalCorrect:0,consecutiveCorrect:0,consecutiveWrong:0,averageResponseTime:0,lastResponseTime:0}}updateSM2OnCorrect(t,s){const n=t.sm2;n.repetition++;const a=this.mapConfidenceToQuality(s),i=n.easeFactor+(.1-(5-a)*(.08+(5-a)*.02));n.easeFactor=Math.max(this.config.minEaseFactor,Math.min(this.config.maxEaseFactor,i)),n.repetition===1?n.interval=1:n.repetition===2?n.interval=6:n.interval=Math.round(n.interval*n.easeFactor),t.lastResponseTime>3e3&&t.lastResponseTime>t.averageResponseTime*1.5&&(n.interval=Math.max(1,Math.round(n.interval*.8))),t.nextReviewDate=t.lastReviewDate+n.interval*864e5}updateSM2OnWrong(t){const s=t.sm2;s.repetition=0,s.easeFactor=Math.max(this.config.minEaseFactor,s.easeFactor-this.config.easeFactorDecrement),s.interval=1,t.nextReviewDate=t.lastReviewDate+s.interval*864e5}mapConfidenceToQuality(t){return Math.max(0,Math.min(5,t))}calculateForgettingIndex(t){const a=(t.totalReviews>0?1-t.totalCorrect/t.totalReviews:0)*2,i=t.averageResponseTime>2e3?(t.averageResponseTime-2e3)/5e3:0,l=Math.min(t.consecutiveWrong*.3,1.5),o=1+a+i+l;return Math.max(.5,Math.min(5,o))}}const Fi={minSampleSize:20,confidenceThreshold:.7,learningSpeedWindow:7,forgettingSpeedWindow:30},rr={learningSpeed:1,forgettingSpeed:1,consolidationThreshold:3,responseTimeProfile:{averageResponseTime:2e3,fastThreshold:1e3,slowThreshold:3e3,consistencyScore:.5},confidenceLevel:0,sampleSize:0,lastUpdated:Date.now()};class Qi{constructor(t){Ye(this,"config");Ye(this,"parameters");Ye(this,"historyCache",[]);this.config={...Fi,...t},this.parameters={...rr}}addHistory(t){this.historyCache.push(t),this.historyCache.length>100&&this.historyCache.shift()}estimateParameters(t){const s=t||this.historyCache;return s.length<this.config.minSampleSize?(this.parameters.sampleSize=s.length,this.parameters.confidenceLevel=0,{...this.parameters}):(this.parameters.learningSpeed=this.estimateLearningSpeed(s),this.parameters.forgettingSpeed=this.estimateForgettingSpeed(s),this.parameters.consolidationThreshold=this.estimateConsolidationThreshold(s),this.parameters.responseTimeProfile=this.estimateResponseTimeProfile(s),this.parameters.confidenceLevel=this.calculateConfidenceLevel(s.length),this.parameters.sampleSize=s.length,this.parameters.lastUpdated=Date.now(),{...this.parameters})}getParameters(){return{...this.parameters}}importParameters(t){this.parameters={...t}}clearHistory(){this.historyCache=[]}estimateLearningSpeed(t){const s=new Map,n=new Map;for(const l of t){const o=l.word;s.has(o)||s.set(o,0),s.set(o,s.get(o)+1),l.isCorrect&&!n.has(o)&&n.set(o,s.get(o))}const a=Array.from(n.values());if(a.length===0)return 1;const i=a.reduce((l,o)=>l+o,0)/a.length;return i<=2?1.8:i<=2.5?1.5:i<=3.5?1:i<=5?.7:.5}estimateForgettingSpeed(t){const s=new Map,n=[];for(const i of t){const l=i.word;if(i.isCorrect)s.set(l,i.timestamp);else if(s.has(l)){const o=s.get(l),c=(i.timestamp-o)/864e5;n.push(c),s.delete(l)}}if(n.length===0)return 1;const a=n.reduce((i,l)=>i+l,0)/n.length;return a>=7?.6:a>=5?.8:a>=3?1:a>=1?1.5:2}estimateConsolidationThreshold(t){const s=new Map,n=new Map,a=[];for(const l of t){const o=l.word;if(s.has(o)||(s.set(o,0),n.set(o,0)),l.isCorrect){const c=s.get(o)+1;s.set(o,c);const d=Math.max(n.get(o),c);n.set(o,d),c===5&&a.push(this.getWordTotalReviews(o,t))}else s.set(o,0)}if(a.length===0)return 3;const i=a.reduce((l,o)=>l+o,0)/a.length;return Math.max(2,Math.min(5,Math.round(i*.6)))}estimateResponseTimeProfile(t){const s=t.map(m=>m.responseTime);if(s.length===0)return rr.responseTimeProfile;const n=s.reduce((m,h)=>m+h,0)/s.length,a=s.reduce((m,h)=>m+Math.pow(h-n,2),0)/s.length,i=Math.sqrt(a),l=Math.max(500,n-i),o=Math.min(5e3,n+i),c=i/n,d=Math.max(0,Math.min(1,1-c));return{averageResponseTime:Math.round(n),fastThreshold:Math.round(l),slowThreshold:Math.round(o),consistencyScore:Math.round(d*100)/100}}calculateConfidenceLevel(t){return t<this.config.minSampleSize?0:t<50?(t-this.config.minSampleSize)/(50-this.config.minSampleSize)*.7:t<100?.7+(t-50)/50*.2:.9+Math.min((t-100)/200*.1,.1)}getWordTotalReviews(t,s){return s.filter(n=>n.word===t).length}}const Fr={acquisitionRatio:.6,retentionRatio:.4,adaptiveAdjustment:!0,sessionQuestionNumber:0};class Gi{constructor(t=Fr){Ye(this,"strategy");Ye(this,"personalParams",null);this.strategy={...t}}setPersonalParameters(t){this.personalParams=t}updateStrategy(t){this.strategy={...this.strategy,...t}}selectNextQuestion(t){if(t.length===0)return null;const s=t.map(a=>this.calculatePriority(a));s.sort((a,i)=>i.priority-a.priority);const n=s.find(a=>a.candidate.queueType!==void 0);return n?n.candidate:this.selectByStrategy(s)}calculatePriority(t){const s={queuePriority:this.calculateQueuePriority(t),phasePriority:this.calculatePhasePriority(t),timingPriority:this.calculateTimingPriority(t),personalPriority:this.calculatePersonalPriority(t)},n=Object.values(s).reduce((i,l)=>i+l,0),a=this.generatePriorityReason(t,s);return{candidate:t,priority:n,breakdown:s,reason:a}}calculateQueuePriority(t){if(!t.queueType)return 0;let n={[Ct.IMMEDIATE]:40,[Ct.EARLY]:30,[Ct.MID]:20,[Ct.END]:10}[t.queueType]||0;if(t.questionNumber!==void 0){const a=Math.max(0,5-t.questionNumber*.5);n+=a}return Math.min(40,n)}calculatePhasePriority(t){return{[yt.ENCODING]:25,[yt.INITIAL_CONSOLIDATION]:30,[yt.INTRADAY_REVIEW]:20,[yt.SHORT_TERM]:15,[yt.LONG_TERM]:10}[t.phase]||0}calculateTimingPriority(t){const s=Date.now();if(!t.nextReviewTime)return 15;const n=s-t.nextReviewTime;if(n>=0){const i=n/36e5;return Math.min(20,10+i*2)}const a=Math.abs(n)/(1e3*60*60);return a<=1?10-a*5:0}calculatePersonalPriority(t){if(!this.personalParams)return 5;let s=5;return t.reviewCount===0&&this.personalParams.learningSpeed<.8&&(s-=2),t.reviewCount===0&&this.personalParams.learningSpeed>1.2&&(s+=2),t.reviewCount>0&&this.personalParams.forgettingSpeed>1.2&&(s+=3),t.reviewCount>0&&this.personalParams.forgettingSpeed<.8&&(s-=2),Math.max(0,Math.min(10,s))}selectByStrategy(t){var l,o;if(t.length===0)return null;const s=t.filter(c=>c.candidate.reviewCount===0),n=t.filter(c=>c.candidate.reviewCount>0);if(s.length===0)return((l=n[0])==null?void 0:l.candidate)||null;if(n.length===0)return((o=s[0])==null?void 0:o.candidate)||null;let a=this.strategy.acquisitionRatio;return this.strategy.adaptiveAdjustment&&this.strategy.sessionQuestionNumber!==void 0&&(a=this.calculateAdaptiveRatio(this.strategy.sessionQuestionNumber)),Math.random()<a?s[0].candidate:n[0].candidate}calculateAdaptiveRatio(t){return t<=10?.7:t<=20?.6:t<=30?.5:.4}generatePriorityReason(t,s){const n=[];if(t.queueType&&n.push(`ã‚­ãƒ¥ãƒ¼: ${t.queueType}`),n.push(`ãƒ•ã‚§ãƒ¼ã‚º: ${t.phase}`),t.nextReviewTime){const i=Date.now()-t.nextReviewTime,l=Math.abs(i/(1e3*60*60));i>=0?n.push(`é…å»¶: ${l.toFixed(1)}æ™‚é–“`):n.push(`äºˆå®šã¾ã§: ${l.toFixed(1)}æ™‚é–“`)}return t.reviewCount===0?n.push("æ–°è¦å˜èª"):n.push(`å¾©ç¿’${t.reviewCount}å›ç›®`),n.join(", ")}getAllPriorities(t){return t.map(s=>this.calculatePriority(s)).sort((s,n)=>n.priority-s.priority)}}function nr(r,t){return t?{word:r,reviewCount:t.correctCount+t.incorrectCount,correctCount:t.correctCount,wrongCount:t.incorrectCount,lastReviewTime:t.lastStudied||0,lastCorrectTime:t.consecutiveCorrect>0?t.lastStudied:0,averageResponseTime:t.averageResponseTime||0,consecutiveCorrect:t.consecutiveCorrect,consecutiveWrong:t.consecutiveIncorrect}:{word:r,reviewCount:0,correctCount:0,wrongCount:0,lastReviewTime:0,lastCorrectTime:0,averageResponseTime:0,consecutiveCorrect:0,consecutiveWrong:0}}function os(r=Nt.MEMORIZATION,t){const s=u.useRef(null),n=u.useRef(null),a=u.useRef(null),i=u.useRef(null),l=u.useRef(null),[o,c]=u.useState(0),[d,m]=u.useState({currentPhase:null,personalParams:null,queueSizes:{immediate:0,early:0,mid:0,end:0},sessionProgress:{totalQuestions:0,newWords:0,reviews:0}});u.useEffect(()=>{f.info("[useAdaptiveLearning] Initializing adaptive learning algorithms",{category:r,sessionId:t}),s.current=new Ei,n.current=new Oi,a.current=new zi,i.current=new Qi,l.current=new Gi({...Fr,sessionQuestionNumber:0});try{localStorage.getItem(`adaptive-learning-queues-${r}`)&&n.current&&f.debug("[useAdaptiveLearning] Restored queues from localStorage")}catch(x){f.error("[useAdaptiveLearning] Failed to restore queues:",x)}try{if(i.current){const x=i.current.estimateParameters();m(v=>({...v,personalParams:x})),l.current&&l.current.setPersonalParameters(x),f.info("[useAdaptiveLearning] Personal parameters estimated:",x)}}catch(x){f.error("[useAdaptiveLearning] Failed to estimate personal parameters:",x)}return()=>{try{if(n.current){const x=n.current.exportQueues();localStorage.setItem(`adaptive-learning-queues-${r}`,JSON.stringify(x)),f.debug("[useAdaptiveLearning] Saved queues to localStorage")}}catch(x){f.error("[useAdaptiveLearning] Failed to save queues:",x)}}},[r,t]);const h=u.useCallback(x=>{if(!l.current||!s.current||!n.current)return f.warn("[useAdaptiveLearning] Algorithms not initialized"),x.length>0?x[0]:null;try{const v=x.map(M=>{const S=Ft(M.word),j=nr(M.word,S),z=s.current.detectPhase(M.word,j),V=n.current.getQueueInfo(M.word);return{id:M.word,word:M.word,category:r,phase:z,reviewCount:j.reviewCount,correctCount:j.correctCount,lastReviewTime:j.lastReviewTime||Date.now(),queueType:V==null?void 0:V.queueType,questionNumber:V==null?void 0:V.questionNumber,difficulty:parseInt(M.difficulty)||3}});l.current.updateStrategy({sessionQuestionNumber:o});const k=l.current.selectNextQuestion(v);if(k){const M=x.find(S=>S.word===k.word);return c(S=>S+1),m(S=>({...S,currentPhase:k.phase,sessionProgress:{totalQuestions:S.sessionProgress.totalQuestions+1,newWords:S.sessionProgress.newWords+(k.reviewCount===0?1:0),reviews:S.sessionProgress.reviews+(k.reviewCount>0?1:0)}})),f.debug("[useAdaptiveLearning] Selected question:",{word:k.word,phase:k.phase,queueType:k.queueType}),M||null}return null}catch(v){return f.error("[useAdaptiveLearning] Error selecting question:",v),x.length>0?x[0]:null}},[r,o]),p=u.useCallback((x,v,k)=>{try{if(s.current){const M=Ft(x),S=nr(x,M),j=s.current.detectPhase(x,S);m(z=>({...z,currentPhase:j}))}if(n.current){n.current.recordAnswer(x,v,k);const M=n.current.getQueueSizes();m(S=>({...S,queueSizes:M}))}if(a.current&&a.current.recordReview(x,{isCorrect:v,confidence:v?3:0,responseTime:k,timestamp:Date.now()}),i.current&&(i.current.addHistory({word:x,timestamp:Date.now(),isCorrect:v,responseTime:k,reviewNumber:1,daysSinceFirstSeen:0}),o>0&&o%20===0)){const M=i.current.estimateParameters();m(S=>({...S,personalParams:M})),l.current&&l.current.setPersonalParameters(M),f.info("[useAdaptiveLearning] Personal parameters updated:",M)}f.debug("[useAdaptiveLearning] Recorded answer:",{word:x,isCorrect:v,responseTime:k})}catch(M){f.error("[useAdaptiveLearning] Error recording answer:",M)}},[o]),N=u.useCallback(()=>{f.info("[useAdaptiveLearning] Resetting adaptive learning algorithms"),c(0),m({currentPhase:null,personalParams:null,queueSizes:{immediate:0,early:0,mid:0,end:0},sessionProgress:{totalQuestions:0,newWords:0,reviews:0}}),n.current&&n.current.clearQueues(),i.current&&i.current.clearHistory()},[]),b=u.useCallback(()=>{var x;return{sessionQuestionCount:o,state:d,queues:((x=n.current)==null?void 0:x.exportQueues())||null,personalParams:d.personalParams}},[o,d]);return{selectNextQuestion:h,recordAnswer:p,state:d,reset:N,getDebugInfo:b}}function Bi({quizState:r,_categoryList:t,selectedCategory:s,onCategoryChange:n,selectedDifficulty:a,onDifficultyChange:i,selectedWordPhraseFilter:l="all",onWordPhraseFilterChange:o,selectedPhraseTypeFilter:c="all",onPhraseTypeFilterChange:d,selectedDataSource:m="all",onDataSourceChange:h,questionSets:p=[],onStartQuiz:N,onAnswer:b,onNext:x,onPrevious:v,onSkip:k,onDifficultyRate:M,onReviewFocus:S,sessionStats:j,isReviewFocusMode:z=!1,errorPrediction:V,customQuestionSets:ye=[],onAddWordToCustomSet:ue,onRemoveWordFromCustomSet:K,onOpenCustomSetManagement:he}){var Pe,L;const{questions:Se,currentIndex:se,answered:fe,selectedAnswer:y}=r,P=Se.length>0,R=P?Se[se]:null,[U,J]=u.useState(!1),[Z,ke]=u.useState(!1),[xe,we]=u.useState(Date.now()),[Le,Ze]=u.useState(void 0),[Te,$e]=u.useState(void 0),[He,_e]=u.useState(0),[ze,We]=u.useState(0),oe=os(Nt.TRANSLATION),{learningLimit:Ie,reviewLimit:qe,setLearningLimit:Fe,setReviewLimit:Je}=Qs("translation"),[Be,et]=u.useState(()=>localStorage.getItem("autoNext")==="true"),[je,T]=u.useState(()=>{const ee=localStorage.getItem("autoNextDelay");return ee?parseInt(ee,10):1500}),[w,g]=u.useState(()=>localStorage.getItem("autoShowDetails")!=="false"),C=async(ee,q)=>{const _=ee===q;Ze(_),$e(R==null?void 0:R.word),_?(_e(W=>W+1),We(0)):(We(W=>W+1),_e(0)),await b(ee,q),we(Date.now()),R!=null&&R.word&&oe.recordAnswer(R.word,_,3e3),Be&&_&&setTimeout(()=>{$e(void 0),x()},je)},I=()=>{$e(void 0),x()},G=async()=>{k&&(await k(),we(Date.now()))},F=localStorage.getItem("learning-schedule-90days"),B=!!F;let ae=null;if(B)try{const ee=JSON.parse(F),q=Math.floor((Date.now()-ee.startDate)/(1e3*60*60*24)),_=Math.min(q+1,ee.totalDays),W=Math.round(_/ee.totalDays*100);ae={currentDay:_,totalDays:ee.totalDays,progressPercent:W,phase:ee.phase}}catch(ee){f.error("Failed to parse learning plan:",ee)}const be=()=>{ke(!Z)};return Z&&P&&R?e.jsx("div",{className:"fixed inset-0 z-50 bg-gray-50 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-8",children:[e.jsx("button",{onClick:be,className:"fixed top-4 right-4 z-50 p-3 bg-gray-800 text-white rounded-full shadow-lg hover:bg-gray-700:bg-gray-600 transition","aria-label":"å…¨ç”»é¢çµ‚äº†",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"w-full max-w-4xl px-4",children:e.jsx(er,{question:R,questionNumber:se+1,allQuestions:Se,currentIndex:se,answered:fe,selectedAnswer:y,onAnswer:C,onNext:k?fe?I:G:I,onPrevious:v,onDifficultyRate:M,errorPrediction:V,customQuestionSets:ye,onAddWordToCustomSet:ue,onRemoveWordFromCustomSet:K,onOpenCustomSetManagement:he,onFullscreen:be})})]})}):e.jsxs("div",{className:"quiz-view",children:[B&&ae&&e.jsx("div",{className:"plan-progress-banner",children:e.jsxs("div",{className:"plan-progress-content",children:[e.jsx("span",{className:"plan-progress-icon",children:"ğŸ“š"}),e.jsxs("div",{className:"plan-progress-info",children:[e.jsx("div",{className:"plan-progress-title",children:"å­¦ç¿’ãƒ—ãƒ©ãƒ³é€²è¡Œä¸­"}),e.jsxs("div",{className:"plan-progress-detail",children:[ae.currentDay,"æ—¥ç›® / ",ae.totalDays,"æ—¥ (Phase ",ae.phase,") -"," ",ae.progressPercent,"%å®Œäº†"]})]})]})}),P&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(is,{mode:"translation",currentScore:r.score,totalAnswered:r.totalAnswered,sessionCorrect:j==null?void 0:j.correct,sessionIncorrect:j==null?void 0:j.incorrect,sessionReview:j==null?void 0:j.review,sessionMastered:j==null?void 0:j.mastered,sessionStats:j,onReviewFocus:S,isReviewFocusMode:z,onShowSettings:()=>J(!0),currentWord:R==null?void 0:R.word,onAnswerTime:xe,lastAnswerCorrect:Le,lastAnswerWord:Te,lastAnswerDifficulty:R==null?void 0:R.difficulty,correctStreak:He,incorrectStreak:ze,learningPhase:oe.state.currentPhase??void 0,estimatedSpeed:(Pe=oe.state.personalParams)==null?void 0:Pe.learningSpeed,dataSource:((L=p==null?void 0:p.find(ee=>ee.id===m))==null?void 0:L.name)||"å…¨å•é¡Œé›†",category:s==="å…¨åˆ†é‡"?"å…¨åˆ†é‡":s,difficulty:a,wordPhraseFilter:l})})}),U&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>J(!1),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 text-sm shadow-sm:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"category-select-quiz",children:"ğŸ“š é–¢é€£åˆ†é‡:"}),e.jsxs("select",{id:"category-select-quiz",value:s,onChange:ee=>n(ee.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®åˆ†é‡"}),Jr.map(ee=>e.jsx("option",{value:ee,children:ee},ee))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-select-quiz",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-select-quiz",value:a,onChange:ee=>i(ee.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®ãƒ¬ãƒ™ãƒ«"}),e.jsx("option",{value:"beginner",children:"åˆç´š"}),e.jsx("option",{value:"intermediate",children:"ä¸­ç´š"}),e.jsx("option",{value:"advanced",children:"ä¸Šç´š"})]})]}),h&&p&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"data-source-select-quiz",children:"ğŸ“š å‡ºé¡Œå…ƒ:"}),e.jsx("select",{id:"data-source-select-quiz",value:m,onChange:ee=>h(ee.target.value),className:"select-input",children:p.map(ee=>e.jsx("option",{value:ee.id,children:ee.name},ee.id))})]}),o&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"word-phrase-filter-quiz",children:"ğŸ“– å˜èª/ç†Ÿèª:"}),e.jsxs("select",{id:"word-phrase-filter-quiz",value:l,onChange:ee=>o(ee.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"words-only",children:"å˜èªã®ã¿"}),e.jsx("option",{value:"phrases-only",children:"ç†Ÿèªã®ã¿"})]})]}),d&&l==="phrases-only"&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"phrase-type-filter-quiz",children:"ğŸ·ï¸ ç†Ÿèªã‚¿ã‚¤ãƒ—:"}),e.jsxs("select",{id:"phrase-type-filter-quiz",value:c,onChange:ee=>d(ee.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"phrasal-verb",children:"å¥å‹•è©"}),e.jsx("option",{value:"idiom",children:"ã‚¤ãƒ‡ã‚£ã‚ªãƒ "}),e.jsx("option",{value:"collocation",children:"ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³"}),e.jsx("option",{value:"other",children:"ãã®ä»–"})]})]}),e.jsx(Fs,{learningLimit:Ie,reviewLimit:qe,onLearningLimitChange:Fe,onReviewLimitChange:Je,idPrefix:"quiz-"}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-next-toggle",checked:Be,onChange:ee=>{et(ee.target.checked),localStorage.setItem("autoNext",ee.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-next-toggle",className:"checkbox-label",children:["æ­£è§£æ™‚è‡ªå‹•ã§æ¬¡ã¸ï¼š",Be?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})}),Be&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"auto-next-delay",children:"â±ï¸ æ¬¡ã¸ã®é…å»¶æ™‚é–“ï¼š"}),e.jsxs("div",{className:"slider-row",children:[e.jsx("input",{type:"range",id:"auto-next-delay",min:"500",max:"3000",step:"100",value:je,onChange:ee=>{const q=parseInt(ee.target.value,10);T(q),localStorage.setItem("autoNextDelay",q.toString())},className:"slider-input"}),e.jsxs("span",{className:"slider-value",children:[(je/1e3).toFixed(1),"ç§’"]})]})]}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-show-details-toggle",checked:w,onChange:ee=>{g(ee.target.checked),localStorage.setItem("autoShowDetails",ee.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-show-details-toggle",className:"checkbox-label",children:["ä¸æ­£è§£æ™‚è‡ªå‹•ã§è©³ç´°ã‚’é–‹ãï¼š",w?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})})]}),e.jsx("div",{className:"question-container",children:R&&e.jsx(e.Fragment,{children:e.jsx(er,{question:R,questionNumber:se+1,allQuestions:Se,currentIndex:se,answered:fe,selectedAnswer:y,onAnswer:C,onNext:k?fe?I:G:I,onPrevious:v,onDifficultyRate:M,errorPrediction:V,customQuestionSets:ye,onAddWordToCustomSet:ue,onRemoveWordFromCustomSet:K,onOpenCustomSetManagement:he,onFullscreen:be})})})]})]})}function Ui(r){const[t,s]=u.useState({questions:[],currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedLetters:[],correctWord:""}),[n,a]=u.useState([]),[i,l]=u.useState([]),[o,c]=u.useState([]),[d,m]=u.useState(0),[h,p]=u.useState([]),N=u.useRef(0);return u.useEffect(()=>{r.length>0&&s({questions:r,currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedLetters:[],correctWord:""})},[r]),u.useEffect(()=>{if(t.questions.length>0){const j=t.questions[t.currentIndex].word.toLowerCase();if(j.includes(" ")){const z=j.split(/\s+/);c(z),m(0),p([]);const ye=[...z[0].split("")].sort(()=>Math.random()-.5);a(ye),s(ue=>({...ue,correctWord:j.replace(/\s+/g,""),answered:!1}))}else{c([]),m(0),p([]);const V=[...j.split("")].sort(()=>Math.random()-.5);a(V),s(ye=>({...ye,correctWord:j,answered:!1}))}l([]),N.current=Date.now()}},[t.currentIndex,t.questions]),{spellingState:t,setSpellingState:s,shuffledLetters:n,selectedSequence:i,setSelectedSequence:l,phraseWords:o,currentWordIndex:d,completedWords:h,handleLetterClick:S=>{if(t.answered){if(i.includes(`${S}`))l(i.filter(z=>z!==`${S}`));else{const z=[...i,`${S}`];l(z)}return}if(i.includes(`${S}`))return;const j=[...i,`${S}`];return l(j),j.length===n.length?j:null},checkAnswer:S=>{const j=S.map(V=>n[parseInt(V)]).join(""),z=Date.now()-N.current;if(o.length>0){const V=o[d];if(j===V){const ue=[...h,j];if(p(ue),d<o.length-1){const K=d+1;m(K);const Se=[...o[K].split("")].sort(()=>Math.random()-.5);return a(Se),l([]),{isPartialCorrect:!0,isComplete:!1,userWord:j,responseTime:z}}else{const K=ue.join("");return{isPartialCorrect:!0,isComplete:!0,isCorrect:K===t.correctWord,userWord:K,responseTime:z}}}else return{isPartialCorrect:!1,isComplete:!0,isCorrect:!1,userWord:[...h,j].join(""),responseTime:z}}else return{isComplete:!0,isCorrect:j===t.correctWord,userWord:j,responseTime:z}},moveToNextQuestion:()=>{s(S=>({...S,currentIndex:S.currentIndex+1,answered:!1}))},updateScore:S=>{s(j=>({...j,score:S?j.score+1:j.score,totalAnswered:j.totalAnswered+1,answered:!0}))},resetAnswer:()=>{if(l([]),s(S=>({...S,answered:!1})),o.length>0){const j=[...o[d].split("")].sort(()=>Math.random()-.5);a(j)}else{const z=[...t.questions[t.currentIndex].word.toLowerCase().split("")].sort(()=>Math.random()-.5);a(z)}N.current=Date.now()}}}function Hi(){const[r,t]=u.useState({correct:0,incorrect:0,review:0,mastered:0,newQuestions:0,reviewQuestions:0,consecutiveNew:0,consecutiveReview:0});return{sessionStats:r,setSessionStats:t,resetStats:()=>{t({correct:0,incorrect:0,review:0,mastered:0,newQuestions:0,reviewQuestions:0,consecutiveNew:0,consecutiveReview:0})},updateStats:a=>{t(i=>({...i,correct:i.correct+(a==="correct"?1:0),incorrect:i.incorrect+(a==="incorrect"?1:0),review:i.review+(a==="review"?1:0),mastered:i.mastered+(a==="mastered"?1:0)}))}}}function Vi({questions:r,_categoryList:t,selectedCategory:s,onCategoryChange:n,selectedDifficulty:a,onDifficultyChange:i,selectedWordPhraseFilter:l="all",onWordPhraseFilterChange:o,selectedPhraseTypeFilter:c="all",onPhraseTypeFilterChange:d,selectedDataSource:m="all",onDataSourceChange:h,onStartQuiz:p,onReviewFocus:N,isReviewFocusMode:b=!1,customQuestionSets:x=[],onAddWordToCustomSet:v,onRemoveWordFromCustomSet:k,onOpenCustomSetManagement:M}){var ne,ce,Ne;const{spellingState:S,setSpellingState:j,shuffledLetters:z,selectedSequence:V,setSelectedSequence:ye,phraseWords:ue,completedWords:K,handleLetterClick:he,checkAnswer:Se,moveToNextQuestion:se,updateScore:fe}=Ui(r),{sessionStats:y,setSessionStats:P,resetStats:R,updateStats:U}=Hi(),J=os(Nt.SPELLING),{reAddQuestion:Z,clearExpiredFlags:ke,updateRequeueStats:xe}=as(),[we,Le]=u.useState(!1),[Ze,Te]=u.useState(!1),[$e,He]=u.useState(Date.now()),[_e,ze]=u.useState(void 0),[We,oe]=u.useState(void 0),[Ie,qe]=u.useState(0),[Fe,Je]=u.useState(0),{learningLimit:Be,reviewLimit:et,setLearningLimit:je,setReviewLimit:T}=Qs("spelling"),[w,g]=u.useState(()=>localStorage.getItem("autoNext")==="true"),[C,I]=u.useState(()=>{const $=localStorage.getItem("autoNextDelay");return $?parseInt($,10):1500}),G=u.useRef(null),F=u.useRef(0),B=u.useRef(0),ae=u.useRef([]);u.useEffect(()=>{r.length>0&&(F.current=Date.now(),ae.current=[],R())},[r,R]),u.useEffect(()=>{if(!S.answered&&G.current){const $=setTimeout(()=>{var O;(O=G.current)==null||O.focus()},100);return()=>clearTimeout($)}},[S.answered,S.currentIndex,S.questions.length]);const be=($,O)=>{const D=he(O);D&&D.length===z.length&&setTimeout(()=>Pe(D),300)},Pe=async $=>{const O=Se($);O&&(O.isPartialCorrect&&!O.isComplete||O.isComplete&&await L(O.userWord,O.isCorrect||!1,O.responseTime))},L=async($,O,D)=>{var re;const E=S.questions[S.currentIndex];if(ze(O),oe(E.word),O?(qe(Y=>Y+1),Je(0)):(Je(Y=>Y+1),qe(0)),E){await pt(E.word,O,D,void 0,"spelling"),He(Date.now()),J.recordAnswer(E.word,O,D);const H=(re=(await rt()).wordProgress)==null?void 0:re[E.word];let de=O?"correct":"incorrect";H&&H.masteryLevel==="mastered"?de="mastered":!O&&H&&H.incorrectCount>=2&&(de="review"),U(de),bt({status:de,word:E.word,timestamp:Date.now()},"spelling"),H&&H.skippedCount&&H.skippedCount>0&&(O?Ar(E.word):Ir(E.word))}if(!O&&E){ae.current.push(E.word),y.correct+y.incorrect;{const Y=S.questions.slice(S.currentIndex+1);if(Y.length>1){const H=localStorage.getItem("learning-limit-spelling"),de=localStorage.getItem("review-limit-spelling"),Ee=H?parseInt(H):null,Ae=de?parseInt(de):null,Oe=ns(Y,{isReviewFocusMode:b||!1,learningLimit:Ee,reviewLimit:Ae,mode:"spelling"});j(Ve=>({...Ve,questions:[...Ve.questions.slice(0,Ve.currentIndex+1),...Oe]}))}}}if(!O&&E&&j(Y=>({...Y,questions:Z(E,Y.questions,Y.currentIndex)})),E){const Y=String(E.word);jt.onShown(Y),jt.onAnswer(Y,O),xe(E,y,P)}fe(O),E&&Mt({id:It(),questionSetId:"spelling-quiz-single",questionSetName:"ã‚¹ãƒšãƒ«ã‚¯ã‚¤ã‚º",score:O?1:0,total:1,percentage:O?100:0,date:Date.now(),timeSpent:Math.floor(D/1e3),incorrectWords:O?[]:[E.word],mode:"spelling"})},ee=()=>{const $=S.currentIndex+1;if($<S.questions.length){const O=ke(S.questions,$-1);O!==S.questions&&j(D=>({...D,questions:O}))}oe(void 0),se()},q=async()=>{const $=S.questions[S.currentIndex];if(!$)return;if(S.answered){ee();return}const O=Date.now()-B.current;console.log("[SpellingView] Skipå‡¦ç†é–‹å§‹:",{word:$.word,responseTime:O,currentScore:S.score,totalAnswered:S.totalAnswered}),ze(!0),oe($.word),qe(D=>D+1),Je(0),ts($.word,30),Mr($.word),await pt($.word,!0,O,void 0,"spelling"),He(Date.now()),ye([]),j(D=>({...D,totalAnswered:D.totalAnswered+1,score:D.score+1,answered:!1})),U("correct"),U("mastered"),bt({status:"correct",word:$.word,timestamp:Date.now()},"spelling"),console.log("[SpellingView] Skipå‡¦ç†å®Œäº†:",{word:$.word,newScore:S.score+1,newTotalAnswered:S.totalAnswered+1}),Mt({id:It(),questionSetId:"spelling-quiz-single",questionSetName:"ã‚¹ãƒšãƒ«ã‚¯ã‚¤ã‚º",score:1,total:1,percentage:100,date:Date.now(),timeSpent:Math.floor(O/1e3),incorrectWords:[],mode:"spelling",difficulty:$.difficulty}),ee()},_=()=>{ye([]),j($=>({...$,currentIndex:$.currentIndex>0?$.currentIndex-1:0,answered:!1})),B.current=Date.now()},W=()=>{if(V.length>0){const $=V.slice(0,-1);ye($)}},ge=S.questions.length>0,Q=ge?S.questions[S.currentIndex]:null,Ce=V.map($=>z[parseInt($)]).join(""),De=Q?{word:Q.word,meaning:Q.meaning,katakana:Q.reading,source:"spelling"}:null,A=localStorage.getItem("learning-schedule-90days"),ie=!!A;let te=null;if(ie)try{const $=JSON.parse(A),O=Math.floor((Date.now()-$.startDate)/(1e3*60*60*24)),D=Math.min(O+1,$.totalDays),E=Math.round(D/$.totalDays*100);te={currentDay:D,totalDays:$.totalDays,progressPercent:E,phase:$.phase}}catch($){f.error("Failed to parse learning plan:",$)}return e.jsxs("div",{className:"spelling-view",children:[ie&&te&&e.jsx("div",{className:"plan-progress-banner",children:e.jsxs("div",{className:"plan-progress-content",children:[e.jsx("span",{className:"plan-progress-icon",children:"ğŸ“š"}),e.jsxs("div",{className:"plan-progress-info",children:[e.jsx("div",{className:"plan-progress-title",children:"å­¦ç¿’ãƒ—ãƒ©ãƒ³é€²è¡Œä¸­"}),e.jsxs("div",{className:"plan-progress-detail",children:[te.currentDay,"æ—¥ç›® / ",te.totalDays,"æ—¥ (Phase ",te.phase,") -"," ",te.progressPercent,"%å®Œäº†"]})]})]})}),!ge&&e.jsx("div",{className:"quiz-controls",children:e.jsx("button",{onClick:p,className:"w-64 px-8 py-4 text-lg font-bold bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all duration-300 shadow-xl:bg-primary-hover",children:"ğŸ¯ ã‚¯ã‚¤ã‚ºé–‹å§‹"})}),ge?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(is,{mode:"spelling",currentScore:S.score,totalAnswered:S.totalAnswered,sessionCorrect:y.correct,sessionIncorrect:y.incorrect,sessionReview:y.review,sessionMastered:y.mastered,sessionStats:y,onReviewFocus:N,isReviewFocusMode:b,onShowSettings:()=>Le(!0),currentWord:(ne=S.questions[S.currentIndex])==null?void 0:ne.word,onAnswerTime:$e,lastAnswerCorrect:_e,lastAnswerWord:We,lastAnswerDifficulty:(ce=S.questions[S.currentIndex])==null?void 0:ce.difficulty,correctStreak:Ie,incorrectStreak:Fe,learningPhase:J.state.currentPhase??void 0,estimatedSpeed:(Ne=J.state.personalParams)==null?void 0:Ne.learningSpeed,dataSource:m==="all"?"å…¨å•é¡Œé›†":m==="junior"?"é«˜æ ¡å—é¨“":"é«˜æ ¡å—é¨“æ¨™æº–",category:s==="å…¨åˆ†é‡"?"å…¨åˆ†é‡":s,difficulty:a,wordPhraseFilter:l})})}),we&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>Le(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-200 hover:border-gray-400 transition-all duration-200 text-sm shadow-sm:bg-gray-600:border-gray-500",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"category-select-spelling",children:"ğŸ“š é–¢é€£åˆ†é‡:"}),e.jsxs("select",{id:"category-select-spelling",value:s,onChange:$=>n($.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®åˆ†é‡"}),Jr.map($=>e.jsx("option",{value:$,children:$},$))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-select-spelling",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-select-spelling",value:a,onChange:$=>i($.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®ãƒ¬ãƒ™ãƒ«"}),e.jsx("option",{value:"beginner",children:"åˆç´š"}),e.jsx("option",{value:"intermediate",children:"ä¸­ç´š"}),e.jsx("option",{value:"advanced",children:"ä¸Šç´š"})]})]}),h&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"data-source-select-spelling",children:"ğŸ“š å•é¡Œé›†:"}),e.jsxs("select",{id:"data-source-select-spelling",value:m,onChange:$=>h($.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"junior",children:"é«˜æ ¡å—é¨“"}),e.jsx("option",{value:"intermediate",children:"é«˜æ ¡å—é¨“æ¨™æº–"})]})]}),o&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"word-phrase-filter-spelling",children:"ğŸ“– å˜èª/ç†Ÿèª:"}),e.jsxs("select",{id:"word-phrase-filter-spelling",value:l,onChange:$=>o($.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"words-only",children:"å˜èªã®ã¿"}),e.jsx("option",{value:"phrases-only",children:"ç†Ÿèªã®ã¿"})]})]}),d&&l==="phrases-only"&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"phrase-type-filter-spelling",children:"ğŸ·ï¸ ç†Ÿèªã‚¿ã‚¤ãƒ—:"}),e.jsxs("select",{id:"phrase-type-filter-spelling",value:c,onChange:$=>{d&&d($.target.value)},className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"phrasal-verb",children:"å¥å‹•è©"}),e.jsx("option",{value:"idiom",children:"ã‚¤ãƒ‡ã‚£ã‚ªãƒ "}),e.jsx("option",{value:"collocation",children:"ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³"}),e.jsx("option",{value:"other",children:"ãã®ä»–"})]})]}),e.jsx(Fs,{learningLimit:Be,reviewLimit:et,onLearningLimitChange:je,onReviewLimitChange:T,idPrefix:"spelling-quiz-"})]}),Q&&e.jsxs("div",{className:"question-card relative",children:[e.jsx("button",{onClick:()=>Te(!0),className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsxs("div",{className:"question-nav-row meaning-row",children:[e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:_,disabled:S.currentIndex===0,title:"å‰ã¸",children:"â†"}),e.jsxs("div",{className:"meaning-display",children:[e.jsxs("div",{className:"meaning-line",children:[e.jsx("span",{className:"text-xl text-gray-600",children:"æ„å‘³:"}),e.jsx("span",{className:"text-4xl font-bold text-gray-900 ml-2",children:Q.meaning})]}),De&&v&&k&&M&&x&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx(At,{word:De,sets:x,onAddWord:v,onRemoveWord:k,onOpenManagement:M,size:"medium",variant:"both"})}),e.jsxs("div",{className:"meaning-meta",children:[Q.difficulty&&e.jsx("div",{className:`difficulty-badge ${Q.difficulty}`,children:Q.difficulty==="beginner"?"åˆç´š":Q.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"}),Q.word.includes(" ")&&e.jsxs("div",{className:"phrase-hint",children:["ğŸ’¡ ç†Ÿèª(",ue.length,"èª): å˜èªã”ã¨ã«å…¥åŠ›ã—ã¦ãã ã•ã„",K.length>0&&e.jsxs("span",{className:"phrase-progress",children:[" ","(å®Œæˆ: ",K.join(" "),")"]})]})]})]}),e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:S.answered?ee:q,disabled:S.currentIndex>=S.questions.length-1,title:S.answered?"æ¬¡ã¸":"ã‚¹ã‚­ãƒƒãƒ—",children:"â†’"})]}),e.jsx("div",{className:"question-content-inline",children:e.jsxs("div",{className:"user-word-display",children:[e.jsx("div",{className:"user-word-label",children:"ã‚ãªãŸã®ç­”ãˆ:"}),e.jsx("div",{className:"user-word-text",children:ue.length>0?e.jsxs(e.Fragment,{children:[K.join(" "),K.length>0&&" ",Ce||"ï¼ˆä¸¦ã³æ›¿ãˆï¼‰"]}):Ce||"ï¼ˆä¸¦ã³æ›¿ãˆï¼‰"})]})}),e.jsx("div",{className:"letter-cards",ref:G,tabIndex:0,onKeyDown:$=>{if(S.answered)$.key==="Enter"&&($.preventDefault(),ee());else{const O=$.key.toLowerCase();if(O.length===1&&O>="a"&&O<="z"){$.preventDefault();const D=z.findIndex((E,re)=>E===O&&!V.includes(`${re}`));D!==-1&&be(O,D)}else $.key==="Backspace"?($.preventDefault(),W()):($.key===" "||$.key==="Enter")&&($.preventDefault(),q())}},children:z.map(($,O)=>{const D=V.includes(`${O}`),E=V.indexOf(`${O}`)+1;let re="";return S.answered&&D&&(re=V.map(de=>z[parseInt(de)]).join("")===S.correctWord?"correct":"incorrect"),e.jsxs("button",{className:`letter-card ${D?"selected":""} ${S.answered?"practice-mode":""} ${re}`,onClick:()=>be($,O),children:[$,D&&e.jsx("span",{className:"selection-number",children:E})]},O)})}),!S.answered&&e.jsxs("div",{className:"spelling-reset-button-container",children:[V.length>0&&e.jsx("button",{className:"btn-reset-selection",onClick:W,children:"âŒ« 1æ–‡å­—æˆ»ã™"}),e.jsx("button",{className:"btn-skip-word",onClick:q,children:"â­ï¸ åˆ†ã‹ã‚‰ãªã„ (ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼)"})]}),S.answered&&e.jsxs("div",{className:"result-display",children:[e.jsxs("div",{className:"correct-answer",children:[Ce===S.correctWord?"âœ… æ­£è§£: ":Ce===""?"â­ï¸ ã‚¹ã‚­ãƒƒãƒ— - æ­£è§£: ":"âŒ ä¸æ­£è§£ - æ­£è§£: ",e.jsxs("strong",{className:Ge()?"clickable-word":"",onClick:$=>{$.stopPropagation(),Ge()&&Q&&st(Q.word,{rate:.85})},title:Ge()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":void 0,children:[(Q==null?void 0:Q.word)||S.correctWord,Ge()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"}),(Q==null?void 0:Q.reading)&&e.jsxs("span",{className:"pronunciation-hint",children:["(",Q.reading,")"]})]})]}),e.jsxs("div",{className:"question-details-spelling",children:[Q.reading&&e.jsxs("div",{className:"detail-row clickable-row",onClick:()=>Ge()&&st(Q.word,{rate:.85}),title:"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ ğŸ”Š",children:[e.jsx("span",{className:"detail-label",children:"èª­ã¿:"}),e.jsx("span",{className:"detail-content",children:Q.reading})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"æ„å‘³:"}),e.jsx("span",{className:"detail-content",children:Q.meaning})]}),Q.etymology&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"ğŸ“š èªæºç­‰è§£èª¬:"}),e.jsx("span",{className:"detail-content",children:Q.etymology})]}),Q.relatedWords&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"ğŸ”— é–¢é€£èª:"}),e.jsx("span",{className:"detail-content",children:Q.relatedWords})]}),Q.relatedFields&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"ğŸ·ï¸ é–¢é€£åˆ†é‡:"}),e.jsx("span",{className:"detail-content",children:Q.relatedFields})]}),Q.difficulty&&e.jsxs("div",{className:"detail-row clickable-row",onClick:()=>Ge()&&st(Q.word,{rate:.85}),title:"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ ğŸ”Š",children:[e.jsx("span",{className:"detail-label",children:"é›£æ˜“åº¦:"}),e.jsx("div",{className:`difficulty-badge ${Q.difficulty}`,children:Q.difficulty==="beginner"?"åˆç´š":Q.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})]})]})]})]})]}):e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"ğŸ“– æ¡ä»¶ã‚’é¸æŠã—ã¦ã€Œã‚¯ã‚¤ã‚ºé–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„"})})]})}function Ji(r){const t=r.split("/").pop()||"",n=t.replace(/\.txt$/,"").split("_");return n.length>=3?n.slice(2).join("_"):t}const Yi=[{id:"beginner-morning-routine",level:"beginner",topic:"daily-life",wordCount:50,filePath:"/data/passages-for-phrase-work/beginner_50_Morning-Routine.txt"},{id:"beginner-supermarket-shopping",level:"beginner",topic:"daily-life",wordCount:1910,filePath:"/data/passages-for-phrase-work/beginner_1910_Shopping-at-the-Supermarket.txt"},{id:"beginner-cafe-day",level:"beginner",topic:"food-culture",wordCount:1380,filePath:"/data/passages-for-phrase-work/beginner_1380_A-Day-at-the-Cafe.txt"},{id:"beginner-conversation-daily",level:"beginner",topic:"communication",wordCount:3018,filePath:"/data/passages-for-phrase-work/beginner_3018_Daily-Conversations.txt"},{id:"beginner-weather-seasons",level:"beginner",topic:"nature",wordCount:2111,filePath:"/data/passages-for-phrase-work/beginner_2111_Weather-and-Seasons.txt"},{id:"beginner-wildlife-park-guide",level:"beginner",topic:"animals",wordCount:2097,filePath:"/data/passages-for-phrase-work/beginner_2097_Wildlife-Park-Guide.txt"},{id:"intermediate-exchange-student-australia",level:"intermediate",topic:"culture-exchange",wordCount:3199,filePath:"/data/passages-for-phrase-work/intermediate_3199_Exchange-Student-in-Australia.txt"},{id:"intermediate-homestay-america",level:"intermediate",topic:"culture-exchange",wordCount:3148,filePath:"/data/passages-for-phrase-work/intermediate_3148_Homestay-in-America.txt"},{id:"intermediate-career-day",level:"intermediate",topic:"education-career",wordCount:2895,filePath:"/data/passages-for-phrase-work/intermediate_2895_Career-Day-at-School.txt"},{id:"intermediate-hospital-visit",level:"intermediate",topic:"health",wordCount:2721,filePath:"/data/passages-for-phrase-work/intermediate_2721_A-Visit-to-the-Hospital.txt"},{id:"intermediate-science-museum",level:"intermediate",topic:"science-education",wordCount:3265,filePath:"/data/passages-for-phrase-work/intermediate_3265_Science-Museum-Experience.txt"},{id:"intermediate-community-events",level:"intermediate",topic:"community",wordCount:2216,filePath:"/data/passages-for-phrase-work/intermediate_2216_Community-Events.txt"},{id:"intermediate-school-events-year",level:"intermediate",topic:"school-life",wordCount:2558,filePath:"/data/passages-for-phrase-work/intermediate_2558_A-Year-of-School-Events.txt"},{id:"intermediate-school-news",level:"intermediate",topic:"school-life",wordCount:1937,filePath:"/data/passages-for-phrase-work/intermediate_1937_School-News.txt"},{id:"advanced-environmental-issues",level:"advanced",topic:"environment",wordCount:4263,filePath:"/data/passages-for-phrase-work/advanced_4263_Environmental-Issues-and-Solutions.txt"},{id:"advanced-family-gathering",level:"advanced",topic:"culture-family",wordCount:4493,filePath:"/data/passages-for-phrase-work/advanced_4493_Family-Gathering-Traditions.txt"},{id:"advanced-health-statistics",level:"advanced",topic:"health-data",wordCount:3422,filePath:"/data/passages-for-phrase-work/advanced_3422_Health-Statistics-Analysis.txt"},{id:"advanced-historical-figures",level:"advanced",topic:"history",wordCount:3115,filePath:"/data/passages-for-phrase-work/advanced_3115_Historical-Figures-Study.txt"},{id:"advanced-international-exchange",level:"advanced",topic:"culture-global",wordCount:3813,filePath:"/data/passages-for-phrase-work/advanced_3813_Cultural-Exchange-Insights.txt"},{id:"advanced-school-festival",level:"advanced",topic:"school-events",wordCount:4419,filePath:"/data/passages-for-phrase-work/advanced_4419_School-Festival-Planning.txt"},{id:"advanced-summer-vacation-stories",level:"advanced",topic:"personal-growth",wordCount:3255,filePath:"/data/passages-for-phrase-work/advanced_3255_Summer-Vacation-Stories.txt"},{id:"advanced-technology-future",level:"advanced",topic:"technology-innovation",wordCount:3161,filePath:"/data/passages-for-phrase-work/advanced_3161_Technology-and-Future.txt"}],Gs=Yi.map(r=>({...r,title:Ji(r.filePath),level:r.level}));function Qr(){return Gs}async function Gr(r){try{const t=Gs.find(l=>l.id===r);if(!t)return f.error(`Passage not found: ${r}`),"";const n=`/data/passages-original/${t.filePath.split("/").pop()||""}`,a=await fetch(n);return a.ok?await a.text():(f.log(`Original file not found: ${n}`),"")}catch(t){return f.error(`Error loading original passage ${r}:`,t),""}}async function Ki(r){const t=Gs.find(s=>s.id===r);if(!t)return f.error(`Passage not found: ${r}`),null;try{const s=await fetch(t.filePath);if(!s.ok)throw new Error(`Failed to fetch: ${s.statusText}`);const n=await s.text(),a=Xi(n);return{...t,content:n,sections:a}}catch(s){return f.error(`Error loading passage ${r}:`,s),null}}function Xi(r){const t=r.split(`
`),s=[];let n=null;for(const a of t){const i=a.trim();i&&(!a.startsWith("    ")&&i.length>0&&i.length<80?(n&&s.push(n),n={title:i,paragraphs:[]}):a.startsWith("    ")&&n&&n.paragraphs.push(i))}return n&&s.push(n),s}function xt(r){const t=r.toLowerCase().trim();if(t.endsWith("ing")&&t.length>4){const s=t.slice(0,-3);return s.endsWith("n")||s.endsWith("m")||s.endsWith("t")?s.slice(0,-1):s+"e"}if(t.endsWith("ed")&&t.length>3){const s=t.slice(0,-2);return s.endsWith("i")?s.slice(0,-1)+"y":s}return t.endsWith("es")&&t.length>3?t.slice(0,-2):t.endsWith("s")&&t.length>2&&!t.endsWith("ss")?t.slice(0,-1):t}async function Br(r){try{let t=`/data/passages/passages-translations/${r}-ja.txt`;console.log(`[å…¨è¨³] Attempting to load: ${t} for passageId: ${r}`);let s=await fetch(t);if(s.ok||(t=`/data/passages-translations/${r}-ja.txt`,console.log(`[å…¨è¨³] Trying old path: ${t}`),s=await fetch(t)),!s.ok)return console.log(`[å…¨è¨³] File not found (${s.status}): ${t}`),"";const n=await s.text();return console.log(`[å…¨è¨³] Successfully loaded ${n.length} characters from ${t}`),n}catch(t){return console.error(`[å…¨è¨³] Error loading full translation for ${r}:`,t),""}}async function Zi(r){try{const t=Qr().find(o=>o.id===r);if(!t)return[];const n=`/data/passages-for-phrase-work-ja/${(t.filePath.split("/").pop()||"").replace(/\.txt$/,"-ja.txt")}`,a=await fetch(n);if(!a.ok)return f.log(`No Japanese phrase file found: ${n}`),[];const l=(await a.text()).split(`
`).map(o=>o.trim()).filter(o=>o.length>0);return f.log(`Loaded ${l.length} Japanese phrases from ${n}`),l}catch(t){return f.error(`Error loading Japanese phrases for ${r}:`,t),[]}}async function eo(r,t){const s=await Ki(r);if(!s)return null;const[n,a,i]=await Promise.all([Zi(r),Br(r),Gr(r)]);let l=0;const o=[];return s.sections.forEach(d=>{d.paragraphs.forEach(m=>{if(m.match(/^([^:]+):\s*"([^"]+)"$/)){const p=m.trim(),N=p.split(/\s+/),b=N.map(v=>{let k=v,M="";if(k.startsWith('"')&&(M='"',k=k.substring(1)),/^(Ms|Mr|Mrs|Dr|Prof|St|Ave|Inc|Ltd|etc)\.$|^[A-Z]\.$|^vs\.$|^e\.g\.$|^i\.e\.$/.test(k)){const z=xt(k.replace(/\.$/,"")),V=t.get(z),ye=(V==null?void 0:V.meaning)||"",ue=[];return M&&ue.push({word:M,meaning:"",isUnknown:!1}),ue.push({word:k,meaning:ye==="-"?"":ye,isUnknown:!1}),ue}const j=k.match(/([.,!?;:â€”"])$/);if(j){const z=k.replace(/[.,!?;:â€”"]$/,""),V=j[1];if(!z){const Se=[];return M&&Se.push({word:M,meaning:"",isUnknown:!1}),Se.push({word:V,meaning:"",isUnknown:!1}),Se}const ye=xt(z),ue=t.get(ye),K=(ue==null?void 0:ue.meaning)||"",he=[];return M&&he.push({word:M,meaning:"",isUnknown:!1}),he.push({word:z,meaning:K==="-"?"":K,isUnknown:!1}),he.push({word:V,meaning:"",isUnknown:!1}),he}else{const z=xt(k),V=t.get(z),ye=(V==null?void 0:V.meaning)||"",ue=[];return M&&ue.push({word:M,meaning:"",isUnknown:!1}),ue.push({word:k,meaning:ye==="-"?"":ye,isUnknown:!1}),ue}}).flat(),x=n[l]||"";l++,o.push({english:p,japanese:x,phraseMeaning:x,words:N,segments:b})}else{const p=m.trim(),N=p.split(/\s+/),b=N.map(v=>{if(/^(Ms|Mr|Mrs|Dr|Prof|St|Ave|Inc|Ltd|etc)\.$|^[A-Z]\.$|^vs\.$|^e\.g\.$|^i\.e\.$/.test(v)){const S=xt(v.replace(/\.$/,"")),j=t.get(S),z=(j==null?void 0:j.meaning)||"";return{word:v,meaning:z==="-"?"":z,isUnknown:!1}}const M=v.match(/([.,!?;:â€”])$/);if(M){const S=v.replace(/[.,!?;:â€”]$/,""),j=M[1];if(!S)return{word:j,meaning:"",isUnknown:!1};const z=xt(S),V=t.get(z),ye=(V==null?void 0:V.meaning)||"";return[{word:S,meaning:ye==="-"?"":ye,isUnknown:!1},{word:j,meaning:"",isUnknown:!1}]}else{const S=xt(v),j=t.get(S),z=(j==null?void 0:j.meaning)||"";return{word:v,meaning:z==="-"?"":z,isUnknown:!1}}}).flat(),x=n[l]||"";l++,o.push({english:p,japanese:x,phraseMeaning:x,words:N,segments:b})}})}),{id:s.id,title:s.title,level:s.level,actualWordCount:s.wordCount,phrases:o,translation:a,originalText:i}}async function to(r){var t;try{const s=await fetch(`/data/passages-phrase-learning/${r}.json`);if(!s.ok)return f.log(`No phrase learning JSON found for ${r}, will use .txt conversion`),null;const n=await s.json();f.log(`Loaded phrase learning JSON for ${r}, phrases: ${((t=n.phrases)==null?void 0:t.length)||0}`);const[a,i]=await Promise.all([Br(r),Gr(r)]);return{...n,phrases:n.phrases||[],translation:a,originalText:i}}catch{return f.log(`Skipping phrase learning JSON for ${r} (file may be old or moved), will use .txt conversion`),null}}async function so(r){var n;const t=Qr(),s=[];f.log(`Loading ${t.length} passages...`);for(const a of t){let i=await to(a.id);i||(i=await eo(a.id,r)),i?(f.log(`âœ“ Loaded passage: ${a.id} (${((n=i.phrases)==null?void 0:n.length)||0} phrases)`),s.push(i)):f.error(`âœ— Failed to load passage: ${a.id}`)}return f.log(`Total passages loaded: ${s.length}`),s}const ar=new Set(["be","am","is","are","was","were","been","being","have","has","had","having","do","does","did","done","doing","can","could","will","would","shall","should","may","might","must","go","goes","went","gone","going","get","gets","got","gotten","getting","make","makes","made","making","take","takes","took","taken","taking","see","sees","saw","seen","seeing","come","comes","came","coming","want","wants","wanted","wanting","use","uses","used","using","find","finds","found","finding","give","gives","gave","given","giving","tell","tells","told","telling","work","works","worked","working","call","calls","called","calling","try","tries","tried","trying","ask","asks","asked","asking","need","needs","needed","needing","feel","feels","felt","feeling","become","becomes","became","becoming","leave","leaves","left","leaving","put","puts","putting","mean","means","meant","meaning","keep","keeps","kept","keeping","let","lets","letting","begin","begins","began","begun","beginning","seem","seems","seemed","seeming","help","helps","helped","helping","talk","talks","talked","talking","turn","turns","turned","turning","start","starts","started","starting","show","shows","showed","shown","showing","hear","hears","heard","hearing","play","plays","played","playing","run","runs","ran","running","move","moves","moved","moving","like","likes","liked","liking","live","lives","lived","living","believe","believes","believed","believing","bring","brings","brought","bringing","happen","happens","happened","happening","write","writes","wrote","written","writing","sit","sits","sat","sitting","stand","stands","stood","standing","lose","loses","lost","losing","pay","pays","paid","paying","meet","meets","met","meeting","include","includes","included","including","continue","continues","continued","continuing","set","sets","setting","learn","learns","learned","learning","change","changes","changed","changing","lead","leads","led","leading","understand","understands","understood","understanding","watch","watches","watched","watching","follow","follows","followed","following","stop","stops","stopped","stopping","create","creates","created","creating","speak","speaks","spoke","spoken","speaking","read","reads","reading","spend","spends","spent","spending","grow","grows","grew","grown","growing","open","opens","opened","opening","walk","walks","walked","walking","win","wins","won","winning","teach","teaches","taught","teaching","offer","offers","offered","offering","remember","remembers","remembered","remembering","consider","considers","considered","considering","appear","appears","appeared","appearing","buy","buys","bought","buying","serve","serves","served","serving","die","dies","died","dying","send","sends","sent","sending","build","builds","built","building","stay","stays","stayed","staying","fall","falls","fell","fallen","falling","cut","cuts","cutting","reach","reaches","reached","reaching","kill","kills","killed","killing","raise","raises","raised","raising","pass","passes","passed","passing","sell","sells","sold","selling","decide","decides","decided","deciding","return","returns","returned","returning","explain","explains","explained","explaining","hope","hopes","hoped","hoping","develop","develops","developed","developing","carry","carries","carried","carrying","break","breaks","broke","broken","breaking","receive","receives","received","receiving","agree","agrees","agreed","agreeing","support","supports","supported","supporting","hit","hits","hitting","produce","produces","produced","producing","eat","eats","ate","eaten","eating","cover","covers","covered","covering","catch","catches","caught","catching","draw","draws","drew","drawn","drawing","wake","wakes","woke","woken","waking","brush","brushes","brushed","brushing","wash","washes","washed","washing","prepare","prepares","prepared","preparing","check","checks","checked","checking"]),Ur=new Set(["in","on","at","to","for","with","from","by","about","as","into","like","through","after","over","between","out","against","during","without","before","under","around","among","of","up"]),ro=new Set(["and","but","or","so","yet","for","nor","because","although","if","when","while","since","unless","that","which","who","whom","whose","where"]),no=new Set(["the","a","an","this","that","these","those","my","your","his","her","its","our","their","some","any","no","every","each","either","neither","much","many","more","most","few","little","several"]),ao=new Set(["i","you","he","she","it","we","they","me","him","her","us","them","myself","yourself","himself","herself","itself","ourselves","themselves"]),io=new Set(["good","new","first","last","long","great","little","own","other","old","right","big","high","different","small","large","next","early","young","important","few","public","bad","same","able","ready","usual","toast","juice"]),oo=new Set(["not","so","up","out","just","now","how","then","more","also","here","well","only","very","even","back","there","down","still","in","as","too","when","never","really","usually","finally","first","after","before"]);function lo(r){return{S:"#3b82f6",V:"#ef4444",O:"#10b981",C:"#f59e0b",M:"#8b5cf6",Prep:"#6366f1",Conj:"#ec4899",Det:"#14b8a6",Adj:"#f97316",Adv:"#a855f7",Unknown:"#6b7280"}[r]}function co(r){return{S:"ä¸»èª",V:"å‹•è©",O:"ç›®çš„èª",C:"è£œèª",M:"ä¿®é£¾èª",Prep:"å‰ç½®è©",Conj:"æ¥ç¶šè©",Det:"å† è©ãƒ»é™å®šè©",Adj:"å½¢å®¹è©",Adv:"å‰¯è©",Unknown:"ä¸æ˜"}[r]}function uo(r,t,s){var a;const n=r.toLowerCase();return/^[.,!?;:]$/.test(r)?"Unknown":ar.has(n)?"V":Ur.has(n)?"Prep":ro.has(n)?"Conj":no.has(n)?"Det":io.has(n)?"Adj":oo.has(n)?"Adv":ao.has(n)?t===0||t>0&&ar.has((a=s[t+1])==null?void 0:a.toLowerCase())?"S":"O":"Unknown"}function mo(r){return{".":"æ–‡ã®çµ‚ã‚ã‚Š",",":"åŒºåˆ‡ã‚Šãƒ»åˆ—æŒ™","!":"æ„Ÿå˜†ãƒ»å¼·èª¿","?":"ç–‘å•",";":"é–¢é€£ã™ã‚‹æ–‡ã®åŒºåˆ‡ã‚Š",":":"èª¬æ˜ãƒ»ä¾‹ç¤ºã®å°å…¥","-":"è£œè¶³èª¬æ˜ãƒ»è¨€ã„æ›ãˆ","â€”":"å¼·ã„åŒºåˆ‡ã‚Šãƒ»æŒ¿å…¥","â€“":"ç¯„å›²ãƒ»é–¢ä¿‚",'"':"å¼•ç”¨","'":"å¼•ç”¨ãƒ»æ‰€æœ‰æ ¼","(":"è£œè¶³æƒ…å ±ã®é–‹å§‹",")":"è£œè¶³æƒ…å ±ã®çµ‚äº†"}[r]||"å¥èª­ç‚¹"}function $t(r){const t=r.match(/\b[\w']+\b|[.,!?;:\-â€”â€“"'()]/g)||[],s=[];let n=!1,a=!1;for(let i=0;i<t.length;i++){const l=t[i];if(/^[.,!?;:\-â€”â€“"'()]$/.test(l)){s.push({word:l,tag:"Unknown",color:"#6b7280",description:mo(l)});continue}let o=uo(l,i,t);o==="Unknown"&&(i===0&&/^[A-Z]/.test(l)&&!a?(o="S",a=!0):n&&!a?o="O":(i>0&&Ur.has(t[i-1].toLowerCase()),o="M")),o==="V"&&(n=!0),o==="S"&&(a=!0),s.push({word:l,tag:o,color:lo(o),description:co(o)})}return s}const ho=[{words:["wake","up"],meaning:"èµ·ãã‚‹",type:"phrasal-verb"},{words:["get","up"],meaning:"èµ·åºŠã™ã‚‹",type:"phrasal-verb"},{words:["wake","up"],meaning:"ç›®ã‚’è¦šã¾ã™",type:"phrasal-verb"},{words:["brush","my","teeth"],meaning:"æ­¯ã‚’ç£¨ã",type:"phrasal-verb"},{words:["wash","my","face"],meaning:"é¡”ã‚’æ´—ã†",type:"phrasal-verb"},{words:["have","breakfast"],meaning:"æœé£Ÿã‚’é£Ÿã¹ã‚‹",type:"phrasal-verb"},{words:["go","to","school"],meaning:"å­¦æ ¡ã«è¡Œã",type:"phrasal-verb"},{words:["come","back"],meaning:"å¸°ã£ã¦ãã‚‹",type:"phrasal-verb"},{words:["come","home"],meaning:"å¸°å®…ã™ã‚‹",type:"phrasal-verb"},{words:["do","homework"],meaning:"å®¿é¡Œã‚’ã™ã‚‹",type:"phrasal-verb"},{words:["go","to","bed"],meaning:"å¯ã‚‹",type:"phrasal-verb"},{words:["at","seven"],meaning:"7æ™‚ã«",type:"time-expression"},{words:["in","the","morning"],meaning:"æœã«",type:"time-expression"},{words:["in","the","afternoon"],meaning:"åˆå¾Œã«",type:"time-expression"},{words:["in","the","evening"],meaning:"å¤•æ–¹ã«",type:"time-expression"},{words:["at","night"],meaning:"å¤œã«",type:"time-expression"},{words:["every","morning"],meaning:"æ¯æœ",type:"determiner-noun"},{words:["every","day"],meaning:"æ¯æ—¥",type:"determiner-noun"},{words:["every","night"],meaning:"æ¯æ™©",type:"determiner-noun"},{words:["every","week"],meaning:"æ¯é€±",type:"determiner-noun"}];function go(r){const t=[],s=r.map(n=>n.toLowerCase());for(const n of ho){const a=n.words.map(i=>i.toLowerCase());for(let i=0;i<=s.length-a.length;i++){let l=!0;for(let o=0;o<a.length;o++)if(s[i+o]!==a[o]){l=!1;break}l&&t.push({...n,words:r.slice(i,i+a.length)})}}return t}const po=[{name:"too ~ to ...",meaning:"ã€œã™ãã¦...ã§ããªã„",pattern:/\btoo\s+\w+\s+to\s+\w+/i,explanation:"ã€Œtoo + å½¢å®¹è©/å‰¯è© + to + å‹•è©ã€ã®å½¢ã§ã€ã€Œã€œã™ãã¦...ã§ããªã„ã€ã¨ã„ã†æ„å‘³"},{name:"so ~ that ...",meaning:"ã¨ã¦ã‚‚ã€œãªã®ã§...",pattern:/\bso\s+\w+\s+that\b/i,explanation:"ã€Œso + å½¢å®¹è©/å‰¯è© + that ~ã€ã®å½¢ã§ã€ã€Œã¨ã¦ã‚‚ã€œãªã®ã§...ã€ã¨ã„ã†æ„å‘³"},{name:"so that ...",meaning:"ã€œã™ã‚‹ãŸã‚ã«",pattern:/\bso\s+that\b/i,explanation:"ã€Œso that ~ã€ã®å½¢ã§ã€ã€Œã€œã™ã‚‹ãŸã‚ã«ã€ã¨ã„ã†ç›®çš„ã‚’è¡¨ã™"},{name:"It is ~ for ... to",meaning:"...ãŒã€œã™ã‚‹ã®ã¯",pattern:/\bit\s+is\s+\w+\s+for\s+\w+\s+to\b/i,explanation:"ã€ŒIt is + å½¢å®¹è© + for + äºº + to + å‹•è©ã€ã®å½¢ã§ã€ã€Œ(äºº)ãŒã€œã™ã‚‹ã®ã¯...ã ã€ã¨ã„ã†æ„å‘³"},{name:"It is ~ to ...",meaning:"ã€œã™ã‚‹ã“ã¨ã¯...ã ",pattern:/\bit\s+is\s+\w+\s+to\s+\w+/i,explanation:"ã€ŒIt is + å½¢å®¹è© + to + å‹•è©ã€ã®å½¢ã§ã€ã€Œã€œã™ã‚‹ã“ã¨ã¯...ã ã€ã¨ã„ã†æ„å‘³"},{name:"It is ~ that ...",meaning:"...ãªã®ã¯ã€œã  (å¼·èª¿)",pattern:/\bit\s+is\s+\w+\s+that\b/i,explanation:"å¼·èª¿æ§‹æ–‡ã€‚ã€ŒIt is ~ that ...ã€ã®å½¢ã§ã€ç‰¹å®šã®éƒ¨åˆ†ã‚’å¼·èª¿ã™ã‚‹"},{name:"not only ~ but also ...",meaning:"ã€œã ã‘ã§ãªã...ã‚‚",pattern:/\bnot\s+only\s+.+\s+but\s+also\b/i,explanation:"ã€Œnot only A but also Bã€ã®å½¢ã§ã€ã€ŒAã ã‘ã§ãªãBã‚‚ã€ã¨ã„ã†æ„å‘³"},{name:"either ~ or ...",meaning:"ã€œã‹...ã‹ã©ã¡ã‚‰ã‹",pattern:/\beither\s+.+\s+or\b/i,explanation:"ã€Œeither A or Bã€ã®å½¢ã§ã€ã€ŒAã‹Bã‹ã©ã¡ã‚‰ã‹ã€ã¨ã„ã†é¸æŠã‚’è¡¨ã™"},{name:"neither ~ nor ...",meaning:"ã€œã‚‚...ã‚‚ãªã„",pattern:/\bneither\s+.+\s+nor\b/i,explanation:"ã€Œneither A nor Bã€ã®å½¢ã§ã€ã€ŒAã‚‚Bã‚‚ãªã„ã€ã¨ã„ã†å¦å®šã‚’è¡¨ã™"},{name:"both ~ and ...",meaning:"ã€œã‚‚...ã‚‚ä¸¡æ–¹",pattern:/\bboth\s+.+\s+and\b/i,explanation:"ã€Œboth A and Bã€ã®å½¢ã§ã€ã€ŒAã‚‚Bã‚‚ä¸¡æ–¹ã€ã¨ã„ã†æ„å‘³"},{name:"as ~ as ...",meaning:"...ã¨åŒã˜ãã‚‰ã„ã€œ",pattern:/\bas\s+\w+\s+as\b/i,explanation:"ã€Œas + å½¢å®¹è©/å‰¯è© + as ...ã€ã®å½¢ã§ã€ã€Œ...ã¨åŒã˜ãã‚‰ã„ã€œã€ã¨ã„ã†åŒç­‰æ¯”è¼ƒ"},{name:"not as ~ as ...",meaning:"...ã»ã©ã€œãªã„",pattern:/\bnot\s+as\s+\w+\s+as\b/i,explanation:"ã€Œnot as + å½¢å®¹è©/å‰¯è© + as ...ã€ã®å½¢ã§ã€ã€Œ...ã»ã©ã€œãªã„ã€ã¨ã„ã†æ„å‘³"},{name:"one of the ~est",meaning:"æœ€ã‚‚ã€œãªã‚‚ã®ã®1ã¤",pattern:/\bone\s+of\s+the\s+\w+est\b/i,explanation:"ã€Œone of the + æœ€ä¸Šç´š + è¤‡æ•°åè©ã€ã®å½¢ã§ã€ã€Œæœ€ã‚‚ã€œãªã‚‚ã®ã®1ã¤ã€ã¨ã„ã†æ„å‘³"},{name:"make/let/have + äºº + å‹•è©",meaning:"äººã«ã€œã•ã›ã‚‹",pattern:/\b(make|let|have|help)\s+\w+\s+\w+/i,explanation:"ä½¿å½¹å‹•è©ã®æ§‹æ–‡ã€‚ã€Œmake/let/have + äºº + å‹•è©ã®åŸå½¢ã€ã§ã€Œäººã«ã€œã•ã›ã‚‹ã€"},{name:"be used to ~ing",meaning:"ã€œã™ã‚‹ã“ã¨ã«æ…£ã‚Œã¦ã„ã‚‹",pattern:/\b(am|is|are|was|were)\s+used\s+to\s+\w+ing\b/i,explanation:"ã€Œbe used to + å‹•åè©ã€ã®å½¢ã§ã€ã€Œã€œã™ã‚‹ã“ã¨ã«æ…£ã‚Œã¦ã„ã‚‹ã€ã¨ã„ã†æ„å‘³"},{name:"used to + å‹•è©",meaning:"æ˜”ã¯ã€œã—ãŸã‚‚ã®ã ",pattern:/\bused\s+to\s+\w+/i,explanation:"ã€Œused to + å‹•è©ã®åŸå½¢ã€ã®å½¢ã§ã€ã€Œæ˜”ã¯ã€œã—ãŸã‚‚ã®ã ã€ã¨ã„ã†éå»ã®ç¿’æ…£ã‚’è¡¨ã™"}];function fo(r){const t=[];for(const s of po)s.pattern.test(r)&&t.push(s);return t}function ir(r){return{beginner:"åˆç´š",intermediate:"ä¸­ç´š",advanced:"ä¸Šç´š",Advanced:"ä¸Šç´š",åˆç´š:"åˆç´š",ä¸­ç´š:"ä¸­ç´š",ä¸Šç´š:"ä¸Šç´š"}[r]||r}function Hr({onSaveUnknownWords:r,customQuestionSets:t=[],onAddWordToCustomSet:s,onRemoveWordFromCustomSet:n,onOpenCustomSetManagement:a}){var je;const[i,l]=u.useState([]),[o,c]=u.useState(null),[d,m]=u.useState([]),[h,p]=u.useState([]),[N,b]=u.useState("all"),[x,v]=u.useState(null),[k,M]=u.useState(new Map),[S,j]=u.useState(new Map),[z,V]=u.useState(null),[ye,ue]=u.useState(!1),[K,he]=u.useState(!0),[Se,se]=u.useState("reading"),[fe,y]=u.useState(0),[P,R]=u.useState(!1),[U,J]=u.useState(!1),[Z,ke]=u.useState(null),[xe,we]=u.useState(null),[Le,Ze]=u.useState(!1),[Te,$e]=u.useState(!1),[He,_e]=u.useState(!0);u.useEffect(()=>{if(i.length>0){const T="reading-unknown-words-state";try{const w=i.map(g=>({id:g.id,unknownWords:g.phrases.flatMap((C,I)=>C.segments.map((G,F)=>G.isUnknown?`${I}-${F}`:null).filter(Boolean))}));localStorage.setItem(T,JSON.stringify(w))}catch(w){f.warn("åˆ†ã‹ã‚‰ãªã„å˜èªã®çŠ¶æ…‹ä¿å­˜ã«å¤±æ•—:",w)}}},[i]),u.useEffect(()=>{f.log("[é•·æ–‡] è¾æ›¸ã®èª­ã¿è¾¼ã¿ã‚’é–‹å§‹..."),fetch("/data/vocabulary/high-school-entrance-words.csv").then(T=>{if(!T.ok)throw new Error(`CSVèª­ã¿è¾¼ã¿å¤±æ•—: ${T.status}`);return T.text()}).then(T=>{const w=T.split(`
`),g=new Map;w.slice(1).forEach(C=>{if(!C.trim())return;const I=C.split(",").map(G=>G.trim());if(I.length>=7){const G=I[0].toLowerCase().trim();g.set(G,{word:I[0],reading:I[1],meaning:I[2],etymology:I[3],relatedWords:I[4],relatedFields:I[5],difficulty:I[6]})}}),f.log(`[é•·æ–‡] ãƒ¡ã‚¤ãƒ³è¾æ›¸: ${g.size}å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`),M(g)}).catch(T=>{}),fetch("/data/dictionaries/reading-passages-dictionary.json").then(T=>{if(!T.ok)throw new Error(`JSONèª­ã¿è¾¼ã¿å¤±æ•—: ${T.status}`);return T.json()}).then(T=>{const w=new Map;Object.entries(T).forEach(([g,C])=>{w.set(g.toLowerCase(),C)}),j(w),f.log(`[é•·æ–‡] é•·æ–‡èª­è§£è¾æ›¸: ${w.size}å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`)}).catch(T=>{f.error("[é•·æ–‡] Error loading reading dictionary:",T)})},[]);const ze=u.useCallback(T=>{const w=T.toLowerCase().replace(/[.,!?;:"']/g,"").trim();if(k.has(w)||S.has(w))return w;if(w.endsWith("es")){const g=w.slice(0,-2);if(k.has(g)||S.has(g))return g}if(w.endsWith("s")){const g=w.slice(0,-1);if(k.has(g)||S.has(g))return g}if(w.endsWith("ed")){const g=w.slice(0,-2);if(k.has(g)||S.has(g))return g;if(k.has(g+"e")||S.has(g+"e"))return g+"e";if(g.length>2&&g[g.length-1]===g[g.length-2]){const C=g.slice(0,-1);if(k.has(C)||S.has(C))return C}}if(w.endsWith("ing")){const g=w.slice(0,-3);if(k.has(g)||S.has(g))return g;if(k.has(g+"e")||S.has(g+"e"))return g+"e";if(g.length>2&&g[g.length-1]===g[g.length-2]){const C=g.slice(0,-1);if(k.has(C)||S.has(C))return C}}if(w.endsWith("ly")){const g=w.slice(0,-2);if(k.has(g)||S.has(g))return g}if(w.endsWith("er")){const g=w.slice(0,-2);if(k.has(g)||S.has(g))return g}if(w.endsWith("est")){const g=w.slice(0,-3);if(k.has(g)||S.has(g))return g}return w},[k,S]),We=u.useCallback((T,w)=>{if(w&&typeof w=="string"&&w.trim()&&w!=="-")return w;if(w&&typeof w=="object"&&"meaning"in w&&typeof w.meaning=="string")return w.meaning;const g=T.toLowerCase();if(g==="who")return"(é–¢ä¿‚ä»£åè©)ãã®äººã¯";if(g==="whom")return"(é–¢ä¿‚ä»£åè©)ãã®äººã‚’";if(g==="which")return"(é–¢ä¿‚ä»£åè©)ãã®ç‰©ç­‰ã¯ãƒ»ã‚’";if(g==="that")return"(é–¢ä¿‚ä»£åè©)ãã®äººãƒ»ç‰©ç­‰ã¯ãƒ»ã‚’";const C=ze(T),I=k.get(C),G=S.get(C);return(I==null?void 0:I.meaning)||(G==null?void 0:G.meaning)||""},[ze,k,S]);u.useEffect(()=>{const T=setInterval(()=>{P&&!Di()&&!Mi()&&(R(!1),J(!1))},500);return()=>clearInterval(T)},[P]),u.useEffect(()=>{if(k.size===0){f.log("[é•·æ–‡] è¾æ›¸ã®èª­ã¿è¾¼ã¿ã‚’å¾…æ©Ÿä¸­...");return}f.log(`[é•·æ–‡] ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚’é–‹å§‹... (è¾æ›¸: ${k.size}å˜èª)`);try{localStorage.removeItem("reading-passages-data")}catch{}const T="reading-unknown-words-state";let w=[];try{const g=localStorage.getItem(T);g&&(w=JSON.parse(g))}catch(g){f.warn("[é•·æ–‡] ä¿å­˜æ¸ˆã¿é€²æ—ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",g)}_e(!0),so(k).then(g=>{var C,I;if(g&&g.length>0){f.log(`[é•·æ–‡] ${g.length}ä»¶ã®ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);const G=g.map(ae=>{const be=w.find(Pe=>Pe.id===ae.id);return be!=null&&be.unknownWords&&be.unknownWords.length>0?{...ae,phrases:ae.phrases.map((Pe,L)=>({...Pe,segments:Pe.segments.map((ee,q)=>{var _;return{...ee,isUnknown:((_=be.unknownWords)==null?void 0:_.includes(`${L}-${q}`))??!1}})}))}:ae}),F={åˆç´š:1,beginner:1,ä¸­ç´š:2,intermediate:2,ä¸Šç´š:3,advanced:3,Advanced:3},B=G.sort((ae,be)=>{const Pe=F[ae.level||""]||999,L=F[be.level||""]||999;if(Pe!==L)return Pe-L;const ee=ae.actualWordCount||0,q=be.actualWordCount||0;return ee-q});l(B),f.log(`[é•·æ–‡] ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨­å®šå®Œäº†: ${B.length}ä»¶`),B.length>0&&(c(B[0].id),m(new Array(((C=B[0].phrases)==null?void 0:C.length)||0).fill(!1)),p(new Array(((I=B[0].phrases)==null?void 0:I.length)||0).fill(!1)),f.log(`[é•·æ–‡] åˆæœŸãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã‚’é¸æŠ: ${B[0].id}`)),_e(!1)}else f.error("[é•·æ–‡] loadAllPassagesAsReadingFormatãŒç©ºã®é…åˆ—ã‚’è¿”ã—ã¾ã—ãŸ"),v("ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ã™ï¼‰"),_e(!1)}).catch(g=>{f.error("[é•·æ–‡] Error loading passages:",g),v("ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: "+g.message),_e(!1)})},[k]);const oe=u.useMemo(()=>i.find(T=>T.id===o),[i,o]),Ie=u.useMemo(()=>{const T=N==="all"?i:i.filter(g=>g.level===N),w={åˆç´š:1,beginner:1,ä¸­ç´š:2,intermediate:2,ä¸Šç´š:3,advanced:3,Advanced:3};return T.sort((g,C)=>{const I=w[g.level||""]||999,G=w[C.level||""]||999;if(I!==G)return I-G;const F=g.actualWordCount||0,B=C.actualWordCount||0;return F-B})},[i,N]),qe=u.useCallback(T=>{var g,C;c(T);const w=i.find(I=>I.id===T);w&&(m(new Array(((g=w.phrases)==null?void 0:g.length)||0).fill(!1)),p(new Array(((C=w.phrases)==null?void 0:C.length)||0).fill(!1)),y(0))},[i]);u.useCallback((T,w)=>{if(w.preventDefault(),w.stopPropagation(),!oe||!Ge())return;const C=oe.phrases[T].segments.filter(G=>G.word&&G.word.trim()!=="").map(G=>G.word).join(" ");st(C,{rate:.85});const I=w.currentTarget;I.classList.add("speaking"),setTimeout(()=>{I.classList.remove("speaking")},600)},[oe]);const Fe=(T,w)=>{if(w.preventDefault(),w.stopPropagation(),z&&z.word===T){V(null);return}const g=T.toLowerCase().replace(/[.,!?;:"']/g,"").trim(),I=(F=>{if(k.has(F))return F;if(F.endsWith("es")&&k.has(F.slice(0,-2)))return F.slice(0,-2);if(F.endsWith("s")&&k.has(F.slice(0,-1)))return F.slice(0,-1);if(F.endsWith("ed")){const B=F.slice(0,-2);if(k.has(B))return B;if(k.has(B+"e"))return B+"e";if(B.length>2&&B[B.length-1]===B[B.length-2]){const ae=B.slice(0,-1);if(k.has(ae))return ae}}if(F.endsWith("ing")){const B=F.slice(0,-3);if(k.has(B))return B;if(k.has(B+"e"))return B+"e";if(B.length>2&&B[B.length-1]===B[B.length-2]){const ae=B.slice(0,-1);if(k.has(ae))return ae}}return F.endsWith("ly")&&k.has(F.slice(0,-2))||F.endsWith("er")&&k.has(F.slice(0,-2))?F.slice(0,-2):F.endsWith("est")&&k.has(F.slice(0,-3))?F.slice(0,-3):null})(g),G=I?k.get(I):null;if(G){const F=w.currentTarget.getBoundingClientRect();V({word:G.word,meaning:G.meaning,reading:G.reading,etymology:G.etymology,relatedWords:G.relatedWords,x:F.left+window.scrollX,y:F.bottom+window.scrollY+5})}else{const F=S.get(I||g);if(F){const B=w.currentTarget.getBoundingClientRect();V({word:F.word,meaning:F.meaning,reading:F.reading||"",etymology:F.etymology||"",relatedWords:F.relatedWords||"",x:B.left+window.scrollX,y:B.bottom+window.scrollY+5})}else f.warn(`Word not found in dictionary: ${g}`)}},Je=()=>{if(!oe)return;const T=[];if(oe.phrases.forEach(w=>{w.segments.forEach(g=>{g.isUnknown&&g.word.trim()!==""&&(T.some(C=>C.word.toLowerCase()===g.word.toLowerCase())||T.push({word:g.word,meaning:g.meaning,reading:g.reading||"",etymology:g.etymology||"",relatedWords:g.relatedWords||"",relatedFields:g.relatedFields||"",difficulty:g.difficulty||"intermediate"}))})}),T.length===0){alert(`åˆ†ã‹ã‚‰ãªã„å˜èªãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
å˜èªã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãƒãƒ¼ã‚¯ã—ã¦ãã ã•ã„ã€‚`);return}r&&r(T),l(w=>w.map(g=>g.id===oe.id?{...g,phrases:g.phrases.map(C=>({...C,segments:C.segments.map(I=>({...I,isUnknown:!1}))}))}:g)),alert(`${T.length}å€‹ã®å˜èªã‚’ã€Œ${oe.title}ã€ã‹ã‚‰ä¿å­˜ã—ã¾ã—ãŸï¼`)},Be=()=>{oe&&(l(T=>T.map(w=>w.id===oe.id?{...w,phrases:w.phrases.map(g=>({...g,segments:g.segments.map(C=>({...C,isUnknown:!1}))}))}:w)),m(new Array(oe.phrases.length).fill(!1)),p(new Array(oe.phrases.length).fill(!1)))};if(x)return e.jsx("div",{className:"error-message",children:x});if(He)return e.jsx("div",{className:"empty-container",children:"èª­ã¿è¾¼ã¿ä¸­..."});if(i.length===0)return e.jsx("div",{className:"empty-container",children:"ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"});if(Ie.length===0)return e.jsxs("div",{className:"comprehensive-reading-view",children:[e.jsx("div",{className:"reading-header",children:e.jsxs("div",{className:"filter-controls",children:[e.jsx("label",{htmlFor:"difficulty-filter",children:"é›£æ˜“åº¦: "}),e.jsxs("select",{id:"difficulty-filter",value:N,onChange:T=>b(T.target.value),title:"é›£æ˜“åº¦ã‚’é¸æŠ",children:[e.jsx("option",{value:"all",children:"å…¨ã¦"}),e.jsx("option",{value:"åˆç´š",children:"åˆç´š"}),e.jsx("option",{value:"ä¸­ç´š",children:"ä¸­ç´š"}),e.jsx("option",{value:"ä¸Šç´š",children:"ä¸Šç´š"})]})]})}),e.jsx("div",{className:"empty-container",children:"é¸æŠã—ãŸé›£æ˜“åº¦ã®ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚åˆ¥ã®é›£æ˜“åº¦ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"})]});const et=((je=oe==null?void 0:oe.phrases)==null?void 0:je.reduce((T,w)=>T+w.segments.filter(g=>g.isUnknown).length,0))||0;return e.jsxs("div",{className:"comprehensive-reading-view",children:[!K&&ye&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>ue(!1),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 text-sm shadow-sm:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-filter",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-filter",value:N,onChange:T=>b(T.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦"}),e.jsx("option",{value:"åˆç´š",children:"åˆç´š"}),e.jsx("option",{value:"ä¸­ç´š",children:"ä¸­ç´š"}),e.jsx("option",{value:"ä¸Šç´š",children:"ä¸Šç´š"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"passage-select",children:"ğŸ“– ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸:"}),e.jsx("select",{id:"passage-select",value:o||"",onChange:T=>qe(T.target.value),className:"select-input",children:Ie.map(T=>e.jsxs("option",{value:T.id,children:[ir(T.level||"beginner"),"_",T.actualWordCount,"èª_",T.title]},T.id))})]})]}),K&&e.jsxs("div",{className:"reading-sub-tabs grid grid-cols-6 gap-1 sm:gap-2",children:[e.jsx("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${Se==="reading"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>se("reading"),children:"ğŸ“– èª­è§£"}),e.jsx("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${Se==="fullText"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>se("fullText"),children:"ğŸ“„ å…¨æ–‡"}),e.jsx("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${Se==="fullTranslation"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>se("fullTranslation"),children:"ğŸ“ å…¨è¨³"}),e.jsxs("button",{onClick:Je,className:"px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium bg-success text-white rounded-t-lg border-b-2 border-success transition-all duration-200 hover:bg-success-hover disabled:opacity-50 disabled:cursor-not-allowed:bg-success-hover",disabled:et===0,title:"æœªçŸ¥èªã‚’ä¿å­˜",children:["ğŸ’¾ ä¿å­˜ (",et,")"]}),e.jsx("button",{onClick:Be,className:"px-4 py-2 text-sm font-medium bg-warning text-warning-dark border-2 border-warning rounded-lg transition-all duration-200 hover:bg-warning-hover hover:shadow-md:bg-warning-hover",title:"ãƒªã‚»ãƒƒãƒˆ",children:"ğŸ”„ ãƒªã‚»ãƒƒãƒˆ"}),e.jsx("button",{className:"px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 border-2 border-transparent rounded-lg transition-all duration-200 hover:bg-gray-300:bg-gray-600",onClick:()=>ue(!ye),title:"å­¦ç¿’è¨­å®šã‚’é–‹ã",children:"âš™ï¸ å­¦ç¿’è¨­å®š"})]}),K&&ye&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>ue(!1),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 text-sm shadow-sm:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-filter-reading",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-filter-reading",value:N,onChange:T=>b(T.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦"}),e.jsx("option",{value:"åˆç´š",children:"åˆç´š"}),e.jsx("option",{value:"ä¸­ç´š",children:"ä¸­ç´š"}),e.jsx("option",{value:"ä¸Šç´š",children:"ä¸Šç´š"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"passage-select-reading",children:"ğŸ“– ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸:"}),e.jsx("select",{id:"passage-select-reading",value:o||"",onChange:T=>qe(T.target.value),className:"select-input",children:Ie.map(T=>e.jsxs("option",{value:T.id,children:[ir(T.level||"beginner"),"_",T.actualWordCount,"èª_",T.title]},T.id))})]})]}),z&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"word-popup-overlay",onClick:()=>V(null)}),e.jsxs("div",{className:"word-popup","data-popup-x":z.x,"data-popup-y":z.y,children:[e.jsx("button",{className:"popup-close",onClick:()=>V(null),title:"é–‰ã˜ã‚‹",children:"âœ•"}),e.jsx("div",{className:"popup-word",children:z.word}),z.reading&&e.jsx("div",{className:"popup-reading",children:z.reading}),e.jsx("div",{className:"popup-meaning",children:z.meaning}),z.etymology&&e.jsxs("div",{className:"popup-etymology",children:[e.jsx("strong",{children:"èªæº:"})," ",z.etymology]}),z.relatedWords&&e.jsxs("div",{className:"popup-related",children:[e.jsx("strong",{children:"é–¢é€£èª:"})," ",z.relatedWords]})]})]}),K&&oe&&oe.phrases&&oe.phrases.length>0&&e.jsxs("div",{className:"passage-content",children:[e.jsx("h3",{className:"passage-title",children:oe.title}),Se==="reading"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"reading-full-text-area",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"ğŸ“– å…¨æ–‡"}),e.jsx("div",{className:"full-text-content",children:(()=>{if(oe.originalText){const w=oe.originalText.split(/([.!?])\s+/).filter(C=>C.trim()),g=[];for(let C=0;C<w.length;C+=2){const I=w[C],G=w[C+1]||"";g.push((I+G).trim())}return e.jsx("div",{className:"sentences-container",children:g.map((C,I)=>e.jsxs("span",{className:`sentence-clickable ${Z===I?"selected-reading":""}`,onClick:()=>{ke(I);const G=$t(C);we({text:C,grammarAnalysis:G,showMeanings:!1})},children:[C," "]},I))})}if(oe.title.toLowerCase().includes("conversation")){const w=[];return oe.phrases.forEach(g=>{let C=g.segments.map(I=>I.word).join(" ").trim();!C||C==="-"||(C=C.replace(/\s+([.,!?;:"])/g,"$1"),w.push(C))}),e.jsx("div",{className:"sentences-container",children:w.map((g,C)=>e.jsxs("span",{className:`sentence-clickable ${Z===C?"selected-reading":""}`,onClick:()=>{ke(C);const I=$t(g);we({text:g,grammarAnalysis:I,showMeanings:!1})},children:[g," "]},C))})}else{let w="",g=!0;oe.phrases.forEach(G=>{G.segments.forEach(F=>{let B=F.word.trim();B&&B!=="-"&&(/^[.,!?;:]$/.test(B)?(w+=B,g=/^[.!?]$/.test(B)):(B==='"'||B==="'"||(g&&B.length>0&&(B=B.charAt(0).toUpperCase()+B.slice(1),g=!1),w.length>0&&!w.endsWith(" ")&&!w.endsWith('"')&&!w.endsWith("'")&&(w+=" ")),w+=B))})}),w=w.replace(/\s+"/g,'"').replace(/\s+'/g,"'");const C=w.split(/([.!?])\s+/).filter(G=>G.trim()),I=[];for(let G=0;G<C.length;G+=2){const F=C[G],B=C[G+1]||"";I.push((F+B).trim())}return e.jsx("div",{className:"sentences-container",children:I.map((G,F)=>e.jsxs("span",{className:`sentence-clickable ${Z===F?"selected-reading":""}`,onClick:()=>{ke(F);const B=$t(G);we({text:G,grammarAnalysis:B,showMeanings:!1})},children:[G," "]},F))})}})()})]}),Z!==null&&xe&&e.jsxs("div",{className:"selected-sentence-analysis mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"m-0 text-lg font-semibold",children:"ğŸ“ é¸æŠã—ãŸæ–‡ã®èª­è§£"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 text-sm bg-primary text-white rounded hover:bg-primary-hover",onClick:()=>st(xe.text),title:"ã“ã®æ–‡ã‚’ç™ºéŸ³",children:"ğŸ”Š ç™ºéŸ³"}),e.jsx("button",{className:"px-3 py-1 text-sm bg-info text-white rounded hover:bg-info-hover",onClick:()=>we({...xe,showMeanings:!xe.showMeanings}),children:xe.showMeanings?"æ„å‘³ã‚’éš ã™":"æ„å‘³ã‚’è¡¨ç¤º"})]})]}),e.jsx("div",{className:"selected-sentence-text mb-4",children:xe.text}),e.jsxs("div",{className:"grammar-structure mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h5",{className:"text-sm font-semibold m-0",children:"ğŸ”¤ æ–‡æ³•æ§‹é€ :"}),e.jsx("button",{className:"px-2 py-1 text-xs bg-gray-200 rounded hover:bg-gray-300:bg-gray-600",onClick:()=>Ze(!Le),children:Le?"å‡¡ä¾‹ã‚’éš ã™":"å‡¡ä¾‹ã‚’è¡¨ç¤º"})]}),Le&&e.jsxs("div",{className:"grammar-legend mb-3 p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center mb-2",children:[e.jsx("h6",{className:"text-xs font-semibold m-0",children:"ğŸ“– æ–‡æ³•ã‚¿ã‚°ä¸€è¦§"}),e.jsx("button",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200:bg-blue-800",onClick:()=>$e(!Te),children:Te?"ç°¡æ˜“è¡¨ç¤º":"ğŸ“š ã•ã‚‰ã«è©³ã—ã"})]}),Te?e.jsxs("div",{className:"detailed-grammar-explanation text-xs space-y-3 break-words",children:[e.jsxs("div",{className:"explanation-section",children:[e.jsx("h6",{className:"font-semibold text-sm mb-2",children:"ğŸ¯ æ–‡ã®éª¨æ ¼ (å¿…é ˆè¦ç´ )"}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"S",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"S",children:"[S]"})}),e.jsx("strong",{children:"ä¸»èª (Subject)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œèª°ãŒã€ã€Œä½•ãŒã€"}),"ã‚’è¡¨ã™ã€‚æ–‡ã®ä¸»å½¹ã€‚",e.jsx("br",{}),"ä¾‹: ",e.jsx("em",{children:"I"})," study English. / ",e.jsx("em",{children:"The cat"})," is cute."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"V",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"V",children:"[V]"})}),e.jsx("strong",{children:"å‹•è© (Verb)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œã€œã™ã‚‹ã€ã€Œã€œã§ã‚ã‚‹ã€"}),"ã‚’è¡¨ã™ã€‚ä¸»èªã®å‹•ä½œã‚„çŠ¶æ…‹ã€‚",e.jsx("br",{}),"ä¾‹: I ",e.jsx("em",{children:"study"})," English. / The cat ",e.jsx("em",{children:"is"})," cute."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"O",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"O",children:"[O]"})}),e.jsx("strong",{children:"ç›®çš„èª (Object)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œä½•ã‚’ã€ã€Œèª°ã‚’ã€"}),"ã‚’è¡¨ã™ã€‚å‹•è©ã®å¯¾è±¡ã€‚",e.jsx("br",{}),"ä¾‹: I study ",e.jsx("em",{children:"English"}),". / I like ",e.jsx("em",{children:"cats"}),"."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"C",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"C",children:"[C]"})}),e.jsx("strong",{children:"è£œèª (Complement)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œã©ã†ã§ã‚ã‚‹ã€ã€Œä½•ã§ã‚ã‚‹ã€"}),"ã‚’è¡¨ã™ã€‚ä¸»èªã‚„ç›®çš„èªã®çŠ¶æ…‹ãƒ»æ€§è³ªã€‚",e.jsx("br",{}),"ä¾‹: The cat is ",e.jsx("em",{children:"cute"}),". / I am ",e.jsx("em",{children:"a student"}),"."]})]})]}),e.jsxs("div",{className:"explanation-section",children:[e.jsx("h6",{className:"font-semibold text-sm mb-2",children:"âœ¨ æ–‡ã‚’è©³ã—ãã™ã‚‹è¦ç´ "}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"M",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"M",children:"[M]"})}),e.jsx("strong",{children:"ä¿®é£¾èª (Modifier)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œã©ã‚“ãªã€ã€Œã©ã®ã‚ˆã†ã«ã€ã€Œã„ã¤ã€ã€Œã©ã“ã§ã€"}),"ã‚’è¡¨ã™ã€‚æ–‡ã‚’è±Šã‹ã«ã™ã‚‹ã€‚",e.jsx("br",{}),"ä¾‹: I wake up at ",e.jsx("em",{children:"seven"}),". / I read a ",e.jsx("em",{children:"good"})," book."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adj",children:"[Adj]"})}),e.jsx("strong",{children:"å½¢å®¹è© (Adjective)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"åè©ã‚’è©³ã—ãèª¬æ˜"}),"ã™ã‚‹èªã€‚",e.jsx("br",{}),"ä¾‹: a ",e.jsx("em",{children:"beautiful"})," flower / ",e.jsx("em",{children:"happy"})," students"]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adv",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adv",children:"[Adv]"})}),e.jsx("strong",{children:"å‰¯è© (Adverb)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"å‹•è©ãƒ»å½¢å®¹è©ãƒ»å‰¯è©ã‚’è©³ã—ãèª¬æ˜"}),"ã™ã‚‹èªã€‚",e.jsx("br",{}),"ä¾‹: run ",e.jsx("em",{children:"quickly"})," / ",e.jsx("em",{children:"very"})," happy / ",e.jsx("em",{children:"always"})," ","study"]})]})]}),e.jsxs("div",{className:"explanation-section",children:[e.jsx("h6",{className:"font-semibold text-sm mb-2",children:"ğŸ”— ã¤ãªããƒ»é™å®šã™ã‚‹è¦ç´ "}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Prep",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Prep",children:"[Prep]"})}),e.jsx("strong",{children:"å‰ç½®è© (Preposition)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"åè©ã®å‰ã«ç½®ã„ã¦å ´æ‰€ãƒ»æ™‚é–“ãƒ»æ–¹æ³•"}),"ãªã©ã‚’ç¤ºã™ã€‚",e.jsx("br",{}),"ä¾‹: ",e.jsx("em",{children:"at"})," school / ",e.jsx("em",{children:"in"})," the morning / ",e.jsx("em",{children:"with"})," ","friends"]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Conj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Conj",children:"[Conj]"})}),e.jsx("strong",{children:"æ¥ç¶šè© (Conjunction)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"èªãƒ»å¥ãƒ»æ–‡ã‚’ã¤ãªã"}),"èªã€‚",e.jsx("br",{}),"ä¾‹: I ",e.jsx("em",{children:"and"})," you / study ",e.jsx("em",{children:"but"})," tired /"," ",e.jsx("em",{children:"because"})," I like it"]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Det",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Det",children:"[Det]"})}),e.jsx("strong",{children:"é™å®šè© (Determiner)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"åè©ã®ç¯„å›²ãƒ»æ•°é‡ã‚’é™å®š"}),"ã™ã‚‹èªã€‚å† è©ãƒ»æŒ‡ç¤ºè©ãƒ»æ•°é‡è©ãªã©ã€‚",e.jsx("br",{}),"ä¾‹: ",e.jsx("em",{children:"the"})," book / ",e.jsx("em",{children:"my"})," cat / ",e.jsx("em",{children:"every"})," day /"," ",e.jsx("em",{children:"some"})," water"]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"S",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"S",children:"[S]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ä¸»èª (Subject)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"V",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"V",children:"[V]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å‹•è© (Verb)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"O",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"O",children:"[O]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ç›®çš„èª (Object)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"C",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"C",children:"[C]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"è£œèª (Complement)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"M",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"M",children:"[M]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ä¿®é£¾èª (Modifier)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Prep",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Prep",children:"[Prep]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å‰ç½®è© (Preposition)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Conj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Conj",children:"[Conj]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"æ¥ç¶šè© (Conjunction)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Det",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Det",children:"[Det]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"é™å®šè© (Determiner)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adj",children:"[Adj]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å½¢å®¹è© (Adjective)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adv",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adv",children:"[Adv]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å‰¯è© (Adverb)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Unknown",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Unknown",children:"[?]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ãã®ä»–"})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.grammarAnalysis.filter(T=>!/^[.,!?;:\-â€”â€“"'()]$/.test(T.word)).map((T,w)=>e.jsxs("div",{className:"grammar-tag","data-tag":T.tag,title:T.description,children:[e.jsx("span",{className:"font-semibold",children:T.word}),e.jsxs("span",{className:"ml-1 text-xs grammar-tag-label","data-tag":T.tag,children:["[",T.tag,"]"]})]},w))}),xe.grammarAnalysis.some(T=>/^[.,!?;:\-â€”â€“"'()]$/.test(T.word))&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{className:"text-xs font-semibold mb-2 text-gray-600",children:"ğŸ“Œ è¨˜å·ã®æ„å‘³:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.grammarAnalysis.filter(T=>/^[.,!?;:\-â€”â€“"'()]$/.test(T.word)).map((T,w)=>e.jsxs("div",{className:"punctuation-card",title:T.description,children:[e.jsx("span",{className:"font-bold text-lg",children:T.word}),e.jsx("span",{className:"ml-2 text-xs text-gray-600",children:T.description})]},w))})]})]}),(()=>{const T=xe.grammarAnalysis.map(g=>g.word),w=go(T);return w.length===0?null:e.jsxs("div",{className:"phrasal-expressions-section mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ”— ç†Ÿèª:"}),e.jsx("div",{className:"space-y-2",children:w.map((g,C)=>e.jsxs("div",{className:"phrasal-expression-card",children:[e.jsx("div",{className:"phrasal-expression-words",children:g.words.map((I,G)=>{const F=We(I,void 0);return e.jsxs("div",{className:"phrasal-word-item",children:[e.jsx("div",{className:"phrasal-word",children:I}),e.jsx("div",{className:"phrasal-word-meaning",children:F||"-"})]},G)})}),e.jsxs("div",{className:"phrasal-expression-divider",children:[e.jsx("div",{className:"phrasal-divider-line"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"phrasal-type-label",children:"ç†Ÿèª"}),s&&n&&a&&e.jsx(At,{word:{word:g.words.join(" "),meaning:g.meaning,source:"reading",sourceDetail:oe==null?void 0:oe.title},sets:t,onAddWord:s,onRemoveWord:n,onOpenManagement:a,size:"small"})]})]}),e.jsx("div",{className:"phrasal-expression-meaning",children:g.meaning})]},C))})]})})(),(()=>{const T=fo(xe.text);return T.length===0?null:e.jsxs("div",{className:"grammar-patterns-section mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ“ é‡è¦æ§‹æ–‡:"}),e.jsx("div",{className:"space-y-2",children:T.map((w,g)=>e.jsxs("div",{className:"grammar-pattern-card",children:[e.jsxs("div",{className:"pattern-header",children:[e.jsx("div",{className:"pattern-name",children:w.name}),e.jsx("div",{className:"pattern-meaning",children:w.meaning})]}),e.jsx("div",{className:"pattern-sentence",children:xe.text}),e.jsxs("div",{className:"pattern-explanation",children:["ğŸ’¡ ",w.explanation]})]},g))})]})})(),xe.showMeanings&&e.jsxs("div",{className:"word-cards-container",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ“š å˜èªã®æ„å‘³:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.grammarAnalysis.filter(T=>!/^[.,!?;:\-â€”â€“"'()]$/.test(T.word)).map((T,w)=>{const g=We(T.word,void 0);return e.jsxs("div",{className:"word-card",onDoubleClick:C=>Fe(T.word,C),title:"ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—: è©³ç´°è¡¨ç¤º",children:[e.jsx("div",{className:"word-card-word",children:T.word}),g&&g!=="-"&&e.jsx("div",{className:"word-card-meaning text-xs",children:g})]},w)})})]})]})]}),Se==="fullText"&&e.jsxs("div",{className:"full-text-display",children:[e.jsx("h3",{children:"ğŸ“„ å…¨æ–‡"}),e.jsxs("div",{className:"full-text-controls",children:[e.jsx("button",{className:"px-6 py-3 text-base font-medium bg-primary text-white border-2 border-primary rounded-lg transition-all duration-200 hover:bg-primary-hover hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed:bg-primary-hover",onClick:()=>{const T=oe.phrases.map(w=>w.segments.map(C=>C.word).join(" ").replace(/^[A-Z][a-z]*(?:\s+\d+)?:\s*/,"").replace(/"/g,"")).join(" ").replace(/\s+([.,!?;:])/g,"$1");st(T),R(!0),J(!1)},disabled:P&&!U,title:"å…¨æ–‡ã‚’ç™ºéŸ³",children:"ğŸ”Š ç™ºéŸ³"}),e.jsx("button",{className:"px-6 py-3 text-base font-medium bg-warning text-warning-dark border-2 border-warning rounded-lg transition-all duration-200 hover:bg-warning-hover hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed:bg-warning-hover",onClick:()=>{U?(Ci(),J(!1)):(ki(),J(!0))},disabled:!P,title:U?"ç™ºéŸ³ã‚’å†é–‹":"ç™ºéŸ³ã‚’ä¸€æ™‚åœæ­¢",children:U?"â–¶ï¸ å†é–‹":"â¸ï¸ ä¸€æ™‚åœæ­¢"}),e.jsx("button",{className:"px-6 py-3 text-base font-medium bg-error text-white border-2 border-error rounded-lg transition-all duration-200 hover:bg-error-hover hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed:bg-error-hover",onClick:()=>{Si(),R(!1),J(!1)},disabled:!P,title:"ç™ºéŸ³ã‚’åœæ­¢",children:"â¹ï¸ åœæ­¢"})]}),e.jsx("div",{className:"full-text-content",children:(()=>{if(oe.originalText)return e.jsx("div",{className:"paragraph-en",children:oe.originalText});if(oe.title.toLowerCase().includes("conversation")){const w=[];return oe.phrases.forEach(g=>{let C=g.segments.map(I=>I.word).join(" ").trim();!C||C==="-"||(C=C.replace(/\s+([.,!?;:"])/g,"$1"),w.push(C))}),e.jsx("div",{children:w.map((g,C)=>e.jsx("p",{className:"paragraph-en conversation-line",children:g},C))})}else{const g=oe.phrases[0].segments.map(_=>_.word).join(" ").trim(),C=g.length<100&&!/[.!?]$/.test(g);let I="",G=!0;oe.phrases.forEach((_,W)=>{W===0&&C||_.segments.forEach(ge=>{let Q=ge.word.trim();Q&&Q!=="-"&&(/^[.,!?;:]$/.test(Q)?(I+=Q,G=/^[.!?]$/.test(Q)):(Q==='"'||Q==="'"||(G&&Q.length>0&&(Q=Q.charAt(0).toUpperCase()+Q.slice(1),G=!1),I.length>0&&!I.endsWith(" ")&&!I.endsWith('"')&&!I.endsWith("'")&&(I+=" ")),I+=Q))})}),I=I.replace(/\s+"/g,'"').replace(/\s+'/g,"'");const F=I.split(/([.!?])\s+/).filter(_=>_.trim()),B=[];for(let _=0;_<F.length;_+=2){const W=F[_],ge=F[_+1]||"";B.push((W+ge).trim())}const ae=[];let be=[],Pe=0;const L=60;B.forEach((_,W)=>{const ge=_.split(/\s+/).length;be.push(_),Pe+=ge,(Pe>=L||W===B.length-1)&&(ae.push(be.join(" ")),be=[],Pe=0)}),be.length>0&&ae.push(be.join(" "));const ee=B,q=_=>{ke(_);const W=ee[_],ge=$t(W);we({text:W,grammarAnalysis:ge,showMeanings:!1})};return e.jsxs("div",{children:[e.jsx("div",{className:"sentences-container",children:ee.map((_,W)=>e.jsxs("span",{className:`sentence-clickable ${Z===W?"selected":""}`,onClick:()=>q(W),children:[_," "]},W))}),Z!==null&&xe&&e.jsxs("div",{className:"selected-sentence-analysis",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"m-0",children:"ğŸ“– é¸æŠã—ãŸæ–‡ã®èª­è§£"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 text-sm bg-primary text-white rounded hover:bg-primary-hover",onClick:()=>st(xe.text),title:"ã“ã®æ–‡ã‚’ç™ºéŸ³",children:"ğŸ”Š ç™ºéŸ³"}),e.jsx("button",{className:"px-3 py-1 text-sm bg-info text-white rounded hover:bg-info-hover",onClick:()=>we({...xe,showMeanings:!xe.showMeanings}),children:xe.showMeanings?"æ„å‘³ã‚’éš ã™":"æ„å‘³ã‚’è¡¨ç¤º"})]})]}),e.jsx("div",{className:"selected-sentence-text",children:xe.text}),e.jsxs("div",{className:"grammar-structure mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ”¤ æ–‡æ³•æ§‹é€ :"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.grammarAnalysis.map((_,W)=>e.jsxs("div",{className:"grammar-tag","data-tag":_.tag,title:_.description,children:[e.jsx("span",{className:"font-semibold",children:_.word}),e.jsxs("span",{className:"ml-1 text-xs grammar-tag-label","data-tag":_.tag,children:["[",_.tag,"]"]})]},W))})]}),xe.showMeanings&&e.jsxs("div",{className:"word-cards-container mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ“š å˜èªã®æ„å‘³:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.grammarAnalysis.filter(_=>!/^[.,!?;:]$/.test(_.word)).map((_,W)=>{const ge=We(_.word,void 0);return e.jsxs("div",{className:"word-card",onDoubleClick:Q=>Fe(_.word,Q),title:"ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—: è©³ç´°è¡¨ç¤º",children:[e.jsx("div",{className:"word-card-word",children:_.word}),ge&&ge!=="-"&&e.jsx("div",{className:"word-card-meaning text-xs",children:ge})]},W)})})]})]})]})}})()})]}),Se==="fullTranslation"&&e.jsx("div",{className:"full-translation-display",children:e.jsx("div",{className:"full-translation-content",children:(()=>{var w;if(console.log("[å…¨è¨³ã‚¿ãƒ–] currentPassage.id:",oe.id),console.log("[å…¨è¨³ã‚¿ãƒ–] currentPassage.translation exists:",!!oe.translation),console.log("[å…¨è¨³ã‚¿ãƒ–] currentPassage.translation length:",((w=oe.translation)==null?void 0:w.length)||0),oe.translation){const g=oe.translation.split(/\n+/).map(C=>C.trim()).filter(C=>C.length>0);return e.jsx("div",{className:"full-translation-text",children:g.map((C,I)=>e.jsx("p",{className:"paragraph-ja",children:C},I))})}if(oe.title.toLowerCase().includes("conversation")){const g=[];return oe.phrases.forEach(C=>{let I=C.phraseMeaning||"";I=I.replace(/\[è¦ä¿®æ­£\]/g,"").trim(),!(!I||I==="-")&&g.push(I)}),g.map((C,I)=>e.jsx("p",{className:"paragraph-ja conversation-line",children:C},I))}else{const g=[];let C="";oe.phrases.forEach(F=>{let B=F.phraseMeaning||"";if(B){if(B=B.replace(/\[è¦ä¿®æ­£\]/g,"").trim(),!B)return;const ae=F.segments.map(Pe=>Pe.word).join(" ").trim(),be=/[.!?]$/.test(ae);/[ã€‚ï¼ï¼Ÿ]$/.test(B)?(C+=B,be&&(g.push(C.trim()),C="")):be?(C+=B+"ã€‚",g.push(C.trim()),C=""):C+=B+"ã€"}}),C.trim()&&g.push(C.trim()+"ã€‚");const I=[],G=4;for(let F=0;F<g.length;F+=G){const B=g.slice(F,F+G);I.push(B.join(""))}return I.map((F,B)=>e.jsx("p",{className:"paragraph-ja",children:F},B))}})()})})]}),e.jsx("style",{children:`
        .comprehensive-reading-view {
          max-width: 1200px;
          margin: 0 auto;
          padding: 20px;
          width: 100%;
        }

        @media (max-width: 768px) {
          .comprehensive-reading-view {
            max-width: 100%;
            margin: 0;
            padding: 8px;
          }
        }

        .reading-header {
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          margin-bottom: 20px;
        }

        .dark-mode .reading-header {
          background: var(--gray-800);
        }

        .reading-header h2 {
          margin: 0 0 20px 0;
        }

        .filter-controls, .passage-selector {
          margin-bottom: 15px;
        }

        .filter-controls label, .passage-selector label {
          font-weight: bold;
          margin-right: 10px;
          color: #333;
        }

        .dark-mode .filter-controls label,
        .dark-mode .passage-selector label {
          color: var(--gray-200);
        }

        .filter-controls select, .passage-selector select {
          padding: 8px 12px;
          border: 1px solid #ddd;
          border-radius: 4px;
          font-size: 14px;
          background: white;
          color: #333;
        }

        .dark-mode .filter-controls select,
        .dark-mode .passage-selector select {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-200);
        }

        .passage-stats {
          display: flex;
          gap: 10px;
          margin: 15px 0;
          flex-wrap: wrap;
        }

        .stat-badge {
          display: inline-block;
          padding: 6px 12px;
          background: #f0f0f0;
          border-radius: 4px;
          font-size: 14px;
          color: #333;
        }

        .dark-mode .stat-badge {
          background: var(--gray-700);
          color: var(--gray-200);
        }

        .stat-badge.unknown-count {
          background: #fff3cd;
          color: #856404;
          font-weight: bold;
        }

        .dark-mode .stat-badge.unknown-count {
          background: var(--yellow-500);
          color: var(--black);
        }

        .action-buttons {
          display: flex;
          gap: 10px;
          margin-top: 15px;
        }

        .action-buttons button {
          padding: 10px 20px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 14px;
          font-weight: bold;
          transition: all 0.3s;
        }

        .btn-primary {
          background: #007bff;
          color: white;
        }

        .btn-primary:hover {
          background: #0056b3;
        }

        .btn-info {
          background: #17a2b8;
          color: white;
        }

        .btn-info:hover {
          background: #138496;
        }

        .btn-success {
          background: #28a745;
          color: white;
        }

        .btn-success:hover {
          background: #218838;
        }

        .btn-success:disabled {
          background: #ccc;
          cursor: not-allowed;
        }

        .btn-secondary {
          background: #6c757d;
          color: white;
        }

        .btn-secondary:hover {
          background: #545b62;
        }

        .passage-content {
          background: white;
          padding: 30px;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .dark-mode .passage-content {
          background: var(--gray-800);
          color: var(--gray-100);
        }

        .passage-title {
          text-align: center;
          color: #333;
          margin-bottom: 30px;
          font-size: 24px;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .dark-mode .passage-title {
          color: var(--white);
        }

        .passage-body {
          line-height: 1.5;
          font-family: 'Times New Roman', Georgia, serif;
          color: #333;
        }

        .dark-mode .passage-body {
          color: var(--gray-200);
        }

        .phrase-block {
          margin-bottom: 8px;
          padding: 8px 12px;
          background: #ffffff;
          border-left: 3px solid #007bff;
          border-radius: 2px;
        }

        .dark-mode .phrase-block {
          background: var(--gray-700);
          border-left-color: var(--blue-400);
        }

        .phrase-english {
          font-size: 16px;
          line-height: 1.6;
          margin-bottom: 6px;
          font-family: 'Times New Roman', 'Georgia', serif;
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          align-items: flex-start;
        }

        .word-card {
          display: inline-flex;
          flex-direction: column;
          align-items: center;
          padding: 2px 5px;
          margin: 1px;
          background: #f8f9fa;
          border: 1px solid #dee2e6;
          border-radius: 4px;
          cursor: pointer;
          transition: all 0.2s;
          min-width: 60px;
        }

        .dark-mode .word-card {
          background: var(--gray-700);
          border-color: var(--gray-600);
        }

        .word-card:hover {
          background: #e7f3ff;
          border-color: #007bff;
        }

        .dark-mode .word-card:hover {
          background: var(--gray-600);
          border-color: var(--blue-400);
        }

        .word-card.unknown {
          background: #ffc107;
          color: #000;
          border-color: #ff9800;
          font-weight: bold;
        }

        .word-card.phrase-card {
          background: #e8f5e9;
          border-color: #4caf50;
        }

        .dark-mode .word-card.phrase-card {
          background: var(--gray-700);
          border-color: var(--green-400);
        }

        .word-card.phrase-card:hover {
          background: #c8e6c9;
        }

        .dark-mode .word-card.phrase-card:hover {
          background: var(--gray-600);
        }

        .word-card.punctuation-card {
          min-width: 20px;
          background: transparent;
          border: none;
          cursor: default;
          padding: 2px 4px;
        }

        .word-card.punctuation-card:hover {
          background: transparent;
          border: none;
        }

        .word-card-word {
          font-size: 16px;
          font-weight: 500;
          color: #333;
          text-align: center;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .dark-mode .word-card-word {
          color: var(--gray-200);
        }

        .phrase-card .word-card-word {
          font-size: 15px;
          color: #2e7d32;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .dark-mode .phrase-card .word-card-word {
          color: var(--green-400);
        }

        .word-card-meaning {
          font-size: 12px;
          color: #666;
          margin-top: 1px;
          text-align: center;
          padding: 1px 3px;
          background: rgba(255, 255, 255, 0.8);
          border-radius: 2px;
          min-height: 14px;
        }

        .dark-mode .word-card-meaning {
          color: var(--gray-300);
          background: rgba(48, 48, 48, 0.8);
        }

        .word-segment {
          display: inline-block;
          padding: 2px 4px;
          margin: 0 2px;
          cursor: pointer;
          border-radius: 3px;
          transition: all 0.2s;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .word-segment:hover {
          background: #e7f3ff;
        }

        .word-segment.unknown {
          background: #ffc107;
          color: #000;
          font-weight: bold;
        }

        .show-translation-btn {
          background: #f8f9fa;
          border: 1px solid #ddd;
          padding: 8px 16px;
          border-radius: 4px;
          cursor: pointer;
          color: #666;
          font-size: 14px;
        }

        .show-translation-btn:hover {
          background: #e9ecef;
        }

        .phrase-translation {
          margin-top: 10px;
          padding: 15px;
          background: white;
          border-radius: 4px;
          border: 1px solid #dee2e6;
        }

        .dark-mode .phrase-translation {
          background: var(--gray-800);
          border-color: var(--gray-600);
        }

        .translation-text {
          font-size: 16px;
          color: #333;
          margin-bottom: 10px;
          font-weight: 500;
        }

        .dark-mode .translation-text {
          color: var(--gray-200);
        }

        .word-meanings {
          display: flex;
          flex-wrap: wrap;
          gap: 10px;
          font-size: 14px;
          color: #666;
        }

        .dark-mode .word-meanings {
          color: var(--gray-300);
        }

        .word-meaning-pair {
          background: #e7f3ff;
          padding: 4px 8px;
          border-radius: 3px;
        }

        .dark-mode .word-meaning-pair {
          background: var(--gray-700);
          color: var(--gray-200);
        }

        .error-message, .empty-container {
          text-align: center;
          padding: 50px;
          font-size: 18px;
          color: #666;
        }

        .dark-mode .error-message,
        .dark-mode .empty-container {
          color: var(--gray-300);
        }

        .error-message {
          color: #dc3545;
        }

        .dark-mode .error-message {
          color: var(--red-400);
        }

        /* å˜èªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .word-popup-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: transparent;
          z-index: 999;
        }

        .word-popup {
          position: absolute;
          left: var(--popup-x, 0);
          top: var(--popup-y, 0);
          background: white;
          border: 2px solid #007bff;
          border-radius: 8px;
          padding: 16px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          z-index: 1000;
          max-width: 400px;
          min-width: 250px;
        }

        .dark-mode .word-popup {
          background: var(--gray-800);
          border-color: var(--blue-400);
          color: var(--gray-200);
        }

        .popup-close {
          position: absolute;
          top: 8px;
          right: 8px;
          background: #f8f9fa;
          border: none;
          border-radius: 4px;
          width: 24px;
          height: 24px;
          cursor: pointer;
          font-size: 16px;
          line-height: 1;
          color: #666;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .popup-close:hover {
          background: #e9ecef;
          color: #000;
        }

        .popup-word {
          font-size: 20px;
          font-weight: bold;
          color: #007bff;
          margin-bottom: 4px;
          padding-right: 30px;
        }

        .popup-reading {
          font-size: 14px;
          color: #666;
          margin-bottom: 8px;
        }

        .popup-meaning {
          font-size: 16px;
          color: #333;
          margin-bottom: 12px;
          padding: 8px;
          background: #f0f8ff;
          border-radius: 4px;
        }

        .popup-etymology {
          font-size: 13px;
          color: #555;
          margin-bottom: 8px;
          padding: 6px;
          background: #f8f9fa;
          border-radius: 4px;
        }

        .popup-related {
          font-size: 13px;
          color: #555;
          padding: 6px;
          background: #f8f9fa;
          border-radius: 4px;
        }

        .popup-etymology strong,
        .popup-related strong {
          color: #007bff;
        }

        .full-text-display, .full-translation-display {
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          margin-top: 20px;
        }

        .dark-mode .full-text-display,
        .dark-mode .full-translation-display {
          background: var(--gray-800);
          color: var(--gray-100);
        }

        .full-text-display h3, .full-translation-display h3 {
          margin: 0 0 15px 0;
          color: #667eea;
        }

        .dark-mode .full-text-display h3,
        .dark-mode .full-translation-display h3 {
          color: var(--blue-400);
        }

        .full-text-content {
          font-size: 1.1em;
          line-height: 1.8;
          color: #333;
          font-family: 'Times New Roman', 'Georgia', serif;
        }

        .full-text-content .paragraph-en {
          margin-bottom: 1.5em;
          text-indent: 2em;
          text-align: left;
        }

        .full-text-content .paragraph-en:first-child {
          margin-top: 0;
        }

        /* ä¼šè©±å½¢å¼ã®è¡Œã‚¹ã‚¿ã‚¤ãƒ« */
        .full-text-content .conversation-line {
          text-indent: 0;
          margin-bottom: 1em;
          padding-left: 1em;
          border-left: 3px solid #667eea;
        }

        .full-translation-content {
          font-size: 1.05em;
          line-height: 2;
          color: #333;
        }

        .full-translation-text {
          white-space: pre-wrap;
          line-height: 2;
        }

        .full-translation-content .paragraph-ja {
          margin-bottom: 1.5em;
          text-indent: 1em;
          text-align: left;
        }

        .full-translation-content .paragraph-ja:first-child {
          margin-top: 0;
        }

        /* ä¼šè©±å½¢å¼ã®æ—¥æœ¬èªè¨³ã‚¹ã‚¿ã‚¤ãƒ« */
        .full-translation-content .conversation-line {
          text-indent: 0;
          margin-bottom: 1em;
          padding-left: 1em;
          border-left: 3px solid #667eea;
        }

        .translation-line {
          margin-bottom: 10px;
          padding: 8px;
          background: #f8f9fa;
          border-radius: 4px;
        }
      `})]})}const xo=Object.freeze(Object.defineProperty({__proto__:null,default:Hr},Symbol.toStringTag,{value:"Module"}));function Vr(r){var ce,Ne,$,O;const[t,s]=u.useState(()=>localStorage.getItem("grammar-quiz-type")||"verb-form"),[n,a]=u.useState(()=>localStorage.getItem("grammar-grade")||"all"),[i,l]=u.useState([]),[o,c]=u.useState(!1),[d,m]=u.useState(!1),h=os(Nt.GRAMMAR),{reAddQuestion:p,clearExpiredFlags:N,updateRequeueStats:b}=as(),[x,v]=u.useState(Date.now()),[k,M]=u.useState(void 0),[S,j]=u.useState(void 0),[z,V]=u.useState(0),[ye,ue]=u.useState(0),{learningLimit:K,reviewLimit:he,setLearningLimit:Se,setReviewLimit:se}=Qs("grammar"),[fe,y]=u.useState(!1),P=()=>{y(!fe)},[R,U]=u.useState(()=>localStorage.getItem("autoNext-grammar")==="true"),[J,Z]=u.useState(()=>{const D=localStorage.getItem("autoNextDelay-grammar");return D?parseInt(D,10):1500}),[ke,xe]=u.useState(()=>localStorage.getItem("autoReadAloud-grammar")==="true"),[we,Le]=u.useState(!1),[Ze,Te]=u.useState(!1),[$e,He]=u.useState([]),[_e,ze]=u.useState(0),[We,oe]=u.useState(null),[Ie,qe]=u.useState([]),[Fe,Je]=u.useState([]),[Be,et]=u.useState(""),[je,T]=u.useState(!1),[w,g]=u.useState(!1),[C,I]=u.useState(0),[G,F]=u.useState(0),[B,ae]=u.useState({correct:0,incorrect:0,review:0,mastered:0,newQuestions:0,reviewQuestions:0,consecutiveNew:0,consecutiveReview:0}),[be,Pe]=u.useState(null),L=$e[_e],ee=(L==null?void 0:L.type)==="sentenceOrdering"||t==="sentence-ordering",q=L!=null&&L.id?(()=>{const D=L.id.match(/^g(\d+)-u(\d+)/);if(D)return`g${D[1]}-unit${D[2]}`})():void 0,_=u.useRef({quizType:t,grade:n}),W=u.useRef(Date.now()),ge=u.useCallback(()=>{if(_e<$e.length-1){const D=_e+1,E=N($e,D-1);E!==$e&&He(E),ze(D),oe(null),qe([]),T(!1),g(!1),W.current=Date.now(),j(void 0)}},[_e,$e]),Q=u.useCallback(async()=>{var D,E;Te(!0),Pe(null);try{let re=[],Y=null;if(n==="all")re=["1","2","3"];else if(n.match(/^[123]$/))re=[n];else if(n.endsWith("-all"))re=[n.charAt(0)];else if(n.match(/^g\d+-unit\d+$/)){const Ee=(D=n.match(/^g(\d+)-unit(\d+)$/))==null?void 0:D[1],Ae=(E=n.match(/^g(\d+)-unit(\d+)$/))==null?void 0:E[2];Ee&&Ae!==void 0&&(re=[Ee],Y=parseInt(Ae))}const H=[];for(const Ee of re)for(let Ae=0;Ae<10;Ae++)if(!(Y!==null&&Ae!==Y))try{const Oe=await fetch(`/data/grammar/grammar_grade${Ee}_unit${Ae}.json`);if(Oe.ok){const Ve=await Oe.json();if(Ve.enabled===!1){f.log(`grammar_grade${Ee}_unit${Ae}.json is disabled: ${Ve.disabledReason||"No reason provided"}`);continue}H.push(Ve)}else f.log(`grammar_grade${Ee}_unit${Ae}.json returned status ${Oe.status}, skipping...`)}catch(Oe){f.log(`Failed to fetch grammar_grade${Ee}_unit${Ae}.json:`,Oe)}if(H.length===0)throw new Error(`å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼ˆå­¦å¹´: ${n}, å½¢å¼: ${t}ï¼‰`);let de=[];if(H.forEach(Ee=>{const Ae=Ee.questions||[],Oe={"verb-form":"verbForm","fill-in-blank":"fillInBlank","sentence-ordering":"sentenceOrdering"};if(t==="all"||t==="random")de.push(...Ae);else{const Ve=Oe[t]||t,ve=Ae.filter(Me=>Me.type===Ve);de.push(...ve)}}),de.length===0)throw new Error("é¸æŠã•ã‚ŒãŸæ¡ä»¶ã«è©²å½“ã™ã‚‹å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“");if(f.log(`Total questions: ${de.length}`),de.length===0)throw new Error("å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");de=de.sort(()=>Math.random()-.5),He(de),ze(0),oe(null),qe([]),Je([]),T(!1),g(!1),I(0),F(0),ae({correct:0,incorrect:0,review:0,mastered:0,newQuestions:0,reviewQuestions:0,consecutiveNew:0,consecutiveReview:0}),Le(!0),Te(!1)}catch(re){f.error("ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",re),Pe(re instanceof Error?re.message:String(re)),Te(!1)}},[t,n]),Ce=u.useCallback(async()=>{if(je)ge();else{I(de=>de+1),F(de=>de+1),ae(de=>({...de,correct:de.correct+1,mastered:de.mastered+1}));const D=Date.now()-W.current,{updateWordProgress:E,addSessionHistory:re}=await it(async()=>{const{updateWordProgress:de,addSessionHistory:Ee}=await Promise.resolve().then(()=>Lt);return{updateWordProgress:de,addSessionHistory:Ee}},void 0),Y=L.id?`grammar_${L.id}`:L.question?`grammar_${L.question.slice(0,50).replace(/[^a-zA-Z0-9]/g,"_")}`:`grammar_unknown_${Date.now()}`;await E(Y,!0,D,void 0,"grammar"),re({status:"correct",word:Y,timestamp:Date.now()},"grammar"),v(Date.now()),_e<$e.length-1?(ze(de=>de+1),oe(null),qe([]),T(!1),g(!1),W.current=Date.now()):T(!1)}},[je,_e,$e.length,L,ge]);u.useEffect(()=>{localStorage.setItem("grammar-quiz-type",t)},[t]),u.useEffect(()=>{localStorage.setItem("grammar-grade",n)},[n]),u.useEffect(()=>{(async()=>{const E=[],re=n.match(/^g?(\d+)/),Y=re?re[1]:null;if(!Y||n==="all"){l([]);return}for(let H=0;H<10;H++)try{const de=await fetch(`/data/grammar/grammar_grade${Y}_unit${H}.json`);if(de.ok){const Ee=await de.json();if(Ee.enabled===!1)continue;E.push({value:`g${Y}-unit${H}`,label:`ä¸­${Y}_Unit${H}_${Ee.title}`})}}catch{}l(E)})()},[n,t]),u.useEffect(()=>{const D=_.current,E=D.quizType!==t||D.grade!==n;we&&E&&Q(),_.current={quizType:t,grade:n}},[t,n,Q,we]),u.useEffect(()=>{if(ee&&L&&L.words){const D=[...L.words].sort(()=>Math.random()-.5);Je(D),qe([]),T(!1),g(!1)}},[_e,$e,ee,L]),u.useEffect(()=>{oe(null),et(""),T(!1),g(!1)},[_e]),u.useEffect(()=>{const D=E=>{we&&!je&&E.key==="Enter"&&(E.preventDefault(),Ce())};return window.addEventListener("keydown",D),()=>{window.removeEventListener("keydown",D)}},[we,je,Ce]);const De=async D=>{var me;if(je||ee)return;oe(D),T(!0);const E=D===L.correctAnswer,re=D==="åˆ†ã‹ã‚‰ãªã„";M(E),j(L.question||L.sentence),E?(V(X=>X+1),ue(0)):(ue(X=>X+1),V(0)),ke&&L.sentence&&setTimeout(()=>{const X=new SpeechSynthesisUtterance(L.sentence);X.lang="en-US",X.rate=.9,window.speechSynthesis.speak(X)},300),F(X=>X+1);const Y=Date.now()-W.current;if(E){I(pe=>pe+1);const X=L&&C>=2;ae(pe=>({...pe,correct:pe.correct+1,mastered:X?pe.mastered+1:pe.mastered}))}else ae(re?X=>({...X,incorrect:X.incorrect+1,review:X.review+1}):X=>({...X,incorrect:X.incorrect+1}));const{updateWordProgress:H,loadProgress:de,addSessionHistory:Ee,addQuizResult:Ae}=await it(async()=>{const{updateWordProgress:X,loadProgress:pe,addSessionHistory:Ke,addQuizResult:Qe}=await Promise.resolve().then(()=>Lt);return{updateWordProgress:X,loadProgress:pe,addSessionHistory:Ke,addQuizResult:Qe}},void 0),Oe=L.id?`grammar_${L.id}`:L.question?`grammar_${L.question.slice(0,50).replace(/[^a-zA-Z0-9]/g,"_")}`:`grammar_unknown_${Date.now()}`,{generateId:Ve}=await it(async()=>{const{generateId:X}=await Promise.resolve().then(()=>Rn);return{generateId:X}},void 0);await Ae({id:Ve(),questionSetId:"grammar-set",questionSetName:"æ–‡æ³•å•é¡Œ",score:E?1:0,total:1,percentage:E?100:0,date:Date.now(),timeSpent:Math.floor(Y/1e3),incorrectWords:E?[]:[Oe],mode:"grammar",category:void 0,difficulty:L.difficulty}),await H(Oe,E,Y,void 0,"grammar"),h.recordAnswer(Oe,E,Y);const Me=(me=(await de()).wordProgress)==null?void 0:me[Oe];let le=E?"correct":"incorrect";if(Me&&Me.masteryLevel==="mastered"?le="mastered":!E&&Me&&Me.incorrectCount>=2&&(le="review"),Ee({status:le,word:Oe,timestamp:Date.now()},"grammar"),v(Date.now()),!E&&!fe){const X=$e.slice(_e+1);if(X.length>1){const pe=localStorage.getItem("learning-limit-grammar"),Ke=localStorage.getItem("review-limit-grammar"),Qe=pe?parseInt(pe):null,Xe=Ke?parseInt(Ke):null,tt=ns(X,{isReviewFocusMode:!1,learningLimit:Qe,reviewLimit:Xe,mode:"grammar"});He([...$e.slice(0,_e+1),...tt])}}!E&&!fe&&He(X=>p(L,X,_e));{const X=String(L.word);jt.onShown(X),jt.onAnswer(X,E)}b(L,B,ae)},A=(D,E)=>{je||!ee||(E?(Je(re=>re.filter(Y=>Y!==D)),qe(re=>{var H;const Y=[...re,D];return Y.length===((H=L.words)==null?void 0:H.length)&&!je&&setTimeout(async()=>{var Ke;T(!0);const de=Y.join(" "),Ee=(L.correctAnswer||L.correctOrder||L.sentence||"").replace(/[.!?]/g,"").trim(),Ae=de.toLowerCase()===Ee.toLowerCase();F(Qe=>Qe+1);const Oe=Date.now()-W.current;if(ke&&setTimeout(()=>{const Qe=new SpeechSynthesisUtterance(Ee);Qe.lang="en-US",Qe.rate=.9,window.speechSynthesis.speak(Qe)},300),Ae){I(Xe=>Xe+1);const Qe=C>=2;ae(Xe=>({...Xe,correct:Xe.correct+1,mastered:Qe?Xe.mastered+1:Xe.mastered}))}else ae(Qe=>({...Qe,incorrect:Qe.incorrect+1}));const{updateWordProgress:Ve,loadProgress:ve,addSessionHistory:Me}=await it(async()=>{const{updateWordProgress:Qe,loadProgress:Xe,addSessionHistory:tt}=await Promise.resolve().then(()=>Lt);return{updateWordProgress:Qe,loadProgress:Xe,addSessionHistory:tt}},void 0),le=L.id?`grammar_${L.id}`:L.question?`grammar_${L.question.slice(0,50).replace(/[^a-zA-Z0-9]/g,"_")}`:`grammar_unknown_${Date.now()}`;await Ve(le,Ae,Oe,void 0,"grammar");const X=(Ke=(await ve()).wordProgress)==null?void 0:Ke[le];let pe=Ae?"correct":"incorrect";X&&X.masteryLevel==="mastered"?pe="mastered":!Ae&&X&&X.incorrectCount>=2&&(pe="review"),Me({status:pe,word:le,timestamp:Date.now()},"grammar"),v(Date.now())},100),Y})):(qe(re=>re.filter(Y=>Y!==D)),Je(re=>[...re,D])))},ie=()=>{g(!w)},te=()=>{_e>0&&(ze(D=>D-1),oe(null),qe([]),T(!1),g(!1),W.current=Date.now())},ne=()=>{var D;return!L||!je?!1:ee?Ie.join(" ")===((D=L.words)==null?void 0:D.join(" ")):We===L.correctAnswer};return u.useEffect(()=>{we||Q()},[t,n,Q,we]),e.jsxs("div",{className:"quiz-view",children:[be&&e.jsxs("div",{className:"error-message",children:[e.jsxs("p",{children:["âŒ ",be]}),e.jsx("button",{onClick:Q,className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"å†è©¦è¡Œ"})]}),!be&&we&&L&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(is,{mode:"grammar",currentScore:C,totalAnswered:G,sessionCorrect:B.correct,sessionIncorrect:B.incorrect,sessionReview:B.review,sessionMastered:B.mastered,sessionStats:B,onReviewFocus:P,isReviewFocusMode:fe,onShowSettings:()=>c(!0),onAnswerTime:x,lastAnswerCorrect:k,lastAnswerWord:S,lastAnswerDifficulty:L==null?void 0:L.difficulty,correctStreak:z,incorrectStreak:ye,learningPhase:h.state.currentPhase??void 0,estimatedSpeed:(ce=h.state.personalParams)==null?void 0:ce.learningSpeed,dataSource:n.startsWith("g")&&n.includes("-unit")?` æ–‡æ³•å•é¡Œé›†ï½œ${n.replace("g","").replace("-unit","-unit")}`:` ${n==="all"?"å…¨å­¦å¹´":`${n}å¹´`}`,category:`å‡ºé¡Œå½¢å¼: ${t==="all"?"å…¨ç¨®é¡":t==="verb-form"?"å‹•è©å¤‰åŒ–":t==="fill-in-blank"?"ç©´åŸ‹ã‚":t==="sentence-ordering"?"ä¸¦ã³æ›¿ãˆ":"å…¨ç¨®é¡"}`,difficulty:"",wordPhraseFilter:"all",grammarUnit:q})})}),o&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 border-2 border-transparent rounded-lg transition-all duration-200 hover:bg-gray-300:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"grade-select-active",children:"ğŸ“š å­¦å¹´ãƒ»å˜å…ƒ:"}),e.jsxs("select",{id:"grade-select-active",value:n,onChange:D=>a(D.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨å­¦å¹´ã®å†…å®¹"}),e.jsx("option",{value:"1",children:"1å¹´ã®å†…å®¹"}),i.filter(D=>D.value.startsWith("g1-")).map(D=>e.jsxs("option",{value:D.value,children:["1å¹´_",D.label.replace(/^ä¸­\d+_/,"")]},D.value)),e.jsx("option",{value:"2",children:"2å¹´ã®å†…å®¹"}),i.filter(D=>D.value.startsWith("g2-")).map(D=>e.jsxs("option",{value:D.value,children:["2å¹´_",D.label.replace(/^ä¸­\d+_/,"")]},D.value)),e.jsx("option",{value:"3",children:"3å¹´ã®å†…å®¹"}),i.filter(D=>D.value.startsWith("g3-")).map(D=>e.jsxs("option",{value:D.value,children:["3å¹´_",D.label.replace(/^ä¸­\d+_/,"")]},D.value))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"quiz-type-select-active",children:"ğŸ“ å•é¡Œã®ç¨®é¡:"}),e.jsxs("select",{id:"quiz-type-select-active",value:t,onChange:D=>s(D.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®ç¨®é¡"}),e.jsx("option",{value:"verb-form",children:"å‹•è©å¤‰åŒ–"}),e.jsx("option",{value:"fill-in-blank",children:"ç©´åŸ‹ã‚"}),e.jsx("option",{value:"sentence-ordering",children:"ä¸¦ã³æ›¿ãˆ"})]})]}),e.jsx(Fs,{learningLimit:K,reviewLimit:he,onLearningLimitChange:Se,onReviewLimitChange:se,idPrefix:"grammar-quiz-"}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-next-toggle-grammar-quiz",checked:R,onChange:D=>{U(D.target.checked),localStorage.setItem("autoNext-grammar",D.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-next-toggle-grammar-quiz",className:"checkbox-label",children:["æ­£è§£æ™‚è‡ªå‹•ã§æ¬¡ã¸ï¼š",R?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})}),R&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"auto-next-delay-grammar-quiz",children:"â±ï¸ æ¬¡ã¸ã®é…å»¶æ™‚é–“ï¼š"}),e.jsxs("div",{className:"slider-row",children:[e.jsx("input",{type:"range",id:"auto-next-delay-grammar-quiz",min:"500",max:"3000",step:"100",value:J,onChange:D=>{const E=parseInt(D.target.value,10);Z(E),localStorage.setItem("autoNextDelay-grammar",E.toString())},className:"slider-input"}),e.jsxs("span",{className:"slider-value",children:[(J/1e3).toFixed(1),"ç§’"]})]})]}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-read-aloud-toggle-grammar-quiz",checked:ke,onChange:D=>{xe(D.target.checked),localStorage.setItem("autoReadAloud-grammar",D.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-read-aloud-toggle-grammar-quiz",className:"checkbox-label",children:["å›ç­”æ™‚è‡ªå‹•ã§èª­ã¿ä¸Šã’ï¼š",ke?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})})]}),e.jsx("div",{className:"question-container",children:e.jsxs("div",{className:"question-card relative",children:[e.jsx("button",{onClick:()=>m(!0),className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsx("div",{className:"comment-bar-container"}),e.jsxs("div",{className:"question-nav-row",children:[e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:te,disabled:_e===0,title:"å‰ã¸",children:"â†"}),e.jsxs("div",{className:"question-content-inline",children:[e.jsxs("div",{className:`question-text ${w?"hint-active":""} ${je?"":"clickable"}`,onClick:je?void 0:ie,title:je?"":"ã‚¿ãƒƒãƒ—ã—ã¦ãƒ’ãƒ³ãƒˆã‚’è¡¨ç¤º ğŸ’¡",children:[L.japanese,!je&&e.jsx("span",{className:"hint-icon",children:"ğŸ’¡"})]}),L.difficulty&&e.jsx("div",{className:`difficulty-badge ${L.difficulty}`,children:L.difficulty==="beginner"?"åˆç´š":L.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})]}),e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:Ce,disabled:_e>=$e.length-1,title:je?"æ¬¡ã¸":"ã‚¹ã‚­ãƒƒãƒ— (Enter)",children:"â†’"})]}),w&&!je&&e.jsx("div",{className:"hint-box",children:L.hint}),L.passage&&e.jsxs("div",{className:"passage-context",children:[e.jsx("div",{className:"passage-label",children:"ğŸ“– æ–‡è„ˆ"}),e.jsxs("div",{className:"passage-content",children:[e.jsx("div",{className:"passage-english",children:L.passage}),L.passageJapanese&&e.jsx("div",{className:"passage-japanese",children:L.passageJapanese})]})]}),ee?e.jsxs("div",{className:"word-area",children:[e.jsxs("div",{className:"selected-words-area",children:[e.jsxs("div",{className:"area-label-with-reset",children:[e.jsxs("span",{className:"area-label",children:["é¸æŠã—ãŸå˜èª (",Ie.length,"èª)"]}),!je&&e.jsx("button",{className:`reset-ordering-button ${Ie.length===0?"disabled":""}`,onClick:()=>{if(Ie.length>0){const D=Ie[Ie.length-1];qe(E=>E.slice(0,-1)),Je(E=>[...E,D])}},disabled:Ie.length===0,title:Ie.length===0?"å˜èªã‚’é¸æŠã—ã¦ãã ã•ã„":"æœ€å¾Œã®å˜èªã‚’æˆ»ã™",children:"â†¶ 1ã¤æˆ»ã‚‹"})]}),e.jsxs("div",{className:"word-container",children:[Ie.map((D,E)=>e.jsx("button",{className:"word-button selected",onClick:()=>A(D,!1),disabled:je,children:D},`selected-${E}`)),Ie.length===0&&e.jsx("div",{className:"placeholder",children:"ã“ã“ã«å˜èªã‚’ä¸¦ã¹ã¦ãã ã•ã„"})]})]}),e.jsxs("div",{className:"remaining-words-area",children:[e.jsxs("div",{className:"area-label",children:["ä½¿ãˆã‚‹å˜èª (",Fe.length,"èª)"]}),e.jsx("div",{className:"word-container",children:Fe.map((D,E)=>e.jsx("button",{className:"word-button remaining",onClick:()=>A(D,!0),disabled:je,children:D},`remaining-${E}`))})]})]}):e.jsxs("div",{className:"choices-area",children:[L.conversation?e.jsxs(e.Fragment,{children:[L.japanese&&L.japanese.includes("A:")&&L.japanese.includes("B:")&&e.jsx("div",{className:"japanese-conversation",children:L.japanese.split(/([AB]:)/).map((D,E)=>D==="A:"||D==="B:"?e.jsx("span",{className:"conversation-speaker",children:D},E):D.trim()?e.jsx("span",{className:"conversation-text",children:D.trim()},E):null)}),e.jsx("div",{className:"conversation-display",children:(L.conversation||((Ne=L.dialogue)==null?void 0:Ne.map(D=>`${D.speaker}: ${D.text}`))||[]).map((D,E)=>e.jsx("div",{className:"conversation-line",children:D.split("____").map((re,Y,H)=>e.jsxs("span",{children:[re,Y<H.length-1&&e.jsx("span",{className:"fill-in-blank-space",children:"_______"})]},Y))},E))})]}):L.originalSentence||L.targetSentence?e.jsxs("div",{className:"paraphrase-display",children:[e.jsx("div",{className:"paraphrase-label",children:"ğŸ“ å…ƒã®æ–‡:"}),e.jsx("div",{className:"sentence-display original",children:L.originalSentence||L.sentence}),e.jsx("div",{className:"paraphrase-arrow",children:"â†“ è¨€ã„æ›ãˆ"}),e.jsx("div",{className:"paraphrase-label",children:"âœï¸ æ›¸ãæ›ãˆå¾Œ:"}),e.jsx("div",{className:"sentence-display target",children:($=L.question||L.targetSentence)==null?void 0:$.split("____").map((D,E,re)=>e.jsxs("span",{children:[D,E<re.length-1&&e.jsx("span",{className:"fill-in-blank-space",children:"_______"})]},E))})]}):e.jsx("div",{className:"sentence-display",children:(O=L.sentence)==null?void 0:O.split("____").map((D,E,re)=>e.jsxs("span",{children:[D,E<re.length-1&&e.jsx("span",{className:"fill-in-blank-space",children:"_______"})]},E))}),L.choices&&L.choices.length>0?e.jsxs("div",{className:"choices-grid",children:[L.choices.map((D,E)=>{const re=We===D,Y=D===L.correctAnswer,H=je&&Y,de=je&&re&&!Y;return e.jsxs("button",{className:`choice-button ${re?"selected":""} ${H?"correct":""} ${de?"incorrect":""}`,onClick:()=>De(D),disabled:je,children:[D,H&&" âœ“",de&&" âœ—"]},E)}),e.jsxs("button",{className:`choice-button dont-know ${We==="åˆ†ã‹ã‚‰ãªã„"?"selected":""} ${je&&We==="åˆ†ã‹ã‚‰ãªã„"?"incorrect":""}`,onClick:()=>De("åˆ†ã‹ã‚‰ãªã„"),disabled:je,children:["åˆ†ã‹ã‚‰ãªã„",je&&We==="åˆ†ã‹ã‚‰ãªã„"&&" âœ—"]})]}):e.jsxs("div",{className:"text-input-container",children:[e.jsx("input",{type:"text",className:"text-answer-input",value:Be,onChange:D=>et(D.target.value),onKeyPress:D=>{D.key==="Enter"&&Be.trim()&&De(Be.trim())},placeholder:"ç­”ãˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...",disabled:je,autoFocus:!0}),e.jsx("button",{className:"submit-answer-button",onClick:()=>De(Be.trim()),disabled:je||!Be.trim(),children:"å›ç­”ã™ã‚‹"}),e.jsx("button",{className:`choice-button dont-know ${We==="åˆ†ã‹ã‚‰ãªã„"?"selected":""}`,onClick:()=>De("åˆ†ã‹ã‚‰ãªã„"),disabled:je,children:"åˆ†ã‹ã‚‰ãªã„"})]})]}),je&&e.jsx(e.Fragment,{children:ee?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`result-box ${ne()?"correct":"incorrect"}`,children:[e.jsx("div",{className:"result-header",children:ne()?"âœ… æ­£è§£ï¼":"âŒ ä¸æ­£è§£"}),e.jsx("div",{className:"result-content",children:e.jsxs("div",{className:"answer-comparison",children:[e.jsxs("div",{className:"user-answer",children:[e.jsx("strong",{children:"ã‚ãªãŸã®å›ç­”:"}),e.jsx("br",{}),Ie.join(" ")]}),!ne()&&e.jsxs("div",{className:"correct-answer",children:[e.jsx("strong",{children:"æ­£è§£:"}),e.jsx("br",{}),L.correctAnswer||L.correctOrder||L.sentence||""]})]})})]}),L.explanation&&e.jsx("div",{className:"explanation-box",children:e.jsxs("div",{className:"explanation",children:[e.jsx("strong",{children:"è§£èª¬:"}),e.jsx("br",{}),L.explanation]})})]}):e.jsx(e.Fragment,{children:L.explanation&&e.jsx("div",{className:"explanation-box",children:e.jsxs("div",{className:"explanation",children:[e.jsx("strong",{children:"è§£èª¬:"}),e.jsx("br",{}),L.explanation]})})})})]})})]})]})}const yo=Object.freeze(Object.defineProperty({__proto__:null,default:Vr},Symbol.toStringTag,{value:"Module"}));function vo({allQuestions:r,questionSets:t,customQuestionSets:s=[],onAddWordToCustomSet:n,onRemoveWordFromCustomSet:a,onOpenCustomSetManagement:i}){var De;const[l,o]=u.useState(!1),[c,d]=u.useState("all"),[m,h]=u.useState("all"),[p,N]=u.useState("all"),[b,x]=u.useState("all"),[v,k]=u.useState(()=>{const A=localStorage.getItem("memorization-still-learning-limit");return A?parseInt(A):null}),[M,S]=u.useState(()=>{const A=localStorage.getItem("memorization-incorrect-limit");return A?parseInt(A):null}),[j,z]=u.useState({showWord:!0,showMeaning:!0,showPronunciation:!1,showExample:!1,showEtymology:!1,showRelated:!1}),[V,ye]=u.useState(!1),[ue,K]=u.useState(!0),[he,Se]=u.useState(!1),[se,fe]=u.useState(1.5),[y,P]=u.useState(null),[R,U]=u.useState(0),[J,Z]=u.useState([]),[ke]=u.useState(()=>`session-${Date.now()}`),[xe,we]=u.useState(0),[Le,Ze]=u.useState(!1),[Te,$e]=u.useState({correct:0,still_learning:0,incorrect:0,total:0,newQuestions:0,reviewQuestions:0,consecutiveNew:0,consecutiveReview:0}),[He,_e]=u.useState(0),[ze,We]=u.useState(void 0),[oe,Ie]=u.useState(void 0),[qe,Fe]=u.useState(0),[Je,Be]=u.useState(0),et=u.useRef(0),[je,T]=u.useState(!0),w=u.useRef(0),g=u.useRef(null),C=u.useRef(null),[I,G]=u.useState(!1),F=os(Nt.MEMORIZATION),{reAddQuestion:B,clearExpiredFlags:ae,updateRequeueStats:be}=as();u.useEffect(()=>{(async()=>{try{const ie=await $s();ie&&z(ie);const te=await _s();te&&(ye(te.autoVoice||!1),K(te.voiceWord!==void 0?te.voiceWord:!0),Se(te.voiceMeaning||!1),fe(te.voiceDelay!==void 0?te.voiceDelay:1.5)),T(!1)}catch(ie){f.error("è¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",ie),T(!1)}})()},[]);const Pe=()=>{const A=new Set;return r.forEach(ie=>{ie.relatedFields&&Array.isArray(ie.relatedFields)&&ie.relatedFields.forEach(te=>A.add(te))}),Array.from(A).sort()};u.useEffect(()=>{if(je)return;(()=>{const ie=r;if(ie.length===0)return;let te=ie;p!=="all"&&(te=te.filter(ce=>ce.difficulty===p)),m!=="all"&&(te=te.filter(ce=>ce.relatedFields&&Array.isArray(ce.relatedFields)&&ce.relatedFields.includes(m))),b==="words"?te=te.filter(ce=>!ce.word.includes(" ")||ce.word.split(" ").length<=2):b==="phrases"&&(te=te.filter(ce=>ce.word.includes(" ")&&ce.word.split(" ").length>2));const ne=_(te,v,M);Z(ne),ne.length>0&&(P(ne[0]),U(0),et.current=Date.now())})()},[t,c,p,m,b,r,je,Le]);const L=()=>{Ze(!Le)};u.useEffect(()=>{(v!==null&&Te.still_learning>=v||M!==null&&Te.incorrect>=M)&&(Le||Ze(!0))},[Te,v,M,Le]);const ee=(A,ie=2.5)=>A===0?0:A===1?1:A===2?3:A===3?7:Math.round(7*Math.pow(ie,A-3)),q=(A,ie,te)=>{const $=(Date.now()-A)/(1e3*60*60*24)/(ie||1)*100,O=(1-te/100)*50;return $+O},_=(A,ie,te)=>{const ne=ve=>{var me;const le=localStorage.getItem("english-progress");if(!le)return null;try{const pe=(me=JSON.parse(le).wordProgress)==null?void 0:me[ve];if(!pe)return null;const Ke=pe.memorizationAttempts||0,Qe=pe.memorizationCorrect||0,Xe=pe.memorizationStillLearning||0,tt=pe.memorizationStreak||0,mt=pe.lastStudied||0,Yr=pe.easinessFactor||2.5,Rt=pe.reviewInterval||ee(tt,Yr),$o=pe.avgResponseSpeed||0;if(Ke===0)return{category:"new",priority:3,lastStudied:mt,attempts:Ke,correct:Qe,streak:tt,forgettingRisk:0,reviewInterval:0};const Kr=Qe+Xe*.5,ls=Ke>0?Kr/Ke*100:0,cs=q(mt,Rt,ls);return tt>=3||tt>=2&&ls>=80?{category:"mastered",priority:5,lastStudied:mt,attempts:Ke,correct:Qe,streak:tt,forgettingRisk:cs,reviewInterval:Rt}:ls>=50||Xe>0?{category:"still_learning",priority:2,lastStudied:mt,attempts:Ke,correct:Qe,streak:tt,forgettingRisk:cs,reviewInterval:Rt}:{category:"incorrect",priority:1,lastStudied:mt,attempts:Ke,correct:Qe,streak:tt,forgettingRisk:cs,reviewInterval:Rt}}catch(X){return f.error("çµ±è¨ˆæƒ…å ±ã®å–å¾—ã‚¨ãƒ©ãƒ¼:",X),null}},ce=A.map(ve=>({question:ve,status:ne(ve.word)})),Ne={mastered:ce.filter(ve=>{var Me;return((Me=ve.status)==null?void 0:Me.category)==="mastered"}).length,still_learning:ce.filter(ve=>{var Me;return((Me=ve.status)==null?void 0:Me.category)==="still_learning"}).length,incorrect:ce.filter(ve=>{var Me;return((Me=ve.status)==null?void 0:Me.category)==="incorrect"}).length,new:ce.filter(ve=>{var Me;return((Me=ve.status)==null?void 0:Me.category)==="new"}).length},$=ie!==null&&Ne.still_learning>=ie,O=te!==null&&Ne.incorrect>=te,D=Ne.mastered+Ne.still_learning+Ne.incorrect,E=Ne.still_learning+Ne.incorrect,Y=(D>0?E/D:0)>=.2,H=te!==null?te:50,de=Math.max(3,Math.floor(H*.6)),Ee=Math.max(2,Math.floor(H*.3)),Ae=Ne.incorrect>de,Oe=Ne.incorrect<=Ee;return ce.sort((ve,Me)=>{const le=ve.status,me=Me.status;let X=(le==null?void 0:le.priority)||3,pe=(me==null?void 0:me.priority)||3;if(Le)(le==null?void 0:le.category)==="incorrect"&&(X=0),(me==null?void 0:me.category)==="incorrect"&&(pe=0),(le==null?void 0:le.category)==="still_learning"&&X!==0&&(X=.5),(me==null?void 0:me.category)==="still_learning"&&pe!==0&&(pe=.5),(le==null?void 0:le.category)==="mastered"&&X>1&&(X=10),(me==null?void 0:me.category)==="mastered"&&pe>1&&(pe=10),(le==null?void 0:le.category)==="new"&&X>1&&(X=8),(me==null?void 0:me.category)==="new"&&pe>1&&(pe=8);else{const Xe=(le==null?void 0:le.forgettingRisk)||0,tt=(me==null?void 0:me.forgettingRisk)||0;Xe>=150&&(X=.1),tt>=150&&(pe=.1),Xe>=100&&Xe<150&&(X=.2),tt>=100&&tt<150&&(pe=.2),(le==null?void 0:le.category)==="incorrect"&&X>.2&&(Ae?X=le.lastStudied&&Date.now()-le.lastStudied<864e5?.1:.3:X=.3),(me==null?void 0:me.category)==="incorrect"&&pe>.2&&(Ae?pe=me.lastStudied&&Date.now()-me.lastStudied<864e5?.1:.3:pe=.3),(le==null?void 0:le.category)==="still_learning"&&X>.3&&(X=.8),(me==null?void 0:me.category)==="still_learning"&&pe>.3&&(pe=.8),(le==null?void 0:le.category)==="mastered"&&(Xe>=50&&X>1?X=2:X>2&&(X=4.5)),(me==null?void 0:me.category)==="mastered"&&(tt>=50&&pe>1?pe=2:pe>2&&(pe=4.5)),(le==null?void 0:le.category)==="new"&&X>3&&(Ae?X=10:Oe?X=3.5:X=Y?5:3.5),(me==null?void 0:me.category)==="new"&&pe>3&&(Ae?pe=10:Oe?pe=3.5:pe=Y?5:3.5),O&&((le==null?void 0:le.category)==="incorrect"&&(X=0),(me==null?void 0:me.category)==="incorrect"&&(pe=0)),$&&((le==null?void 0:le.category)==="still_learning"&&(X=.05),(me==null?void 0:me.category)==="still_learning"&&(pe=.05))}if(X!==pe)return X-pe;const Ke=(le==null?void 0:le.lastStudied)||0,Qe=(me==null?void 0:me.lastStudied)||0;return Ke!==Qe?Ke-Qe:Math.random()-.5}).map(ve=>ve.question)};u.useEffect(()=>{if(!y||!V||C.current===y.word)return;C.current=y.word,(async()=>{if(ue&&st(y.word,{rate:.85}),he&&y.meaning){await new Promise(te=>setTimeout(te,se*1e3));const ie=new SpeechSynthesisUtterance(y.meaning);ie.lang="ja-JP",ie.rate=.85,window.speechSynthesis.speak(ie)}})()},[y,V,ue,he,se]);const W=()=>{G(!I)},ge=async A=>{if(A==="showWord")return;const ie={...j,[A]:!j[A]};z(ie),await Ts(ie)},Q=async(A,ie,te,ne)=>{ye(A),K(ie),Se(te),ne!==void 0&&fe(ne),await Es({autoVoice:A,voiceWord:ie,voiceMeaning:te,voiceDelay:ne!==void 0?ne:se,interleavingMode:"off",cardDisplaySettings:j})},Ce=u.useCallback(async A=>{if(!y)return;const ie=(Date.now()-et.current)/1e3,te=A==="right",ne=A==="center";if(We(te),Ie(y.word),te?(Fe(O=>O+1),Be(0)):ne?(Fe(0),Be(0)):(Be(O=>O+1),Fe(0)),$e(O=>({correct:te?O.correct+1:O.correct,still_learning:ne?O.still_learning+1:O.still_learning,incorrect:!te&&!ne?O.incorrect+1:O.incorrect,total:O.total+1,newQuestions:O.newQuestions,reviewQuestions:O.reviewQuestions,consecutiveNew:O.consecutiveNew,consecutiveReview:O.consecutiveReview})),ie<16){const O={word:y.word,timestamp:Date.now(),viewDuration:ie,swipeDirection:A==="center"?"left":A,sessionId:ke,consecutiveViews:xe+1};await Ls(O),we(E=>E+1);const{updateWordProgress:D}=await it(async()=>{const{updateWordProgress:E}=await Promise.resolve().then(()=>Lt);return{updateWordProgress:E}},void 0);await D(y.word,te,ie*1e3,void 0,"memorization",ne),F.recordAnswer(y.word,te,ie*1e3)}_e(Date.now());const ce=!te,Ne=Te.total%3===0||v!==null&&Te.still_learning>=v||M!==null&&Te.incorrect>=M;if((ce||Ne)&&J.length>1){const O=J.slice(R+1),D=ns(O,{isReviewFocusMode:!1,learningLimit:v,reviewLimit:M,mode:"memorization"}),E=[...J.slice(0,R+1),...D];Z(E)}(!te||ne)&&Z(O=>B(y,O,R)),be(y,Te,$e);const $=R+1;if($<J.length){const O=ae(J,R);O!==J&&Z(O),P(J[$]),U($),et.current=Date.now(),Ie(void 0)}else P(null),Ie(void 0)},[y,R,J,ke,xe,Te,v,M]);return u.useEffect(()=>{const A=g.current;if(!A)return;const ie=ce=>{w.current=ce.touches[0].clientX},te=ce=>{const $=ce.changedTouches[0].clientX-w.current;Math.abs($)>100&&($>0?Ce("right"):Ce("left"))},ne=ce=>{ce.key==="ArrowLeft"||ce.key==="1"?(ce.preventDefault(),Ce("left")):ce.key==="ArrowDown"||ce.key==="2"?(ce.preventDefault(),Ce("center")):(ce.key==="ArrowRight"||ce.key==="3")&&(ce.preventDefault(),Ce("right"))};return A.addEventListener("touchstart",ie),A.addEventListener("touchend",te),document.addEventListener("keydown",ne),()=>{A.removeEventListener("touchstart",ie),A.removeEventListener("touchend",te),document.removeEventListener("keydown",ne)}},[Ce]),je?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-xl",children:"èª­ã¿è¾¼ã¿ä¸­..."})}):y?e.jsx("div",{className:"min-h-screen flex flex-col",children:I?e.jsx("div",{className:"fixed inset-0 z-50 bg-gray-50 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-8",children:[e.jsx("button",{onClick:W,className:"fixed top-4 right-4 z-50 p-3 bg-gray-800 text-white rounded-full shadow-lg hover:bg-gray-700:bg-gray-600 transition","aria-label":"å…¨ç”»é¢çµ‚äº†",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"w-full max-w-4xl px-4",children:e.jsxs("div",{ref:g,className:"question-card",children:[e.jsx("div",{className:"mb-8 py-8 flex flex-col items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:`flex flex-col items-center ${Ge()?"clickable-pronunciation":""}`,onClick:A=>{Ge()&&(A.preventDefault(),A.stopPropagation(),st(y.word,{rate:.85}))},onTouchEnd:A=>{Ge()&&(A.preventDefault(),A.stopPropagation(),st(y.word,{rate:.85}))},title:Ge()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":"",children:[e.jsxs("div",{className:`text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 break-words text-center px-4 ${y.word.includes(" ")?"phrase-text":""} ${Ge()?"clickable-word":""}`,children:[y.word,Ge()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"})]}),y.reading&&e.jsxs("div",{className:"question-reading text-base sm:text-lg md:text-xl text-gray-600 mt-3 text-center",children:["ã€",y.reading,"ã€‘"]}),y.difficulty&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:`difficulty-badge ${y.difficulty}`,children:y.difficulty==="beginner"?"åˆç´š":y.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("button",{onClick:()=>Ce("left"),className:"flex flex-col items-center justify-center py-6 px-2 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"åˆ†ã‹ã‚‰ãªã„",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âŒ"}),e.jsx("span",{className:"text-sm sm:text-base",children:"åˆ†ã‹ã‚‰ãªã„"})]}),e.jsxs("button",{onClick:()=>Ce("center"),className:"flex flex-col items-center justify-center py-6 px-2 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"ã¾ã ã¾ã ",children:[e.jsx("span",{className:"text-3xl mb-2",children:"ğŸ¤”"}),e.jsx("span",{className:"text-sm sm:text-base",children:"ã¾ã ã¾ã "})]}),e.jsxs("button",{onClick:()=>Ce("right"),className:"flex flex-col items-center justify-center py-6 px-2 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"è¦šãˆã¦ã‚‹",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âœ…"}),e.jsx("span",{className:"text-sm sm:text-base",children:"è¦šãˆã¦ã‚‹"})]})]}),n&&a&&i&&e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx(At,{word:{word:y.word,meaning:y.meaning,ipa:y.reading,source:"memorization"},sets:s,onAddWord:n,onRemoveWord:a,onOpenManagement:i,size:"medium",variant:"both"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>ge("showMeaning"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"æ„å‘³"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showMeaning?"â–¼":"â–¶"})]}),j.showMeaning&&e.jsx("div",{className:"flex-1 text-base sm:text-lg text-gray-900 break-words",children:y.meaning})]})}),e.jsx("button",{onClick:()=>ge("showPronunciation"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"èª­ã¿"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showPronunciation?"â–¼":"â–¶"})]}),j.showPronunciation&&e.jsx("div",{className:"flex-1 text-sm sm:text-base text-gray-700 break-words",children:y.reading})]})}),y.etymology&&y.etymology.trim()!==""&&y.etymology!=="ä¸­å­¦è‹±èªã§é‡è¦ãªå˜èªã§ã™ã€‚"&&e.jsx("button",{onClick:()=>ge("showEtymology"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-20 sm:w-24 flex-shrink-0 text-sm sm:text-base",children:"èªæºãƒ»è§£èª¬"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showEtymology?"â–¼":"â–¶"})]}),j.showEtymology&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:y.etymology})]})}),y.relatedWords&&y.relatedWords.trim()!==""&&e.jsx("button",{onClick:()=>ge("showRelated"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"é–¢é€£èª"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showRelated?"â–¼":"â–¶"})]}),j.showRelated&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:y.relatedWords})]})})]})]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(is,{mode:"memorization",sessionCorrect:Te.correct,sessionReview:Te.still_learning,sessionIncorrect:Te.incorrect,totalAnswered:Te.total,currentWord:y==null?void 0:y.word,onAnswerTime:He,lastAnswerCorrect:ze,lastAnswerWord:oe,lastAnswerDifficulty:y==null?void 0:y.difficulty,correctStreak:qe,incorrectStreak:Je,learningPhase:F.state.currentPhase??void 0,estimatedSpeed:(De=F.state.personalParams)==null?void 0:De.learningSpeed,onShowSettings:()=>o(!0),dataSource:c,category:m==="all"?"å…¨åˆ†é‡":m,difficulty:p,wordPhraseFilter:b,onReviewFocus:L,isReviewFocusMode:Le})})}),l&&e.jsxs("div",{className:"mb-4 bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-datasource",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ“– å‡ºé¡Œå…ƒ:"}),e.jsxs("select",{id:"memorization-datasource",value:c,onChange:A=>d(A.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å…¨å•é¡Œé›†"}),e.jsx("option",{value:"standard",children:"é«˜æ ¡å—é¨“æ¨™æº–"}),e.jsx("option",{value:"advanced",children:"é«˜æ ¡å—é¨“ä¸Šç´š"}),e.jsx("option",{value:"comprehensive",children:"é«˜æ ¡å—é¨“ç·åˆ"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-difficulty",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ“Š é›£æ˜“åº¦:"}),e.jsxs("select",{id:"memorization-difficulty",value:p,onChange:A=>N(A.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å…¨é›£æ˜“åº¦"}),e.jsx("option",{value:"beginner",children:"åˆç´š"}),e.jsx("option",{value:"intermediate",children:"ä¸­ç´š"}),e.jsx("option",{value:"advanced",children:"ä¸Šç´š"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-category",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ·ï¸ é–¢é€£åˆ†é‡:"}),e.jsxs("select",{id:"memorization-category",value:m,onChange:A=>h(A.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å…¨åˆ†é‡"}),Pe().map(A=>e.jsx("option",{value:A,children:A},A))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-filter",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ“ å˜èªãƒ»ç†Ÿèª:"}),e.jsxs("select",{id:"memorization-filter",value:b,onChange:A=>x(A.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å˜èªï¼‹ç†Ÿèª"}),e.jsx("option",{value:"words",children:"å˜èªã®ã¿"}),e.jsx("option",{value:"phrases",children:"ç†Ÿèªã®ã¿"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-3 text-gray-700",children:"ğŸ¯ å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š:"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"æœªå…¥åŠ›ã®å ´åˆã¯ç„¡åˆ¶é™ã«å‡ºé¡Œã—ã¾ã™ï¼ˆæ¨å¥¨ï¼šLeitnerã‚·ã‚¹ãƒ†ãƒ æ–¹å¼ï¼‰"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:v!==null,onChange:A=>{A.target.checked?(k(50),localStorage.setItem("memorization-still-learning-limit","50")):(k(null),localStorage.removeItem("memorization-still-learning-limit"))},className:"mr-2 w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"ğŸŸ¡ ã¾ã ã¾ã ã®èªæ•°ä¸Šé™ã‚’è¨­å®š"})]}),v!==null&&e.jsxs("div",{className:"ml-6",children:[e.jsx("select",{value:v,title:"ã¾ã ã¾ã ã®èªæ•°ä¸Šé™",onChange:A=>{const ie=parseInt(A.target.value);k(ie),localStorage.setItem("memorization-still-learning-limit",ie.toString())},className:"w-full px-3 py-2 border rounded-lg bg-white",children:[5,10,20,30,50,100,150,200].map(A=>e.jsx("option",{value:A,children:A},A))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ã€å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«è‡ªå‹•ã§åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:M!==null,onChange:A=>{A.target.checked?(S(30),localStorage.setItem("memorization-incorrect-limit","30")):(S(null),localStorage.removeItem("memorization-incorrect-limit"))},className:"mr-2 w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"ğŸ”´ åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™ã‚’è¨­å®š"})]}),M!==null&&e.jsxs("div",{className:"ml-6",children:[e.jsx("select",{value:M,title:"åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™",onChange:A=>{const ie=parseInt(A.target.value);S(ie),localStorage.setItem("memorization-incorrect-limit",ie.toString())},className:"w-full px-3 py-2 border rounded-lg bg-white",children:[5,10,20,30,50,100,150,200].map(A=>e.jsx("option",{value:A,children:A},A))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ã€å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«è‡ªå‹•ã§åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™"})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-3 text-gray-700",children:"ğŸ”Š è‡ªå‹•ç™ºéŸ³è¨­å®š:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:V,onChange:A=>Q(A.target.checked,ue,he),className:"mr-2 w-4 h-4"}),e.jsx("span",{children:"è‡ªå‹•ã§ç™ºéŸ³ã™ã‚‹"})]}),V&&e.jsxs("div",{className:"ml-6 space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:ue,onChange:A=>Q(V,A.target.checked,he),className:"mr-2 w-4 h-4"}),e.jsx("span",{children:"èªå¥ã‚’èª­ã¿ä¸Šã’"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:he,onChange:A=>Q(V,ue,A.target.checked),className:"mr-2 w-4 h-4"}),e.jsx("span",{children:"æ„å‘³ã‚’èª­ã¿ä¸Šã’"})]}),he&&e.jsxs("div",{className:"ml-6 mt-2",children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["â±ï¸ èªå¥ã¨æ„å‘³ã®é–“éš”: ",se.toFixed(1),"ç§’"]}),e.jsx("input",{type:"range",min:"0.5",max:"5.0",step:"0.5",value:se,onChange:A=>{const ie=parseFloat(A.target.value);fe(ie),Q(V,ue,he,ie)},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer","aria-label":"èªå¥ã¨æ„å‘³ã®é–“éš”"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0.5ç§’"}),e.jsx("span",{children:"5.0ç§’"})]})]})]})]})]})]})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full max-w-4xl",children:[e.jsx("button",{onClick:W,className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsxs("div",{ref:g,className:"question-card w-full",children:[e.jsx("div",{className:"mb-8 py-8 flex flex-col items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:`flex flex-col items-center ${Ge()?"clickable-pronunciation":""}`,onClick:A=>{Ge()&&(A.preventDefault(),A.stopPropagation(),st(y.word,{rate:.85}))},onTouchEnd:A=>{Ge()&&(A.preventDefault(),A.stopPropagation(),st(y.word,{rate:.85}))},title:Ge()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":"",children:[e.jsxs("div",{className:`text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 break-words text-center px-4 ${y.word.includes(" ")?"phrase-text":""} ${Ge()?"clickable-word":""}`,children:[y.word,Ge()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"})]}),y.reading&&e.jsxs("div",{className:"question-reading text-base sm:text-lg md:text-xl text-gray-600 mt-3 text-center",children:["ã€",y.reading,"ã€‘"]}),y.difficulty&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:`difficulty-badge ${y.difficulty}`,children:y.difficulty==="beginner"?"åˆç´š":y.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("button",{onClick:()=>Ce("left"),className:"flex flex-col items-center justify-center py-6 px-2 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"åˆ†ã‹ã‚‰ãªã„",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âŒ"}),e.jsx("span",{className:"text-sm sm:text-base",children:"åˆ†ã‹ã‚‰ãªã„"})]}),e.jsxs("button",{onClick:()=>Ce("center"),className:"flex flex-col items-center justify-center py-6 px-2 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"ã¾ã ã¾ã ",children:[e.jsx("span",{className:"text-3xl mb-2",children:"ğŸ¤”"}),e.jsx("span",{className:"text-sm sm:text-base",children:"ã¾ã ã¾ã "})]}),e.jsxs("button",{onClick:()=>Ce("right"),className:"flex flex-col items-center justify-center py-6 px-2 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"è¦šãˆã¦ã‚‹",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âœ…"}),e.jsx("span",{className:"text-sm sm:text-base",children:"è¦šãˆã¦ã‚‹"})]})]}),n&&a&&i&&e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx(At,{word:{word:y.word,meaning:y.meaning,ipa:y.reading,source:"memorization"},sets:s,onAddWord:n,onRemoveWord:a,onOpenManagement:i,size:"medium",variant:"both"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>ge("showMeaning"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"æ„å‘³"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showMeaning?"â–¼":"â–¶"})]}),j.showMeaning&&e.jsx("div",{className:"flex-1 text-base sm:text-lg text-gray-900 break-words",children:y.meaning})]})}),e.jsx("button",{onClick:()=>ge("showPronunciation"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"èª­ã¿"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showPronunciation?"â–¼":"â–¶"})]}),j.showPronunciation&&e.jsx("div",{className:"flex-1 text-sm sm:text-base text-gray-700 break-words",children:y.reading})]})}),y.etymology&&y.etymology.trim()!==""&&y.etymology!=="ä¸­å­¦è‹±èªã§é‡è¦ãªå˜èªã§ã™ã€‚"&&e.jsx("button",{onClick:()=>ge("showEtymology"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-20 sm:w-24 flex-shrink-0 text-sm sm:text-base",children:"èªæºãƒ»è§£èª¬"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showEtymology?"â–¼":"â–¶"})]}),j.showEtymology&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:y.etymology})]})}),y.relatedWords&&y.relatedWords.trim()!==""&&e.jsx("button",{onClick:()=>ge("showRelated"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"é–¢é€£èª"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:j.showRelated?"â–¼":"â–¶"})]}),j.showRelated&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:y.relatedWords})]})})]})]})]})})]})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-xl",children:"èª­ã¿è¾¼ã¿ä¸­..."})})}const wo=()=>{const[r,t]=u.useState("prepositions");return e.jsxs("div",{className:"grammar-guide-view p-4 max-w-app mx-auto",children:[e.jsxs("div",{className:"grammar-guide-tabs grid grid-cols-3 gap-1 sm:gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>t("prepositions"),className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${r==="prepositions"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“ å‰ç½®è©"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“"})]}),e.jsxs("button",{onClick:()=>t("punctuation"),className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${r==="punctuation"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"âœï¸ è¨˜å·"}),e.jsx("span",{className:"sm:hidden",children:"âœï¸"})]}),e.jsxs("button",{onClick:()=>t("tips"),className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${r==="tips"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ’¡ èª­è§£ã‚³ãƒ„"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ’¡"})]})]}),e.jsxs("div",{className:"content-area bg-white rounded-lg p-4 shadow-md border border-gray-200",children:[r==="prepositions"&&e.jsx(bo,{}),r==="punctuation"&&e.jsx(jo,{}),r==="tips"&&e.jsx(No,{})]})]})},bo=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-color mb-4",children:"å‰ç½®è©ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã¨ä½¿ã„åˆ†ã‘"}),e.jsx("p",{className:"text-text-secondary mb-6",children:"è‹±èªã§æœ€ã‚‚é »ç¹ã«ä½¿ã†å‰ç½®è©ã‚’é‡è¦åº¦é †ã«ç´¹ä»‹ã—ã¾ã™ã€‚ãã‚Œãã‚Œã®ã‚³ã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€è‡ªç„¶ãªè‹±èªè¡¨ç¾ãŒèº«ã«ã¤ãã¾ã™ã€‚"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸŒŸ æœ€é‡è¦ï¼šæ™‚é–“ãƒ»å ´æ‰€ã®åŸºæœ¬3ã¤"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50/20 rounded-lg p-5 border-2 border-blue-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“¦"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:"IN"}),e.jsx("div",{className:"text-sm text-blue-700 mt-1",children:"ã€Œå›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸ“… ",e.jsx("strong",{children:"in 2024"})," â†’ å¹´ã¨ã„ã†é•·ã„æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ—“ï¸ ",e.jsx("strong",{children:"in May"})," â†’ æœˆã¨ã„ã†æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ… ",e.jsx("strong",{children:"in the morning"})," â†’ åˆå‰ã¨ã„ã†æ™‚é–“å¸¯ã®ä¸­"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ ",e.jsx("strong",{children:"in Japan"})," â†’ å›½ã¨ã„ã†åºƒã„ç©ºé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ  ",e.jsx("strong",{children:"in the room"})," â†’ éƒ¨å±‹ã¨ã„ã†å›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-5 border-2 border-green-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“„"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 mt-2",children:"ON"}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"ã€Œæ¥è§¦ãƒ»ãã£ã¤ã„ã¦ã„ã‚‹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸ“† ",e.jsx("strong",{children:"on Monday"})," â†’ æ›œæ—¥ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ“… ",e.jsx("strong",{children:"on May 1st"})," â†’ æ—¥ä»˜ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ„ ",e.jsx("strong",{children:"on Christmas"})," â†’ ãã®æ—¥ã«æ¥è§¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸª‘ ",e.jsx("strong",{children:"on the table"})," â†’ ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨é¢ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ–¼ï¸ ",e.jsx("strong",{children:"on the wall"})," â†’ å£é¢ã«æ¥è§¦"]})]})]})]})]}),e.jsxs("div",{className:"bg-orange-50/20 rounded-lg p-5 border-2 border-orange-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600 mt-2",children:"AT"}),e.jsx("div",{className:"text-sm text-orange-700 mt-1",children:"ã€Œãƒ”ãƒ³ãƒã‚¤ãƒ³ãƒˆãƒ»åœ°ç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ•– ",e.jsx("strong",{children:"at 7:00"})," â†’ 7æ™‚ã¨ã„ã†æ™‚åˆ»ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["â˜€ï¸ ",e.jsx("strong",{children:"at noon"})," â†’ æ­£åˆã¨ã„ã†ç¬é–“ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"at night"})," â†’ å¤œã¨ã„ã†æ™‚ç‚¹"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ« ",e.jsx("strong",{children:"at school"})," â†’ å­¦æ ¡ã¨ã„ã†åœ°ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸšª ",e.jsx("strong",{children:"at the door"})," â†’ ãƒ‰ã‚¢ã¨ã„ã†åœ°ç‚¹"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"â­ ãã®ä»–ã®é‡è¦ãªå‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50/20 rounded-lg p-5 border-2 border-blue-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“¦"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:"IN"}),e.jsx("div",{className:"text-sm text-blue-700 mt-1",children:"ã€Œå›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸ“… ",e.jsx("strong",{children:"in 2024"})," â†’ å¹´ã¨ã„ã†é•·ã„æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ—“ï¸ ",e.jsx("strong",{children:"in May"})," â†’ æœˆã¨ã„ã†æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ… ",e.jsx("strong",{children:"in the morning"})," â†’ åˆå‰ã¨ã„ã†æ™‚é–“å¸¯ã®ä¸­"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ ",e.jsx("strong",{children:"in Japan"})," â†’ å›½ã¨ã„ã†åºƒã„ç©ºé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ  ",e.jsx("strong",{children:"in the room"})," â†’ éƒ¨å±‹ã¨ã„ã†å›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-5 border-2 border-green-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“„"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 mt-2",children:"ON"}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"ã€Œæ¥è§¦ãƒ»ãã£ã¤ã„ã¦ã„ã‚‹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸ“† ",e.jsx("strong",{children:"on Monday"})," â†’ æ›œæ—¥ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ“… ",e.jsx("strong",{children:"on May 1st"})," â†’ æ—¥ä»˜ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ„ ",e.jsx("strong",{children:"on Christmas"})," â†’ ãã®æ—¥ã«æ¥è§¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸª‘ ",e.jsx("strong",{children:"on the table"})," â†’ ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨é¢ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ–¼ï¸ ",e.jsx("strong",{children:"on the wall"})," â†’ å£é¢ã«æ¥è§¦"]})]})]})]})]}),e.jsxs("div",{className:"bg-orange-50/20 rounded-lg p-5 border-2 border-orange-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600 mt-2",children:"AT"}),e.jsx("div",{className:"text-sm text-orange-700 mt-1",children:"ã€Œãƒ”ãƒ³ãƒã‚¤ãƒ³ãƒˆãƒ»åœ°ç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ•– ",e.jsx("strong",{children:"at 7:00"})," â†’ 7æ™‚ã¨ã„ã†æ™‚åˆ»ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["â˜€ï¸ ",e.jsx("strong",{children:"at noon"})," â†’ æ­£åˆã¨ã„ã†ç¬é–“ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"at night"})," â†’ å¤œã¨ã„ã†æ™‚ç‚¹"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ« ",e.jsx("strong",{children:"at school"})," â†’ å­¦æ ¡ã¨ã„ã†åœ°ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸšª ",e.jsx("strong",{children:"at the door"})," â†’ ãƒ‰ã‚¢ã¨ã„ã†åœ°ç‚¹"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"â­ ãã®ä»–ã®é‡è¦ãªå‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-pink-50/20 rounded-lg p-5 border-2 border-pink-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â¡ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-pink-600 mt-2",children:"TO"}),e.jsx("div",{className:"text-sm text-pink-700 mt-1",children:"ã€Œæ–¹å‘ãƒ»åˆ°é”ç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-pink-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ§­"})," æ–¹å‘ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-pink-600",children:["ğŸ« ",e.jsx("strong",{children:"to school"})," â†’ å­¦æ ¡ã¸ï¼ˆæ–¹å‘ï¼‰"]}),e.jsxs("div",{className:"text-pink-600",children:["ğŸ—¼ ",e.jsx("strong",{children:"to Tokyo"})," â†’ æ±äº¬ã¸ï¼ˆç›®çš„åœ°ï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-pink-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”„"})," ç¯„å›²ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-pink-600",children:["ğŸ“Š ",e.jsx("strong",{children:"from A to B"})," â†’ Aã‹ã‚‰Bã¾ã§ï¼ˆç¯„å›²ï¼‰"]}),e.jsxs("div",{className:"text-pink-600",children:["ğŸ• ",e.jsx("strong",{children:"from 9 to 5"})," â†’ 9æ™‚ã‹ã‚‰5æ™‚ã¾ã§"]})]})]})]})]}),e.jsxs("div",{className:"bg-purple-50/20 rounded-lg p-5 border-2 border-purple-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¯"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600 mt-2",children:"FOR"}),e.jsx("div",{className:"text-sm text-purple-700 mt-1",children:"ã€Œç›®çš„ãƒ»å¯¾è±¡ãƒ»æœŸé–“ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ’"})," ç›®çš„ãƒ»å¯¾è±¡ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-purple-600",children:["ğŸ‘¤ ",e.jsx("strong",{children:"for you"})," â†’ ã‚ãªãŸã®ãŸã‚ã«ï¼ˆå¯¾è±¡ï¼‰"]}),e.jsxs("div",{className:"text-purple-600",children:["ğŸ³ ",e.jsx("strong",{children:"for breakfast"})," â†’ æœé£Ÿã¨ã—ã¦ï¼ˆç›®çš„ï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â±ï¸"})," æœŸé–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-purple-600",children:["â° ",e.jsx("strong",{children:"for 3 hours"})," â†’ 3æ™‚é–“ï¼ˆç¶™ç¶šæœŸé–“ï¼‰"]}),e.jsxs("div",{className:"text-purple-600",children:["ğŸ“… ",e.jsx("strong",{children:"for a week"})," â†’ 1é€±é–“ï¼ˆç¶™ç¶šæœŸé–“ï¼‰"]})]})]})]})]}),e.jsxs("div",{className:"bg-teal-50/20 rounded-lg p-5 border-2 border-teal-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¬"}),e.jsx("div",{className:"text-2xl font-bold text-teal-600 mt-2",children:"FROM"}),e.jsx("div",{className:"text-sm text-teal-700 mt-1",children:"ã€Œèµ·ç‚¹ãƒ»å‡ºç™ºç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-teal-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," èµ·ç‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-teal-600",children:["ğŸ  ",e.jsx("strong",{children:"from home"})," â†’ å®¶ã‹ã‚‰ï¼ˆå‡ºç™ºç‚¹ï¼‰"]}),e.jsxs("div",{className:"text-teal-600",children:["ğŸ‡¯ğŸ‡µ ",e.jsx("strong",{children:"from Japan"})," â†’ æ—¥æœ¬ã‹ã‚‰ï¼ˆå‡ºèº«ï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-teal-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ•"})," æ™‚é–“ã®èµ·ç‚¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-teal-600",children:["â° ",e.jsx("strong",{children:"from 9 am"})," â†’ 9æ™‚ã‹ã‚‰ï¼ˆé–‹å§‹æ™‚åˆ»ï¼‰"]}),e.jsxs("div",{className:"text-teal-600",children:["ğŸ“… ",e.jsx("strong",{children:"from Monday"})," â†’ æœˆæ›œæ—¥ã‹ã‚‰"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸ“Œ ã‚ˆãä½¿ã†å‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-indigo-50/20 rounded-lg p-5 border-2 border-indigo-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¤"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600 mt-2",children:"WITH"}),e.jsx("div",{className:"text-sm text-indigo-700 mt-1",children:"ã€Œä¸€ç·’ã«ãƒ»ä½¿ã£ã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-indigo-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ‘¥"})," ä¼´ã†ç›¸æ‰‹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-indigo-600",children:["ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ",e.jsx("strong",{children:"with my family"})," â†’ å®¶æ—ã¨ä¸€ç·’ã«"]}),e.jsxs("div",{className:"text-indigo-600",children:["ğŸ§‘â€ğŸ¤â€ğŸ§‘ ",e.jsx("strong",{children:"with friends"})," â†’ å‹é”ã¨"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-indigo-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ› ï¸"})," ä½¿ã†é“å…·ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-indigo-600",children:["âœï¸ ",e.jsx("strong",{children:"with a pen"})," â†’ ãƒšãƒ³ã§ï¼ˆé“å…·ï¼‰"]}),e.jsxs("div",{className:"text-indigo-600",children:["ğŸ´ ",e.jsx("strong",{children:"with chopsticks"})," â†’ ç®¸ã§"]})]})]})]})]}),e.jsxs("div",{className:"bg-amber-50/20 rounded-lg p-5 border-2 border-amber-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸš—"}),e.jsx("div",{className:"text-2xl font-bold text-amber-600 mt-2",children:"BY"}),e.jsx("div",{className:"text-sm text-amber-700 mt-1",children:"ã€Œã€œã®ãã°ã«ãƒ»æ‰‹æ®µã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-amber-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸšŒ"})," æ‰‹æ®µãƒ»æ–¹æ³•ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-amber-600",children:["ğŸš† ",e.jsx("strong",{children:"by train"})," â†’ é›»è»Šã§ï¼ˆäº¤é€šæ‰‹æ®µï¼‰"]}),e.jsxs("div",{className:"text-amber-600",children:["âœ‰ï¸ ",e.jsx("strong",{children:"by email"})," â†’ ãƒ¡ãƒ¼ãƒ«ã§ï¼ˆé€šä¿¡æ‰‹æ®µï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-amber-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," ãã°ã«ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-amber-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"by the sea"})," â†’ æµ·ã®ãã°ã«"]}),e.jsxs("div",{className:"text-amber-600",children:["ğŸªŸ ",e.jsx("strong",{children:"by the window"})," â†’ çª“ã®ãã°ã«"]})]})]})]})]}),e.jsxs("div",{className:"bg-rose-50/20 rounded-lg p-5 border-2 border-rose-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ”—"}),e.jsx("div",{className:"text-2xl font-bold text-rose-600 mt-2",children:"OF"}),e.jsx("div",{className:"text-sm text-rose-700 mt-1",children:"ã€Œã€œã®ï¼ˆæ‰€å±ãƒ»éƒ¨åˆ†ï¼‰ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-rose-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ‘‘"})," æ‰€å±ãƒ»æ‰€æœ‰ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-rose-600",children:["ğŸ“š ",e.jsx("strong",{children:"the book of mine"})," â†’ ç§ã®æœ¬"]}),e.jsxs("div",{className:"text-rose-600",children:["ğŸ›ï¸ ",e.jsx("strong",{children:"the capital of Japan"})," â†’ æ—¥æœ¬ã®é¦–éƒ½"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-rose-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ§©"})," éƒ¨åˆ†ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-rose-600",children:["ğŸ° ",e.jsx("strong",{children:"a piece of cake"})," â†’ ã‚±ãƒ¼ã‚­ä¸€åˆ‡ã‚Œ"]}),e.jsxs("div",{className:"text-rose-600",children:["ğŸ’§ ",e.jsx("strong",{children:"a glass of water"})," â†’ ã‚³ãƒƒãƒ—ä¸€æ¯ã®æ°´"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸ’« ä¸­é »åº¦ã®å‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-cyan-50/20 rounded-lg p-5 border-2 border-cyan-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ’­"}),e.jsx("div",{className:"text-2xl font-bold text-cyan-600 mt-2",children:"ABOUT"}),e.jsx("div",{className:"text-sm text-cyan-700 mt-1",children:"ã€Œã€œã«ã¤ã„ã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-cyan-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“–"})," è©±é¡Œãƒ»å†…å®¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-cyan-600",children:["ğŸ“š ",e.jsx("strong",{children:"a book about history"})," â†’ æ­´å²ã«ã¤ã„ã¦ã®æœ¬"]}),e.jsxs("div",{className:"text-cyan-600",children:["ğŸ’¬ ",e.jsx("strong",{children:"talk about sports"})," â†’ ã‚¹ãƒãƒ¼ãƒ„ã«ã¤ã„ã¦è©±ã™"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-cyan-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”¢"})," ãŠãŠã‚ˆãã®æ•°ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-cyan-600",children:["â° ",e.jsx("strong",{children:"about 10 minutes"})," â†’ ç´„10åˆ†"]}),e.jsxs("div",{className:"text-cyan-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"about 50 people"})," â†’ ç´„50äºº"]})]})]})]})]}),e.jsxs("div",{className:"bg-lime-50/20 rounded-lg p-5 border-2 border-lime-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â­ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-lime-600 mt-2",children:"AFTER"}),e.jsx("div",{className:"text-sm text-lime-700 mt-1",children:"ã€Œã€œã®å¾Œã«ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-lime-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®å¾Œï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-lime-600",children:["ğŸ½ï¸ ",e.jsx("strong",{children:"after dinner"})," â†’ å¤•é£Ÿã®å¾Œ"]}),e.jsxs("div",{className:"text-lime-600",children:["ğŸ« ",e.jsx("strong",{children:"after school"})," â†’ æ”¾èª²å¾Œ"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-lime-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," é †åºï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-lime-600",children:["ğŸ”¤ ",e.jsx("strong",{children:"after you"})," â†’ ãŠå…ˆã«ã©ã†ã"]}),e.jsxs("div",{className:"text-lime-600",children:["ğŸ“ ",e.jsx("strong",{children:"one after another"})," â†’ æ¬¡ã€…ã«"]})]})]})]})]}),e.jsxs("div",{className:"bg-sky-50/20 rounded-lg p-5 border-2 border-sky-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â®ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-sky-600 mt-2",children:"BEFORE"}),e.jsx("div",{className:"text-sm text-sky-700 mt-1",children:"ã€Œã€œã®å‰ã«ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-sky-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®å‰ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-sky-600",children:["ğŸ½ï¸ ",e.jsx("strong",{children:"before breakfast"})," â†’ æœé£Ÿå‰"]}),e.jsxs("div",{className:"text-sky-600",children:["ğŸ„ ",e.jsx("strong",{children:"before Christmas"})," â†’ ã‚¯ãƒªã‚¹ãƒã‚¹ã®å‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-sky-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," é †åºãƒ»ä½ç½®ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-sky-600",children:["ğŸšª ",e.jsx("strong",{children:"before the door"})," â†’ ãƒ‰ã‚¢ã®å‰"]}),e.jsxs("div",{className:"text-sky-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"before everyone"})," â†’ ã¿ã‚“ãªã®å‰ã§"]})]})]})]})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-violet-50/20 rounded-lg p-5 border-2 border-violet-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸŒ‰"}),e.jsx("div",{className:"text-2xl font-bold text-violet-600 mt-2",children:"OVER"}),e.jsx("div",{className:"text-sm text-violet-700 mt-1",children:"ã€Œã€œã®ä¸Šã‚’è¶Šãˆã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-violet-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ¦…"})," ä¸Šæ–¹ãƒ»è¶Šãˆã‚‹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-violet-600",children:["ğŸŒ‰ ",e.jsx("strong",{children:"over the bridge"})," â†’ æ©‹ã‚’è¶Šãˆã¦"]}),e.jsxs("div",{className:"text-violet-600",children:["ğŸ”ï¸ ",e.jsx("strong",{children:"over the mountain"})," â†’ å±±ã‚’è¶Šãˆã¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-violet-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”¢"})," ä»¥ä¸Šãƒ»è¶…éï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-violet-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"over 100 people"})," â†’ 100äººä»¥ä¸Š"]}),e.jsxs("div",{className:"text-violet-600",children:["ğŸ’° ",e.jsx("strong",{children:"over $50"})," â†’ 50ãƒ‰ãƒ«ä»¥ä¸Š"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50/20 rounded-lg p-5 border-2 border-slate-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â¬‡ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-slate-600 mt-2",children:"UNDER"}),e.jsx("div",{className:"text-sm text-slate-700 mt-1",children:"ã€Œã€œã®ä¸‹ã«ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-slate-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â¬‡ï¸"})," ä¸‹æ–¹ãƒ»ä¸‹å´ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-slate-600",children:["ğŸŒ³ ",e.jsx("strong",{children:"under the tree"})," â†’ æœ¨ã®ä¸‹ã«"]}),e.jsxs("div",{className:"text-slate-600",children:["ğŸŒ‰ ",e.jsx("strong",{children:"under the bridge"})," â†’ æ©‹ã®ä¸‹ã«"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-slate-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”¢"})," æœªæº€ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-slate-600",children:["ğŸ‘¶ ",e.jsx("strong",{children:"under 18"})," â†’ 18æ­³æœªæº€"]}),e.jsxs("div",{className:"text-slate-600",children:["ğŸ’° ",e.jsx("strong",{children:"under $10"})," â†’ 10ãƒ‰ãƒ«æœªæº€"]})]})]})]})]}),e.jsxs("div",{className:"bg-fuchsia-50/20 rounded-lg p-5 border-2 border-fuchsia-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸš‡"}),e.jsx("div",{className:"text-2xl font-bold text-fuchsia-600 mt-2",children:"THROUGH"}),e.jsx("div",{className:"text-sm text-fuchsia-700 mt-1",children:"ã€Œã€œã‚’é€šã£ã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-fuchsia-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸšª"})," é€šéãƒ»è²«é€šï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸªŸ ",e.jsx("strong",{children:"through the window"})," â†’ çª“ã‚’é€šã£ã¦"]}),e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸŒ² ",e.jsx("strong",{children:"through the forest"})," â†’ æ£®ã‚’æŠœã‘ã¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-fuchsia-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æœŸé–“å…¨ä½“ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"through the night"})," â†’ ä¸€æ™©ä¸­"]}),e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸŒ§ï¸ ",e.jsx("strong",{children:"through the winter"})," â†’ å†¬ã®é–“ãšã£ã¨"]})]})]})]})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"âœ¨ çŸ¥ã£ã¦ãŠãã¨ä¾¿åˆ©ãªå‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-emerald-50/20 rounded-lg p-5 border-2 border-emerald-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â†”ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600 mt-2",children:"BETWEEN"}),e.jsx("div",{className:"text-sm text-emerald-700 mt-1",children:"ã€Œã€œã®é–“ã«ï¼ˆ2ã¤ï¼‰ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-emerald-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," 2ã¤ã®é–“ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-emerald-600",children:["ğŸ«ğŸ¥ ",e.jsx("strong",{children:"between the school and hospital"})," â†’ å­¦æ ¡ã¨ç—…é™¢ã®é–“"]}),e.jsxs("div",{className:"text-emerald-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"between you and me"})," â†’ ã‚ãªãŸã¨ç§ã®é–“ã§"]})]})]})})]}),e.jsxs("div",{className:"bg-orange-50/20 rounded-lg p-5 border-2 border-orange-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ‘¥"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600 mt-2",children:"AMONG"}),e.jsx("div",{className:"text-sm text-orange-700 mt-1",children:"ã€Œã€œã®é–“ã«ï¼ˆ3ã¤ä»¥ä¸Šï¼‰ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"})," è¤‡æ•°ã®ä¸­ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸŒ¸ ",e.jsx("strong",{children:"among the flowers"})," â†’ èŠ±ã€…ã®ä¸­ã«"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"among friends"})," â†’ å‹äººãŸã¡ã®é–“ã§"]})]})]})})]}),e.jsxs("div",{className:"bg-red-50/20 rounded-lg p-5 border-2 border-red-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸš«"}),e.jsx("div",{className:"text-2xl font-bold text-red-600 mt-2",children:"WITHOUT"}),e.jsx("div",{className:"text-sm text-red-700 mt-1",children:"ã€Œã€œãªã—ã§ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-red-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"âŒ"})," æ¬ å¦‚ãƒ»ä¸åœ¨ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-red-600",children:["ğŸ’§ ",e.jsx("strong",{children:"without water"})," â†’ æ°´ãªã—ã§"]}),e.jsxs("div",{className:"text-red-600",children:["ğŸ‘¤ ",e.jsx("strong",{children:"without you"})," â†’ ã‚ãªãŸãªã—ã§"]})]})]})})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-yellow-50/20 rounded-lg p-5 border-2 border-yellow-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â³"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600 mt-2",children:"DURING"}),e.jsx("div",{className:"text-sm text-yellow-700 mt-1",children:"ã€Œã€œã®é–“ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-yellow-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“…"})," æœŸé–“ä¸­ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-yellow-600",children:["ğŸŒ´ ",e.jsx("strong",{children:"during summer vacation"})," â†’ å¤ä¼‘ã¿ã®é–“"]}),e.jsxs("div",{className:"text-yellow-600",children:["ğŸ¥ ",e.jsx("strong",{children:"during the movie"})," â†’ æ˜ ç”»ã®é–“"]})]})]})})]}),e.jsxs("div",{className:"bg-teal-50/20 rounded-lg p-5 border-2 border-teal-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â°"}),e.jsx("div",{className:"text-2xl font-bold text-teal-600 mt-2",children:"UNTIL/TILL"}),e.jsx("div",{className:"text-sm text-teal-700 mt-1",children:"ã€Œã€œã¾ã§ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-teal-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ•"})," ç¶™ç¶šã®çµ‚ç‚¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-teal-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"until midnight"})," â†’ çœŸå¤œä¸­ã¾ã§"]}),e.jsxs("div",{className:"text-teal-600",children:["ğŸ“… ",e.jsx("strong",{children:"until next week"})," â†’ æ¥é€±ã¾ã§"]})]})]})})]}),e.jsxs("div",{className:"bg-blue-50/20 rounded-lg p-5 border-2 border-blue-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“†"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:"SINCE"}),e.jsx("div",{className:"text-sm text-blue-700 mt-1",children:"ã€Œã€œä»¥æ¥ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“…"})," èµ·ç‚¹ã‹ã‚‰ç¶™ç¶šï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸ‚ ",e.jsx("strong",{children:"since last year"})," â†’ å»å¹´ã‹ã‚‰ï¼ˆãšã£ã¨ï¼‰"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ‘¶ ",e.jsx("strong",{children:"since childhood"})," â†’ å­ä¾›ã®é ƒã‹ã‚‰"]})]})]})})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸ  å ´æ‰€ã‚’è¡¨ã™å‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-purple-50/20 rounded-lg p-5 border-2 border-purple-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¢"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600 mt-2",children:"INSIDE"}),e.jsx("div",{className:"text-sm text-purple-700 mt-1",children:"ã€Œã€œã®å†…å´ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“¦"})," å†…å´ãƒ»å†…éƒ¨ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-purple-600",children:["ğŸ  ",e.jsx("strong",{children:"inside the house"})," â†’ å®¶ã®ä¸­ã«"]}),e.jsxs("div",{className:"text-purple-600",children:["ğŸ“¦ ",e.jsx("strong",{children:"inside the box"})," â†’ ç®±ã®ä¸­ã«"]})]})]})})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-5 border-2 border-green-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸŒ³"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 mt-2",children:"OUTSIDE"}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"ã€Œã€œã®å¤–å´ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸŒ²"})," å¤–å´ãƒ»å¤–éƒ¨ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸ¡ ",e.jsx("strong",{children:"outside the house"})," â†’ å®¶ã®å¤–ã«"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ« ",e.jsx("strong",{children:"outside the school"})," â†’ å­¦æ ¡ã®å¤–ã«"]})]})]})})]}),e.jsxs("div",{className:"bg-cyan-50/20 rounded-lg p-5 border-2 border-cyan-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“"}),e.jsx("div",{className:"text-2xl font-bold text-cyan-600 mt-2",children:"NEAR"}),e.jsx("div",{className:"text-sm text-cyan-700 mt-1",children:"ã€Œã€œã®è¿‘ãã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-cyan-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ¯"})," è¿‘æ¥ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-cyan-600",children:["ğŸš‰ ",e.jsx("strong",{children:"near the station"})," â†’ é§…ã®è¿‘ãã«"]}),e.jsxs("div",{className:"text-cyan-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"near the sea"})," â†’ æµ·ã®è¿‘ãã«"]})]})]})})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-indigo-50/20 rounded-lg p-5 border-2 border-indigo-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ‘¤"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600 mt-2",children:"BEHIND"}),e.jsx("div",{className:"text-sm text-indigo-700 mt-1",children:"ã€Œã€œã®å¾Œã‚ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-indigo-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â¬…ï¸"})," å¾Œæ–¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-indigo-600",children:["ğŸšª ",e.jsx("strong",{children:"behind the door"})," â†’ ãƒ‰ã‚¢ã®å¾Œã‚ã«"]}),e.jsxs("div",{className:"text-indigo-600",children:["ğŸ  ",e.jsx("strong",{children:"behind the house"})," â†’ å®¶ã®è£ã«"]})]})]})})]}),e.jsxs("div",{className:"bg-pink-50/20 rounded-lg p-5 border-2 border-pink-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸŒ‰"}),e.jsx("div",{className:"text-2xl font-bold text-pink-600 mt-2",children:"ACROSS"}),e.jsx("div",{className:"text-sm text-pink-700 mt-1",children:"ã€Œã€œã‚’æ¨ªåˆ‡ã£ã¦ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-pink-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â†”ï¸"})," æ¨ªæ–­ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-pink-600",children:["ğŸ›£ï¸ ",e.jsx("strong",{children:"across the street"})," â†’ é€šã‚Šã‚’æ¨ªåˆ‡ã£ã¦"]}),e.jsxs("div",{className:"text-pink-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"across the river"})," â†’ å·ã‚’æ¸¡ã£ã¦"]})]})]})})]}),e.jsxs("div",{className:"bg-lime-50/20 rounded-lg p-5 border-2 border-lime-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ›¤ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-lime-600 mt-2",children:"ALONG"}),e.jsx("div",{className:"text-sm text-lime-700 mt-1",children:"ã€Œã€œã«æ²¿ã£ã¦ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-lime-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â¡ï¸"})," æ²¿ã£ã¦é€²ã‚€ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-lime-600",children:["ğŸ›£ï¸ ",e.jsx("strong",{children:"along the street"})," â†’ é€šã‚Šã«æ²¿ã£ã¦"]}),e.jsxs("div",{className:"text-lime-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"along the river"})," â†’ å·æ²¿ã„ã«"]})]})]})})]})]})})]}),jo=()=>{const r=[{symbol:".",name:"Period (ãƒ”ãƒªã‚ªãƒ‰)",usage:"æ–‡ã®çµ‚ã‚ã‚Š",example:"I like cats.",explanation:"å¹³å™æ–‡ãƒ»å‘½ä»¤æ–‡ã®çµ‚ã‚ã‚Šã‚’ç¤ºã™"},{symbol:",",name:"Comma (ã‚³ãƒ³ãƒ)",usage:"åŒºåˆ‡ã‚Šãƒ»åˆ—æŒ™",example:"I bought apples, oranges, and bananas.",explanation:"å˜èªã‚„å¥ã‚’åŒºåˆ‡ã‚‹ã€‚æ¥ç¶šè©ã®å‰ã«ã‚‚ä½¿ç”¨"},{symbol:"!",name:"Exclamation Mark (æ„Ÿå˜†ç¬¦)",usage:"æ„Ÿå˜†ãƒ»å¼·èª¿",example:"What a beautiful day!",explanation:"é©šããƒ»å–œã³ãƒ»å¼·ã„æ„Ÿæƒ…ã‚’è¡¨ã™"},{symbol:"?",name:"Question Mark (ç–‘å•ç¬¦)",usage:"ç–‘å•",example:"Do you like music?",explanation:"ç–‘å•æ–‡ã®çµ‚ã‚ã‚Šã‚’ç¤ºã™"},{symbol:":",name:"Colon (ã‚³ãƒ­ãƒ³)",usage:"èª¬æ˜ãƒ»ä¾‹ç¤ºã®å°å…¥",example:"I have three pets: a dog, a cat, and a bird.",explanation:"å¾Œã‚ã«èª¬æ˜ã‚„åˆ—æŒ™ãŒç¶šãã“ã¨ã‚’ç¤ºã™"},{symbol:";",name:"Semicolon (ã‚»ãƒŸã‚³ãƒ­ãƒ³)",usage:"é–¢é€£ã™ã‚‹æ–‡ã®åŒºåˆ‡ã‚Š",example:"I love reading; my sister prefers sports.",explanation:"ãƒ”ãƒªã‚ªãƒ‰ã‚ˆã‚Šå¼±ãã€ã‚³ãƒ³ãƒã‚ˆã‚Šå¼·ã„åŒºåˆ‡ã‚Š"},{symbol:"-",name:"Hyphen (ãƒã‚¤ãƒ•ãƒ³)",usage:"è¤‡åˆèªãƒ»è£œè¶³",example:"a well-known writer",explanation:"2ã¤ä»¥ä¸Šã®å˜èªã‚’ç¹‹ã’ã‚‹"},{symbol:"â€”",name:"Em Dash (ãƒ€ãƒƒã‚·ãƒ¥)",usage:"å¼·ã„åŒºåˆ‡ã‚Šãƒ»æŒ¿å…¥",example:"My friendsâ€”John and Maryâ€”are coming.",explanation:"è£œè¶³æƒ…å ±ã‚’æŒ¿å…¥ã™ã‚‹"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-color mb-4",children:"è‹±æ–‡è¨˜å·ã®æ„å‘³ã¨ä½¿ã„æ–¹"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((t,s)=>e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-5 hover:shadow-lg transition-shadow border border-border-color",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-3",children:[e.jsx("div",{className:"text-5xl font-bold text-primary flex-shrink-0",children:t.symbol}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-text-color",children:t.name}),e.jsx("p",{className:"text-sm text-primary font-semibold",children:t.usage})]})]}),e.jsx("div",{className:"bg-blue-50/20 rounded p-3 mb-3",children:e.jsx("div",{className:"font-mono text-sm text-blue-600",children:t.example})}),e.jsx("p",{className:"text-sm text-text-secondary",children:t.explanation})]},s))})]})},No=()=>{const r=[{icon:"ğŸ“",title:"æœ€åˆã«æ³¨é‡ˆã¨è¨­å•ã‚’ç¢ºèª",description:"æœ¬æ–‡ã‚’èª­ã‚€å‰ã«ã€æ³¨é‡ˆã¨å•é¡Œã‹ã‚‰é‡è¦ãªæ‰‹ãŒã‹ã‚Šã‚’å¾—ã‚‹",details:["æ³¨é‡ˆã¯å˜ã«é›£ã—ã„å˜èªã®æ„å‘³ã§ã¯ãªãã€å†…å®¹ç†è§£ã®ã‚«ã‚®","æ³¨é‡ˆã®å˜èªã‚’é€£æƒ³ã™ã‚‹ã¨é•·æ–‡ã®ã‚ã‚‰ã™ã˜ãŒè¦‹ãˆã¦ãã‚‹","ç­†è€…ã®ä¸»å¼µã‚„å¤§æ„ã‚’å•ã†è¨­å•ã‹ã‚‰ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ‹¾ã†","éƒ¨åˆ†çš„ãªé¸æŠå•é¡Œã®é¸æŠè‚¢ã«ã‚‚å…±é€šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒéš ã‚Œã¦ã„ã‚‹"]},{icon:"ğŸ¯",title:"ã‚¿ã‚¤ãƒˆãƒ«ã¨ç¬¬1æ®µè½ã§å…¨ä½“åƒã‚’æ´ã‚€",description:"è‹±èªã®æ–‡ç« ã¯ã€Œçµè«–å…ˆå‡ºã—ã€ãŒåŸºæœ¬ã€‚æœ€åˆã«å…¨ä½“ã®æ–¹å‘æ€§ãŒç¤ºã•ã‚Œã‚‹",example:{title:"The Importance of Reading Books",para1:"Reading books is one of the best ways to improve your knowledge and imagination. Many people think that reading is boring, but it actually helps you learn new things and understand the world better.",explanation:`ã‚¿ã‚¤ãƒˆãƒ«: ã€Œæœ¬ã‚’èª­ã‚€é‡è¦æ€§ã€â†’ ãƒ†ãƒ¼ãƒç¢ºå®š
ç¬¬1æ®µè½: ã€Œæœ¬ã‚’èª­ã‚€ã“ã¨ã¯çŸ¥è­˜ã¨æƒ³åƒåŠ›ã‚’é«˜ã‚ã‚‹æœ€è‰¯ã®æ–¹æ³•ã®1ã¤ã€â†’ ç­†è€…ã®ä¸»å¼µ
â†’ ã“ã®æ™‚ç‚¹ã§ã€Œæœ¬ã‚’èª­ã‚€ã“ã¨ã®è‰¯ã„ç‚¹ã«ã¤ã„ã¦è¿°ã¹ã‚‹æ–‡ç« ã€ã ã¨åˆ†ã‹ã‚‹`},details:["ã‚¿ã‚¤ãƒˆãƒ« â†’ è©±é¡Œï¼ˆãƒˆãƒ”ãƒƒã‚¯ï¼‰ã‚’ç¤ºã™","ç¬¬1æ®µè½ â†’ ç­†è€…ã®ç«‹å ´ãƒ»ä¸»å¼µã‚’æ˜ç¢ºã«ã™ã‚‹","ã€Œä½•ã«ã¤ã„ã¦ã€ã€Œã©ã†è€ƒãˆã¦ã„ã‚‹ã‹ã€ã‚’ãƒ¡ãƒ¢ã™ã‚‹ã¨æ•´ç†ã—ã‚„ã™ã„","å•é¡Œæèµ·ï¼ˆç–‘å•ï¼‰â†’ æœ¬æ–‡ã§ç­”ãˆã‚’æ¢ã™ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚å¤šã„"]},{icon:"ğŸ“",title:"æ®µè½ã®æœ€åˆã¨æœ€å¾Œã«æ³¨ç›®",description:"è‹±èªã¯ã€Œãƒ‘ãƒ©ã‚°ãƒ©ãƒ•ãƒ»ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã€‚1æ®µè½ = 1ã¤ã®ä¸»å¼µ",example:{structure:`ã€å…¸å‹çš„ãªæ®µè½æ§‹é€ ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¬¬1æ–‡ï¼ˆãƒˆãƒ”ãƒƒã‚¯ã‚»ãƒ³ãƒ†ãƒ³ã‚¹ï¼‰
ã€Œé‹å‹•ã¯å¥åº·ã«è‰¯ã„ã€â† æ®µè½ã®ä¸»å¼µ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä¸­é–“éƒ¨ï¼ˆã‚µãƒãƒ¼ãƒˆï¼‰
ç†ç”±1: ä½“ãŒå¼·ããªã‚‹
ç†ç”±2: ã‚¹ãƒˆãƒ¬ã‚¹è§£æ¶ˆã«ãªã‚‹
å…·ä½“ä¾‹: æ¯æ—¥30åˆ†æ­©ãã ã‘ã§åŠ¹æœ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æœ€çµ‚æ–‡ï¼ˆã¾ã¨ã‚ï¼‰
ã€Œã ã‹ã‚‰é‹å‹•ã‚’ç¿’æ…£ã«ã™ã¹ãã€â† çµè«–
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`,tips:"ç¬¬1æ–‡ã¨æœ€çµ‚æ–‡ã ã‘èª­ã‚ã°ã€ãã®æ®µè½ã§ä½•ã‚’è¨€ã„ãŸã„ã‹ãŒåˆ†ã‹ã‚‹ï¼"},details:["ç¬¬1æ–‡ï¼ˆãƒˆãƒ”ãƒƒã‚¯ã‚»ãƒ³ãƒ†ãƒ³ã‚¹ï¼‰: ãã®æ®µè½ã§æœ€ã‚‚è¨€ã„ãŸã„ã“ã¨","ä¸­é–“éƒ¨: ç†ç”±ãƒ»å…·ä½“ä¾‹ãƒ»ãƒ‡ãƒ¼ã‚¿ï¼ˆé£›ã°ã—èª­ã¿OKï¼‰","æœ€çµ‚æ–‡: ã¾ã¨ã‚ãƒ»çµè«–ãƒ»æ¬¡ã®æ®µè½ã¸ã®æ©‹æ¸¡ã—","æ€¥ã„ã§ã„ã‚‹æ™‚ã¯å„æ®µè½ã®ç¬¬1æ–‡ã ã‘èª­ã‚€ã®ã‚‚æœ‰åŠ¹"]},{icon:"ğŸ”—",title:"ãƒ‡ã‚£ã‚¹ã‚³ãƒ¼ã‚¹ãƒãƒ¼ã‚«ãƒ¼ã‚’è¦‹é€ƒã•ãªã„",description:"æ–‡ç« ã®æµã‚Œã‚’ç¤ºã™ã¤ãªãè¨€è‘‰ãŒè«–ç†å±•é–‹ã®ã‚«ã‚®",details:["é€†æ¥: However, But, Yet, On the other hand","å› æœ: Therefore, So, Thus, As a result","ä¾‹ç¤º: For example, For instance, Such as","è¿½åŠ : In addition, Moreover, Furthermore","è¨€ã„æ›ãˆ: In other words, That is, Namely"]},{icon:"ğŸ”",title:"è¨­å•ã®ç¨®é¡åˆ¥ã®æ”»ç•¥æ³•",description:"å•é¡Œã®ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸèª­ã¿æ–¹ã‚’ä½¿ã„åˆ†ã‘ã‚‹",details:["ä¸»æ—¨å•é¡Œ: å„æ®µè½ã®ç¬¬1æ–‡ã¨æœ€çµ‚æ®µè½ã‚’é‡ç‚¹çš„ã«","è©³ç´°å•é¡Œ: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§è©²å½“ç®‡æ‰€ã‚’ç‰¹å®šã—ã¦ç²¾èª­","èªå½™å•é¡Œ: å‰å¾Œã®æ–‡è„ˆã‹ã‚‰æ„å‘³ã‚’æ¨æ¸¬","æŒ‡ç¤ºèªå•é¡Œ: ç›´å‰ã®å†…å®¹ã‚’ç¢ºèª","NOTå•é¡Œ: æœ¬æ–‡ã«æ›¸ã‹ã‚Œã¦ã„ãªã„é¸æŠè‚¢ã‚’æ¢ã™"]},{icon:"â±ï¸",title:"æ™‚é–“é…åˆ†ã¨å„ªå…ˆé †ä½",description:"å…¨å•è§£ããŸã‚ã®æˆ¦ç•¥çš„ãªæ™‚é–“ç®¡ç†",details:["1å•ã‚ãŸã‚Šã®ç›®å®‰æ™‚é–“ã‚’æ±ºã‚ã‚‹ï¼ˆä¾‹: 3åˆ†/å•ï¼‰","æ˜“ã—ã„å•é¡Œã‹ã‚‰è§£ã„ã¦å¾—ç‚¹ã‚’ç¢ºä¿","é›£å•ã¯å¾Œå›ã—ã€æœ€å¾Œã«æˆ»ã‚‹","æœ€ä½5åˆ†ã¯è¦‹ç›´ã—æ™‚é–“ã‚’ç¢ºä¿"]},{icon:"â“",title:"åˆ†ã‹ã‚‰ãªã„éƒ¨åˆ†ã®å¯¾å‡¦æ³•",description:"å®Œç’§ã‚’ç›®æŒ‡ã•ãšã€åŠ¹ç‡çš„ã«å¾—ç‚¹ã™ã‚‹",details:["çŸ¥ã‚‰ãªã„å˜èªã¯å‰å¾Œã‹ã‚‰æ¨æ¸¬ï¼ˆå“è©ãƒ»è‚¯å®šå¦å®šã‚’åˆ¤æ–­ï¼‰","ä¸€æ–‡ãŒåˆ†ã‹ã‚‰ãªãã¦ã‚‚æ®µè½å…¨ä½“ã‹ã‚‰æ„å‘³ã‚’æ´ã‚€","ç´°éƒ¨ã‚ˆã‚Šå…¨ä½“ã®æµã‚Œã‚’å„ªå…ˆ","æ¶ˆå»æ³•ã§é¸æŠè‚¢ã‚’çµã‚‹ï¼ˆæ˜ã‚‰ã‹ã«é•ã†ã‚‚ã®ã‚’é™¤å¤–ï¼‰"]}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-color mb-4",children:"é•·æ–‡èª­è§£ã®ã‚³ãƒ„"}),e.jsx("div",{className:"bg-yellow-50/20 rounded-lg p-6 border-l-4 border-yellow-500 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ğŸ’¡"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-yellow-800 mb-2",children:"åŸºæœ¬æˆ¦ç•¥"}),e.jsx("p",{className:"text-yellow-700 mb-3",children:"é•·æ–‡èª­è§£ã¯ã€Œå®Œç’§ã«ç†è§£ã™ã‚‹ã€ã®ã§ã¯ãªãã€Œå¿…è¦ãªæƒ…å ±ã‚’åŠ¹ç‡çš„ã«è¦‹ã¤ã‘ã‚‹ã€ä½œæ¥­ã§ã™ã€‚ æ³¨é‡ˆã¨è¨­å•ã‹ã‚‰æ‰‹ãŒã‹ã‚Šã‚’å¾—ã¦ã€å…¨ä½“ã®æµã‚Œã‚’æ´ã¿ãªãŒã‚‰ã€è§£ç­”ã«å¿…è¦ãªéƒ¨åˆ†ã‚’æ¢ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚"}),e.jsxs("div",{className:"bg-yellow-100/30 rounded p-3 text-sm",children:[e.jsx("p",{className:"font-semibold text-yellow-900 mb-1",children:"âš¡ æœ€é‡è¦ãƒã‚¤ãƒ³ãƒˆ"}),e.jsx("p",{className:"text-yellow-800",children:"èª­ã‚€é †ç•ª: â‘  æ³¨é‡ˆ â†’ â‘¡ è¨­å•ãƒ»é¸æŠè‚¢ â†’ â‘¢ ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ç¬¬1æ®µè½ â†’ â‘£ å„æ®µè½ã®ç¬¬1æ–‡ â†’ â‘¤ å¿…è¦ç®‡æ‰€ã‚’ç²¾èª­"})]})]})]})}),e.jsx("div",{className:"space-y-4",children:r.map((t,s)=>e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 hover:shadow-lg transition-shadow border-l-4 border-primary/30",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("span",{className:"text-4xl",children:t.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-text-color mb-2",children:t.title}),e.jsx("p",{className:"text-text-secondary",children:t.description})]})]}),t.example&&e.jsx("div",{className:"ml-14 mb-4 bg-blue-50/20 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"space-y-3",children:[t.example.title&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"ğŸ“Œ ã‚¿ã‚¤ãƒˆãƒ«ä¾‹"}),e.jsx("div",{className:"bg-white rounded p-2 font-mono text-sm text-blue-700",children:t.example.title})]}),t.example.para1&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"ğŸ“„ ç¬¬1æ®µè½ä¾‹"}),e.jsx("div",{className:"bg-white rounded p-2 text-sm text-gray-700 leading-relaxed",children:t.example.para1})]}),t.example.structure&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"ğŸ“Š æ®µè½ã®æ§‹é€ "}),e.jsx("div",{className:"bg-white rounded p-3 text-sm font-mono whitespace-pre-line text-gray-700",children:t.example.structure})]}),t.example.explanation&&e.jsxs("div",{className:"bg-yellow-50/30 rounded p-3 border-l-2 border-yellow-500",children:[e.jsx("div",{className:"text-xs font-semibold text-yellow-800 mb-1",children:"ğŸ’¡ èª­ã¿å–ã‚Œã‚‹ã“ã¨"}),e.jsx("div",{className:"text-sm text-yellow-700 whitespace-pre-line",children:t.example.explanation})]}),t.example.tips&&e.jsx("div",{className:"bg-green-50/30 rounded p-3 border-l-2 border-green-500",children:e.jsxs("div",{className:"text-sm font-semibold text-green-700",children:["âœ¨ ",t.example.tips]})})]})}),e.jsx("ul",{className:"space-y-2 ml-14",children:t.details.map((n,a)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-primary mt-1",children:"âœ“"}),e.jsx("span",{className:"text-text-color",children:n})]},a))})]},s))}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50/20/20 rounded-lg p-6 mt-8 border-2 border-blue-300",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“–"}),e.jsx("span",{children:"å®Ÿè·µï¼åŠ¹ç‡çš„ãªèª­è§£æ‰‹é †"})]}),e.jsx("ol",{className:"space-y-3",children:[{step:"æ³¨é‡ˆã‚’èª­ã‚€",detail:"â†’ é‡è¦å˜èªã‹ã‚‰å†…å®¹ã‚’äºˆæƒ³"},{step:"è¨­å•ã¨é¸æŠè‚¢ã‚’èª­ã‚€",detail:"â†’ ä½•ã‚’èã‹ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯"},{step:"ã‚¿ã‚¤ãƒˆãƒ«ã¨ç¬¬1æ®µè½ã‚’èª­ã‚€",detail:"â†’ ãƒ†ãƒ¼ãƒã¨è«–ç‚¹ã‚’æŠŠæ¡"},{step:"å„æ®µè½ã®ç¬¬1æ–‡ã‚’æµã—èª­ã¿",detail:"â†’ å…¨ä½“æ§‹æˆã‚’ç†è§£"},{step:"è¨­å•ã«é–¢é€£ã™ã‚‹æ®µè½ã‚’ç²¾èª­",detail:"â†’ ç­”ãˆã®æ ¹æ‹ ã‚’æ¢ã™"},{step:"é¸æŠè‚¢ã‚’æœ¬æ–‡ã¨ç…§ã‚‰ã—åˆã‚ã›ã‚‹",detail:"â†’ æ ¹æ‹ ãŒã‚ã‚‹é¸æŠè‚¢ã‚’é¸ã¶"},{step:"è¦‹ç›´ã—",detail:"â†’ é¸ã‚“ã ç­”ãˆãŒæœ¬æ–‡ã®å†…å®¹ã¨çŸ›ç›¾ã—ã¦ã„ãªã„ã‹ç¢ºèª"}].map((t,s)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:s+1}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-color font-semibold",children:t.step}),e.jsx("span",{className:"text-text-secondary text-sm ml-2",children:t.detail})]})]},s))})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-6 border-l-4 border-green-500",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“Œ"}),e.jsx("span",{children:"æ³¨é‡ˆã®åŠ¹æœçš„ãªæ´»ç”¨æ³•"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-green-700",children:[e.jsxs("p",{children:["âœ“ ",e.jsx("strong",{children:"æ³¨é‡ˆãŒã‚ã‚‹ = ãã®å˜èªãŒå†…å®¹ç†è§£ã«å¿…é ˆ"}),"ã¨ã„ã†å‡ºé¡Œè€…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"]}),e.jsx("p",{children:"âœ“ æ³¨é‡ˆã®å˜èªã‚’ä¸¦ã¹ã‚‹ã¨ã€é•·æ–‡ã®ãƒ†ãƒ¼ãƒã‚„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãŒæµ®ã‹ã³ä¸ŠãŒã‚‹"}),e.jsx("p",{children:"âœ“ ä¾‹: ã€Œç’°å¢ƒã€ã€Œæ±šæŸ“ã€ã€Œå¯¾ç­–ã€â†’ ç’°å¢ƒå•é¡Œã«ã¤ã„ã¦ã®æ–‡ç« ã ã¨äºˆæ¸¬ã§ãã‚‹"}),e.jsx("p",{className:"pt-2 italic",children:"ğŸ’¡ æœ¬æ–‡ã‚’èª­ã‚€å‰ã«æ³¨é‡ˆã ã‘ã§å†…å®¹ã‚’äºˆæƒ³ã™ã‚‹ç·´ç¿’ã‚’ã™ã‚‹ã¨åŠ¹æœçš„ï¼"})]})]})]})},So=()=>e.jsx("div",{className:"dictionary-view",children:e.jsxs("div",{className:"dictionary-container",children:[e.jsx("h2",{children:"ğŸ“š è‹±å˜èªè¾æ›¸"}),e.jsx("p",{className:"coming-soon",children:"è¾æ›¸æ©Ÿèƒ½ã¯æº–å‚™ä¸­ã§ã™"})]})}),ko=({isOpen:r,onClose:t,sets:s,onCreateSet:n,onDeleteSet:a,onEditSet:i,onRemoveWord:l})=>{const[o,c]=u.useState("manage"),[d,m]=u.useState(""),[h,p]=u.useState(""),[N,b]=u.useState(null),[x,v]=u.useState(null),[k,M]=u.useState(""),[S,j]=u.useState("");if(!r)return null;const z=()=>{d.trim()&&(n(d.trim(),h.trim()||void 0),m(""),p(""),c("manage"))},V=K=>{v(K.id),M(K.name),j(K.description||"")},ye=()=>{x&&k.trim()&&(i(x,k.trim(),S.trim()||void 0),v(null))},ue=()=>{v(null),M(""),j("")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl sm:max-w-4xl w-full mx-auto max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"ğŸ“š ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆç®¡ç†"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700:text-gray-200 text-2xl","aria-label":"é–‰ã˜ã‚‹",children:"âœ•"})]}),e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>c("manage"),className:`flex-1 px-6 py-3 font-medium ${o==="manage"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900:text-gray-200"}`,children:["ğŸ“‹ ã‚»ãƒƒãƒˆç®¡ç† (",s.length,")"]}),e.jsx("button",{onClick:()=>c("create"),className:`flex-1 px-6 py-3 font-medium ${o==="create"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900:text-gray-200"}`,children:"â• æ–°è¦ä½œæˆ"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o==="manage"?e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg mb-2",children:"ğŸ“ ã¾ã ã‚»ãƒƒãƒˆãŒã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm",children:"ã€Œæ–°è¦ä½œæˆã€ã‚¿ãƒ–ã‹ã‚‰æœ€åˆã®ã‚»ãƒƒãƒˆã‚’ä½œã‚Šã¾ã—ã‚‡ã†"})]}):s.map(K=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 p-4",children:x===K.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:k,onChange:he=>M(he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"ã‚»ãƒƒãƒˆå"}),e.jsx("textarea",{value:S,onChange:he=>j(he.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"èª¬æ˜ï¼ˆä»»æ„ï¼‰",rows:2}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ye,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"ä¿å­˜"}),e.jsx("button",{onClick:ue,className:"px-4 py-2 bg-gray-300 text-gray-900 rounded-md hover:bg-gray-400:bg-gray-500",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"})]})]}):e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:K.icon||"ğŸ“–"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:K.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",K.words.length,"èª)"]})]}),K.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:K.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ä½œæˆ: ",new Date(K.createdAt).toLocaleDateString("ja-JP")]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V(K),className:"text-blue-600 hover:text-blue-700:text-blue-300 text-sm","aria-label":"ç·¨é›†",children:"âœï¸"}),e.jsx("button",{onClick:()=>b(N===K.id?null:K.id),className:"text-gray-600 hover:text-gray-700:text-gray-300 text-sm","aria-label":N===K.id?"æŠ˜ã‚ŠãŸãŸã‚€":"å±•é–‹",children:N===K.id?"â–²":"â–¼"}),e.jsx("button",{onClick:()=>{confirm(`ã€Œ${K.name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)&&a(K.id)},className:"text-red-600 hover:text-red-700:text-red-300 text-sm","aria-label":"å‰Šé™¤",children:"ğŸ—‘ï¸"})]})]})}),N===K.id&&e.jsx("div",{className:"p-4 bg-white",children:K.words.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"ã¾ã å˜èªãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã›ã‚“"}):e.jsx("div",{className:"space-y-2",children:K.words.map((he,Se)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:he.word}),he.ipa&&e.jsxs("span",{className:"text-sm text-blue-600",children:["/",he.ipa,"/"]})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:he.meaning}),he.source&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["å‡ºå…¸: ",he.source,he.sourceDetail&&` (${he.sourceDetail})`]})]}),e.jsx("button",{onClick:()=>l(K.id,he),className:"ml-4 text-red-600 hover:text-red-700:text-red-300","aria-label":"å‰Šé™¤",children:"â–"})]},`${he.word}-${Se}`))})})]},K.id))}):e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ã‚»ãƒƒãƒˆå ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:d,onChange:K=>m(K.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"ä¾‹: è‹¦æ‰‹ãªå‰ç½®è©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"èª¬æ˜ï¼ˆä»»æ„ï¼‰"}),e.jsx("textarea",{value:h,onChange:K=>p(K.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"ä¾‹: é«˜æ ¡å…¥è©¦ã§ã‚ˆãå‡ºã‚‹å‰ç½®è©ã‚’ã¾ã¨ã‚ãŸã‚»ãƒƒãƒˆ",rows:3})]}),e.jsx("button",{onClick:z,disabled:!d.trim(),className:"w-full px-6 py-3 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300:bg-gray-600 disabled:cursor-not-allowed font-medium",children:"â• ã‚»ãƒƒãƒˆã‚’ä½œæˆ"})]}),e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"ğŸ’¡ ãƒ’ãƒ³ãƒˆ"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ ã‚»ãƒƒãƒˆã‚’ä½œæˆå¾Œã€å„ã‚¿ãƒ–ã®+ãƒœã‚¿ãƒ³ã§å˜èªã‚’è¿½åŠ ã§ãã¾ã™"}),e.jsx("li",{children:"â€¢ ã‚»ãƒƒãƒˆåã¯å¾Œã‹ã‚‰ç·¨é›†ã§ãã¾ã™"}),e.jsx("li",{children:"â€¢ è¤‡æ•°ã®ã‚»ãƒƒãƒˆã‚’ä½œã£ã¦ã€ãƒ†ãƒ¼ãƒã”ã¨ã«æ•´ç†ã—ã¾ã—ã‚‡ã†"})]})]})]})})]})})};function Co({onResetComplete:r,allQuestions:t,onQuestionSetsUpdated:s}){const[n,a]=u.useState(!1),[i,l]=u.useState(null),[o,c]=u.useState(!1),[d,m]=u.useState([]),[h,p]=u.useState(null),[N,b]=u.useState(null),[x,v]=u.useState([]),[k,M]=u.useState(null),[S,j]=u.useState([]),[z,V]=u.useState([]),[ye,ue]=u.useState([]),[K,he]=u.useState(0),Se=()=>{try{let y=0;const P=[];for(let R=0;R<localStorage.length;R++){const U=localStorage.key(R);if(U){const J=localStorage.getItem(U);if(J){const Z=new Blob([J]).size;y+=Z,P.push({key:U,sizeMB:Z/(1024*1024)})}}}P.sort((R,U)=>U.sizeMB-R.sizeMB),l({totalMB:y/(1024*1024),details:P.slice(0,5)})}catch(y){f.error("ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã®å–å¾—ã‚¨ãƒ©ãƒ¼:",y)}},se=u.useCallback(()=>{const y=As(14);m(y),p(ys()),b(vs()),v(Rs(12)),M(Ps());const R=Zt(10).map(J=>{const Z=t.find(ke=>ke.word&&J.word&&ke.word.toLowerCase()===J.word.toLowerCase());return{...J,etymology:Z==null?void 0:Z.etymology,relatedWords:Z==null?void 0:Z.relatedWords,difficulty:Z==null?void 0:Z.difficulty}});j(R),V(Ns(10)),ue(ws(7,5));const U=Re();he(U.statistics.streakDays),Se()},[t]);u.useEffect(()=>{se();const y=async()=>{const U=(await rs()).some(J=>J.source==="weak-words");c(U)};y();const P=()=>{se(),y()};if(typeof window<"u"&&window.addEventListener(vt,P),n){const R=setInterval(()=>{se(),y()},1e3);return()=>{clearInterval(R),typeof window<"u"&&window.removeEventListener(vt,P)}}return()=>{typeof window<"u"&&window.removeEventListener(vt,P)}},[n,se]);const fe=()=>{confirm("æœ¬å½“ã«ã™ã¹ã¦ã®å­¦ç¿’è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚")&&(Is(),m([]),p(null),b(null),v([]),M(null),j([]),V([]),ue([]),he(0),alert("å­¦ç¿’è¨˜éŒ²ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ"),se(),r&&r())};return e.jsxs("div",{className:"stats-view",children:[e.jsxs("div",{className:"w-full mb-4 px-2",children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:["ğŸ“† å­¦ç¿’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"ï¼ˆéå»12é€±é–“ï¼‰"})]}),e.jsx(Do,{data:d})]}),e.jsxs("div",{className:"w-full mb-4 px-2",children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:["ğŸ˜° è‹¦æ‰‹å˜èªãƒˆãƒƒãƒ—10",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"ï¼ˆè¦å¾©ç¿’ï¼‰"})]}),S.length>0?e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-orange-200 p-6",children:[e.jsx("ul",{className:"space-y-3",children:S.map((y,P)=>e.jsx("li",{className:"p-4 bg-gradient-to-r from-orange-50 to-red-50/30/30 rounded-lg border border-orange-200 hover:shadow-md hover:scale-[1.02] transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 bg-orange-500 text-white font-bold rounded-full text-sm",children:P+1}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:y.word}),y.meaning&&e.jsx("span",{className:"text-sm text-gray-600 mt-1",children:y.meaning}),y.reading&&e.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:y.reading}),y.etymology&&e.jsxs("span",{className:"text-xs text-blue-600 mt-1",children:["ğŸ“– ",y.etymology]}),y.relatedWords&&e.jsxs("span",{className:"text-xs text-purple-600 mt-0.5",children:["ğŸ”— ",y.relatedWords]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("span",{className:"px-3 py-1 bg-red-100/50 text-red-700 rounded-full font-medium",children:["âŒ ",y.mistakes,"å›"]}),y.recentAccuracy>0&&e.jsxs("span",{className:"px-3 py-1 bg-blue-100/50 text-blue-700 rounded-full font-medium",children:["æ­£è§£ç‡ ",y.recentAccuracy,"%"]})]})]})},P))}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsxs("button",{onClick:async()=>{try{const y=await Ut(`è‹¦æ‰‹èªå¥é›† ${new Date().toLocaleDateString("ja-JP")}`,20,3,60,t);await Bt(y),c(!0),s&&await s(),alert(`âœ… å•é¡Œã‚»ãƒƒãƒˆã€Œ${y.name}ã€ã‚’${o?"æ›´æ–°":"ä½œæˆ"}ã—ã¾ã—ãŸï¼
å’Œè¨³ãƒ»æš—è¨˜ãƒ»ã‚¹ãƒšãƒ«ã‚¿ãƒ–ã§åˆ©ç”¨ã§ãã¾ã™ã€‚`)}catch(y){f.error("å•é¡Œã‚»ãƒƒãƒˆä½œæˆã‚¨ãƒ©ãƒ¼:",y),alert("âŒ å•é¡Œã‚»ãƒƒãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}},className:"flex-1 px-6 py-3 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center gap-2",children:["ğŸ“š å•é¡Œã‚»ãƒƒãƒˆã‚’",o?"æ›´æ–°":"ä½œæˆ",e.jsx("span",{className:"text-xs opacity-90",children:"(ä¸Šä½20èª)"})]}),e.jsx("button",{onClick:async()=>{const y=prompt("å–å¾—ã™ã‚‹è‹¦æ‰‹èªå¥ã®æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆ1-100ï¼‰","30");if(!y)return;const P=parseInt(y);if(isNaN(P)||P<1||P>100){alert("1ã‹ã‚‰100ã¾ã§ã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return}try{const R=await Ut(`è‹¦æ‰‹èªå¥é›† ${new Date().toLocaleDateString("ja-JP")} (${P}èª)`,P,3,60,t);await Bt(R),c(!0),s&&await s(),alert(`âœ… å•é¡Œã‚»ãƒƒãƒˆã€Œ${R.name}ã€ã‚’${o?"æ›´æ–°":"ä½œæˆ"}ã—ã¾ã—ãŸï¼
å’Œè¨³ãƒ»æš—è¨˜ãƒ»ã‚¹ãƒšãƒ«ã‚¿ãƒ–ã§åˆ©ç”¨ã§ãã¾ã™ã€‚`)}catch(R){f.error("å•é¡Œã‚»ãƒƒãƒˆä½œæˆã‚¨ãƒ©ãƒ¼:",R),alert("âŒ å•é¡Œã‚»ãƒƒãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}},className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200",children:"âš™ï¸ ã‚«ã‚¹ã‚¿ãƒ "})]})]}):e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50/20/20 rounded-xl border-2 border-dashed border-green-300 p-8 text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-green-700",children:"è‹¦æ‰‹ãªå˜èªã¯ã‚ã‚Šã¾ã›ã‚“ï¼ğŸ‰"}),e.jsx("p",{className:"text-sm text-green-600 mt-2",children:"é †èª¿ã«å­¦ç¿’ãŒé€²ã‚“ã§ã„ã¾ã™"})]})]}),e.jsx("div",{className:"w-full mb-4 px-2",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border-2 border-red-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:"âš ï¸ ãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚»ãƒƒãƒˆ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ã™ã¹ã¦ã®å­¦ç¿’è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚"})]}),e.jsx("button",{onClick:fe,className:"px-8 py-3 bg-red-600 hover:bg-red-700:bg-red-800 text-white font-bold rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center gap-2",children:"ğŸ—‘ï¸ ãƒªã‚»ãƒƒãƒˆå®Ÿè¡Œ"})]})})}),i&&e.jsxs("div",{className:"w-full mb-4 px-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:"ğŸ’¾ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-purple-200 p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"åˆè¨ˆä½¿ç”¨é‡"}),e.jsxs("span",{className:`text-xl font-bold ${i.totalMB>4?"text-red-600":"text-green-600"}`,children:[i.totalMB.toFixed(2)," MB"," ",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"/ ç´„ 5-10 MB"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden relative",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 absolute left-0 top-0 ${i.totalMB>8?"bg-red-600 w-full":i.totalMB>4?"bg-yellow-500":"bg-green-500"}`,"data-progress":Math.min(i.totalMB/10*100,100)})}),i.totalMB>4&&e.jsx("p",{className:"mt-2 text-sm font-medium text-red-600 flex items-center gap-1",children:"âš ï¸ å®¹é‡ãŒä¸è¶³ã—ã¦ã„ã¾ã™"})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-blue-600 hover:text-blue-700:text-blue-300 font-medium flex items-center gap-2",children:"ğŸ“Š è©³ç´°ã‚’è¡¨ç¤º"}),e.jsx("ul",{className:"mt-4 space-y-2",children:i.details.map((y,P)=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("code",{className:"text-sm text-gray-700 font-mono",children:y.key}),e.jsxs("span",{className:"text-sm font-semibold text-gray-800",children:[y.sizeMB.toFixed(2)," MB"]})]},P))}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50/20 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-700 flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:"ğŸ’¡"}),e.jsx("span",{children:"ãƒ’ãƒ³ãƒˆ: ãƒ‡ãƒ¼ã‚¿ãŒå¤§ãããªã‚Šã™ããŸå ´åˆã¯ã€å¤ã„æˆç¸¾ã‚’å‰Šé™¤ã™ã‚‹ã¨å®¹é‡ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚"})]})})]})]})]})]})}function Do({data:r}){const t=new Date;t.setHours(0,0,0,0);const s=Vt(t),n=r.find(b=>b.date===s);if(r.length===0)return e.jsxs("div",{className:"w-full p-8 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center",children:[e.jsx("p",{className:"text-gray-500 text-lg",children:"ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"å­¦ç¿’ã‚’é–‹å§‹ã™ã‚‹ã¨ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"}),e.jsxs("p",{className:"text-xs text-red-500 mt-4",children:["DEBUG: ä»Šæ—¥=",s,", ãƒ‡ãƒ¼ã‚¿ä»¶æ•°=",r.length,", ä»Šæ—¥ã®ãƒ‡ãƒ¼ã‚¿=",n?`${n.count}å•`:"ãªã—"]})]});const a=new Date(t);a.setDate(a.getDate()-13);const i=new Map(r.map(b=>[b.date,b])),l=[[],[]],o=new Date(t),c=o.getDay(),d=c===0?6:c-1;o.setDate(o.getDate()-d);const m=new Date(o);m.setDate(m.getDate()-7);const h=new Date(m);for(let b=0;b<2;b++)for(let x=0;x<7;x++){const v=Vt(h),k=i.get(v),M=new Date(h);if(M.setHours(0,0,0,0),M.getTime()>t.getTime())l[b].push(null);else{const S=k?Math.round(k.count*k.accuracy/100):0,j=k?{...k,correct:S}:{date:v,count:0,accuracy:0,correct:0};l[b].push(j)}h.setDate(h.getDate()+1)}const p=b=>b===0?"calendar-color-0":b<10?"calendar-color-1":b<20?"calendar-color-2":b<30?"calendar-color-3":"calendar-color-4",N=["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ","æ—¥"];return e.jsxs("div",{className:"w-full p-6 bg-white rounded-xl shadow-lg border-2 border-blue-200",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-max mx-auto w-fit",children:[e.jsx("div",{className:"flex gap-2 mb-2",children:N.map((b,x)=>e.jsx("div",{className:"w-20 h-8 flex items-center justify-center text-sm font-bold text-gray-700",children:b},x))}),e.jsx("div",{className:"flex flex-col gap-2",children:l.map((b,x)=>e.jsx("div",{className:"flex gap-2",children:b.map((v,k)=>{if(!v)return e.jsx("div",{className:"w-20 h-20 rounded bg-gray-100 border border-dashed border-gray-300"},k);const M=new Date(v.date),S=["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"][M.getDay()],j=v.date===s,z={"calendar-color-0":"bg-gray-200 text-gray-500","calendar-color-1":"bg-blue-300 text-blue-900","calendar-color-2":"bg-blue-400 text-white","calendar-color-3":"bg-blue-500 text-white","calendar-color-4":"bg-blue-600 text-white"};return e.jsx("div",{className:`w-20 h-20 rounded-lg flex items-center justify-center text-xs font-bold transition-all duration-200 hover:scale-105 hover:shadow-xl cursor-pointer border-2 ${z[p(v.count)]} ${j?"ring-4 ring-yellow-400 ring-offset-2 ring-offset-white shadow-2xl border-yellow-400":"border-transparent"}`,title:`${v.date} (${S})${j?" [ä»Šæ—¥]":""}: ${v.count}å• (æ­£ç­”ç‡${v.accuracy.toFixed(0)}%, æ­£è§£${v.correct}å•)`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-base",children:v.correct}),e.jsx("span",{className:"text-[10px] opacity-80",children:"/"}),e.jsx("span",{className:"text-sm",children:v.count})]})},k)})},x))})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-6 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"å­¦ç¿’é‡:"}),e.jsx("span",{className:"text-xs",children:"å°‘"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-300 border border-gray-300"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-400 border border-gray-300"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-500 border border-gray-300"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-600 border border-gray-300"}),e.jsx("span",{className:"text-xs",children:"å¤š"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"è¡¨ç¤º:"})," æ­£è§£æ•°/å‡ºé¡Œæ•° |",e.jsx("span",{className:"ml-2 inline-block w-6 h-6 rounded bg-gray-200 border-2 border-yellow-400 align-middle"}),e.jsx("span",{className:"ml-1",children:"= ä»Šæ—¥"})]})]})]})}function Mo({allQuestions:r,onStartSession:t}){const[s,n]=u.useState(null),[a,i]=u.useState(null),[l]=u.useState(3),[o,c]=u.useState({totalLearned:0,totalReviewed:0,averageAccuracy:0,estimatedCompletion:90});if(u.useEffect(()=>{const x=localStorage.getItem("learning-schedule-90days");if(x)try{const v=JSON.parse(x),k=Math.floor((Date.now()-v.startDate)/(1e3*60*60*24)),M=v.totalDays;v.currentDay=Math.min(k+1,M);const S=Math.floor(M/3),j=Math.floor(M*2/3);v.phase=v.currentDay<=S?1:v.currentDay<=j?2:3,n(v),i(Nr(v,r))}catch(v){f.error("Failed to load schedule:",v)}},[r]),u.useEffect(()=>{if(s){c(Sr(s));const x=document.querySelector(".progress-bar");if(x){const v=s.currentDay,k=s.totalDays,M=v/k*100;x.style.width=`${M}%`}}},[s]),!s)return null;const d=["åŸºç¤å›ºã‚æœŸ","å¿œç”¨æ‹¡å¤§æœŸ","å®Œæˆãƒ»å®šç€æœŸ"],m=s.phase,h=s.currentDay,p=s.totalDays,N=h/p*100,b=kr(s);return e.jsxs("div",{className:"learning-plan-dashboard",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsxs("div",{className:"day-counter",children:[e.jsx("span",{className:"day-number",children:h}),e.jsxs("span",{className:"day-label",children:["/ ",p,"æ—¥ç›®"]})]}),e.jsxs("div",{className:"phase-indicator",children:[e.jsxs("span",{className:`phase-badge phase-${m}`,children:["Phase ",m]}),e.jsx("span",{className:"phase-name",children:d[m-1]})]}),e.jsxs("div",{className:"progress-bar-container",children:[e.jsx("div",{className:`progress-bar phase-${m}`}),e.jsxs("span",{className:"progress-label",children:[N.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"stats-summary",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“š"}),e.jsx("div",{className:"stat-value",children:o.totalLearned}),e.jsx("div",{className:"stat-label",children:"å­¦ç¿’æ¸ˆã¿å˜èª"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âœ…"}),e.jsxs("div",{className:"stat-value",children:[o.averageAccuracy.toFixed(1),"%"]}),e.jsx("div",{className:"stat-label",children:"å¹³å‡æ­£ç­”ç‡"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ¯"}),e.jsxs("div",{className:"stat-value",children:[b>0?b.toFixed(0):0,"%"]}),e.jsx("div",{className:"stat-label",children:"ä»Šé€±ã®é”æˆç‡"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"â±ï¸"}),e.jsx("div",{className:"stat-value",children:o.estimatedCompletion}),e.jsx("div",{className:"stat-label",children:"å®Œäº†ã¾ã§ï¼ˆæ—¥ï¼‰"})]})]}),a&&e.jsxs("div",{className:"today-plan",children:[e.jsxs("h2",{children:["ğŸ“– ä»Šæ—¥ã®å­¦ç¿’ãƒ—ãƒ©ãƒ³ï¼ˆDay ",h,"ï¼‰"]}),e.jsxs("div",{className:"session-cards",children:[e.jsxs("div",{className:"session-card morning",children:[e.jsxs("div",{className:"session-header",children:[e.jsx("span",{className:"session-icon",children:"ğŸŒ…"}),e.jsxs("div",{className:"session-info",children:[e.jsx("h3",{children:"æœï¼šæ–°è¦å­¦ç¿’"}),e.jsxs("p",{children:[a.morning.newWords.length,"èª Â· 20åˆ†"]})]})]}),e.jsx("button",{onClick:()=>t("morning",a.morning.newWords),className:"btn-start-session",disabled:a.morning.newWords.length===0,children:a.morning.newWords.length===0?"å˜èªãªã—":"é–‹å§‹ã™ã‚‹"})]}),e.jsxs("div",{className:"session-card afternoon",children:[e.jsxs("div",{className:"session-header",children:[e.jsx("span",{className:"session-icon",children:"â˜€ï¸"}),e.jsxs("div",{className:"session-info",children:[e.jsx("h3",{children:"æ˜¼ï¼šå¼±ç‚¹å¾©ç¿’"}),e.jsxs("p",{children:[a.afternoon.reviewWords.length,"èª Â· 15åˆ†"]})]})]}),e.jsx("button",{onClick:()=>t("afternoon",a.afternoon.reviewWords),className:"btn-start-session",disabled:a.afternoon.reviewWords.length===0,children:a.afternoon.reviewWords.length===0?"å˜èªãªã—":"é–‹å§‹ã™ã‚‹"})]}),e.jsxs("div",{className:"session-card evening",children:[e.jsxs("div",{className:"session-header",children:[e.jsx("span",{className:"session-icon",children:"ğŸŒ™"}),e.jsxs("div",{className:"session-info",children:[e.jsx("h3",{children:"å¤œï¼šç·åˆæ¼”ç¿’"}),e.jsxs("p",{children:[a.evening.mixedWords.length,"èª Â· 20åˆ†"]})]})]}),e.jsx("button",{onClick:()=>t("evening",a.evening.mixedWords),className:"btn-start-session",disabled:a.evening.mixedWords.length===0,children:a.evening.mixedWords.length===0?"å˜èªãªã—":"é–‹å§‹ã™ã‚‹"})]})]})]}),e.jsxs("div",{className:"milestones",children:[e.jsx("h2",{children:"ğŸ† ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³"}),e.jsx("div",{className:"milestone-list",children:s.milestones.map((x,v)=>{const k=h>x.day,M=h===x.day,S=o.totalLearned>=x.wordsTarget;return e.jsxs("div",{className:`milestone-item ${S?"achieved":""} ${M?"current":""} ${k?"passed":""}`,children:[e.jsxs("div",{className:"milestone-day",children:["Day ",x.day]}),e.jsx("div",{className:"milestone-title",children:x.title}),e.jsxs("div",{className:"milestone-target",children:[x.wordsTarget,"èª"]}),S&&e.jsx("span",{className:"check-mark",children:"âœ“"})]},v)})})]})]})}function Io({allQuestions:r,onStartSession:t,_selectedDataSource:s="all",_onDataSourceChange:n,customQuestionSets:a,onOpenCustomSetManagement:i}){const[l,o]=u.useState(()=>{const j=localStorage.getItem("batchSize");return j?parseInt(j,10):20}),[c,d]=u.useState(()=>localStorage.getItem("aiPersonality")||"kind-teacher"),m=j=>{d(j),localStorage.setItem("aiPersonality",j)},[h,p]=u.useState(()=>{const j=localStorage.getItem("voiceGender");return j==="female"||j==="male"?j:"female"}),[N,b]=u.useState(()=>{const j=localStorage.getItem("speechRate");return j?parseFloat(j):.9}),x=j=>{p(j),localStorage.setItem("voiceGender",j)},v=j=>{b(j),localStorage.setItem("speechRate",j.toString())},[k,M]=u.useState(()=>{const j=localStorage.getItem("darkMode");return j==="system"||j==="light"||j==="dark"?j:j==="true"?"dark":j==="false"?"light":"system"}),S=j=>{let z=!1;j==="system"?z=window.matchMedia("(prefers-color-scheme: dark)").matches:z=j==="dark",document.documentElement.classList.toggle("dark",z)};return u.useEffect(()=>{if(S(k),k==="system"){const j=window.matchMedia("(prefers-color-scheme: dark)"),z=()=>{S("system")};return j.addEventListener("change",z),()=>j.removeEventListener("change",z)}},[k]),r.length,e.jsxs("div",{className:"w-full px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“š"}),e.jsx("span",{children:"ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆ"}),e.jsxs("span",{className:"text-sm font-normal text-text-secondary",children:["(",a.length,"å€‹)"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:i,className:"w-full px-6 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-center rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all shadow-md flex items-center justify-center gap-2",children:[e.jsx("span",{children:"ğŸ“š"}),e.jsx("span",{children:"ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã‚’ç®¡ç†"})]}),e.jsx("p",{className:"text-sm text-text-secondary bg-bg-secondary px-4 py-3 rounded-lg",children:"ğŸ’¡ è‡ªåˆ†ã ã‘ã®ã‚ªãƒªã‚¸ãƒŠãƒ«å•é¡Œã‚»ãƒƒãƒˆã‚’ä½œæˆãƒ»ç®¡ç†ã§ãã¾ã™ã€‚å­¦ç¿’ã—ãŸã„å˜èªã‚’è‡ªç”±ã«è¿½åŠ ã—ã¦ã€åŠ¹ç‡çš„ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚"})]})]}),e.jsx(Mo,{allQuestions:r,onStartSession:t}),e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ­"}),e.jsx("span",{children:"AIã®äººæ ¼"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.entries(Ba).map(([j,z])=>e.jsxs("button",{className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-all duration-200 ${c===j?"bg-primary border-primary text-white shadow-lg scale-105":"bg-bg-secondary border-border-color text-text-color hover:border-primary hover:shadow-md hover:scale-102"}`,onClick:()=>m(j),children:[e.jsx("div",{className:"text-3xl",children:z.avatar}),e.jsx("div",{className:"font-semibold text-sm",children:z.name}),e.jsx("div",{className:"text-xs opacity-80 text-center",children:z.description})]},j))})]}),e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”Š"}),e.jsx("span",{children:"éŸ³å£°è¨­å®š"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-base font-semibold text-text-color mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ¤"}),e.jsx("span",{children:"å£°ã®ç¨®é¡"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:`flex flex-col items-center gap-2 px-4 py-4 rounded-lg border-2 transition-all duration-200 ${h==="female"?"bg-primary border-primary text-white shadow-lg scale-105":"bg-bg-secondary border-border-color text-text-color hover:border-primary hover:shadow-md"}`,onClick:()=>x("female"),children:[e.jsx("div",{className:"text-3xl",children:"ğŸ‘©"}),e.jsx("div",{className:"text-sm font-semibold",children:"å¥³æ€§"})]}),e.jsxs("button",{className:`flex flex-col items-center gap-2 px-4 py-4 rounded-lg border-2 transition-all duration-200 ${h==="male"?"bg-primary border-primary text-white shadow-lg scale-105":"bg-bg-secondary border-border-color text-text-color hover:border-primary hover:shadow-md"}`,onClick:()=>x("male"),children:[e.jsx("div",{className:"text-3xl",children:"ğŸ‘¨"}),e.jsx("div",{className:"text-sm font-semibold",children:"ç”·æ€§"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-base font-semibold text-text-color mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"â±ï¸"}),e.jsx("span",{children:"ç™ºéŸ³é€Ÿåº¦"}),e.jsx("span",{className:"text-xs font-normal text-text-secondary",children:"(WPM: Words Per Minute)"})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"font-bold text-primary text-4xl mb-1",children:Math.round(N*150)}),e.jsx("div",{className:"text-sm text-text-secondary",children:"WPM"}),e.jsx("div",{className:"text-xs text-text-secondary mt-2",children:N<.75?"ğŸ¢ ã‚†ã£ãã‚Šã¨ç™ºéŸ³":N>=.95?"ğŸš€ ãƒã‚¤ãƒ†ã‚£ãƒ–ä¸¦ã®é€Ÿåº¦":"ğŸ¯ é«˜æ ¡å…¥è©¦ãƒªã‚¹ãƒ‹ãƒ³ã‚°ç›¸å½“"})]}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("input",{type:"range",min:"0.6",max:"1.0",step:"0.05",value:N,onChange:j=>v(parseFloat(j.target.value)),className:"w-full h-3 bg-border-color rounded-lg appearance-none cursor-pointer accent-primary","aria-label":"ç™ºéŸ³é€Ÿåº¦"}),e.jsxs("div",{className:"absolute top-0 left-0 w-full h-3 pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/2 left-0 -translate-y-1/2 w-0.5 h-5 bg-gray-400"}),e.jsx("div",{className:"absolute top-1/2 left-[37.5%] -translate-y-1/2 w-0.5 h-5 bg-blue-500"}),e.jsx("div",{className:"absolute top-1/2 left-[75%] -translate-y-1/2 w-0.5 h-5 bg-green-500"}),e.jsx("div",{className:"absolute top-1/2 left-full -translate-y-1/2 -translate-x-0.5 w-0.5 h-5 bg-orange-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center text-xs",children:[e.jsxs("button",{onClick:()=>v(.6),className:"bg-gray-50/50 rounded-lg p-3 border border-gray-200 hover:bg-gray-100:bg-gray-700/50 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-gray-600",children:"90 WPM"}),e.jsx("div",{className:"text-gray-500 mt-1",children:"æœ€ä½é€Ÿåº¦"})]}),e.jsxs("button",{onClick:()=>v(.75),className:"bg-blue-50/20 rounded-lg p-3 border border-blue-200 hover:bg-blue-100:bg-blue-800/30 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-blue-600",children:"113 WPM"}),e.jsx("div",{className:"text-blue-500 mt-1",children:"åˆå­¦è€…å‘ã‘"})]}),e.jsxs("button",{onClick:()=>v(.9),className:"bg-green-50/20 rounded-lg p-3 border border-green-200 hover:bg-green-100:bg-green-800/30 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-green-600",children:"135 WPM"}),e.jsx("div",{className:"text-green-500 mt-1",children:"é«˜æ ¡å…¥è©¦"})]}),e.jsxs("button",{onClick:()=>v(1),className:"bg-orange-50/20 rounded-lg p-3 border border-orange-200 hover:bg-orange-100:bg-orange-800/30 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-orange-600",children:"150 WPM"}),e.jsx("div",{className:"text-orange-500 mt-1",children:"ãƒã‚¤ãƒ†ã‚£ãƒ–"})]})]})]})]})]}),e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“‹"}),e.jsx("span",{children:"ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("a",{href:"/privacy.html",target:"_blank",rel:"noopener noreferrer",className:"block w-full px-4 py-3 bg-primary text-white text-center rounded-lg font-semibold hover:bg-btn-primary-hover transition-colors shadow-md",children:"ğŸ“„ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼"}),e.jsx("p",{className:"text-sm text-text-secondary bg-bg-secondary px-4 py-3 rounded-lg text-center",children:"æœ¬ã‚¢ãƒ—ãƒªã¯å€‹äººæƒ…å ±ã‚’åé›†ã›ãšã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã«ã®ã¿ä¿å­˜ã•ã‚Œã¾ã™ã€‚"})]})]})]})}const Ao=({isVisible:r,message:t="èª­ã¿è¾¼ã¿ä¸­..."})=>r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 pointer-events-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 flex flex-col items-center gap-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"relative w-16 h-16",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-gray-200"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-blue-600 animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-800 font-semibold text-lg",children:t}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"æº–å‚™ä¸­ã§ã™..."})]})]})}):null;let Et=null,_t=null;async function or(){return Et||(Et=(await it(()=>Promise.resolve().then(()=>yo),void 0)).default,Et)}async function lr(){return _t||(_t=(await it(()=>Promise.resolve().then(()=>xo),void 0)).default,_t)}function cr(){typeof requestIdleCallback<"u"?requestIdleCallback(()=>{or(),lr()}):setTimeout(()=>{or(),lr()},2e3)}const Jr=["è¨€èªåŸºæœ¬","å­¦æ ¡ãƒ»å­¦ç¿’","æ—¥å¸¸ç”Ÿæ´»","äººãƒ»ç¤¾ä¼š","è‡ªç„¶ãƒ»ç’°å¢ƒ","é£Ÿãƒ»å¥åº·","é‹å‹•ãƒ»å¨¯æ¥½","å ´æ‰€ãƒ»ç§»å‹•","æ™‚é–“ãƒ»æ•°é‡","ç§‘å­¦ãƒ»æŠ€è¡“"];function Ro(){try{let r=0;const t=[];for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);if(a){const i=localStorage.getItem(a);if(i){const l=new Blob([i]).size;r+=l,t.push({key:a,size:l})}}}const s=r/(1024*1024);f.log(`ğŸ“Š LocalStorageä½¿ç”¨é‡: ${s.toFixed(2)}MB`),t.sort((n,a)=>a.size-n.size),t.slice(0,5).forEach(n=>{const a=n.size/1048576;f.log(`  - ${n.key}: ${a.toFixed(2)}MB`)}),s>4&&(f.warn("âš ï¸ LocalStorageã®ä½¿ç”¨é‡ãŒå¤šã„ãŸã‚ã€å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å‰Šé™¤ã—ã¦ã„ã¾ã™ã€‚"),rt(),f.log("è‡ªå‹•åœ§ç¸®ãŒå®Œäº†ã—ã¾ã—ãŸã€‚"))}catch(r){f.error("LocalStorageã‚µã‚¤ã‚ºã®ç¢ºèªã‚¨ãƒ©ãƒ¼:",r)}}function Po(){const[r,t]=u.useState("translation"),[s,n]=u.useState(!1),[a,i]=u.useState([]),[l,o]=u.useState(()=>En()),[c,d]=u.useState(!1);u.useEffect(()=>{_n(l)},[l]),u.useEffect(()=>{!window.location.hostname.includes("github.io")&&it(()=>import("./scoreBoardTests-pQqN2S0L.js"),__vite__mapDeps([0,1,2])).then(()=>{f.log("âœ… ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ"),f.log("   ä½¿ã„æ–¹: window.runScoreBoardTests()"),f.log('   ã¾ãŸã¯: window.checkCurrentScoreBoardDisplay("translation")')}).catch(_=>{f.error("ãƒ†ã‚¹ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",_)})},[]);const{categoryList:m,setCategoryList:h,selectedCategory:p,setSelectedCategory:N,selectedDifficulty:b,setSelectedDifficulty:x,selectedWordPhraseFilter:v,setSelectedWordPhraseFilter:k,selectedPhraseTypeFilter:M,setSelectedPhraseTypeFilter:S,selectedDataSource:j,setSelectedDataSource:z}=Tn(),[V,ye]=u.useState([]),[ue,K]=u.useState(!1),he=u.useRef(!1);u.useEffect(()=>{he.current=!1},[r]),u.useEffect(()=>{ue&&(r==="translation"||r==="spelling")&&!he.current&&y.questions.length===0&&(he.current=!0,C())},[ue,r]);const[Se]=u.useState(()=>{const q=localStorage.getItem("quiz-adaptive-mode");return q?JSON.parse(q):!1}),{sessionStats:se,setSessionStats:fe,quizState:y,setQuizState:P,reviewFocusMode:R,setReviewFocusMode:U,reviewQuestionPool:J,setReviewQuestionPool:Z,reviewCorrectStreak:ke,setReviewCorrectStreak:xe}=$n(),{reAddQuestion:we,clearExpiredFlags:Le,updateRequeueStats:Ze}=as(),Te=u.useRef(0),$e=u.useRef(0),He=u.useRef([]),_e=u.useRef(0),ze=u.useRef([]),We=u.useRef(null),oe=u.useRef(null),Ie=u.useRef(new Map),qe=u.useRef([]),Fe=u.useRef([]);Pn(),u.useEffect(()=>{const q=Ce=>{const De=Ce==="dark"||Ce==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.classList.toggle("dark-mode",De)},W=localStorage.getItem("darkMode")||"system";q(W);const ge=window.matchMedia("(prefers-color-scheme: dark)"),Q=()=>{const Ce=localStorage.getItem("darkMode");(!Ce||Ce==="system")&&q("system")};return ge.addEventListener("change",Q),()=>ge.removeEventListener("change",Q)},[]),u.useEffect(()=>{(async()=>{try{f.log("ğŸ”„ ãƒ‡ãƒ¼ã‚¿ç§»è¡Œãƒã‚§ãƒƒã‚¯ä¸­...");try{await gn()}catch(ne){f.error("Migration error (continuing):",ne)}pn();let _=!1;try{const ne=await rt();ne&&ne.wordProgress&&ne.statistics&&ne.questionSetStats?(ot(ne),f.log("âœ… Progress data loaded successfully"),_=!0):f.warn("âš ï¸ Progress data incomplete, reinitializing")}catch(ne){f.error("Progress load error:",ne)}if(!_){f.log("ğŸ”§ Initializing fresh progress data");const ne={results:[],statistics:{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:{},wordProgress:{},categoryStats:{},difficultyStats:{}};ot(ne);try{localStorage.setItem("progress-data",JSON.stringify(ne))}catch(ce){f.warn("Failed to save initial progress:",ce)}}Ro();const ge=await(await fetch("/data/vocabulary/high-school-entrance-words.csv")).text(),Q=kt(ge).map(ne=>({...ne,source:"junior"}));let Ce=[];try{const ce=await(await fetch("/data/vocabulary/high-school-entrance-phrases.csv")).text();Ce=kt(ce).map(Ne=>({...Ne,source:"junior"})),f.log(`ğŸ“š é«˜æ ¡å—é¨“è‹±ç†Ÿèªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ: ${Ce.length}å€‹`)}catch(ne){f.warn("é«˜æ ¡å—é¨“è‹±ç†Ÿèªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",ne)}let De=[];try{const ce=await(await fetch("/data/vocabulary/high-school-intermediate-words.csv")).text();De=kt(ce).map(Ne=>({...Ne,source:"intermediate"})),f.log(`ğŸ“š ä¸­ç´š1800å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ: ${De.length}å€‹`)}catch(ne){f.warn("ä¸­ç´š1800å˜èªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",ne)}let A=[];try{const ce=await(await fetch("/data/vocabulary/high-school-intermediate-phrases.csv")).text();A=kt(ce).map(Ne=>({...Ne,source:"intermediate"})),f.log(`ğŸ“š ä¸­ç´š1800ç†Ÿèªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ: ${A.length}å€‹`)}catch(ne){f.warn("ä¸­ç´š1800ç†Ÿèªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",ne)}const ie=new Map;try{for(const ne of[1,2,3])try{const Ne=await(await fetch(`/data/sentence-ordering-grade${ne}.json`)).json();Ne.units&&Ne.units.forEach($=>{const O=`${ne}å¹´ ${$.unit}`;ie.set($.unit,`${$.unit}: ${$.title}`),ie.set(O,`${ne}å¹´ ${$.unit}: ${$.title}`)})}catch(ce){f.warn(`Grade ${ne} sentence ordering data not found:`,ce)}}catch(ne){f.warn("Unit title mapping failed:",ne)}const te=[...Q,...Ce,...De,...A];if(te.length>0){i(te);try{const H=te.map(de=>({word:de.word,difficulty:de.difficulty||"beginner"}));localStorage.setItem("all-questions-cache",JSON.stringify(H))}catch(H){f.warn("Questions cache save failed:",H)}const Ne=Array.from(new Set(te.map(H=>H.category||"").filter(H=>H))).map(H=>ie.has(H)?ie.get(H):H).sort((H,de)=>{const Ee=/(\d+)å¹´\s+Unit\s+(\d+)/i,Ae=H.match(Ee),Oe=de.match(Ee);if(Ae&&Oe){const le=parseInt(Ae[1],10),me=parseInt(Oe[1],10);if(le!==me)return le-me;const X=parseInt(Ae[2],10),pe=parseInt(Oe[2],10);return X-pe}const Ve=/Unit\s+(\d+)/i,ve=H.match(Ve),Me=de.match(Ve);if(ve&&Me){const le=parseInt(ve[1],10),me=parseInt(Me[1],10);return le-me}return H.localeCompare(de,"ja")});h(Ne);const $={id:"all-set",name:"é«˜æ ¡å—é¨“ç·åˆ",questions:te,createdAt:Date.now(),isBuiltIn:!0,source:"é«˜æ ¡å—é¨“2758èª + é«˜æ ¡å—é¨“æ¨™æº–1791èª"},O={id:"advanced-set",name:"é«˜æ ¡å—é¨“ä¸Šç´š",questions:te.filter(H=>H.difficulty==="advanced"),createdAt:Date.now(),isBuiltIn:!0,source:"high-school-entrance (å˜èª2662 + ç†Ÿèª96)"},D={id:"standard-set",name:"é«˜æ ¡å—é¨“æ¨™æº–",questions:te.filter(H=>H.difficulty==="intermediate"||H.difficulty==="beginner"),createdAt:Date.now(),isBuiltIn:!0,source:"high-school-intermediate (å˜èª1579 + ç†Ÿèª212)"},{getCustomQuestionSets:E}=await it(async()=>{const{getCustomQuestionSets:H}=await Promise.resolve().then(()=>Ys);return{getCustomQuestionSets:H}},void 0),Y=(await E()).map(H=>{const de=new Date(H.createdAt),Ee=`${de.getMonth()+1}/${de.getDate()}`,Ae=H.source==="reading"?"é•·æ–‡":H.source==="weak-words"?"è‹¦æ‰‹èªå¥":"æ‰‹å‹•";return{id:H.id,name:`ã‚«ã‚¹ã‚¿ãƒ å•é¡Œï¼ˆ${Ae}_${Ee}ï¼‰`,questions:H.questions,createdAt:H.createdAt,isBuiltIn:!1,source:H.source==="reading"?"é•·æ–‡èª­è§£":H.source==="weak-words"?"è‹¦æ‰‹èªå¥":"æ‰‹å‹•ä½œæˆ"}});ye([$,O,D,...Y]),K(!0)}}catch(_){f.error("è‹±å˜èªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",_),alert("è‹±å˜èªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ")}})()},[]);const Je=async()=>{try{const{getCustomQuestionSets:q}=await it(async()=>{const{getCustomQuestionSets:Q}=await Promise.resolve().then(()=>Ys);return{getCustomQuestionSets:Q}},void 0),_=await q(),W=V.find(Q=>Q.isBuiltIn),ge=_.map(Q=>({id:Q.id,name:Q.name,questions:Q.questions,createdAt:Q.createdAt,isBuiltIn:!1,source:Q.source==="reading"?"é•·æ–‡èª­è§£":Q.source==="weak-words"?"è‹¦æ‰‹èªå¥":"æ‰‹å‹•ä½œæˆ"}));W&&ye([W,...ge])}catch(q){f.error("ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆã®å†èª­ã¿è¾¼ã¿ã«å¤±æ•—:",q)}};u.useEffect(()=>{localStorage.setItem("quiz-adaptive-mode",JSON.stringify(Se))},[Se]),u.useEffect(()=>{localStorage.setItem("selectedDataSource",j)},[j]),u.useEffect(()=>{y.questions.length>0&&C()},[j,p,b,v,M]);const Be=()=>{let q=a;if(j!=="all"&&(q=q.filter(_=>_.source===j)),p!=="all"&&(q=q.filter(_=>_.category===p)),b!=="all"){const _={all:"",beginner:"åˆç´š",intermediate:"ä¸­ç´š",advanced:"ä¸Šç´š"};q=q.filter(W=>W.difficulty===_[b])}return v==="words-only"?q=q.filter(_=>!_.word.includes(" ")):v==="phrases-only"&&(q=q.filter(_=>_.word.includes(" ")),M!=="all"&&(q=q.filter(_=>jr(_.word)===M))),q=ks(q),q},et=(q,_)=>{const W=Ln(q,_);o(ge=>({...ge,sets:[...ge.sets,W]})),f.log(`âœ… ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã€Œ${q}ã€ã‚’ä½œæˆã—ã¾ã—ãŸ`)},je=q=>{o(_=>qn(_,q)),f.log("ğŸ—‘ï¸ ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ")},T=(q,_,W)=>{o(ge=>zn(ge,q,{name:_,description:W})),f.log(`âœï¸ ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã€Œ${_}ã€ã‚’æ›´æ–°ã—ã¾ã—ãŸ`)},w=(q,_)=>{o(W=>Wn(W,q,_)),f.log(`â• ã€Œ${_.word}ã€ã‚’ã‚»ãƒƒãƒˆã«è¿½åŠ ã—ã¾ã—ãŸ`)},g=(q,_)=>{o(W=>On(W,q,_)),f.log(`â– ã€Œ${_.word}ã€ã‚’ã‚»ãƒƒãƒˆã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸ`)},C=async()=>{var D;const q=Wa();f.log("ğŸ® ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³:",q);const _=xs();let W=Be();if(W.length===0){alert("æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã®å•é¡ŒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");return}if(R){const E=Wt();if(W=W.filter(re=>E.some(Y=>Y&&re.word&&Y.toLowerCase()===re.word.toLowerCase())),W.length===0){alert("è¦å¾©ç¿’å•é¡ŒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"),U(!1),Z([]);return}Z([...W]),f.log(`ğŸ¯ è£œä¿®ãƒ¢ãƒ¼ãƒ‰é–‹å§‹: ${W.length}å•ã‚’ç¹°ã‚Šè¿”ã—å‡ºé¡Œ`)}const ge=Hn(a,m),Q=Rr();Q?(Zn(ge),f.log(`ğŸ“Š æ”¹å–„é€²æ—: ${Q.currentDay}æ—¥ç›® - å…¨ä½“é€²æ—${Q.overallProgress.toFixed(1)}%`)):ge.weakCategories.length>0&&(Xn(ge),f.log("ğŸ¯ ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆæ”¹å–„ãƒ—ãƒ©ãƒ³ã‚’é–‹å§‹ã—ã¾ã—ãŸ")),ge.aiRecommendations.length>0&&(f.log("ğŸ§  AIå­¦ç¿’ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ ã‹ã‚‰ã®æ¨å¥¨:"),ge.aiRecommendations.forEach(E=>f.log(`  ${E}`))),ge.weakCategories.length>0&&p==="all"&&(W=Kn(W,ge.weakCategories,Math.min(30,W.length)),f.log(`ğŸ’¡ å¼±ç‚¹åˆ†é‡ã‚’å„ªå…ˆå‡ºé¡Œ: ${ge.weakCategories.slice(0,3).map(E=>E.category).join(", ")}`));const Ce=Wt(),A=Ds(10).map(E=>E.word);let ie=[];if(Ce.length>0){const E=W.filter(Y=>Ce.some(H=>H&&Y.word&&H.toLowerCase()===Y.word.toLowerCase()));ie=_.maxReviewCount>0?E.slice(0,_.maxReviewCount):[];const re=W.filter(Y=>!Ce.some(H=>H&&Y.word&&H.toLowerCase()===Y.word.toLowerCase()));W=[...ie,...re],ie.length>0&&f.log(`ğŸ”„ è¦å¾©ç¿’å•é¡Œ: ${ie.length}å•ï¼ˆä¸Šé™: ${_.maxReviewCount}å•ï¼‰`)}if(A.length>0){const E=W.filter(re=>A.some(Y=>Y&&re.word&&Y.toLowerCase()===re.word.toLowerCase()));if(E.length>0){const re=W.filter(Y=>!A.some(H=>H&&Y.word&&H.toLowerCase()===Y.word.toLowerCase()));W=[...E,...re],f.log(`ğŸ”— æ··åŒå±¥æ­´: ${E.length}å•ã‚’å„ªå…ˆå‡ºé¡Œ`)}}if(!R&&W.length>0){const E=await rt(),re=new Map;W.forEach(ve=>{const Me=E.wordProgress[ve.word];if(Me&&Me.learningHistory&&Me.learningHistory.length>0){const le=Me.learningHistory.map(X=>({timestamp:X.timestamp,wasCorrect:X.wasCorrect,responseTime:X.responseTime,userAnswer:X.userAnswer,confidenceLevel:X.responseTime<2e3?"instant":X.responseTime<5e3?"hesitant":"guessed",sessionContext:{questionIndex:X.sessionIndex||0,previousQuestions:[],sessionFatigue:0}})),me=ea(ve.word,Me,le);re.set(ve.word,me)}});const Y=na(W,E.wordProgress,re),H=ia(Y,W.length),de=Xs(ze.current,Te.current);We.current=de;const Ee=ca(H,de),Ae=new Map(Ee.map(ve=>[ve.word,ve]));if(W=W.filter(ve=>Ae.has(ve.word)).sort((ve,Me)=>{const le=Ae.get(ve.word).priority;return Ae.get(Me.word).priority-le}),f.log("ğŸ§  å­¦ç¿’æ›²ç·šAI: æœ€é©ãªå‡ºé¡Œé †åºã‚’æ±ºå®š"),f.log("  å‡ºé¡Œæˆ¦ç•¥:",Ee.slice(0,5).map(ve=>`${ve.word}(${ve.strategy}, æˆåŠŸç‡${ve.estimatedSuccessRate.toFixed(0)}%)`).join(", ")),de.fatigueLevel>40){const ve=ua(de);f.log(`âš¡ èªçŸ¥è² è·: ${de.fatigueLevel.toFixed(0)}% - ${ve}`)}const Oe=ba(W,E.wordProgress,Fe.current),Ve=new Map;if(Oe.sequence.forEach((ve,Me)=>{Ve.set(ve,Me)}),W=W.sort((ve,Me)=>{const le=Ve.get(ve.word)??999,me=Ve.get(Me.word)??999;return le-me}),f.log("ğŸ”— æ–‡è„ˆå­¦ç¿’AI: æ„å‘³çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°å®Œäº†"),f.log(`  ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ•°: ${Oe.clusters.length}`),Oe.transitions.length>0){const ve=Oe.transitions[0];f.log(`  ä¾‹: ${ve.from} â†’ ${ve.to} (${ve.reason})`)}}R?f.log(`ğŸ¯ è£œä¿®ãƒ¢ãƒ¼ãƒ‰: ${W.length}å•ã‚’ç¹°ã‚Šè¿”ã—å‡ºé¡Œä¸­`):f.log(`ğŸ“š å­¦ç¿’æ•°: ${W.length}å•`),P({questions:W,currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedAnswer:null}),fe({correct:0,incorrect:0,review:0,mastered:0,newQuestions:0,reviewQuestions:0,consecutiveNew:0,consecutiveReview:0}),Te.current=Date.now(),$e.current=Date.now(),He.current=[],ze.current=[],We.current=null;const te=await rt(),ne=ma(te.wordProgress,qe.current);oe.current=ne;const ce=W.map(E=>E.word),Ne=((D=We.current)==null?void 0:D.fatigueLevel)??0,$=ya(ce,te.wordProgress,ne,Ne);Ie.current=$,f.log("ğŸ”® ã‚¨ãƒ©ãƒ¼äºˆæ¸¬AI: èª¤ç­”ãƒªã‚¹ã‚¯åˆ†æå®Œäº†");const O=Array.from($.values()).filter(E=>E.warningLevel==="high"||E.warningLevel==="critical").sort((E,re)=>re.errorRisk-E.errorRisk);O.length>0&&(f.log(`  é«˜ãƒªã‚¹ã‚¯å•é¡Œ: ${O.length}å•`),f.log(`  æœ€é«˜ãƒªã‚¹ã‚¯: ${O[0].word} (${O[0].errorRisk.toFixed(0)}% - ${O[0].primaryPattern})`))},I=()=>{R?(U(!1),Z([]),xe(new Map)):(U(!0),xe(new Map)),C()},G=()=>{R?(U(!1),Z([]),xe(new Map)):(U(!0),xe(new Map)),C()},F=q=>{N(q),U(!1),Z([]),y.questions.length>0&&C()},B=q=>{x(q),U(!1),Z([]),y.questions.length>0&&C()},ae=async(q,_,W)=>{var te,ne,ce,Ne;if(y.answered)return;const ge=q==="åˆ†ã‹ã‚‰ãªã„",Q=q.trim(),Ce=_.trim(),De=!ge&&Q===Ce,A=y.questions[y.currentIndex];!De&&W&&W.word&&(await Cs(W.word,A.word),f.log(`ğŸ”— æ··åŒã‚’è¨˜éŒ²: ${W.word} â† ${A.word}`));const ie=Date.now()-$e.current;if(A){const O=(te=(await rt()).wordProgress)==null?void 0:te[A.word],E=1-(O?O.correctCount/(O.correctCount+O.incorrectCount):.5);ze.current.push({timestamp:Date.now(),wasCorrect:De,responseTime:ie,questionDifficulty:E});const re=Xs(ze.current,Te.current);We.current=re,(ne=re.breakRecommendation)!=null&&ne.shouldBreak&&f.log(`ğŸ’¤ ä¼‘æ†©æ¨å¥¨: ${re.breakRecommendation.reason}`),qe.current.push({word:A.word,wasCorrect:De,userAnswer:Q}),qe.current.length>50&&(qe.current=qe.current.slice(-50))}if(A){await pt(A.word,De,ie,void 0,"translation");const O=(ce=(await rt()).wordProgress)==null?void 0:ce[A.word];let D=De?"correct":"incorrect";O&&O.masteryLevel==="mastered"?D="mastered":!De&&O&&O.incorrectCount>=2&&(D="review"),fe(Y=>({...Y,correct:Y.correct+(D==="correct"?1:0),incorrect:Y.incorrect+(D==="incorrect"?1:0),review:Y.review+(D==="review"?1:0),mastered:Y.mastered+(D==="mastered"?1:0)})),bt({status:D,word:A.word,timestamp:Date.now()},"translation"),Fe.current.push(A.word),Fe.current.length>10&&(Fe.current=Fe.current.slice(-10)),_e.current++;const re=(Ne=(await rt()).wordProgress)==null?void 0:Ne[A.word];if(re&&re.skippedCount&&re.skippedCount>0&&(De?Ar(A.word):(Ir(A.word),f.log("ğŸ¤” AIå­¦ç¿’ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ: ã‚¹ã‚­ãƒƒãƒ—ã—ãŸå˜èªãŒä¸æ­£è§£ã§ã—ãŸã€‚åŒæ™‚æœŸã®å˜èªã‚’å†ç¢ºèªã—ã¾ã™ã€‚"))),Mt({id:It(),questionSetId:"main-set-single",questionSetName:"é«˜æ ¡å—é¨“è‹±å˜èª",score:De?1:0,total:1,percentage:De?100:0,date:Date.now(),timeSpent:Math.floor(ie/1e3),incorrectWords:De?[]:[A.word],mode:"translation",category:p!=="all"?p:void 0,difficulty:b!=="all"?b:void 0}),De||He.current.push(A.word),R){const Y=new Map(ke);if(De){const H=Y.get(A.word)||0;if(Y.set(A.word,H+1),H+1>=2){const de=J.filter(Ee=>Ee.word!==A.word);Z(de),f.log(`âœ… ${A.word} ã‚’è£œä¿®å¯¾è±¡ã‹ã‚‰é™¤å¤– (2å›é€£ç¶šæ­£è§£)`),de.length===0&&(alert("ğŸ‰ ã™ã¹ã¦ã®è¦å¾©ç¿’å•é¡Œã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼"),U(!1),xe(new Map))}}else Y.set(A.word,0);xe(Y)}}if(!De&&!R&&P($=>{$.totalAnswered%3;{const O=$.questions.slice($.currentIndex+1);if(O.length>1){const D=localStorage.getItem("learning-limit-translation"),E=localStorage.getItem("review-limit-translation"),re=D?parseInt(D):null,Y=E?parseInt(E):null,H=ns(O,{isReviewFocusMode:!1,learningLimit:re,reviewLimit:Y,mode:"translation"});return{...$,questions:[...$.questions.slice(0,$.currentIndex+1),...H]}}}return $}),!De&&!R&&A&&P($=>({...$,questions:we(A,$.questions,$.currentIndex)})),A){const $=String(A.word);jt.onShown($),jt.onAnswer($,De),Ze(A,se,fe)}P($=>({...$,answered:!0,selectedAnswer:q,score:De?$.score+1:$.score,totalAnswered:$.totalAnswered+1}))},be=()=>{P(q=>{var ge;const _=R?J:q.questions,W=q.currentIndex+1;if(!R&&W<_.length){const Q=Le(_,W-1);if(Q!==_)return{...q,questions:Q,currentIndex:W,answered:!1,selectedAnswer:null}}if(!R&&W>=_.length){const Q=Date.now(),Ce=ze.current.reduce((Ne,$)=>Ne+$.responseTime,0),De=ze.current.length>0?Ce/ze.current.length:0,A=((ge=We.current)==null?void 0:ge.fatigueLevel)??0,ie=ja(Te.current,Q,q.totalAnswered,q.score,De,A,se.correct+se.mastered,se.review);Da(ie);const te=Ma();if(te.length>=3){const Ne=Ca("user",te),$=Er(),O=Ia(Ne,$);f.log("ğŸ“Š å­¦ç¿’ã‚¹ã‚¿ã‚¤ãƒ«AI:",O)}const ne=(Q-Te.current)/(1e3*60),ce=La(q.score,q.totalAnswered,De,ne,se.correct+se.mastered,A);f.log("ğŸ® ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµæœ:"),f.log(`  ç²å¾—XP: ${ce.xpGained}`),ce.leveledUp&&f.log(`  ğŸ‰ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—! Lv.${ce.newLevel}`),ce.feedback.forEach(Ne=>{f.log(`  ${Ne.icon} ${Ne.message}`)})}return R&&W>=_.length?(f.log("ğŸ”„ è£œä¿®ãƒ¢ãƒ¼ãƒ‰: å•é¡Œã‚’ç¹°ã‚Šè¿”ã—ã¾ã™"),{...q,questions:_,currentIndex:0,answered:!1,selectedAnswer:null}):{...q,questions:_,currentIndex:W%_.length,answered:!1,selectedAnswer:null}}),$e.current=Date.now()},Pe=()=>{P(q=>({...q,currentIndex:q.currentIndex>0?q.currentIndex-1:0,answered:!1,selectedAnswer:null}))},L=async()=>{const q=y.questions[y.currentIndex];if(q){const _=Date.now()-$e.current;await ts(q.word,30),Mr(q.word),await pt(q.word,!0,_,void 0,"translation"),P(W=>({...W,score:W.score+1,totalAnswered:W.totalAnswered+1,currentIndex:(W.currentIndex+1)%W.questions.length,answered:!1,selectedAnswer:null})),fe(W=>({...W,correct:W.correct+1,mastered:W.mastered+1})),bt({status:"correct",word:q.word,timestamp:Date.now()},"translation")}else P(_=>({..._,currentIndex:(_.currentIndex+1)%_.questions.length,answered:!1,selectedAnswer:null}));$e.current=Date.now()},ee=q=>{const _=y.questions[y.currentIndex];if(_){const W=Date.now()-$e.current;pt(_.word,y.selectedAnswer===_.meaning,W,q,"translation")}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(Ao,{isVisible:s,message:"èª­ã¿è¾¼ã¿ä¸­..."}),e.jsxs("div",{className:"flex gap-0 bg-gray-100 shadow-md py-1 sm:py-2",children:[e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="memorization"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("memorization"),children:"ğŸ’¡ æš—è¨˜"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="translation"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("translation"),children:"ğŸ“ å’Œè¨³"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="spelling"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("spelling"),children:"âœï¸ ã‚¹ãƒšãƒ«"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="grammar"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>{t("grammar"),n(!0),setTimeout(()=>n(!1),1500),cr()},children:"ğŸ“š æ–‡æ³•"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="reading"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>{t("reading"),n(!0),setTimeout(()=>n(!1),1500),cr()},children:"ğŸ“– é•·æ–‡"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="grammar-guide"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("grammar-guide"),children:"ğŸ”– å‚è€ƒ"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="dictionary"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("dictionary"),children:"ğŸ“• è¾æ›¸"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="stats"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("stats"),children:"ğŸ“Š æˆç¸¾"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="settings"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("settings"),children:"âš™ï¸ è¨­å®š"})]}),e.jsx(ko,{isOpen:c,onClose:()=>d(!1),sets:l.sets,onCreateSet:et,onDeleteSet:je,onEditSet:T,onRemoveWord:g}),e.jsx("div",{className:"p-2 md:p-6 bg-gray-50",children:e.jsx("div",{className:"max-w-app mx-auto",children:r==="memorization"?e.jsx(vo,{allQuestions:a,questionSets:V,customQuestionSets:l.sets,onAddWordToCustomSet:w,onRemoveWordFromCustomSet:g,onOpenCustomSetManagement:()=>d(!0)}):r==="translation"?e.jsx(Bi,{quizState:y,_categoryList:m,selectedCategory:p,onCategoryChange:F,selectedDifficulty:b,onDifficultyChange:B,selectedWordPhraseFilter:v,onWordPhraseFilterChange:k,selectedPhraseTypeFilter:M,onPhraseTypeFilterChange:S,selectedDataSource:j,onDataSourceChange:z,questionSets:V,onStartQuiz:C,onAnswer:ae,onNext:be,onPrevious:Pe,onSkip:L,onDifficultyRate:ee,onReviewFocus:I,sessionStats:se,isReviewFocusMode:R,errorPrediction:y.questions.length>0&&y.currentIndex<y.questions.length?Ie.current.get(y.questions[y.currentIndex].word):void 0,customQuestionSets:l.sets,onAddWordToCustomSet:w,onRemoveWordFromCustomSet:g,onOpenCustomSetManagement:()=>d(!0)}):r==="spelling"?e.jsx(Vi,{questions:y.questions,_categoryList:m,selectedCategory:p,onCategoryChange:F,selectedDifficulty:b,onDifficultyChange:B,selectedWordPhraseFilter:v,onWordPhraseFilterChange:k,selectedPhraseTypeFilter:M,onPhraseTypeFilterChange:S,selectedDataSource:j,onDataSourceChange:z,onStartQuiz:C,onReviewFocus:G,isReviewFocusMode:R,customQuestionSets:l.sets,onAddWordToCustomSet:w,onRemoveWordFromCustomSet:g,onOpenCustomSetManagement:()=>d(!0)}):r==="reading"?e.jsx(Hr,{customQuestionSets:l.sets,onAddWordToCustomSet:w,onRemoveWordFromCustomSet:g,onOpenCustomSetManagement:()=>d(!0),onSaveUnknownWords:async q=>{if(q.length===0)return;const _=new Date,ge=`é•·æ–‡å˜èªé›† (${`${_.getMonth()+1}/${_.getDate()}`})`,Q=prompt(`${q.length}å€‹ã®å˜èªãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™ã€‚
å•é¡Œé›†ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:`,ge);if(!Q)return;const Ce={id:It(),name:Q,questions:q.map(A=>({word:A.word,reading:A.reading||"",meaning:A.meaning,etymology:A.etymology||"",relatedWords:A.relatedWords||"",relatedFields:A.relatedFields||"",difficulty:A.difficulty||"intermediate"})),createdAt:Date.now(),isBuiltIn:!1,source:"é•·æ–‡èª­è§£"},De=[...V,Ce];ye(De),wr(De),alert(`âœ… å•é¡Œé›†ã€Œ${Q}ã€ã‚’ä½œæˆã—ã¾ã—ãŸï¼ˆ${q.length}èªï¼‰`)}}):r==="grammar"?e.jsx(Vr,{}):r==="grammar-guide"?e.jsx(wo,{}):r==="dictionary"?e.jsx(So,{}):r==="stats"?e.jsx(Co,{questionSets:V,allQuestions:a,categoryList:m,onResetComplete:()=>t("stats"),onQuestionSetsUpdated:Je}):e.jsx(Io,{allQuestions:a,_selectedDataSource:j,_onDataSourceChange:z,customQuestionSets:l.sets,onOpenCustomSetManagement:()=>d(!0),onStartSession:(q,_)=>{P({questions:_,currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedAnswer:null}),Te.current=Date.now(),$e.current=Date.now(),He.current=[],t("translation")}})})})]})}const To=()=>{const r=localStorage.getItem("darkMode");let t="system";r==="system"||r==="light"||r==="dark"?t=r:r==="true"?(t="dark",localStorage.setItem("darkMode","dark")):r==="false"&&(t="light",localStorage.setItem("darkMode","light"));let s=!1;t==="system"?s=window.matchMedia("(prefers-color-scheme: dark)").matches:s=t==="dark",document.documentElement.classList.toggle("dark",s)};To();hs.createRoot(document.getElementById("root")).render(e.jsx(tn.StrictMode,{children:e.jsx(Po,{})}));export{vi as a,f as b,Ms as c,ss as d,Qt as e,qt as f,Ot as g,gr as h,qr as i,xr as j,Wo as k,Re as l};
//# sourceMappingURL=index-C4XTM80x.js.map
