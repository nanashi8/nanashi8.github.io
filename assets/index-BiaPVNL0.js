const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/scoreBoardTests-DZKaB3b9.js","assets/chart-vendor-Dg0f91xX.js","assets/react-vendor-wGySg1uH.js"])))=>i.map(i=>d[i]);
var Ur=Object.defineProperty;var Hr=(r,t,s)=>t in r?Ur(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var Xe=(r,t,s)=>Hr(r,typeof t!="symbol"?t+"":t,s);import{j as e}from"./chart-vendor-Dg0f91xX.js";import{a as Vr,r as u,R as Jr}from"./react-vendor-wGySg1uH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();var ls={},qs=Vr;ls.createRoot=qs.createRoot,ls.hydrateRoot=qs.hydrateRoot;const Yr="modulepreload",Xr=function(r){return"/"+r},zs={},rt=function(t,s,n){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),i=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(s.map(c=>{if(c=Xr(c),c in zs)return;zs[c]=!0;const d=c.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Yr,d||(h.as="script"),h.crossOrigin="",h.href=c,i&&h.setAttribute("nonce",i),document.head.appendChild(h),d)return new Promise((g,S)=>{h.addEventListener("load",g),h.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(l){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=l,window.dispatchEvent(i),!i.defaultPrevented)throw l}return a.then(l=>{for(const i of l||[])i.status==="rejected"&&o(i.reason);return t().catch(o)})},nr=["è¨€èªåŸºæœ¬","å­¦æ ¡ãƒ»å­¦ç¿’","æ—¥å¸¸ç”Ÿæ´»","äººãƒ»ç¤¾ä¼š","è‡ªç„¶ãƒ»ç’°å¢ƒ","é£Ÿãƒ»å¥åº·","é‹å‹•ãƒ»å¨¯æ¥½","å ´æ‰€ãƒ»ç§»å‹•","æ™‚é–“ãƒ»æ•°é‡","ç§‘å­¦ãƒ»æŠ€è¡“"];function Kr(r){return nr.includes(r)}const Mt=typeof window<"u"&&new URLSearchParams(window.location.search).get("debug")==="true",p={log:(...r)=>{Mt&&console.log(...r)},warn:(...r)=>{Mt&&console.warn(...r)},error:(...r)=>{console.error(...r)},debug:(...r)=>{Mt&&console.debug(...r)},info:(...r)=>{Mt&&console.info(...r)}},ar="QuizAppDB",Zr=1,Qe={PROGRESS:"progress",SESSION_HISTORY:"sessionHistory",DAILY_STATS:"dailyStats",SETTINGS:"settings"};function Bt(){try{return"indexedDB"in window&&indexedDB!==null}catch{return!1}}let dt=null;function cs(){return new Promise((r,t)=>{if(dt){r(dt);return}if(!Bt()){t(new Error("IndexedDB is not supported"));return}const s=indexedDB.open(ar,Zr);s.onerror=()=>{p.error("IndexedDB open error:",s.error),t(s.error)},s.onsuccess=()=>{dt=s.result,p.log("âœ… IndexedDB initialized successfully"),r(dt)},s.onupgradeneeded=n=>{const a=n.target.result;if(a.objectStoreNames.contains(Qe.PROGRESS)||a.createObjectStore(Qe.PROGRESS),!a.objectStoreNames.contains(Qe.SESSION_HISTORY)){const o=a.createObjectStore(Qe.SESSION_HISTORY,{keyPath:"id",autoIncrement:!0});o.createIndex("mode","mode",{unique:!1}),o.createIndex("timestamp","timestamp",{unique:!1}),o.createIndex("modeTimestamp",["mode","timestamp"],{unique:!1})}a.objectStoreNames.contains(Qe.DAILY_STATS)||a.createObjectStore(Qe.DAILY_STATS,{keyPath:"date"}).createIndex("date","date",{unique:!0}),a.objectStoreNames.contains(Qe.SETTINGS)||a.createObjectStore(Qe.SETTINGS),p.log("ğŸ“¦ IndexedDB stores created")}})}async function ds(r,t){try{const s=await cs();return new Promise((n,a)=>{const i=s.transaction(r,"readonly").objectStore(r).get(t);i.onsuccess=()=>n(i.result||null),i.onerror=()=>a(i.error)})}catch(s){return p.error("getFromDB error:",s),null}}async function st(r,t,s){try{const n=await cs();return new Promise((a,o)=>{const i=n.transaction(r,"readwrite").objectStore(r),c=s!==void 0?i.put(t,s):i.put(t);c.onsuccess=()=>a(!0),c.onerror=()=>o(c.error)})}catch(n){return p.error("putToDB error:",n),!1}}async function en(){return new Promise(r=>{dt&&(dt.close(),dt=null);const t=indexedDB.deleteDatabase(ar);t.onsuccess=()=>{p.log("ğŸ—‘ï¸ Database deleted"),r(!0)},t.onerror=()=>{p.error("Database delete error"),r(!1)}})}const ir="indexeddb-migration-completed",or="1.1";function us(){try{return localStorage.getItem(ir)===or}catch{return!1}}function as(){try{localStorage.setItem(ir,or),p.log("âœ… Migration flag set")}catch(r){p.error("Failed to set migration flag:",r)}}function Ut(r){try{const t=localStorage.getItem(r);return!t||r.includes("lastLogin")||r.includes("Date")||r.includes("daily-plan")||r.includes("score-board")?null:JSON.parse(t)}catch{return p.warn(`${r} is not valid JSON (skipping)`),null}}function tn(r){try{return localStorage.getItem(r)}catch(t){return p.error(`Failed to get ${r} from localStorage:`,t),null}}async function sn(){try{const r=Ut("progress-data");if(r)return r.wordProgress||(r.wordProgress={}),r.results||(r.results=[]),r.statistics||(r.statistics={totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]}),r.questionSetStats||(r.questionSetStats={}),await st(Qe.PROGRESS,r,"main"),p.log("ğŸ“¦ Progress data migrated:",Object.keys(r.wordProgress||{}).length,"words"),!0;p.log("â„¹ï¸ No progress data to migrate, creating initial data");const t={wordProgress:{},results:[],statistics:{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:{}};return await st(Qe.PROGRESS,t,"main"),!0}catch(r){return p.error("Progress data migration error:",r),!1}}async function rn(){try{const r=["translation","spelling"];let t=0;for(const s of r){const n=`session-history-${s}`,a=Ut(n);if(a&&Array.isArray(a))for(const o of a)await st(Qe.SESSION_HISTORY,{mode:s,status:o.status,word:o.word,timestamp:o.timestamp}),t++}return t>0&&p.log("ğŸ“œ Session history migrated:",t,"items"),!0}catch(r){return p.error("Session history migration error:",r),!1}}async function nn(){try{const r=new Date,t=new Date(r.getTime()-90*24*60*60*1e3);let s=0,n=0;for(let a=0;a<localStorage.length;a++){const o=localStorage.key(a);if(o&&o.startsWith("studyStats-")){const l=o.replace("studyStats-","");if(new Date(l)>=t){const c=Ut(o);c&&(await st(Qe.DAILY_STATS,{date:l,...c}),s++)}else localStorage.removeItem(o),n++}}return(s>0||n>0)&&p.log(`ğŸ“Š Daily stats: migrated ${s}, cleaned ${n}`),!0}catch(r){return p.error("Daily stats migration error:",r),!1}}async function an(){try{const r=["user-goal-level","loginStreak","radar-improvement-progress","skip-exclude-groups"],t=["lastLoginDate","lastLoginData"];let s=0;for(const a of r)try{if(a.includes("lastLogin")){p.warn(`Skipping ${a} from JSON migration`);continue}const o=Ut(a);o!==null&&(await st(Qe.SETTINGS,o,a),s++)}catch(o){p.warn(`Failed to migrate ${a}:`,o)}for(const a of t)try{const o=tn(a);o!==null&&(await st(Qe.SETTINGS,o,a),s++)}catch(o){p.warn(`Failed to migrate ${a}:`,o)}const n=["translation","spelling","reading"];for(const a of n){const o=`daily-plan-target-${a}`,l=`score-board-goal-${a}`;try{const i=localStorage.getItem(o);i&&(await st(Qe.SETTINGS,i,o),s++)}catch(i){p.warn(`Failed to migrate ${o}:`,i)}try{const i=localStorage.getItem(l);i&&(await st(Qe.SETTINGS,i,l),s++)}catch(i){p.warn(`Failed to migrate ${l}:`,i)}}return s>0&&p.log("âš™ï¸ Settings migrated:",s,"items"),!0}catch(r){return p.error("Settings migration error:",r),!1}}async function on(){try{const r=await ds(Qe.PROGRESS,"main");return r?!r.wordProgress||typeof r.wordProgress!="object"?(p.warn("âš ï¸ Progress data verification failed - invalid wordProgress"),!1):(p.log("âœ… Migration verification passed"),!0):(p.warn("âš ï¸ Progress data verification failed - no data found"),!1)}catch(r){return p.error("Migration verification error:",r),!1}}async function ln(){if(us())return p.log("â„¹ï¸ Migration already completed"),!0;if(!Bt())return p.warn("âš ï¸ IndexedDB not supported, using localStorage"),!1;p.log("ğŸš€ Starting data migration to IndexedDB...");try{await cs();const r=await Promise.all([sn(),rn(),nn(),an()]),t=["Progress","SessionHistory","DailyStats","Settings"];return r.forEach((n,a)=>{n||p.warn(`âš ï¸ ${t[a]} migration incomplete (may be empty)`)}),r[0]||r.some(n=>n)?await on()?(as(),p.log("ğŸ‰ Migration completed successfully!"),!0):(p.warn("âš ï¸ Migration verification failed, but marking as complete"),as(),!0):(p.warn("âš ï¸ All migrations returned false, marking as complete anyway"),as(),!0)}catch(r){return p.error("âŒ Migration failed:",r),!1}}let xt=!1;function cn(){xt=Bt()&&us(),p.log(`ğŸ“¦ Storage strategy: ${xt?"IndexedDB":"localStorage"}`)}async function dn(r){try{return xt?await st(Qe.PROGRESS,r,"main"):(localStorage.setItem("progress-data",JSON.stringify(r)),!0)}catch(t){p.error("saveProgressData error:",t);try{return localStorage.setItem("progress-data",JSON.stringify(r)),!0}catch(s){return p.error("localStorage fallback failed:",s),!1}}}async function un(){try{if(xt){const r=await ds(Qe.PROGRESS,"main");if(r)return r;const t=localStorage.getItem("progress-data");return t?JSON.parse(t):null}else{const r=localStorage.getItem("progress-data");return r?JSON.parse(r):null}}catch(r){return p.error("loadProgressData error:",r),null}}async function Ht(r,t){try{return xt?await st(Qe.SETTINGS,t,r):(localStorage.setItem(r,typeof t=="string"?t:JSON.stringify(t)),!0)}catch(s){p.error(`saveSetting(${r}) error:`,s);try{return localStorage.setItem(r,typeof t=="string"?t:JSON.stringify(t)),!0}catch{return!1}}}async function Vt(r){try{if(xt){const t=await ds(Qe.SETTINGS,r);return t!==null?t:localStorage.getItem(r)||null}else return localStorage.getItem(r)||null}catch(t){return p.error(`loadSetting(${r}) error:`,t),null}}const Fs={maxReviewCount:10};function ms(){try{const r=localStorage.getItem("study-settings");if(r)return{maxReviewCount:JSON.parse(r).maxReviewCount??Fs.maxReviewCount}}catch(r){p.error("å­¦ç¿’è¨­å®šã®å–å¾—ã‚¨ãƒ©ãƒ¼:",r)}return{...Fs}}const mn="session-history",hn=50;async function yt(r,t){const s=Bt()&&us();try{if(s)await st(Qe.SESSION_HISTORY,{mode:t,status:r.status,word:r.word,timestamp:r.timestamp});else{const n=`${mn}-${t}`,a=localStorage.getItem(n),o=a?JSON.parse(a):[];o.push(r),o.length>hn&&o.shift(),localStorage.setItem(n,JSON.stringify(o))}}catch(n){p.error("ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",n)}}function $t(){const r=Me(),t=new Date().toLocaleDateString("ja-JP"),s=new Set;return r.results.forEach(n=>{new Date(n.date).toLocaleDateString("ja-JP")===t&&n.incorrectWords.forEach(a=>s.add(a))}),Array.from(s)}function Et(r){const t=Me(),s=new Date().setHours(0,0,0,0),n=s+24*60*60*1e3;let a=t.results.filter(c=>c.date>=s&&c.date<n);r&&(a=a.filter(c=>c.mode===r));const o=a.reduce((c,d)=>c+d.score,0),l=a.reduce((c,d)=>c+d.total,0),i=l>0?Math.round(o/l*100):0;return{todayCorrectCount:o,todayTotalAnswered:l,todayAccuracy:i}}function hs(){const r=Me(),t=new Date,s=t.getDay(),n=s===0?-6:1-s,a=new Date(t);a.setDate(t.getDate()+n),a.setHours(0,0,0,0);const o=new Date(a);o.setDate(a.getDate()+7);const l=new Date(a);l.setDate(a.getDate()-7);const i=new Date(a),c=r.results.filter(D=>D.date>=a.getTime()&&D.date<o.getTime()),d=r.results.filter(D=>D.date>=l.getTime()&&D.date<i.getTime()),m=new Set;c.forEach(D=>{const C=new Date(D.date).toISOString().split("T")[0];m.add(C)});const h=c.reduce((D,C)=>D+C.total,0),g=c.reduce((D,C)=>D+C.score,0),S=h>0?g/h*100:0,b=d.reduce((D,C)=>D+C.total,0),y=d.reduce((D,C)=>D+C.score,0),v=b>0?y/b*100:0;let k=0;return Object.values(r.wordProgress).forEach(D=>{D.masteryLevel==="mastered"&&D.lastStudied>=a.getTime()&&k++}),{studyDays:m.size,totalDays:7,totalAnswered:h,accuracy:S,newMastered:k,previousWeekAccuracy:v}}function gs(){const r=Me(),t=new Date,s=new Date(t.getFullYear(),t.getMonth(),1);s.setHours(0,0,0,0);const n=new Date(t.getFullYear(),t.getMonth()+1,0);n.setHours(23,59,59,999);const a=r.results.filter(h=>h.date>=s.getTime()&&h.date<=n.getTime()),o=new Set;a.forEach(h=>{const g=new Date(h.date).toISOString().split("T")[0];o.add(g)});const l=a.reduce((h,g)=>h+g.total,0),i=a.reduce((h,g)=>h+g.score,0),c=l>0?i/l*100:0;let d=0;Object.values(r.wordProgress).forEach(h=>{h.masteryLevel==="mastered"&&h.lastStudied>=s.getTime()&&d++});const m=n.getDate();return{studyDays:o.size,totalDays:m,totalAnswered:l,accuracy:c,newMastered:d}}function _t(){const r=Me(),t=Object.values(r.wordProgress),s=t.filter(c=>c.correctCount+c.incorrectCount>0);let n=0,a=0,o=0;s.forEach(c=>{const d=c.correctCount+c.incorrectCount,m=d>0?c.correctCount/d*100:0;d===1&&c.correctCount===1||c.consecutiveCorrect>=3||c.consecutiveCorrect>=2&&m>=80?n++:m>=50?a++:o++});const l=s.length,i=n*1+a*.5;return{totalWords:t.length,appearedWords:l,masteredCount:n,learningCount:a,strugglingCount:o,basicRetentionRate:l>0?Math.round(n/l*100):0,weightedRetentionRate:l>0?Math.round(i/l*100):0,masteredPercentage:l>0?Math.round(n/l*100):0,learningPercentage:l>0?Math.round(a/l*100):0,strugglingPercentage:l>0?Math.round(o/l*100):0,masteredWords:n,learningWords:a,newWords:t.length-l,retentionRate:l>0?Math.round(n/l*100):0,averageAttempts:0,categoryBreakdown:{},difficultyBreakdown:{}}}function lr(){const r=Me();let t=0,s=0,n=0,a=0,o=0;return Object.values(r.wordProgress).forEach(l=>{const i=l.correctCount+l.incorrectCount;if(i===0)return;if(Yt(l,!0).isMastered){l.consecutiveCorrect>=7?o++:l.consecutiveCorrect>=5&&a++;return}s++;const{consecutiveCorrect:d}=l,m=l.correctCount/i;d===2||m>=.9&&d===1&&i>=2||i>=4&&m>=.75?(t++,n+=1):n+=Math.max(1,3-d)}),{nearMasteryCount:t,learningCount:s,averageRemainingAnswers:s>0?Math.round(n/s*10)/10:0,longTermMemoryCount:a,superMemoryCount:o}}function ps(r=7,t=10){const s=Me(),n=Date.now()-r*24*60*60*1e3;return Object.entries(s.wordProgress).filter(([o,l])=>l.masteryLevel==="mastered"&&l.lastStudied>=n).map(([o,l])=>({word:o,masteredDate:l.lastStudied,totalAttempts:l.correctCount+l.incorrectCount})).sort((o,l)=>l.masteredDate-o.masteredDate).slice(0,t)}function Lt(){const r=Me(),s=Object.values(r.wordProgress).filter(d=>d.grammarAttempts&&d.grammarAttempts>0||d.word.startsWith("grammar_")||d.word.includes("_g")),n=s.filter(d=>d.grammarAttempts&&d.grammarAttempts>0||d.correctCount+d.incorrectCount>0);let a=0,o=0,l=0;n.forEach(d=>{const m=d.grammarAttempts||d.correctCount+d.incorrectCount,h=d.grammarCorrect||d.correctCount,g=d.grammarStreak||d.consecutiveCorrect,S=m>0?h/m*100:0;m===1&&h===1||g>=3||g>=2&&S>=80?a++:S>=50?o++:l++});const i=n.length,c=a*1+o*.5;return{totalWords:s.length,appearedWords:i,masteredCount:a,learningCount:o,strugglingCount:l,basicRetentionRate:i>0?Math.round(a/i*100):0,weightedRetentionRate:i>0?Math.round(c/i*100):0,masteredPercentage:i>0?Math.round(a/i*100):0,learningPercentage:i>0?Math.round(o/i*100):0,strugglingPercentage:i>0?Math.round(l/i*100):0,masteredWords:a,learningWords:o,newWords:s.length-i,retentionRate:i>0?Math.round(a/i*100):0,averageAttempts:0,categoryBreakdown:{},difficultyBreakdown:{}}}function Nt(){const r=Me(),t=Object.values(r.wordProgress),s=t.filter(c=>c.memorizationAttempts&&c.memorizationAttempts>0);let n=0,a=0,o=0;s.forEach(c=>{const d=c.memorizationAttempts||0,m=c.memorizationCorrect||0,h=c.memorizationStillLearning||0,g=c.memorizationStreak||0,S=m+h*.5,b=d>0?S/d*100:0;d===1&&m===1||g>=3||g>=2&&b>=80?n++:b>=50||h>0?a++:o++});const l=s.length,i=n*1+a*.5;return{totalWords:t.length,appearedWords:l,masteredCount:n,learningCount:a,strugglingCount:o,basicRetentionRate:l>0?Math.round(n/l*100):0,weightedRetentionRate:l>0?Math.round(i/l*100):0,masteredPercentage:l>0?Math.round(n/l*100):0,learningPercentage:l>0?Math.round(a/l*100):0,strugglingPercentage:l>0?Math.round(o/l*100):0,masteredWords:n,learningWords:a,newWords:t.length-l,retentionRate:l>0?Math.round(n/l*100):0,averageAttempts:0,categoryBreakdown:{},difficultyBreakdown:{}}}function fs(){const r=Me(),t=Object.entries(r.wordProgress).filter(([a,o])=>a.startsWith("grammar_")),s=new Map;t.forEach(([a,o])=>{const l=a.match(/grammar_(?:\w+-)?g(\d+)-u(\d+)/);if(!l){a.startsWith("grammar_")&&!a.includes("unknown")&&console.warn(`âš ï¸ æ–‡æ³•å•é¡ŒIDãŒãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãƒãƒƒãƒã—ã¾ã›ã‚“: ${a}`);return}const i=l[1],c=l[2],d=`ä¸­${i}_Unit${c}`;s.has(d)||s.set(d,{questions:[],answered:[],correct:0,incorrect:0,mastered:0,allHistory:[]});const m=s.get(d);m.questions.push([a,o]);const h=o.grammarAttempts||o.correctCount+o.incorrectCount;if(h>0){m.answered.push([a,o]);const g=o.grammarCorrect||o.correctCount||0,S=h-g;if(m.correct+=g,m.incorrect+=S,o.learningHistory&&o.learningHistory.length>0){const C=o.learningHistory.slice(-10);m.allHistory.push(...C)}const b=o.grammarStreak||o.consecutiveCorrect||0,y=h>0?g/h*100:0,v=o.masteryLevel==="mastered",k=h===1&&g===1,D=h>=3&&y>=85;(v||k||D||b>=3)&&m.mastered++}});const n=Array.from(s.entries()).map(([a,o])=>{const l=o.correct+o.incorrect,i=l>0?o.correct/l*100:0,c=o.questions.length>0?o.answered.length/o.questions.length*100:0,m=o.allHistory.sort((h,g)=>h.timestamp-g.timestamp).slice(-10).map(h=>h.wasCorrect?"ğŸŸ©":"ğŸŸ¥").join("");return{unit:a,totalQuestions:o.questions.length,answeredQuestions:o.answered.length,correctCount:o.correct,incorrectCount:o.incorrect,masteredCount:o.mastered,accuracy:Math.round(i),progress:Math.round(c),historyIcons:m}});return n.sort((a,o)=>a.unit.localeCompare(o.unit)),n}const cr="progress-data",Qs=300,Gs=3;function ut(){return{results:[],statistics:{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:{},categoryStats:{},difficultyStats:{},wordProgress:{}}}async function et(){try{const r=await un();if(!r){const n=ut();return nt(n),n}const t=r,s={results:t.results||[],statistics:t.statistics||{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:t.questionSetStats||{},categoryStats:{},difficultyStats:{},wordProgress:t.wordProgress||{}};return s.statistics||(s.statistics={totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]}),s.questionSetStats||(s.questionSetStats={}),s.wordProgress||(s.wordProgress={}),s.results||(s.results=[]),xs(s),nt(s),s}catch(r){p.error("é€²æ—ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=ut();return nt(t),t}}let tt=null;function gn(){return tt||(tt=ut(),p.log("ğŸ“¦ Progress cache initialized with default data")),tt}function Me(){if(tt)return tt.statistics||(p.warn("âš ï¸ Cache missing statistics, reinitializing"),tt=ut()),tt;gn();try{const r=localStorage.getItem(cr);if(!r){const s=ut();return tt=s,s}const t=JSON.parse(r);return t.statistics||(t.statistics={totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]}),t.questionSetStats||(t.questionSetStats={}),t.wordProgress||(t.wordProgress={}),t.results||(t.results=[]),t.results||(t.results=[]),xs(t),tt=t,t}catch(r){p.error("é€²æ—ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=ut();return tt=t,t}}function nt(r){tt=r,p.log("ğŸ”„ progressCacheæ›´æ–° - resultsä»¶æ•°:",r.results.length)}async function at(r){try{xs(r),nt(r);try{localStorage.setItem(cr,JSON.stringify(r))}catch(n){p.warn("LocalStorageä¿å­˜å¤±æ•—ï¼ˆå®¹é‡ä¸è¶³ã®å¯èƒ½æ€§ï¼‰:",n)}const t={quizzes:{},lastUpdated:Date.now(),totalAnswered:{},totalMastered:{},results:r.results,statistics:r.statistics,questionSetStats:r.questionSetStats,wordProgress:r.wordProgress};await dn(t)||p.error("ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}catch(t){p.error("é€²æ—ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—:",t)}}function xs(r){r.results.length>Qs&&(r.results.sort((t,s)=>s.date-t.date),r.results=r.results.slice(0,Qs)),Object.values(r.wordProgress).forEach(t=>{t.responseTimes&&t.responseTimes.length>Gs&&(t.responseTimes=t.responseTimes.slice(-Gs))})}async function St(r){const t=await et();t.results.push(r),p.log("âœ… addQuizResultå‘¼ã³å‡ºã—:",{mode:r.mode,score:r.score,total:r.total,date:new Date(r.date).toISOString(),resultsCount:t.results.length}),pn(t,r),await at(t),p.log("ğŸ’¾ saveProgresså®Œäº† - resultsä»¶æ•°:",t.results.length);try{if(typeof window<"u"){const s=new CustomEvent(ft,{detail:{result:r}});window.dispatchEvent(s)}}catch{}}function pn(r,t){const s=r.statistics;s.totalQuizzes++,s.totalQuestions+=t.total,s.totalCorrect+=t.score,s.averageScore=s.totalQuestions>0?s.totalCorrect/s.totalQuestions*100:0,s.bestScore=Math.max(s.bestScore,t.percentage),s.lastStudyDate=t.date;const n=new Date(t.date).setHours(0,0,0,0);s.studyDates.includes(n)||(s.studyDates.push(n),s.studyDates.sort((i,c)=>c-i)),s.streakDays=fn(s.studyDates),r.questionSetStats[t.questionSetId]||(r.questionSetStats[t.questionSetId]={attempts:0,bestScore:0,averageScore:0,lastAttempt:0,totalTimeSpent:0});const a=r.questionSetStats[t.questionSetId];a.attempts++,a.bestScore=Math.max(a.bestScore,t.percentage),a.lastAttempt=t.date,a.totalTimeSpent+=t.timeSpent;const o=r.results.filter(i=>i.questionSetId===t.questionSetId),l=o.reduce((i,c)=>i+c.percentage,0);a.averageScore=l/o.length}function fn(r){if(r.length===0)return 0;const t=new Date().setHours(0,0,0,0),s=t-24*60*60*1e3,n=r[0];if(n!==t&&n!==s)return 0;let a=1;for(let o=1;o<r.length&&(r[o-1]-r[o])/(24*60*60*1e3)===1;o++)a++;return a}function ys(r=10){const t=Me(),s=new Map;t.results.forEach(a=>{a.incorrectWords.forEach(o=>{s.set(o,(s.get(o)||0)+1)})});const n=[];return s.forEach((a,o)=>{if(a<5)return;const l=t.wordProgress[o];if(!l)return;const i=l.correctCount+l.incorrectCount;if(i===0)return;const c=l.correctCount/i*100,d=c>=80,h=i===1&&l.correctCount===1||l.consecutiveCorrect>=3||c>=85;if(d&&h){const g=a*c;n.push({word:o,totalMistakes:a,recentAccuracy:Math.round(c),overcomeScore:g})}}),n.sort((a,o)=>o.overcomeScore-a.overcomeScore).slice(0,r)}function Jt(r=10){const t=Me(),s=new Map;t.results.forEach(a=>{a.incorrectWords.forEach(o=>{s.set(o,(s.get(o)||0)+1)})});const n=[];return s.forEach((a,o)=>{const l=t.wordProgress[o];if(!l){n.push({word:o,mistakes:a,recentAccuracy:0,meaning:void 0,reading:void 0});return}const i=l.correctCount+l.incorrectCount,c=i>0?l.correctCount/i*100:0,d=i===1&&l.correctCount===1;a>=5&&c>=80&&(d||l.consecutiveCorrect>=3||c>=85)||n.push({word:o,mistakes:a,recentAccuracy:Math.round(c),meaning:l.meaning,reading:l.reading})}),n.sort((a,o)=>o.mistakes-a.mistakes).slice(0,r)}function dr(r){return{word:r,correctCount:0,incorrectCount:0,consecutiveCorrect:0,consecutiveIncorrect:0,lastStudied:0,totalResponseTime:0,averageResponseTime:0,difficultyScore:50,masteryLevel:"new",responseTimes:[]}}function xn(r){const t=r.correctCount+r.incorrectCount;if(t===0)return 50;const n=(1-r.correctCount/t)*100,a=Math.min(r.consecutiveIncorrect*5,20),o=r.averageResponseTime/1e3,l=Math.min(o>5?(o-5)*3:0,15),i=r.userDifficultyRating?(r.userDifficultyRating-5.5)*5:0,c=n+a+l+i;return Math.max(0,Math.min(100,c))}function it(r){const t=[1,1,3,7,14,30,90,180,365];return r>=t.length?365:t[r]||1}function Yt(r,t){const s=r.correctCount+r.incorrectCount,n=s>0?r.correctCount/s:0,{consecutiveCorrect:a,lastStudied:o}=r,i=(Date.now()-o)/(1e3*60*60)/24;if(s===1&&t){const c=it(1);return{isMastered:!0,excludeDays:c,reason:`1ç™ºæ­£è§£ï¼ˆ${c}æ—¥å¾Œã«å†ç¢ºèªï¼‰`,confidence:.85,masteryLevel:1}}if(a>=2&&t){const c=it(a),d=Math.min(7,Math.floor(a/1));let m="";return a>=7?m=`è¶…é•·æœŸè¨˜æ†¶é”æˆï¼ï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«å¹´æ¬¡ç¢ºèªï¼‰`:a>=5?m=`é•·æœŸè¨˜æ†¶å®šç€ï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`:a>=3?m=`çŸ­æœŸâ†’é•·æœŸè¨˜æ†¶ç§»è¡Œï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`:m=`å­¦ç¿’ä¸­ï¼ˆé€£ç¶š${a}å›æ­£è§£ã€${c}æ—¥å¾Œã«å¾©ç¿’ï¼‰`,{isMastered:!0,excludeDays:c,reason:m,confidence:Math.min(.99,.75+a*.05),masteryLevel:d}}if(s>=3&&n>=.9&&a>=2){const c=it(a);return{isMastered:!0,excludeDays:c,reason:`é«˜ç²¾åº¦å®‰å®šå‹ï¼ˆæ­£ç­”ç‡${Math.round(n*100)}%ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.88,masteryLevel:2}}if(a>=2&&i>=7&&t){const c=it(a),d=Math.floor(c*1.5);return{isMastered:!0,excludeDays:d,reason:`é•·æœŸè¨˜æ†¶å‹ï¼ˆ7æ—¥é–“éš”ã§æ­£è§£ã€${d}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.92,masteryLevel:3}}if(a>=2&&i>=3&&t){const c=it(a),d=Math.floor(c*1.2);return{isMastered:!0,excludeDays:d,reason:`ä¸­æœŸè¨˜æ†¶å‹ï¼ˆ3æ—¥é–“éš”ã§æ­£è§£ã€${d}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.85,masteryLevel:2}}if(a>=2&&i<=1&&n>=.85&&s>=4){const c=it(a);return{isMastered:!0,excludeDays:c,reason:`çŸ­æœŸå®Œç’§å‹ï¼ˆ24æ™‚é–“å†…ã«é€£ç¶šæ­£è§£ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.8,masteryLevel:1}}if(s>=5&&n>=.8&&t){const c=Math.max(7,it(2));return{isMastered:!0,excludeDays:c,reason:`é«˜å›æ•°å®‰å®šå‹ï¼ˆ${s}å›æŒ‘æˆ¦ãƒ»æ­£ç­”ç‡${Math.round(n*100)}%ã€${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.83,masteryLevel:2}}if(a>=2&&n>=.75&&s>=3&&t){const c=it(a);return{isMastered:!0,excludeDays:c,reason:`æ¬¡å›å®šç€é”æˆï¼ˆ${c}æ—¥å¾Œã«ç¢ºèªï¼‰`,confidence:.78,masteryLevel:1}}return{isMastered:!1,excludeDays:0,reason:"æœªå®šç€",confidence:1,masteryLevel:0}}function yn(r){const t=r.correctCount+r.incorrectCount;if(t===0)return"new";const s=r.correctCount/t,n=t===1&&r.correctCount===1,a=t===2&&s===1,o=t>=5&&s>=.85,l=t>=3&&s>=.9,i=r.consecutiveCorrect>=5,c=t>=10&&s>=.75&&r.consecutiveCorrect>=2;return n||a||o||l||i||c?"mastered":"learning"}async function mt(r,t,s,n,a,o){const l=await et();l.wordProgress[r]||(l.wordProgress[r]=dr(r));const i=l.wordProgress[r];t?(i.correctCount++,i.consecutiveCorrect++,i.consecutiveIncorrect=0):o?(i.incorrectCount++,i.consecutiveCorrect=0,i.consecutiveIncorrect=0):(i.incorrectCount++,i.consecutiveIncorrect++,i.consecutiveCorrect=0);const c=a;c==="translation"?(i.translationAttempts=(i.translationAttempts||0)+1,t?(i.translationCorrect=(i.translationCorrect||0)+1,i.translationStreak=(i.translationStreak||0)+1):i.translationStreak=0):c==="spelling"?(i.spellingAttempts=(i.spellingAttempts||0)+1,t?(i.spellingCorrect=(i.spellingCorrect||0)+1,i.spellingStreak=(i.spellingStreak||0)+1):i.spellingStreak=0):c==="grammar"?(i.grammarAttempts=(i.grammarAttempts||0)+1,t?(i.grammarCorrect=(i.grammarCorrect||0)+1,i.grammarStreak=(i.grammarStreak||0)+1):i.grammarStreak=0):c==="memorization"&&(i.memorizationAttempts=(i.memorizationAttempts||0)+1,t?(i.memorizationCorrect=(i.memorizationCorrect||0)+1,i.memorizationStreak=(i.memorizationStreak||0)+1):o?i.memorizationStillLearning=(i.memorizationStillLearning||0)+1:i.memorizationStreak=0),i.totalAttempts=(i.translationAttempts||0)+(i.spellingAttempts||0)+(i.grammarAttempts||0)+(i.memorizationAttempts||0),i.totalResponseTime+=s;const d=i.correctCount+i.incorrectCount;if(i.averageResponseTime=i.totalResponseTime/d,n!==void 0&&(i.userDifficultyRating=n),i.lastStudied=Date.now(),c==="memorization"){i.easinessFactor===void 0&&(i.easinessFactor=2.5),t?i.easinessFactor=Math.min(2.5,i.easinessFactor+.1):o||(i.easinessFactor=Math.max(1.3,i.easinessFactor-.2));const g=i.memorizationStreak||0,S=i.easinessFactor;let b=0;if(g===0)b=0;else if(g===1)b=1;else if(g===2)b=3;else if(g===3)b=7;else{const y=i.reviewInterval||7;b=Math.round(y*S)}i.reviewInterval=b,i.lastReviewDate=Date.now(),i.totalReviews=(i.totalReviews||0)+1,i.avgResponseSpeed?i.avgResponseSpeed=i.avgResponseSpeed*.8+s*.2:i.avgResponseSpeed=s,s<2e3&&t&&(i.easinessFactor=Math.min(2.5,i.easinessFactor+.05))}i.learningHistory||(i.learningHistory=[]),i.learningHistory.push({timestamp:Date.now(),wasCorrect:t,responseTime:s,sessionIndex:0}),i.learningHistory.length>20&&(i.learningHistory=i.learningHistory.slice(-20)),i.difficultyScore=xn(i);const m=i.masteryLevel;i.masteryLevel=yn(i),m!==i.masteryLevel&&p.log(`ğŸ”„ ${r}: ${m} â†’ ${i.masteryLevel} (æ­£è§£: ${i.correctCount}, ä¸æ­£è§£: ${i.incorrectCount}, é€£ç¶š: ${i.consecutiveCorrect})`);const h=Yt(i,t);if(h.isMastered&&(i.skipExcludeUntil=Date.now()+h.excludeDays*24*60*60*1e3,vn(r),h.reason!=="æœªå®šç€"&&p.log(`âœ… ${r} ãŒå®šç€: ${h.reason} (é™¤å¤–æœŸé–“: ${h.excludeDays}æ—¥)`)),c){const g=c==="translation"?"å’Œè¨³":c==="spelling"?"ã‚¹ãƒšãƒ«":c==="grammar"?"æ–‡æ³•":c==="memorization"?"æš—è¨˜":"èª­è§£";l.results.push({id:`word-${r}-${Date.now()}`,questionSetId:"individual-word",questionSetName:g,score:t?1:0,total:1,percentage:t?100:0,date:Date.now(),timeSpent:s/1e3,incorrectWords:t?[]:[r],mode:c,difficulty:i.difficultyScore>.7?"advanced":i.difficultyScore>.4?"intermediate":"beginner"})}await at(l);try{if(typeof window<"u"){const g=new CustomEvent(ft,{detail:{word:r,isCorrect:t,responseTime:s,mode:c}});window.dispatchEvent(g)}}catch{}}function vn(r){const t="reading-passages-data",s=localStorage.getItem(t);if(s)try{const n=JSON.parse(s);let a=!1;if(n.forEach(o=>{o.phrases&&o.phrases.forEach(l=>{l.segments&&l.segments.forEach(i=>{i.word.toLowerCase()===r.toLowerCase()&&i.isUnknown&&(i.isUnknown=!1,a=!0)})})}),a)try{localStorage.setItem(t,JSON.stringify(n))}catch(o){if(o instanceof DOMException&&o.name==="QuotaExceededError")p.warn("é•·æ–‡èª­è§£ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«å¤±æ•—ï¼ˆå®¹é‡è¶…éï¼‰ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’åœ§ç¸®ã—ã¾ã™ã€‚"),localStorage.removeItem(t),p.log("é•·æ–‡èª­è§£ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚æ¬¡å›èª­ã¿è¾¼ã¿æ™‚ã«å†å–å¾—ã•ã‚Œã¾ã™ã€‚");else throw o}}catch(n){p.error("é•·æ–‡èª­è§£ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°ã‚¨ãƒ©ãƒ¼:",n)}}function Xt(r,t=30){const s=Me();s.wordProgress[r]||(s.wordProgress[r]=dr(r));const n=s.wordProgress[r];n.skippedCount=(n.skippedCount||0)+1,n.lastSkipped=Date.now(),n.skipExcludeUntil=Date.now()+t*24*60*60*1e3,at(s)}function vs(r){const s=Me().wordProgress[r];return s?!!(s.skipExcludeUntil&&Date.now()<s.skipExcludeUntil||s.masteryLevel==="mastered"&&s.nextReviewDate&&Date.now()<s.nextReviewDate):!1}function ws(r){return r.filter(t=>!vs(t.word))}function Wt(r){return Me().wordProgress[r]||null}function ht(){const r=Me();return Object.values(r.wordProgress)}async function bs(r,t){const s=await et();s.wordProgress[r]||(s.wordProgress[r]={word:r,correctCount:0,incorrectCount:0,consecutiveCorrect:0,consecutiveIncorrect:0,lastStudied:Date.now(),totalResponseTime:0,averageResponseTime:0,difficultyScore:0,masteryLevel:"new",responseTimes:[],confusedWith:[],confusionCount:0,lastConfused:Date.now()});const n=s.wordProgress[r];n.confusedWith||(n.confusedWith=[]),n.confusedWith.push({word:t,timestamp:Date.now()}),n.confusedWith.length>10&&(n.confusedWith=n.confusedWith.slice(-10)),n.confusionCount=(n.confusionCount||0)+1,n.lastConfused=Date.now(),n.difficultyScore=Math.min(100,(n.difficultyScore||0)+5),await at(s),nt(s)}function js(r=20){return ht().filter(s=>(s.confusionCount||0)>0).sort((s,n)=>{const a=(n.confusionCount||0)-(s.confusionCount||0);return a!==0?a:(n.lastConfused||0)-(s.lastConfused||0)}).slice(0,r)}function Ns(r){let s=Me().results;return r&&(s=s.filter(n=>n.mode===r)),s.reduce((n,a)=>n+a.total,0)}function ur(r){const t=Me(),s=new Set;for(const[n,a]of Object.entries(t.wordProgress)){const o=a.correctCount>0||a.incorrectCount>0,l=a.skippedCount&&a.skippedCount>0;(o||l)&&s.add(n)}return s.size}function Kt(){const r=Me();let t=0;for(const s of Object.values(r.wordProgress)){const a=s.correctCount+s.incorrectCount===1&&s.correctCount===1,o=s.consecutiveCorrect>=3,l=s.skippedCount&&s.skippedCount>0;(a||o||l)&&t++}return t}function Ot(){const r=Me(),s=Object.values(r.wordProgress).filter(l=>l.correctCount+l.incorrectCount>0);let n=0;s.forEach(l=>{const i=l.correctCount+l.incorrectCount,c=i>0?l.correctCount/i*100:0,d=l.masteryLevel==="mastered",m=i===1&&l.correctCount===1,h=i>=5&&c>=85,g=i>=3&&c>=90,S=l.consecutiveCorrect>=5,b=i>=10&&c>=75;(d||m||h||g||S||b)&&n++});const a=s.length>0?n/s.length*100:0,o=Math.min(100,Math.max(0,a));return{retentionRate:Math.round(o),masteredCount:n,appearedCount:s.length}}async function Ss(){try{await en(),p.log("âœ… IndexedDBå‰Šé™¤å®Œäº†")}catch(s){p.error("IndexedDBå‰Šé™¤ã‚¨ãƒ©ãƒ¼:",s)}const r=[];for(let s=0;s<localStorage.length;s++){const n=localStorage.key(s);n&&(n.startsWith("quiz-result-")||n==="quiz-app-user-progress"||n==="progress-data"||n.startsWith("session-history-")||n==="session-history"||n==="skipped-words"||n==="skip-groups"||n==="improvement-progress"||n==="study-settings"||n==="reading-passages-data"||n==="all-questions-cache")&&r.push(n)}r.forEach(s=>{try{localStorage.removeItem(s)}catch(n){p.error(`Failed to remove ${s}:`,n)}});const t=ut();at(t),p.log(`âœ… ãƒªã‚»ãƒƒãƒˆå®Œäº†: LocalStorage ${r.length}å€‹ã®ã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`),window.location.reload()}function ks(r=90){const t=Me(),s=new Date,n=[];p.log("ğŸ“Š getStudyCalendarDataå‘¼ã³å‡ºã— - progress.resultsä»¶æ•°:",t.results.length);for(let a=r-1;a>=0;a--){const o=new Date(s);o.setDate(o.getDate()-a);const l=Gt(o),i=new Date(o).setHours(0,0,0,0),c=new Date(o).setHours(23,59,59,999),d=t.results.filter(S=>S.date>=i&&S.date<=c);a===0&&p.log("ğŸ“… ä»Šæ—¥ã®ãƒ‡ãƒ¼ã‚¿:",{dateStr:l,dayStart:new Date(i).toISOString(),dayEnd:new Date(c).toISOString(),dayResults:d.length,sampleResults:d.slice(0,3).map(S=>({mode:S.mode,score:S.score,total:S.total,date:new Date(S.date).toISOString()}))});const m=d.reduce((S,b)=>S+b.total,0),h=d.reduce((S,b)=>S+b.score,0),g=m>0?h/m*100:0;n.push({date:l,count:m,accuracy:g})}return n}function Cs(r=12){const t=Me(),s=new Date,n=[];let a=0,o=0;for(let l=r-1;l>=0;l--){const i=new Date(s);i.setDate(s.getDate()-l*7),i.setHours(23,59,59,999);const c=new Date(i);c.setDate(i.getDate()-6),c.setHours(0,0,0,0);const m=t.results.filter(S=>S.date>=c.getTime()&&S.date<=i.getTime()).reduce((S,b)=>S+b.total,0);o+=m;let h=0;Object.values(t.wordProgress).forEach(S=>{S.masteryLevel==="mastered"&&S.lastStudied>=c.getTime()&&S.lastStudied<=i.getTime()&&h++}),a+=h;const g=`${c.getMonth()+1}/${c.getDate()}`;n.push({weekLabel:g,cumulativeMastered:a,weeklyMastered:h,cumulativeAnswered:o,weeklyAnswered:m})}return n}function Ds(){const r=Me(),t=Date.now(),s=t-7*24*60*60*1e3,n=t-30*24*60*60*1e3,a=new Set,o=new Set,l=new Set,i=new Set,c=new Set,d=new Set;return r.results.forEach(m=>{m.incorrectWords.forEach(h=>{c.add(h),m.date>=n&&l.add(h),m.date>=s&&a.add(h)})}),Object.entries(r.wordProgress).forEach(([m,h])=>{h.masteryLevel==="mastered"&&(d.add(m),h.lastStudied>=n&&i.add(m),h.lastStudied>=s&&o.add(m))}),{last7Days:Math.min(100,Math.max(0,a.size>0?o.size/a.size*100:0)),last30Days:Math.min(100,Math.max(0,l.size>0?i.size/l.size*100:0)),allTime:Math.min(100,Math.max(0,c.size>0?d.size/c.size*100:0))}}function qt(r){const s=Me().wordProgress[r];if(!s)return null;const n=s.correctCount,a=s.correctCount+s.incorrectCount,i=(s.learningHistory||[]).slice(-10).map(g=>g.wasCorrect?"ğŸŸ©":"ğŸŸ¥").join("");let c=0;if(a===0)c=0;else{const g=n/a*70,S=Math.min(20,(s.consecutiveCorrect||0)*5),b=(Date.now()-s.lastStudied)/(24*60*60*1e3),y=Math.min(10,Math.max(0,(b-1)*2));c=Math.min(100,Math.max(0,g+S-y)),s.masteryLevel==="mastered"&&(c=Math.max(90,c))}let d="new",m="æœªå­¦ç¿’",h="âšª";return a===0?(d="new",m="æœªå­¦ç¿’",h="âšª"):s.masteryLevel==="mastered"||c>=80?(d="mastered",m="å®šç€æ¸ˆ",h="ğŸŸ¢"):c>=50?(d="learning",m="å­¦ç¿’ä¸­",h="ğŸŸ¡"):(d="struggling",m="è¦å¾©ç¿’",h="ğŸ”´"),{correctCount:n,totalCount:a,accuracyHistory:i,retentionRate:Math.round(c),status:d,statusLabel:m,statusIcon:h}}async function Ms(r){try{await Ht("memorization-card-settings",r)}catch(t){p.error("ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºè¨­å®šã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t),localStorage.setItem("memorization-card-settings",JSON.stringify(r))}}async function Is(){try{const r=await Vt("memorization-card-settings");return r?typeof r=="string"?JSON.parse(r):typeof r=="object"&&"showFurigana"in r?r:null:null}catch(r){p.error("ã‚«ãƒ¼ãƒ‰è¡¨ç¤ºè¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=localStorage.getItem("memorization-card-settings");return t?JSON.parse(t):null}}async function As(r){try{await Ht("memorization-settings",r)}catch(t){p.error("æš—è¨˜è¨­å®šã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t),localStorage.setItem("memorization-settings",JSON.stringify(r))}}async function Rs(){try{const r=await Vt("memorization-settings");return r?typeof r=="string"?JSON.parse(r):typeof r=="object"&&"shuffleOrder"in r?r:null:null}catch(r){p.error("æš—è¨˜è¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r);const t=localStorage.getItem("memorization-settings");return t?JSON.parse(t):null}}async function Ps(r){try{const t=await Vt("memorization-behaviors"),n=[...t?typeof t=="string"?JSON.parse(t):t:[],r].slice(-1e3);await Ht("memorization-behaviors",n)}catch(t){p.error("æš—è¨˜è¡Œå‹•è¨˜éŒ²ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t)}}const mr="custom-question-sets";async function Zt(){try{const r=await Vt(mr);return r?typeof r=="string"?JSON.parse(r):Array.isArray(r)?r:[]:[]}catch(r){return p.error("ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆå–å¾—ã‚¨ãƒ©ãƒ¼:",r),[]}}async function zt(r){try{const t=await Zt(),s=t.findIndex(n=>n.id===r.id);s>=0?t[s]={...r,updatedAt:Date.now()}:t.push(r),await Ht(mr,t)}catch(t){throw p.error("ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆä¿å­˜ã‚¨ãƒ©ãƒ¼:",t),t}}async function Ft(r,t=20,s=3,n=60,a){const i=Jt(100).filter(d=>d.mistakes>=s&&d.recentAccuracy<=n).slice(0,t).map(d=>{const m=a.find(h=>h.word.toLowerCase()===d.word.toLowerCase());return m||{word:d.word,reading:d.reading||"",meaning:d.meaning||"",etymology:"",relatedWords:"",relatedFields:"",difficulty:"intermediate"}});return{id:`weak-words-${Date.now()}`,name:r,source:"weak-words",questions:i,createdAt:Date.now(),updatedAt:Date.now(),isAutoUpdate:!0,autoUpdateConfig:{limit:t,minMistakes:s,maxAccuracy:n},metadata:{description:`è‹¦æ‰‹èªå¥ã‹ã‚‰è‡ªå‹•ç”Ÿæˆï¼ˆé–“é•ã„${s}å›ä»¥ä¸Šã€æ­£ç­”ç‡${n}%ä»¥ä¸‹ï¼‰`,totalWords:i.length}}}function Qt(){const r=Me(),n=Object.values(r.wordProgress).filter(i=>i.grammarAttempts&&i.grammarAttempts>0||i.word.startsWith("grammar_")||i.word.includes("_g")).filter(i=>i.grammarAttempts&&i.grammarAttempts>0||i.correctCount+i.incorrectCount>0);let a=0;n.forEach(i=>{const c=i.grammarAttempts||i.correctCount+i.incorrectCount,d=i.grammarCorrect||i.correctCount,m=i.grammarStreak||i.consecutiveCorrect,h=c>0?d/c*100:0,g=i.masteryLevel==="mastered",S=c===1&&d===1,b=c>=5&&h>=85,y=c>=3&&h>=90,v=m>=5,k=c>=10&&h>=75;(g||S||b||y||v||k)&&a++});const o=n.length>0?a/n.length*100:0,l=Math.min(100,Math.max(0,o));return{retentionRate:Math.round(l),masteredCount:a,appearedCount:n.length}}async function Ts(){const r=fs();return(await Promise.all(r.map(async s=>{const n=s.unit.match(/ä¸­(\d+)_Unit(\d+)/);if(!n)return null;const a=n[1],o=n[2];try{const l=await fetch(`/data/grammar/grammar_grade${a}_unit${o}.json`);if(l.ok){const i=await l.json();return i.enabled===!1?null:{...s,title:i.title||""}}}catch{return null}return null}))).filter(s=>s!==null)}const Bs=Object.freeze(Object.defineProperty({__proto__:null,addQuizResult:St,addSessionHistory:yt,checkFlexibleMastery:Yt,createWeakWordsQuestionSet:Ft,filterSkippedWords:ws,getAllWordProgress:ht,getConfusedWords:js,getCumulativeProgressData:Cs,getCurrentWeakWords:Jt,getCustomQuestionSets:Zt,getDetailedRetentionStats:_t,getGrammarDetailedRetentionStats:Lt,getGrammarRetentionRateWithAI:Qt,getGrammarUnitStats:fs,getGrammarUnitStatsWithTitles:Ts,getMemorizationCardSettings:Is,getMemorizationDetailedRetentionStats:Nt,getMemorizationSettings:Rs,getMonthlyStats:gs,getNearMasteryStats:lr,getOvercomeWeakWords:ys,getRecentlyMasteredWords:ps,getRetentionRateWithAI:Ot,getRetentionTrend:Ds,getStudyCalendarData:ks,getStudySettings:ms,getTodayIncorrectWords:$t,getTodayStats:Et,getTotalAnsweredCount:Ns,getTotalMasteredWordsCount:Kt,getUniqueQuestionedWordsCount:ur,getWeeklyStats:hs,getWordDetailedData:qt,getWordProgress:Wt,isWordSkipExcluded:vs,loadProgress:et,loadProgressSync:Me,recordConfusion:bs,recordMemorizationBehavior:Ps,recordWordSkip:Xt,resetAllProgress:Ss,saveCustomQuestionSet:zt,saveMemorizationCardSettings:Ms,saveMemorizationSettings:As,saveProgress:at,updateProgressCache:nt,updateWordProgress:mt},Symbol.toStringTag,{value:"Module"}));function bt(r){const t=r.trim().split(`
`);if(t.length===0)return[];function s(l){const i=[];let c="",d=!1;for(let m=0;m<l.length;m++){const h=l[m],g=l[m+1];h==='"'?d&&g==='"'?(c+='"',m++):d=!d:h===","&&!d?(i.push(c.trim()),c=""):c+=h}return i.push(c.trim()),i}let n=0;const a=t[0].trim();(a.includes("èªå¥")||a.includes("term")||a.includes("èª­ã¿")||a.includes("reading")||a.includes("æ„å‘³")||a.includes("meaning"))&&(n=1);const o=[];for(let l=n;l<t.length;l++){const i=t[l].trim();if(!i||i.startsWith("//")||i.startsWith("#"))continue;const c=s(i);if(c.length>=3){const d=c[0]||"",m=c[1]||"",h=c[2]||"",g=c[3]||"";let S="",b="",y="";c.length>=8?(S=(c[4]||"")+(c[5]||""),b=c[6]||"",y=c[7]||""):(S=c[4]||"",b=c[5]||"",y=c[6]||"");let v="";y.includes("åˆç´š")||y==="beginner"?v="beginner":y.includes("ä¸­ç´š")||y==="intermediate"?v="intermediate":(y.includes("ä¸Šç´š")||y==="advanced")&&(v="advanced"),b&&!Kr(b)&&p.warn(`[ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§è­¦å‘Š] ä¸æ­£ãªã‚«ãƒ†ã‚´ãƒª: "${b}" (å˜èª: "${d}")
æœ‰åŠ¹ãªã‚«ãƒ†ã‚´ãƒª: ${nr.join(", ")}
å‚ç…§: docs/19-junior-high-vocabulary.md`),d&&h&&o.push({word:d,reading:m,meaning:h,etymology:g,relatedWords:S,relatedFields:b,category:b,difficulty:v})}}return o}function lt(r){const t=[...r];for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t}function hr(r,t,s){const n=[],a=t.filter((i,c)=>c!==s),o=lt(a);for(let i=0;i<o.length&&n.length<2;i++){const c=o[i];c.meaning!==r.meaning&&!n.some(d=>d.meaning===c.meaning)&&n.push(c)}for(;n.length<2;)n.push({word:`ãƒ€ãƒŸãƒ¼${n.length+1}`,meaning:`é¸æŠè‚¢${n.length+1}`,reading:"",etymology:"",relatedWords:"",relatedFields:"",category:"",difficulty:""});return[...lt([{text:r.meaning,question:r},...n.map(i=>({text:i.meaning,question:i}))]),{text:"åˆ†ã‹ã‚‰ãªã„",question:null}]}const wn="quizApp_questionSets";function gr(r){try{localStorage.setItem(wn,JSON.stringify(r))}catch(t){p.error("Failed to save question sets:",t)}}function Gt(r){const t=r.getFullYear(),s=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${t}-${s}-${n}`}const ft="quiz-result-added";function kt(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function pr(r,t=10){const n=ht().filter(o=>o.difficultyScore>=50).sort((o,l)=>l.difficultyScore-o.difficultyScore).map(o=>o.word.toLowerCase()),a=r.filter(o=>n.includes(o.word.toLowerCase()));return lt(a).slice(0,Math.min(t,a.length))}function fr(r){if(!r.includes(" "))return"word";const t=r.toLowerCase(),s=t.split(" "),n=["get","go","come","take","make","put","look","turn","break","bring","call","carry","check","figure","fill","find","give","hand","hang","hold","keep","knock","lay","let","pass","pick","pull","push","run","set","show","shut","sit","stand","stay","stick","take","talk","think","throw","try","work","write"],a=["up","down","in","out","on","off","away","back","over","through","around","across","along","about","after","for","from","into","to","with"];return s.length>=2&&n.includes(s[0])&&s.slice(1).some(m=>a.includes(m))?"phrasal-verb":[/^a .+ of$/,/^the .+ (of|in)$/,/^(break|beat|hit|kick) (the|a)/,/^(catch|have|take|make) (a|an|the)/,/(eye|eyes|face|hand|tongue|ear|nose|heart|mind|bone)/i,/^once in a/,/^(cost|pay|worth) (an|a)/,/^at .+ (heart|first|last|once)/].some(d=>d.test(t))?"idiom":[/^(in|on|at|by|with|from|to) (the|a|an) /,/^(make|take|do|have|get) (a|an|the) /,/(strong|weak|heavy|light|high|low|good|bad|big|small) /i].some(d=>d.test(t))?"collocation":"other"}function bn(r,t=90){const s=Math.floor(t/3),n=Math.floor(t*2/3);return r<=s?1:r<=n?2:3}function jn(r){const t=ht(),s=new Map;return t.forEach(n=>{s.set(n.word.toLowerCase(),n)}),r.filter(n=>{const a=s.get(n.word.toLowerCase());return!a||a.masteryLevel==="new"})}function Nn(r){const t=Date.now(),s=ht(),n=new Map;return s.forEach(a=>{n.set(a.word.toLowerCase(),a)}),r.filter(a=>{const o=n.get(a.word.toLowerCase());if(!o)return!1;const l=(t-o.lastStudied)/(1e3*60*60*24);let i;switch(o.masteryLevel){case"new":i=1;break;case"learning":i=Math.min(7,o.consecutiveCorrect+1);break;case"mastered":i=Math.min(30,o.consecutiveCorrect*2);break;default:i=1}return l>=i})}function Sn(r,t,s){let n;switch(t){case 1:n=r.filter(c=>c.difficulty==="åˆç´š"),n.length<s&&(n=[...n,...r.filter(c=>c.difficulty==="ä¸­ç´š")]);break;case 2:const a=r.filter(c=>c.difficulty==="åˆç´š"),o=r.filter(c=>c.difficulty==="ä¸­ç´š");n=[...a,...o];break;case 3:const l=r.filter(c=>c.difficulty==="ä¸­ç´š"),i=r.filter(c=>c.difficulty==="ä¸Šç´š");n=[...l,...i];break}return lt(n).slice(0,s)}function xr(r,t){const s=r.currentDay,n=bn(s,r.totalDays),a=jn(t),o=Nn(t),l=Math.ceil(r.dailyGoals.newWords*.3),i=Sn(a,n,l),c=Math.ceil(r.dailyGoals.reviewWords*.4),d=pr(o.length>0?o:t,c),m=Math.floor(l*.3),h=Math.ceil(r.dailyGoals.reviewWords*.3),g=[...lt(i).slice(0,m),...lt(o.length>0?o:t).slice(0,h)];return{date:r.startDate+(s-1)*24*60*60*1e3,dayNumber:s,phase:n,morning:{newWords:i,duration:Math.ceil(r.dailyGoals.timeMinutes*.35),mode:"discovery"},afternoon:{reviewWords:d,duration:Math.ceil(r.dailyGoals.timeMinutes*.3),mode:"weakness"},evening:{mixedWords:lt(g),duration:Math.ceil(r.dailyGoals.timeMinutes*.35),mode:"mixed"},completed:!1,actualAccuracy:0}}function yr(r){const t=ht(),s=t.filter(d=>d.masteryLevel!=="new").length,n=t.reduce((d,m)=>d+m.correctCount+m.incorrectCount,0),a=t.reduce((d,m)=>d+m.correctCount,0),o=n>0?a/n*100:0,l=s/r.currentDay,c=(4700-s)/(l||50);return{totalLearned:s,totalReviewed:n,averageAccuracy:o,estimatedCompletion:Math.ceil(c)}}function vr(r){const t=Math.ceil(r.currentDay/7),s=r.dailyGoals.newWords*7,n=r.weeklyProgress.find(a=>a.week===t);return n?n.wordsLearned/s*100:0}const kn=Object.freeze(Object.defineProperty({__proto__:null,QUIZ_RESULT_EVENT:ft,calculateProgress:yr,calculateWeeklyAchievement:vr,classifyPhraseType:fr,formatLocalYYYYMMDD:Gt,generateChoicesWithQuestions:hr,generateDailyPlan:xr,generateId:kt,parseCSV:bt,saveQuestionSets:gr,selectWeakQuestions:pr,shuffle:lt},Symbol.toStringTag,{value:"Module"}));function Cn(){const[r]=u.useState(()=>{const s=localStorage.getItem("autoAdvance");return s?JSON.parse(s):!1}),[t]=u.useState(()=>{const s=localStorage.getItem("autoAdvanceDelay");return s?parseInt(s,10):1500});return{autoAdvance:r,autoAdvanceDelay:t}}function Dn(){const[r,t]=u.useState([]),[s,n]=u.useState("all"),[a,o]=u.useState("all"),[l,i]=u.useState("all"),[c,d]=u.useState("all"),[m,h]=u.useState(()=>{const g=localStorage.getItem("selectedDataSource");if(g)try{return JSON.parse(g)}catch{return"all"}return"all"});return{categoryList:r,setCategoryList:t,selectedCategory:s,setSelectedCategory:n,selectedDifficulty:a,setSelectedDifficulty:o,selectedWordPhraseFilter:l,setSelectedWordPhraseFilter:i,selectedPhraseTypeFilter:c,setSelectedPhraseTypeFilter:d,selectedDataSource:m,setSelectedDataSource:h}}function Mn(){const[r,t]=u.useState({correct:0,incorrect:0,review:0,mastered:0}),[s,n]=u.useState({questions:[],currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedAnswer:null}),[a,o]=u.useState(!1),[l,i]=u.useState([]),[c,d]=u.useState(new Map);return{sessionStats:r,setSessionStats:t,quizState:s,setQuizState:n,reviewFocusMode:a,setReviewFocusMode:o,reviewQuestionPool:l,setReviewQuestionPool:i,reviewCorrectStreak:c,setReviewCorrectStreak:d}}const wr="customQuestionSets";function In(){try{const r=localStorage.getItem(wr);if(r){const t=JSON.parse(r);return{sets:t.sets||[],activeSetId:t.activeSetId||null,recentSetIds:t.recentSetIds||[]}}}catch(r){console.error("Failed to load custom question state:",r)}return{sets:[],activeSetId:null,recentSetIds:[]}}function An(r){try{localStorage.setItem(wr,JSON.stringify(r))}catch(t){console.error("Failed to save custom question state:",t)}}function Rn(r,t,s,n){const a=new Date().toISOString();return{id:`set_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:r,description:t,words:[],createdAt:a,updatedAt:a,icon:s,color:n}}function Pn(r,t,s){const n=r.sets.map(a=>a.id!==t||a.words.some(o=>o.word===s.word)?a:{...a,words:[...a.words,{...s,addedAt:new Date().toISOString()}],updatedAt:new Date().toISOString()});return{...r,sets:n,recentSetIds:_n(r.recentSetIds,t)}}function Tn(r,t,s){const n=r.sets.map(a=>a.id!==t?a:{...a,words:a.words.filter(o=>o.word!==s.word),updatedAt:new Date().toISOString()});return{...r,sets:n}}function $n(r,t){return{...r,sets:r.sets.filter(s=>s.id!==t),activeSetId:r.activeSetId===t?null:r.activeSetId,recentSetIds:r.recentSetIds.filter(s=>s!==t)}}function En(r,t,s){const n=r.sets.map(a=>a.id!==t?a:{...a,...s,updatedAt:new Date().toISOString()});return{...r,sets:n}}function _n(r,t){const s=r.filter(a=>a!==t);return[t,...s].slice(0,5)}function Ln(r,t,s){if(r===0)return 0;const n=(Date.now()-r)/(1e3*60*60*24);let o=(t>0?n/t:0)*100;return s<50?o*=1.5:s>=80&&(o*=.7),Math.round(Math.min(o,200))}function Wn(r,t=2.5){return r===0?0:r===1?1:r===2?3:r===3?7:Math.round(7*Math.pow(t,r-3))}function On(r,t){var a;const n=localStorage.getItem("english-progress");if(!n)return null;try{const l=(a=JSON.parse(n).wordProgress)==null?void 0:a[r];if(!l)return null;const i=t==="memorization"?"memorization":"default",c=t==="memorization"?l.memorizationAttempts||0:l.attempts||0,d=t==="memorization"?l.memorizationCorrect||0:l.correct||0,m=t==="memorization"&&l.memorizationStillLearning||0,h=t==="memorization"?l.memorizationStreak||0:l.streak||0,g=l.lastStudied||0,S=l.easinessFactor||2.5,b=l.reviewInterval||Wn(h,S);if(c===0)return{category:"new",priority:3,lastStudied:g,attempts:c,correct:d,streak:h,forgettingRisk:0,reviewInterval:0};const y=d+m*.5,v=c>0?y/c*100:0,k=Ln(g,b,v);return h>=3||h>=2&&v>=80?{category:"mastered",priority:5,lastStudied:g,attempts:c,correct:d,streak:h,forgettingRisk:k,reviewInterval:b}:v>=50||m>0?{category:"still_learning",priority:2,lastStudied:g,attempts:c,correct:d,streak:h,forgettingRisk:k,reviewInterval:b}:{category:"incorrect",priority:1,lastStudied:g,attempts:c,correct:d,streak:h,forgettingRisk:k,reviewInterval:b}}catch(o){return p.error("çµ±è¨ˆæƒ…å ±ã®å–å¾—ã‚¨ãƒ©ãƒ¼:",o),null}}function es(r,t){const{isReviewFocusMode:s=!1,learningLimit:n,reviewLimit:a,mode:o}=t,l=r.map(w=>({question:w,status:On(w.word,o)})),i={mastered:l.filter(w=>{var E;return((E=w.status)==null?void 0:E.category)==="mastered"}).length,still_learning:l.filter(w=>{var E;return((E=w.status)==null?void 0:E.category)==="still_learning"}).length,incorrect:l.filter(w=>{var E;return((E=w.status)==null?void 0:E.category)==="incorrect"}).length,new:l.filter(w=>{var E;return((E=w.status)==null?void 0:E.category)==="new"}).length},c=n!=null&&i.still_learning>=n,d=a!=null&&i.incorrect>=a,m=i.mastered+i.still_learning+i.incorrect,h=i.still_learning+i.incorrect,S=(m>0?h/m:0)>=.2,b=n??a??50,y=Math.max(3,Math.floor(b*.6)),v=Math.max(2,Math.floor(b*.3)),k=i.incorrect>y,D=i.incorrect<=v;return l.sort((w,E)=>{const $=w.status,G=E.status;let Y=($==null?void 0:$.priority)||3,q=(G==null?void 0:G.priority)||3;if(s)($==null?void 0:$.category)==="incorrect"&&(Y=0),(G==null?void 0:G.category)==="incorrect"&&(q=0),($==null?void 0:$.category)==="still_learning"&&Y!==0&&(Y=.5),(G==null?void 0:G.category)==="still_learning"&&q!==0&&(q=.5),($==null?void 0:$.category)==="mastered"&&Y>1&&(Y=10),(G==null?void 0:G.category)==="mastered"&&q>1&&(q=10),($==null?void 0:$.category)==="new"&&Y>1&&(Y=8),(G==null?void 0:G.category)==="new"&&q>1&&(q=8);else{const be=($==null?void 0:$.forgettingRisk)||0,Re=(G==null?void 0:G.forgettingRisk)||0;be>=150&&(Y=.1),Re>=150&&(q=.1),be>=100&&be<150&&(Y=.2),Re>=100&&Re<150&&(q=.2),($==null?void 0:$.category)==="incorrect"&&Y>.2&&(k?Y=$.lastStudied&&Date.now()-$.lastStudied<864e5?.1:.3:Y=.3),(G==null?void 0:G.category)==="incorrect"&&q>.2&&(k?q=G.lastStudied&&Date.now()-G.lastStudied<864e5?.1:.3:q=.3),($==null?void 0:$.category)==="still_learning"&&Y>.3&&(Y=.8),(G==null?void 0:G.category)==="still_learning"&&q>.3&&(q=.8),($==null?void 0:$.category)==="mastered"&&(be>=50&&Y>1?Y=2:Y>2&&(Y=4.5)),(G==null?void 0:G.category)==="mastered"&&(Re>=50&&q>1?q=2:q>2&&(q=4.5)),($==null?void 0:$.category)==="new"&&Y>3&&(k?Y=10:D?Y=3.5:Y=S?5:3.5),(G==null?void 0:G.category)==="new"&&q>3&&(k?q=10:D?q=3.5:q=S?5:3.5),d&&(($==null?void 0:$.category)==="incorrect"&&(Y=0),(G==null?void 0:G.category)==="incorrect"&&(q=0)),c&&(($==null?void 0:$.category)==="still_learning"&&(Y=.05),(G==null?void 0:G.category)==="still_learning"&&(q=.05))}if(Y!==q)return Y-q;const me=($==null?void 0:$.lastStudied)||0,Ne=(G==null?void 0:G.lastStudied)||0;return me!==Ne?me-Ne:Math.random()-.5}).map(w=>w.question)}const br="learning-assistant-skip-groups",qn=5*60*1e3;function $s(){try{const r=localStorage.getItem(br);return r?JSON.parse(r):[]}catch(r){return p.error("ã‚¹ã‚­ãƒƒãƒ—ã‚°ãƒ«ãƒ¼ãƒ—ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",r),[]}}function Es(r){try{localStorage.setItem(br,JSON.stringify(r))}catch(t){p.error("ã‚¹ã‚­ãƒƒãƒ—ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¿å­˜ã‚¨ãƒ©ãƒ¼:",t)}}function jr(r){const t=$s(),s=Date.now(),n=t.find(a=>a.verificationStatus==="pending"&&s-a.timestamp<qn);n?n.words.includes(r)||n.words.push(r):t.push({timestamp:s,words:[r],verificationStatus:"pending",suspiciousWords:[]}),Es(t)}function Nr(r){const t=$s(),s=Me(),n=t.find(a=>a.words.includes(r));n&&n.verificationStatus==="pending"&&(n.verificationStatus="suspicious",n.suspiciousWords=n.words.filter(a=>a!==r),n.suspiciousWords.forEach(a=>{if(s.wordProgress[a]){const o=s.wordProgress[a];delete o.skipExcludeUntil,o.masteryLevel="learning",o.consecutiveCorrect=0,o.needsVerification=!0,o.verificationReason=`åŒæ™‚æœŸã«ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã€Œ${r}ã€ãŒä¸æ­£è§£ã ã£ãŸãŸã‚`}}),at(s),Es(t),p.log(`AIå­¦ç¿’ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ: ã€Œ${r}ã€ãŒä¸æ­£è§£ã§ã—ãŸã€‚åŒæ™‚æœŸã«ã‚¹ã‚­ãƒƒãƒ—ã—ãŸ${n.suspiciousWords.length}å€‹ã®å˜èªã‚’å†å‡ºé¡Œå¯¾è±¡ã«ã—ã¾ã™ã€‚`))}function Sr(r){const t=$s(),s=Me(),n=t.find(a=>a.words.includes(r));n&&(n.suspiciousWords=n.suspiciousWords.filter(o=>o!==r),n.words.every(o=>{const l=s.wordProgress[o];return l&&(l.correctCount>0||l.incorrectCount>0)})&&n.suspiciousWords.length===0&&(n.verificationStatus="verified"),s.wordProgress[r]&&(delete s.wordProgress[r].needsVerification,delete s.wordProgress[r].verificationReason),at(s),Es(t))}function zn(r,t){const s=Me(),n=new Map;t.forEach(d=>{n.set(d,{correct:0,total:0,mastered:0,wordCount:0})}),s.results.forEach(d=>{if(d.category&&n.has(d.category)){const m=n.get(d.category);m.correct+=d.score,m.total+=d.total}}),r.forEach(d=>{const m=d.category;if(!m||!n.has(m))return;const h=n.get(m);h.wordCount++;const g=s.wordProgress[d.word];if(g){const S=g.correctCount+g.incorrectCount,b=S===1&&g.correctCount===1||g.consecutiveCorrect>=3||g.skippedCount&&g.skippedCount>0,y=S>=3&&g.correctCount/S>=.8&&g.consecutiveCorrect>=2;(b||y)&&h.mastered++}});const a=[],o=[];n.forEach((d,m)=>{if(d.total===0&&d.wordCount===0)return;const h=d.total>0?d.correct/d.total*100:0,g=d.wordCount>0?d.mastered/d.wordCount*100:0,S=h*.6+g*.4;if(S<60){let b,y,v;S<40?(b="critical",y=100,v=14):S<50?(b="moderate",y=70,v=10):(b="minor",y=40,v=7),d.total<10&&(y+=20),a.push({category:m,accuracy:h,totalAttempts:d.total,masteredWords:d.mastered,totalWords:d.wordCount,weaknessLevel:b,priorityScore:y,estimatedImprovementDays:v})}else if(S>=75){let b;S>=90?b="expert":S>=80?b="proficient":b="good",o.push({category:m,accuracy:h,totalAttempts:d.total,masteredWords:d.mastered,totalWords:d.wordCount,strengthLevel:b})}}),a.sort((d,m)=>m.priorityScore-d.priorityScore),o.sort((d,m)=>m.accuracy-d.accuracy);const l=Fn(n),i=Qn(a),c=Gn(a,o,l);return{weakCategories:a,strongCategories:o,balanceScore:l,improvementPlan:i,aiRecommendations:c}}function Fn(r){const t=[];if(r.forEach(l=>{if(l.total>0){const i=l.correct/l.total*100;t.push(i)}}),t.length===0)return 50;const s=t.reduce((l,i)=>l+i,0)/t.length,n=t.reduce((l,i)=>l+Math.pow(i-s,2),0)/t.length,a=Math.sqrt(n),o=Math.max(0,Math.min(100,100-a*2));return Math.round(o)}function Qn(r){const t=[],s={},n=[],a=r.slice(0,3);a.forEach(l=>{t.push(l.category);let i;l.weaknessLevel==="critical"?i=15:l.weaknessLevel==="moderate"?i=10:i=5,s[l.category]=i;const c={day:Math.ceil(l.estimatedImprovementDays/2),category:l.category,targetAccuracy:Math.min(l.accuracy+20,80),description:`${l.category}ã®æ­£ç­”ç‡ã‚’${Math.round(l.accuracy)}%ã‹ã‚‰${Math.min(l.accuracy+20,80)}%ã«æ”¹å–„`};n.push(c)});const o=a.length>0?Math.max(...a.map(l=>l.estimatedImprovementDays)):0;return{targetCategories:t,dailyQuestions:s,estimatedCompletionDays:o,milestones:n}}function Gn(r,t,s){const n=[];if(r.length>0){const o=r[0];n.push(`ğŸ¯ æœ€å„ªå…ˆ: ã€Œ${o.category}ã€ã‚’é‡ç‚¹å­¦ç¿’ã—ã¾ã—ã‚‡ã†ï¼ˆç¾åœ¨${Math.round(o.accuracy)}% â†’ ç›®æ¨™80%ï¼‰`),o.weaknessLevel==="critical"&&n.push(`âš ï¸ ã€Œ${o.category}ã€ã¯é‡è¦ãªå¼±ç‚¹ã§ã™ã€‚æ¯æ—¥15å•ä»¥ä¸Šå–ã‚Šçµ„ã‚€ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™`),r.length>=3&&n.push(`ğŸ“š ${r.length}å€‹ã®å¼±ç‚¹åˆ†é‡ãŒã‚ã‚Šã¾ã™ã€‚1ã¤ãšã¤é›†ä¸­ã—ã¦æ”¹å–„ã—ã¾ã—ã‚‡ã†`)}if(s<50?n.push(`âš–ï¸ å­¦ç¿’ãƒãƒ©ãƒ³ã‚¹ãŒåã£ã¦ã„ã¾ã™ï¼ˆãƒãƒ©ãƒ³ã‚¹ã‚¹ã‚³ã‚¢: ${s}%ï¼‰ã€‚å¼±ç‚¹åˆ†é‡ã«æ™‚é–“ã‚’é…åˆ†ã—ã¾ã—ã‚‡ã†`):s>=80&&n.push(`âœ¨ ç´ æ™´ã‚‰ã—ã„ãƒãƒ©ãƒ³ã‚¹ã§ã™ï¼ï¼ˆãƒãƒ©ãƒ³ã‚¹ã‚¹ã‚³ã‚¢: ${s}%ï¼‰ã“ã®èª¿å­ã§ç¶™ç¶šã—ã¾ã—ã‚‡ã†`),t.length>0&&r.length>0){const o=t[0];n.push(`ğŸ’ª ã€Œ${o.category}ã€ã¯å¾—æ„åˆ†é‡ã§ã™ï¼ˆ${Math.round(o.accuracy)}%ï¼‰ã€‚ã“ã®å­¦ç¿’æ–¹æ³•ã‚’ä»–ã®åˆ†é‡ã«ã‚‚å¿œç”¨ã—ã¾ã—ã‚‡ã†`)}return r.length>0&&n.push("ğŸ§  AIå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ãŒå¼±ç‚¹åˆ†é‡ã®å•é¡Œã‚’è‡ªå‹•çš„ã«å„ªå…ˆå‡ºé¡Œã—ã¾ã™"),[...r,...t].reduce((o,l)=>o+l.totalAttempts,0)<50&&n.push("ğŸ“ˆ ã¾ã å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªã„ã§ã™ã€‚50å•ä»¥ä¸Šè§£ãã¨ã‚ˆã‚Šæ­£ç¢ºãªåˆ†æãŒã§ãã¾ã™"),n}function Bn(r,t,s=30){if(t.length===0)return r.slice(0,s);const n=[],a=new Map,o=t.slice(0,3).reduce((h,g)=>h+g.priorityScore,0);t.slice(0,3).forEach(h=>{const g=Math.ceil(h.priorityScore/o*s*.7);a.set(h.category,g)}),t.slice(0,3).forEach(h=>{const g=a.get(h.category)||0,S=r.filter(k=>k.category===h.category),b=Me(),y=S.filter(k=>{const D=b.wordProgress[k.word];return D?D.consecutiveCorrect<3:!0}),v=is(y).slice(0,g);n.push(...v)});const l=s-n.length,i=new Set(t.slice(0,3).map(h=>h.category)),c=r.filter(h=>!i.has(h.category||"")),d=new Set(n.map(h=>h.word)),m=c.filter(h=>!d.has(h.word));return n.push(...is(m).slice(0,l)),is(n)}function is(r){const t=[...r];for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t}function Un(r){const t={startDate:Date.now(),currentDay:1,targetCategories:r.improvementPlan.targetCategories,initialAccuracies:{},currentAccuracies:{},improvements:{},overallProgress:0,isCompleted:!1};r.weakCategories.forEach(s=>{r.improvementPlan.targetCategories.includes(s.category)&&(t.initialAccuracies[s.category]=s.accuracy,t.currentAccuracies[s.category]=s.accuracy,t.improvements[s.category]=0)}),localStorage.setItem("radar-improvement-progress",JSON.stringify(t))}function kr(){const r=localStorage.getItem("radar-improvement-progress");if(!r)return null;try{return JSON.parse(r)}catch{return null}}function Hn(r){const t=kr();if(!t)return;const s=Math.floor((Date.now()-t.startDate)/(1e3*60*60*24));t.currentDay=s+1;let n=0;t.targetCategories.forEach(a=>{const o=r.weakCategories.find(c=>c.category===a),l=(o==null?void 0:o.accuracy)||80;t.currentAccuracies[a]=l;const i=l-t.initialAccuracies[a];t.improvements[a]=i,l>=80&&n++}),t.overallProgress=n/t.targetCategories.length*100,t.isCompleted=n===t.targetCategories.length,localStorage.setItem("radar-improvement-progress",JSON.stringify(t))}function Vn(r,t,s){const n=Jn(s),a=Yn(s),o=Xn(t,s,n);return{word:r,attempts:s,confusedWith:a,learningCurve:n,predictionModel:o}}function Jn(r){if(r.length===0)return{accuracyHistory:[],stabilityScore:0,stage:"initial",forgettingPattern:{typicalDecayDays:7,forgettingCount:0},efficiency:{attemptsToMastery:10,currentProgress:0,estimatedDaysToMastery:30}};const t=[],s=5;for(let k=0;k<r.length;k++){const D=Math.max(0,k-s+1),C=r.slice(D,k+1),w=C.filter(E=>E.wasCorrect).length/C.length*100;t.push({timestamp:r[k].timestamp,accuracy:w})}const n=r.slice(-10),a=n.map((k,D)=>{const C=Math.max(0,n.length-5),w=n.slice(C,D+1);return w.filter(E=>E.wasCorrect).length/w.length*100}),o=a.reduce((k,D)=>k+D,0)/a.length,l=a.reduce((k,D)=>k+Math.pow(D-o,2),0)/a.length,i=Math.sqrt(l),c=Math.max(0,Math.min(100,100-i/30*100)),d=n.filter(k=>k.wasCorrect).length/n.length;let m;r.length<3?m="initial":d<.3?m="struggling":d<.7&&c<50?m="improving":d>=.7&&c>=50?m="consolidating":d>=.9&&c>=80?m="mastered":m="improving";const h=r.filter(k=>!k.wasCorrect),g=h.length;let S=7;if(h.length>=2){const k=[];for(let D=1;D<h.length;D++){const C=(h[D].timestamp-h[D-1].timestamp)/864e5;k.push(C)}S=k.reduce((D,C)=>D+C,0)/k.length}const b=Math.min(100,(d*100+c)/2),y=r.length<5?10:Math.ceil(10/(b/100)),v=Math.max(1,Math.ceil((100-b)/5));return{accuracyHistory:t,stabilityScore:c,stage:m,forgettingPattern:{typicalDecayDays:S,lastForgetDate:h.length>0?h[h.length-1].timestamp:void 0,forgettingCount:g},efficiency:{attemptsToMastery:y,currentProgress:b,estimatedDaysToMastery:v}}}function Yn(r){const t=new Map;return r.forEach(s=>{if(!s.wasCorrect&&s.userAnswer){const n=s.userAnswer;if(t.has(n)){const a=t.get(n);a.frequency++,a.lastConfusion=s.timestamp}else t.set(n,{confusedWord:s.userAnswer,frequency:1,lastConfusion:s.timestamp,confusionType:"meaning",similarity:.7})}}),Array.from(t.values()).sort((s,n)=>n.frequency-s.frequency).slice(0,5)}function Xn(r,t,s){const n=t.slice(-5),a=n.length>0?n.filter(g=>g.wasCorrect).length/n.length*100:50,o=s.stabilityScore/100,l=t.length>0?(Date.now()-t[t.length-1].timestamp)/(1e3*60*60*24):0,i=t.slice(-10).filter(g=>!g.wasCorrect&&g.userAnswer),c=Math.min(1,i.length/5);let d=a;d+=o*20;const m=Math.exp(-l/s.forgettingPattern.typicalDecayDays);d*=m,d-=c*30,d=Math.max(0,Math.min(100,d));const h=Math.min(1,t.length/10);return{nextCorrectProbability:d,predictors:{recentAccuracy:a,stabilityFactor:o,timeSinceLastStudy:l,confusionRisk:c},confidence:h}}function Kn(r,t,s){const n=[];return r.forEach(a=>{const o=t[a.word],l=s.get(a.word),i=Zn(a,o,l);n.push(i)}),n.sort((a,o)=>o.priority-a.priority)}function Zn(r,t,s){if(!t||!s)return{word:r.word,priority:50,reason:"æ–°è¦å˜èª",strategy:"new_learning",estimatedSuccessRate:50,learningImpact:60};const n=s.learningCurve,a=s.predictionModel;switch(n.stage){case"struggling":return{word:r.word,priority:90,reason:`è‹¦æˆ¦ä¸­ï¼ˆæ­£ç­”ç‡${a.predictors.recentAccuracy.toFixed(0)}%ï¼‰`,strategy:"immediate_review",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:80};case"improving":{const o=a.predictors.timeSinceLastStudy,l=o>=1&&o<=3;return{word:r.word,priority:l?85:70,reason:`æ”¹å–„ä¸­ï¼ˆ${o.toFixed(1)}æ—¥çµŒéã€æˆåŠŸç‡${a.nextCorrectProbability.toFixed(0)}%ï¼‰`,strategy:l?"consolidation":"spaced_repetition",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:75}}case"consolidating":{const o=n.forgettingPattern.typicalDecayDays*.7,l=a.predictors.timeSinceLastStudy,i=Math.abs(l-o)<2;return{word:r.word,priority:i?60:40,reason:`å®šç€åŒ–ä¸­ï¼ˆæ¬¡å›å¾©ç¿’ã¾ã§${Math.max(0,o-l).toFixed(1)}æ—¥ï¼‰`,strategy:"spaced_repetition",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:50}}case"mastered":return{word:r.word,priority:20,reason:"ç¿’å¾—æ¸ˆã¿ï¼ˆé•·æœŸè¨˜æ†¶ç¢ºèªï¼‰",strategy:"spaced_repetition",estimatedSuccessRate:a.nextCorrectProbability,learningImpact:20};default:return{word:r.word,priority:50,reason:"åˆæœŸæ®µéš",strategy:"new_learning",estimatedSuccessRate:50,learningImpact:60}}}function ea(r,t){const s=r.filter(i=>i.strategy==="immediate_review");if(s.length===0)return r;const n=[],a=s.slice(0,3);n.push(...a);const o=r.filter(i=>i.strategy==="consolidation");o.length>0&&n.push(o[0]),a.length>0&&t>=10&&n.push(a[0]);const l=r.filter(i=>!n.includes(i));return n.push(...l),n.slice(0,t)}function Us(r,t){const n=(Date.now()-t)/(1e3*60),a=r.slice(-5),o=r.slice(-10),l=a.length>0?a.filter(D=>D.wasCorrect).length/a.length*100:100,i=o.length>0?o.filter(D=>D.wasCorrect).length/o.length*100:100,c=i-l>10,d=r.length>0?r.reduce((D,C)=>D+C.responseTime,0)/r.length:3e3,m=r.slice(-5).map(D=>D.responseTime),h=ta(m);let g=0;g+=Math.min(40,n*2),c&&(g+=25),h>1.3&&(g+=20),r.slice(-3).filter(D=>!D.wasCorrect).length>=2&&(g+=15),g=Math.min(100,Math.max(0,g));const b=100-g,y=new Date().getHours();let v;y>=6&&y<12?v="morning":y>=12&&y<18?v="afternoon":y>=18&&y<22?v="evening":v="night";const k=sa(g,n,c);return{fatigueLevel:g,concentrationLevel:b,recentPerformance:{last5Accuracy:l,last10Accuracy:i,isDecreasing:c,averageResponseTime:d},sessionStats:{duration:n,questionsAnswered:r.length,correctCount:r.filter(D=>D.wasCorrect).length,startTime:t},breakRecommendation:k,timeOfDay:v}}function ta(r){if(r.length<2)return 1;const t=r.slice(-3),s=r.slice(0,Math.max(1,r.length-3)),n=t.reduce((o,l)=>o+l,0)/t.length,a=s.reduce((o,l)=>o+l,0)/s.length;return a>0?n/a:1}function sa(r,t,s){if(r>=70)return{shouldBreak:!0,reason:"ç–²åŠ´ãŒè“„ç©ã—ã¦ã„ã¾ã™ã€‚5åˆ†ä¼‘æ†©ã—ã¦é›†ä¸­åŠ›ã‚’å›å¾©ã—ã¾ã—ã‚‡ã†ã€‚",suggestedDuration:5};if(t>=25&&r>=50)return{shouldBreak:!0,reason:"25åˆ†çµŒéã—ã¾ã—ãŸã€‚çŸ­ã„ä¼‘æ†©ã§åŠ¹ç‡ãŒã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚",suggestedDuration:5};if(s&&r>=40)return{shouldBreak:!0,reason:"æ­£ç­”ç‡ãŒä¸‹ãŒã£ã¦ã„ã¾ã™ã€‚ä¸€åº¦ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã—ã¾ã—ã‚‡ã†ã€‚",suggestedDuration:3}}function ra(r,t){const{fatigueLevel:s,concentrationLevel:n,timeOfDay:a,sessionStats:o}=t;return p.log(`ğŸ§  èªçŸ¥è² è·AI: ç–²åŠ´åº¦${s}%, é›†ä¸­åŠ›${n}%, æ™‚é–“å¸¯: ${a}`),s>=70?(p.log("  ğŸ’¤ ç–²åŠ´åº¦é«˜: ç°¡å˜ãªå¾©ç¿’å•é¡Œã‚’å„ªå…ˆ"),r.filter(l=>l.estimatedSuccessRate>=70||l.strategy==="spaced_repetition").map(l=>({...l,priority:l.priority+(l.estimatedSuccessRate>=80?20:0),reason:l.reason+" (ç–²åŠ´æ™‚ãƒ»æ˜“å•å„ªå…ˆ)"}))):s>=40?(p.log("  ğŸ˜ ç–²åŠ´åº¦ä¸­: ãƒãƒ©ãƒ³ã‚¹é‡è¦–"),r.map(l=>l.estimatedSuccessRate<40?{...l,priority:l.priority-20}:l)):n>=70&&o.duration<15?(p.log("  âš¡ é›†ä¸­åŠ›é«˜: æ–°è¦å˜èªãƒ»é›£å•ã‚’å„ªå…ˆ"),r.map(l=>l.strategy==="new_learning"?{...l,priority:l.priority+30,reason:l.reason+" (é›†ä¸­æ™‚ãƒ»æ–°è¦å„ªå…ˆ)"}:l.strategy==="immediate_review"&&l.estimatedSuccessRate<60?{...l,priority:l.priority+20,reason:l.reason+" (é›†ä¸­æ™‚ãƒ»é›£å•æŒ‘æˆ¦)"}:l)):na(r,a)}function na(r,t){switch(t){case"morning":return p.log("  ğŸŒ… æœ: æ–°è¦å­¦ç¿’ã‚’å„ªå…ˆ"),r.map(s=>s.strategy==="new_learning"?{...s,priority:s.priority+15,reason:s.reason+" (æœãƒ»æ–°è¦æœ€é©)"}:s);case"afternoon":return p.log("  â˜€ï¸ åˆå¾Œ: ãƒãƒ©ãƒ³ã‚¹å‹"),r;case"evening":return p.log("  ğŸŒ† å¤•æ–¹: å¾©ç¿’ä¸­å¿ƒ"),r.map(s=>s.strategy==="spaced_repetition"||s.strategy==="consolidation"?{...s,priority:s.priority+10,reason:s.reason+" (å¤•æ–¹ãƒ»å¾©ç¿’æœ€é©)"}:s);case"night":return p.log("  ğŸŒ™ å¤œ: è»½ã„å¾©ç¿’ã®ã¿"),r.filter(s=>s.strategy!=="new_learning"||s.estimatedSuccessRate>=60).map(s=>s.estimatedSuccessRate>=70?{...s,priority:s.priority+15,reason:s.reason+" (å¤œãƒ»å¾©ç¿’æ¨å¥¨)"}:s);default:return r}}function aa(r){const{fatigueLevel:t,breakRecommendation:s}=r;return s!=null&&s.shouldBreak?`ğŸ’¡ ${s.reason}`:t>=60?"ğŸ˜Œ å°‘ã—ç–²ã‚Œã¦ããŸã‹ã‚‚ã€‚ç„¡ç†ã›ãšãƒã‚¤ãƒšãƒ¼ã‚¹ã§ï¼":t<=20?"âœ¨ é›†ä¸­åŠ›ãƒãƒƒãƒãƒªï¼ã“ã®èª¿å­ã§é ‘å¼µã‚ã†ï¼":""}function ia(r,t){const s=new Map,n=[],a=[];let o=0;const l=t.slice(-10),i=l.length>0?l.filter(h=>!h.wasCorrect).length/l.length*100:0;Object.entries(r).forEach(([h,g])=>{o+=g.incorrectCount,g.learningHistory&&g.learningHistory.filter(b=>!b.wasCorrect).forEach(b=>{if(b.userAnswer&&da(h,b.userAnswer)&&s.set("similar_spelling",(s.get("similar_spelling")||0)+1),b.userAnswer){const y=n.find(v=>v.word1===h&&v.word2===b.userAnswer||v.word2===h&&v.word1===b.userAnswer);y?(y.confusionCount++,y.lastConfusion=b.timestamp):b.userAnswer!==h&&n.push({word1:h,word2:b.userAnswer,confusionCount:1,lastConfusion:b.timestamp,pattern:"confusion_pair"})}})});const c=t.slice(-5),d=c.length>0?c.filter(h=>!h.wasCorrect).length/c.length*100:0,m=d<i-10?"improving":d>i+10?"declining":"stable";return{totalErrors:o,errorsByPattern:s,confusionPairs:n.sort((h,g)=>g.confusionCount-h.confusionCount),weakCategories:a,recentErrorRate:i,errorTrend:m}}function oa(r,t,s,n,a){const o=[];let l=30;if(t){const g=t.correctCount+t.incorrectCount;if(g>0){const S=t.incorrectCount/g*100;S>50&&(l+=30,o.push({type:"category_weakness",weight:.3,description:"ã“ã®å˜èªã®éå»ã®èª¤ç­”ç‡ãŒé«˜ã„",evidence:[`èª¤ç­”ç‡: ${S.toFixed(0)}%`]}))}if(t.learningHistory&&t.learningHistory.length>0){const S=t.learningHistory.slice(-3),b=S.filter(y=>!y.wasCorrect).length/S.length*100;b>66&&(l+=25,o.push({type:"timing_based",weight:.25,description:"æœ€è¿‘3å›ã®ã†ã¡2å›ä»¥ä¸Šé–“é•ãˆã¦ã„ã‚‹",evidence:[`ç›´è¿‘3å›ã®èª¤ç­”ç‡: ${b.toFixed(0)}%`]}))}if(t.lastStudied){const S=(Date.now()-t.lastStudied)/864e5;if(S>7){const b=Math.min(20,S*2);l+=b,o.push({type:"timing_based",weight:b/100,description:"å‰å›ã®å¾©ç¿’ã‹ã‚‰æ™‚é–“ãŒçµŒéã—ã¦ã„ã‚‹",evidence:[`${S.toFixed(1)}æ—¥å‰ã«å¾©ç¿’`]})}}}else l+=20,o.push({type:"category_weakness",weight:.2,description:"ã¾ã å­¦ç¿’ã—ãŸã“ã¨ãŒãªã„å˜èª",evidence:["åˆè¦‹"]});const i=s.confusionPairs.find(g=>g.word1===r||g.word2===r);if(i&&i.confusionCount>=2){l+=15;const g=i.word1===r?i.word2:i.word1;o.push({type:"confusion_pair",weight:.15,description:`"${g}"ã¨æ··åŒã—ã‚„ã™ã„`,evidence:[`${i.confusionCount}å›æ··åŒ`]})}if(n>60){const g=(n-60)/2;l+=g,o.push({type:"timing_based",weight:g/100,description:"ç–²åŠ´ã«ã‚ˆã‚Šé›†ä¸­åŠ›ãŒä½ä¸‹ã—ã¦ã„ã‚‹",evidence:[`ç–²åŠ´åº¦: ${n.toFixed(0)}%`]})}s.errorTrend==="declining"&&(l+=10,o.push({type:"category_weakness",weight:.1,description:"å…¨ä½“çš„ã«èª¤ç­”ç‡ãŒä¸Šæ˜‡å‚¾å‘",evidence:[`æœ€è¿‘10å•ã®èª¤ç­”ç‡: ${s.recentErrorRate.toFixed(0)}%`]}));const c=Math.min(100,Math.max(0,l)),d=c>=80?"critical":c>=60?"high":c>=40?"medium":"low",m=la(r,c,d,o,i),h=ca(t,o.length);return{word:r,errorRisk:c,confidence:h,primaryPattern:o.length>0?o[0].type:"category_weakness",riskFactors:o,warningLevel:d,suggestedSupport:m}}function la(r,t,s,n,a){const o=[],l=[];let i="",c="";return s==="critical"?(i=`âš ï¸ æ³¨æ„: ã“ã®å•é¡Œã¯é–“é•ãˆã‚„ã™ã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆãƒªã‚¹ã‚¯: ${t.toFixed(0)}%ï¼‰`,c="è½ã¡ç€ã„ã¦ã€ã—ã£ã‹ã‚Šè€ƒãˆã¦ã‹ã‚‰ç­”ãˆã¾ã—ã‚‡ã†ï¼"):s==="high"?(i=`ğŸ”” ã“ã®å•é¡Œã¯å°‘ã—é›£ã—ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼ˆãƒªã‚¹ã‚¯: ${t.toFixed(0)}%ï¼‰`,c="ã‚†ã£ãã‚Šè€ƒãˆã‚Œã°å¤§ä¸ˆå¤«ã§ã™ï¼"):s==="medium"&&(i=`ğŸ’¡ æ…é‡ã«ç­”ãˆã¦ãã ã•ã„ï¼ˆãƒªã‚¹ã‚¯: ${t.toFixed(0)}%ï¼‰`,c="è½ã¡ç€ã„ã¦å–ã‚Šçµ„ã¿ã¾ã—ã‚‡ã†ï¼"),n.forEach(d=>{switch(d.type){case"confusion_pair":if(a){const m=a.word1===r?a.word2:a.word1;o.push(`"${m}"ã¨æ··åŒã—ãªã„ã‚ˆã†ã«æ³¨æ„`),l.push(m)}break;case"similar_spelling":o.push("ç¶´ã‚Šã‚’ã‚ˆãç¢ºèªã—ã¾ã—ã‚‡ã†");break;case"timing_based":d.description.includes("æ™‚é–“ãŒçµŒé")?o.push("å‰å›ã®å¾©ç¿’ã‹ã‚‰æ™‚é–“ãŒçµŒã£ã¦ã„ã¾ã™ã€‚æ„å‘³ã‚’æ€ã„å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†"):d.description.includes("ç–²åŠ´")&&o.push("ç–²ã‚Œã¦ã„ã‚‹ã¨ãã¯ç„¦ã‚‰ãšã€ã‚†ã£ãã‚Šè€ƒãˆã¾ã—ã‚‡ã†");break;case"category_weakness":o.push("ã“ã®å˜èªã¯éå»ã«é–“é•ãˆã¦ã„ã¾ã™ã€‚æ…é‡ã«ï¼");break}}),{showWarning:s!=="low",warningMessage:i,hints:o.slice(0,2),reviewWords:l,confidenceBooster:c}}function ca(r,t){let s=50;if(r){const n=r.correctCount+r.incorrectCount;s+=Math.min(30,n*5),r.learningHistory&&r.learningHistory.length>=3&&(s+=10)}return s+=Math.min(10,t*3),Math.min(100,s)}function da(r,t){const s=ua(r.toLowerCase(),t.toLowerCase());return s>0&&s<=2}function ua(r,t){const s=[];for(let n=0;n<=t.length;n++)s[n]=[n];for(let n=0;n<=r.length;n++)s[0][n]=n;for(let n=1;n<=t.length;n++)for(let a=1;a<=r.length;a++)t.charAt(n-1)===r.charAt(a-1)?s[n][a]=s[n-1][a-1]:s[n][a]=Math.min(s[n-1][a-1]+1,s[n][a-1]+1,s[n-1][a]+1);return s[t.length][r.length]}function ma(r,t,s,n,a){const o=new Map;return r.forEach(l=>{const i=oa(l,t[l],s,n);o.set(l,i)}),o}const Cr={emotions:{name:"æ„Ÿæƒ…",keywords:["happy","sad","angry","excited","worried","nervous","calm","joy","fear","love","hate","surprise"],relatedCategories:["å½¢å®¹è©"]},movement:{name:"å‹•ä½œãƒ»ç§»å‹•",keywords:["walk","run","jump","fly","swim","climb","move","go","come","enter","leave","return"],relatedCategories:["å‹•è©"]},time:{name:"æ™‚é–“",keywords:["day","night","morning","evening","week","month","year","today","tomorrow","yesterday","always","never","sometimes"],relatedCategories:["åè©","å‰¯è©"]},weather:{name:"å¤©æ°—",keywords:["sunny","rainy","cloudy","windy","snowy","hot","cold","warm","cool","weather","temperature"],relatedCategories:["å½¢å®¹è©","åè©"]},food:{name:"é£Ÿã¹ç‰©",keywords:["food","eat","drink","cook","meal","breakfast","lunch","dinner","hungry","thirsty","delicious"],relatedCategories:["åè©","å‹•è©","å½¢å®¹è©"]},nature:{name:"è‡ªç„¶",keywords:["tree","flower","mountain","river","sea","sky","sun","moon","star","nature","plant","animal"],relatedCategories:["åè©"]},family:{name:"å®¶æ—ãƒ»äººé–“é–¢ä¿‚",keywords:["family","father","mother","brother","sister","parent","child","friend","teacher","student"],relatedCategories:["åè©"]},size:{name:"å¤§ãã•ãƒ»ç¨‹åº¦",keywords:["big","small","large","tiny","huge","long","short","tall","high","low","wide","narrow"],relatedCategories:["å½¢å®¹è©"]},communication:{name:"ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",keywords:["say","speak","talk","tell","ask","answer","listen","hear","write","read","call","email"],relatedCategories:["å‹•è©"]},learning:{name:"å­¦ç¿’",keywords:["learn","study","teach","understand","know","remember","forget","practice","improve","test","exam"],relatedCategories:["å‹•è©","åè©"]}},Dr=[["big","small"],["large","small"],["long","short"],["tall","short"],["high","low"],["wide","narrow"],["deep","shallow"],["heavy","light"],["strong","weak"],["hard","soft"],["hot","cold"],["warm","cool"],["fast","slow"],["quick","slow"],["early","late"],["young","old"],["new","old"],["happy","sad"],["good","bad"],["right","wrong"],["easy","difficult"],["simple","complex"],["start","end"],["begin","finish"],["open","close"],["love","hate"],["day","night"],["morning","evening"],["always","never"],["often","rarely"],["many","few"],["much","little"],["more","less"],["increase","decrease"],["rise","fall"],["up","down"],["front","back"],["before","after"],["first","last"],["enter","leave"],["come","go"],["push","pull"],["give","take"],["buy","sell"],["win","lose"],["remember","forget"],["find","lose"]],Mr=[["big","large","huge","enormous"],["small","little","tiny"],["happy","glad","joyful","pleased"],["sad","unhappy","sorrowful"],["angry","mad","furious"],["beautiful","pretty","lovely"],["ugly","unattractive"],["important","significant","essential"],["difficult","hard","tough","challenging"],["easy","simple"],["fast","quick","rapid","swift"],["slow","sluggish"],["smart","intelligent","clever","bright"],["stupid","foolish","dumb"],["funny","amusing","humorous"],["boring","dull","tedious"],["interesting","fascinating","engaging"],["tired","exhausted","weary"],["afraid","scared","frightened","terrified"],["brave","courageous","bold"],["kind","nice","gentle","friendly"],["mean","cruel","unkind"],["rich","wealthy","affluent"],["poor","needy"],["famous","well-known","renowned"],["strange","odd","weird","unusual"],["normal","ordinary","common","typical"]];function ha(r,t){const s=[],n=new Set;Object.entries(Cr).forEach(([o,l])=>{const i=r.filter(c=>{const d=c.word.toLowerCase(),m=c.meaning.toLowerCase();return l.keywords.some(h=>d.includes(h)||m.includes(h))&&!n.has(c.word)}).map(c=>c.word);if(i.length>=2){i.forEach(m=>n.add(m));const d=50+i.filter(m=>{const h=t[m];return h&&h.incorrectCount>h.correctCount}).length/i.length*50;s.push({id:`theme_${o}`,name:l.name,theme:o,words:i,relationType:"theme",priority:d})}}),Dr.forEach((o,l)=>{const[i,c]=o,d=r.filter(m=>{const h=m.word.toLowerCase();return(h===i||h===c)&&!n.has(m.word)}).map(m=>m.word);d.length===2&&(d.forEach(m=>n.add(m)),s.push({id:`antonym_${l}`,name:`å¯¾ç¾©èª: ${i} â‡” ${c}`,theme:"antonyms",words:d,relationType:"antonym",priority:70}))}),Mr.forEach((o,l)=>{const i=r.filter(c=>{const d=c.word.toLowerCase();return o.includes(d)&&!n.has(c.word)}).map(c=>c.word);i.length>=2&&(i.forEach(c=>n.add(c)),s.push({id:`synonym_${l}`,name:`é¡ç¾©èª: ${o.join(", ")}`,theme:"synonyms",words:i,relationType:"synonym",priority:60}))});const a=new Map;return r.forEach(o=>{if(!n.has(o.word)&&o.category){const l=a.get(o.category)||[];l.push(o.word),a.set(o.category,l)}}),a.forEach((o,l)=>{o.length>=3&&(o.forEach(i=>n.add(i)),s.push({id:`category_${l}`,name:`ã‚«ãƒ†ã‚´ãƒªãƒ¼: ${l}`,theme:l,words:o,relationType:"category",priority:40}))}),s.sort((o,l)=>l.priority-o.priority)}function ga(r,t){const s=r.toLowerCase(),n=t.toLowerCase();for(const a of Dr)if(a[0]===s&&a[1]===n||a[0]===n&&a[1]===s)return{word1:r,word2:t,relationType:"antonym",strength:.9,description:`"${r}"ã¨"${t}"ã¯å¯¾ç¾©èª`};for(const a of Mr)if(a.includes(s)&&a.includes(n))return{word1:r,word2:t,relationType:"synonym",strength:.8,description:`"${r}"ã¨"${t}"ã¯é¡ç¾©èª`};for(const[,a]of Object.entries(Cr)){const o=a.keywords.some(i=>s.includes(i)||i.includes(s)),l=a.keywords.some(i=>n.includes(i)||i.includes(n));if(o&&l)return{word1:r,word2:t,relationType:"theme",strength:.6,description:`"${r}"ã¨"${t}"ã¯åŒã˜ãƒ†ãƒ¼ãƒï¼ˆ${a.name}ï¼‰`}}return null}function pa(r,t,s=[]){const n=ha(r,t),a=[],o=[],l=new Set;return s.forEach(i=>l.add(i)),n.forEach(i=>{const c=i.words.filter(m=>!l.has(m));if(c.length===0)return;c.sort((m,h)=>{const g=t[m],S=t[h];if(!g&&!S)return 0;if(!g)return-1;if(!S)return 1;const b=g.incorrectCount/(g.correctCount+g.incorrectCount||1);return S.incorrectCount/(S.correctCount+S.incorrectCount||1)-b}).forEach(m=>{if(l.has(m))return;const h=a[a.length-1];if(h){const g=ga(h,m);o.push({from:h,to:m,reason:g?g.description:`åŒã˜ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ï¼ˆ${i.name}ï¼‰`})}a.push(m),l.add(m)})}),r.forEach(i=>{l.has(i.word)||(a.push(i.word),l.add(i.word))}),{clusters:n,sequence:a,transitions:o}}function Ir(r=Date.now()){const t=new Date(r).getHours();return t>=5&&t<12?"morning":t>=12&&t<17?"afternoon":t>=17&&t<21?"evening":"night"}function fa(r,t,s,n,a,o,l,i){const c=(t-r)/6e4,d=s>0?n/s*100:0;return{sessionId:`session_${r}`,startTime:r,endTime:t,duration:c,timeOfDay:Ir(r),questionsAnswered:s,correctAnswers:n,accuracy:d,averageResponseTime:a,fatigueLevel:o,newWordsLearned:l,reviewedWords:i}}function xa(r){return["morning","afternoon","evening","night"].map(s=>{const n=r.filter(y=>y.timeOfDay===s);if(n.length===0)return{timeOfDay:s,sessionCount:0,totalQuestions:0,averageAccuracy:0,averageResponseTime:0,averageFatigue:0,efficiencyScore:0,bestForNewLearning:!1,bestForReview:!1};const a=n.reduce((y,v)=>y+v.questionsAnswered,0),l=n.reduce((y,v)=>y+v.correctAnswers,0)/a*100,i=n.reduce((y,v)=>y+v.averageResponseTime,0)/n.length,c=n.reduce((y,v)=>y+v.fatigueLevel,0)/n.length,d=n.reduce((y,v)=>y+v.newWordsLearned,0),m=n.reduce((y,v)=>y+v.reviewedWords,0),h=l,g=Math.max(0,100-i/50),S=100-c,b=h*.4+g*.3+S*.3;return{timeOfDay:s,sessionCount:n.length,totalQuestions:a,averageAccuracy:l,averageResponseTime:i,averageFatigue:c,efficiencyScore:b,bestForNewLearning:d>m,bestForReview:m>=d}}).sort((s,n)=>n.efficiencyScore-s.efficiencyScore)}function ya(r){if(r.length===0)return{optimalDuration:15,currentAverageDuration:0,performanceByDuration:[],recommendation:"å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚ã¾ãšã¯15åˆ†ç¨‹åº¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚"};const t=r.reduce((i,c)=>i+c.duration,0)/r.length,n=[{min:0,max:5,label:"0-5åˆ†"},{min:5,max:10,label:"5-10åˆ†"},{min:10,max:15,label:"10-15åˆ†"},{min:15,max:20,label:"15-20åˆ†"},{min:20,max:30,label:"20-30åˆ†"},{min:30,max:999,label:"30åˆ†ä»¥ä¸Š"}].map(i=>{const c=r.filter(g=>g.duration>=i.min&&g.duration<i.max);if(c.length===0)return{durationRange:i.label,accuracy:0,efficiency:0};const d=c.reduce((g,S)=>g+S.accuracy,0)/c.length,m=c.reduce((g,S)=>g+S.fatigueLevel,0)/c.length,h=d-m*.5;return{durationRange:i.label,accuracy:d,efficiency:h}}).filter(i=>i.efficiency>0),a=n.reduce((i,c)=>c.efficiency>i.efficiency?c:i,n[0]||{durationRange:"10-15åˆ†",efficiency:0}),o=a?parseInt(a.durationRange.split("-")[0])+5:15;let l="";return o<10?l=`çŸ­æœŸé›†ä¸­å‹ã®å­¦ç¿’ãŒåŠ¹æœçš„ã§ã™ã€‚${o}åˆ†ç¨‹åº¦ã®çŸ­ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’1æ—¥è¤‡æ•°å›è¡Œã†ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚`:o<20?l=`${o}åˆ†ç¨‹åº¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæœ€ã‚‚åŠ¹ç‡çš„ã§ã™ã€‚ã“ã®é•·ã•ã‚’ç›®å®‰ã«å­¦ç¿’ã‚’ç¶šã‘ã¾ã—ã‚‡ã†ã€‚`:l=`é•·æ™‚é–“ã®å­¦ç¿’ãŒå¾—æ„ãªã‚ˆã†ã§ã™ã€‚${o}åˆ†ç¨‹åº¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§æ·±ã„å­¦ç¿’ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€ç–²åŠ´ã«æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚`,{optimalDuration:o,currentAverageDuration:t,performanceByDuration:n,recommendation:l}}function va(r){if(r.length<5)return"moderate";const t=r.reduce((a,o)=>a+o.duration,0)/r.length,s=new Set(r.map(a=>new Date(a.startTime).toDateString())),n=r.length/s.size;return t<10&&n>=2?"distributed":t<10?"short_burst":t<20?"moderate":"extended"}function wa(r,t){var g,S,b;const s=va(t),n=xa(t),a=ya(t),o=((g=n[0])==null?void 0:g.timeOfDay)||"morning",l=a.optimalDuration;let i=1;s==="distributed"||s==="short_burst"?i=3:s==="moderate"&&(i=2);const c=[],d=[];((S=n[0])==null?void 0:S.averageAccuracy)>80&&c.push(`${n[0].timeOfDay}ã®å­¦ç¿’ãŒå¾—æ„ï¼ˆæ­£ç­”ç‡${n[0].averageAccuracy.toFixed(0)}%ï¼‰`),s==="distributed"?c.push("åˆ†æ•£å­¦ç¿’ã«ã‚ˆã‚Šè¨˜æ†¶ã®å®šç€ãŒè‰¯å¥½"):s==="extended"&&c.push("é•·æ™‚é–“ã®é›†ä¸­å­¦ç¿’ãŒå¯èƒ½"),t.reduce((y,v)=>y+v.fatigueLevel,0)/t.length>60&&d.push("ç–²åŠ´ãƒ¬ãƒ™ãƒ«ãŒé«˜ã‚ã€‚ä¼‘æ†©ã‚’å¢—ã‚„ã™ã‹ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³æ™‚é–“ã‚’çŸ­ç¸®ã—ã¦ã¿ã¾ã—ã‚‡ã†"),((b=n[n.length-1])==null?void 0:b.averageAccuracy)<60&&d.push(`${n[n.length-1].timeOfDay}ã®å­¦ç¿’åŠ¹ç‡ãŒä½ã„ãŸã‚ã€é¿ã‘ã‚‹ã“ã¨ã‚’æ¨å¥¨`);const h=[];return h.push(`æœ€é©ãªå­¦ç¿’æ™‚é–“å¸¯: ${o==="morning"?"æœ":o==="afternoon"?"åˆå¾Œ":o==="evening"?"å¤•æ–¹":"å¤œ"}`),h.push(`æ¨å¥¨ã‚»ãƒƒã‚·ãƒ§ãƒ³é•·: ${l}åˆ†`),h.push(`1æ—¥ã®æ¨å¥¨å­¦ç¿’å›æ•°: ${i}å›`),s==="distributed"?h.push("çŸ­ã„å­¦ç¿’ã‚’è¤‡æ•°å›è¡Œã†ã‚¹ã‚¿ã‚¤ãƒ«ãŒåŠ¹æœçš„ã§ã™ã€‚æœãƒ»æ˜¼ãƒ»å¤œã«åˆ†ã‘ã¦å­¦ç¿’ã—ã¾ã—ã‚‡ã†"):s==="extended"&&h.push("é•·æ™‚é–“ã®å­¦ç¿’ãŒå¾—æ„ã§ã™ã€‚é€±æœ«ãªã©ã«ã¾ã¨ã‚ã¦å­¦ç¿’ã™ã‚‹æ–¹æ³•ã‚‚æœ‰åŠ¹ã§ã™"),{userId:r,primaryStyle:s,bestTimeOfDay:o,optimalSessionLength:l,optimalDailyFrequency:i,strengths:c,improvements:d,personalizedRecommendations:h}}function ba(r){try{const t="learning-style-sessions",s=localStorage.getItem(t),n=s?JSON.parse(s):[];n.push(r);const a=n.slice(-100);localStorage.setItem(t,JSON.stringify(a))}catch(t){p.error("Failed to save session history:",t)}}function ja(){try{const t=localStorage.getItem("learning-style-sessions");return t?JSON.parse(t):[]}catch(r){return p.error("Failed to load session history:",r),[]}}function Na(r,t){const s=t===r.bestTimeOfDay,n={morning:"æœ",afternoon:"åˆå¾Œ",evening:"å¤•æ–¹",night:"å¤œ"};return s?`âœ¨ ä»Šã¯${n[t]}ã§ã™ã€‚ã‚ãªãŸã®æœ€ã‚‚å­¦ç¿’åŠ¹ç‡ãŒé«˜ã„æ™‚é–“å¸¯ã§ã™ï¼${r.optimalSessionLength}åˆ†ç¨‹åº¦ã®å­¦ç¿’ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚`:`ğŸ’¡ ${n[r.bestTimeOfDay]}ã®å­¦ç¿’ãŒæœ€ã‚‚åŠ¹æœçš„ã§ã™ã€‚ç¾åœ¨ã¯${n[t]}ãªã®ã§ã€è»½ã‚ã®å¾©ç¿’ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚`}const Sa={first_session:{type:"first_session",name:"å­¦ç¿’é–‹å§‹",description:"åˆã‚ã¦ã®å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å®Œäº†",icon:"ğŸ“",rarity:"common"},streak_3_days:{type:"streak_3_days",name:"ä¸‰æ—¥åŠä¸»å…‹æœ",description:"3æ—¥é€£ç¶šã§å­¦ç¿’",icon:"ğŸ”¥",rarity:"common"},streak_7_days:{type:"streak_7_days",name:"ä¸€é€±é–“ã®ç¿’æ…£",description:"7æ—¥é€£ç¶šã§å­¦ç¿’",icon:"â­",rarity:"rare"},streak_30_days:{type:"streak_30_days",name:"ç¿’æ…£ã®é”äºº",description:"30æ—¥é€£ç¶šã§å­¦ç¿’",icon:"ğŸ†",rarity:"epic"},total_100_words:{type:"total_100_words",name:"ç™¾å˜èª",description:"ç´¯è¨ˆ100å˜èªã‚’å­¦ç¿’",icon:"ğŸ“š",rarity:"common"},total_500_words:{type:"total_500_words",name:"äº”ç™¾å˜èª",description:"ç´¯è¨ˆ500å˜èªã‚’å­¦ç¿’",icon:"ğŸ“–",rarity:"rare"},total_1000_words:{type:"total_1000_words",name:"åƒå˜èªãƒã‚¹ã‚¿ãƒ¼",description:"ç´¯è¨ˆ1000å˜èªã‚’å­¦ç¿’",icon:"ğŸ–ï¸",rarity:"epic"},perfect_session:{type:"perfect_session",name:"ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆ",description:"1ã‚»ãƒƒã‚·ãƒ§ãƒ³å…¨å•æ­£è§£",icon:"ğŸ’¯",rarity:"rare"},accuracy_90:{type:"accuracy_90",name:"é«˜ç²¾åº¦",description:"æ­£ç­”ç‡90%ä»¥ä¸Šã‚’10å›é”æˆ",icon:"ğŸ¯",rarity:"rare"},accuracy_95:{type:"accuracy_95",name:"è¶…é«˜ç²¾åº¦",description:"æ­£ç­”ç‡95%ä»¥ä¸Šã‚’10å›é”æˆ",icon:"ğŸ’",rarity:"epic"},early_bird:{type:"early_bird",name:"æ—©èµ·ãé³¥",description:"æœï¼ˆ6-9æ™‚ï¼‰ã«5å›å­¦ç¿’",icon:"ğŸŒ…",rarity:"common"},night_owl:{type:"night_owl",name:"å¤œå‹å­¦ç¿’",description:"å¤œï¼ˆ21-24æ™‚ï¼‰ã«5å›å­¦ç¿’",icon:"ğŸŒ™",rarity:"common"},speed_master:{type:"speed_master",name:"ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒã‚¹ã‚¿ãƒ¼",description:"å¹³å‡å¿œç­”æ™‚é–“2ç§’ä»¥ä¸‹ã‚’10å›é”æˆ",icon:"âš¡",rarity:"rare"},review_champion:{type:"review_champion",name:"å¾©ç¿’ãƒãƒ£ãƒ³ãƒ”ã‚ªãƒ³",description:"è¦å¾©ç¿’å˜èª50å€‹ã‚’ãƒã‚¹ã‚¿ãƒ¼",icon:"â™»ï¸",rarity:"rare"},master_100:{type:"master_100",name:"ç™¾å˜èªãƒã‚¹ã‚¿ãƒ¼",description:"100å˜èªã‚’å®Œå…¨ç¿’å¾—",icon:"ğŸ‘‘",rarity:"epic"},comeback:{type:"comeback",name:"ã‚«ãƒ ãƒãƒƒã‚¯",description:"1é€±é–“ä»¥ä¸Šã®ä¸­æ–­å¾Œã«å†é–‹",icon:"ğŸ’ª",rarity:"common"},marathon:{type:"marathon",name:"ãƒãƒ©ã‚½ãƒ³ãƒ©ãƒ³ãƒŠãƒ¼",description:"1æ™‚é–“ä»¥ä¸Šã®å­¦ç¿’ã‚»ãƒƒã‚·ãƒ§ãƒ³",icon:"ğŸƒ",rarity:"rare"},focused:{type:"focused",name:"é›†ä¸­åŠ›ã®æ¥µã¿",description:"é›†ä¸­åŠ›ã®é«˜ã„å­¦ç¿’ã‚’10å›",icon:"ğŸ§˜",rarity:"rare"}},Ar=r=>Math.floor(100*Math.pow(1.15,r-1)),wt={CORRECT_ANSWER:10,PERFECT_SESSION:100,STREAK_BONUS_PER_DAY:5,SESSION_COMPLETION:50,BADGE_EARNED:200},Rr=()=>{const r=localStorage.getItem("gamificationStats");if(r){const t=JSON.parse(r);return t.lastSessionDate&&(t.lastSessionDate=new Date(t.lastSessionDate)),t.badges=t.badges.map(s=>({...s,earnedAt:s.earnedAt?new Date(s.earnedAt):void 0})),t.milestones=t.milestones.map(s=>({...s,completedAt:s.completedAt?new Date(s.completedAt):void 0})),t.challenges=t.challenges.map(s=>({...s,startDate:new Date(s.startDate),endDate:new Date(s.endDate)})),t}return{level:{level:1,currentXP:0,requiredXP:Ar(1),totalXP:0},badges:[],streak:{current:0,longest:0,lastStudyDate:""},milestones:Ca(),challenges:[],totalSessions:0,totalWordsLearned:0,totalCorrectAnswers:0,averageAccuracy:0}},ka=r=>{localStorage.setItem("gamificationStats",JSON.stringify(r))},Ca=()=>[{id:"first_10_words",title:"æœ€åˆã®10å˜èª",description:"10å˜èªã‚’å­¦ç¿’ã™ã‚‹",target:10,current:0,reward:{xp:100},completed:!1},{id:"first_50_words",title:"50å˜èªé”æˆ",description:"50å˜èªã‚’å­¦ç¿’ã™ã‚‹",target:50,current:0,reward:{xp:300,badge:"total_100_words"},completed:!1},{id:"accuracy_80",title:"æ­£ç­”ç‡80%",description:"æ­£ç­”ç‡80%ä»¥ä¸Šã‚’é”æˆ",target:80,current:0,reward:{xp:200},completed:!1}],Da=(r,t)=>{const s={...r};s.level.currentXP+=t,s.level.totalXP+=t;let n=!1,a;for(;s.level.currentXP>=s.level.requiredXP;)s.level.currentXP-=s.level.requiredXP,s.level.level+=1,s.level.requiredXP=Ar(s.level.level),n=!0,a=s.level.level;return{stats:s,leveledUp:n,newLevel:a}},Ma=r=>{const t=new Date().toISOString().split("T")[0],s=r.streak.lastStudyDate;if(!s)return{...r,streak:{current:1,longest:1,lastStudyDate:t}};if(s===t)return r;const n=new Date;n.setDate(n.getDate()-1);const a=n.toISOString().split("T")[0];if(s===a){const o=r.streak.current+1;return{...r,streak:{current:o,longest:Math.max(o,r.streak.longest),lastStudyDate:t}}}else return{...r,streak:{current:1,longest:r.streak.longest,lastStudyDate:t}}},Ia=(r,t)=>{const s=[],n=new Set(r.badges.map(i=>i.type)),a=i=>{if(!n.has(i)){const c={...Sa[i],earnedAt:new Date};s.push(c),n.add(i)}};r.totalSessions===1&&!n.has("first_session")&&a("first_session"),r.streak.current>=3&&a("streak_3_days"),r.streak.current>=7&&a("streak_7_days"),r.streak.current>=30&&a("streak_30_days"),r.totalWordsLearned>=100&&a("total_100_words"),r.totalWordsLearned>=500&&a("total_500_words"),r.totalWordsLearned>=1e3&&a("total_1000_words"),t.perfectScore&&a("perfect_session");const o=r.totalSessions;return t.accuracy>=90&&o>=10&&a("accuracy_90"),t.accuracy>=95&&o>=10&&a("accuracy_95"),t.timeOfDay==="morning"&&r.totalSessions>=5&&a("early_bird"),t.timeOfDay==="night"&&r.totalSessions>=5&&a("night_owl"),t.avgResponseTime<=2e3&&r.totalSessions>=10&&a("speed_master"),t.sessionDuration>=60&&a("marathon"),t.focused&&r.totalSessions>=10&&a("focused"),r.lastSessionDate&&(new Date().getTime()-r.lastSessionDate.getTime())/864e5>=7&&a("comeback"),{stats:{...r,badges:[...r.badges,...s]},newBadges:s}},Aa=r=>{const t=[],s=r.milestones.map(n=>{if(n.completed)return n;let a=n.current;if(n.id.includes("words")?a=r.totalWordsLearned:n.id.includes("accuracy")&&(a=r.averageAccuracy),a>=n.target&&!n.completed){const l={...n,current:a,completed:!0,completedAt:new Date};return t.push(l),l}return{...n,current:a}});return{stats:{...r,milestones:s},completedMilestones:t}},Ra=(r,t,s,n,a,o)=>{let l=Rr();const i=[];let c=0;l.totalSessions+=1,l.totalWordsLearned+=a,l.totalCorrectAnswers+=r,l.averageAccuracy=(l.averageAccuracy*(l.totalSessions-1)+r/t*100)/l.totalSessions,l.lastSessionDate=new Date;const d=l.streak.current;l=Ma(l),l.streak.current>d&&(i.push({type:"streak",message:`ğŸ”¥ ${l.streak.current}æ—¥é€£ç¶šå­¦ç¿’ï¼`,icon:"ğŸ”¥",priority:4}),c+=wt.STREAK_BONUS_PER_DAY*l.streak.current);const m=r/t*100,h=r===t;c+=r*wt.CORRECT_ANSWER,c+=wt.SESSION_COMPLETION,h&&(c+=wt.PERFECT_SESSION,i.push({type:"praise",message:"ğŸ’¯ ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆï¼å…¨å•æ­£è§£ã§ã™ï¼",icon:"ğŸ’¯",priority:5}));const g=new Date().getHours();let S;g>=6&&g<12?S="morning":g>=12&&g<18?S="afternoon":g>=18&&g<21?S="evening":S="night";const b=o<.3,y=Ia(l,{accuracy:m,avgResponseTime:s,perfectScore:h,timeOfDay:S,sessionDuration:n,focused:b});l=y.stats,y.newBadges.length>0&&y.newBadges.forEach(D=>{i.push({type:"milestone",message:`ğŸ–ï¸ ãƒãƒƒã‚¸ç²å¾—: ${D.name}`,icon:D.icon,priority:5}),c+=wt.BADGE_EARNED});const v=Aa(l);l=v.stats,v.completedMilestones.length>0&&v.completedMilestones.forEach(D=>{i.push({type:"milestone",message:`ğŸ¯ ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³é”æˆ: ${D.title}`,icon:"ğŸ¯",priority:4}),c+=D.reward.xp});const k=Da(l,c);return l=k.stats,k.leveledUp&&k.newLevel&&i.push({type:"level_up",message:`â­ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼ Lv.${k.newLevel}`,icon:"â­",priority:5}),m<50?i.push({type:"encouragement",message:"ğŸ’ª ç„¦ã‚‰ãšå¾©ç¿’ã—ã¾ã—ã‚‡ã†ï¼ç¶™ç¶šãŒå¤§åˆ‡ã§ã™",icon:"ğŸ’ª",priority:2}):m>=50&&m<80?i.push({type:"encouragement",message:"ğŸ‘ è‰¯ã„ãƒšãƒ¼ã‚¹ã§ã™ï¼ã“ã®èª¿å­ã§ï¼",icon:"ğŸ‘",priority:2}):m>=80&&m<95&&i.push({type:"praise",message:"ğŸŒŸ ç´ æ™´ã‚‰ã—ã„ï¼é«˜ã„æ­£ç­”ç‡ã§ã™",icon:"ğŸŒŸ",priority:3}),ka(l),{stats:l,feedback:i.sort((D,C)=>C.priority-D.priority),xpGained:c,leveledUp:k.leveledUp,newLevel:k.newLevel}},Pa=()=>{const r=Rr(),t=[];return r.streak.current>0&&t.push(`ğŸ”¥ ${r.streak.current}æ—¥é€£ç¶šå­¦ç¿’ä¸­ï¼`),r.level.level>1&&t.push(`â­ ãƒ¬ãƒ™ãƒ« ${r.level.level}`),r.level.currentXP/r.level.requiredXP*100>80&&t.push("æ¬¡ã®ãƒ¬ãƒ™ãƒ«ã¾ã§ã‚ã¨å°‘ã—ï¼"),t.length===0&&t.push("ä»Šæ—¥ã‚‚å­¦ç¿’ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼"),t.join(" | ")},Tt=Object.freeze(Object.defineProperty({__proto__:null,addQuizResult:St,addSessionHistory:yt,checkFlexibleMastery:Yt,createWeakWordsQuestionSet:Ft,filterSkippedWords:ws,getAllWordProgress:ht,getConfusedWords:js,getCumulativeProgressData:Cs,getCurrentWeakWords:Jt,getCustomQuestionSets:Zt,getDetailedRetentionStats:_t,getGrammarDetailedRetentionStats:Lt,getGrammarRetentionRateWithAI:Qt,getGrammarUnitStats:fs,getGrammarUnitStatsWithTitles:Ts,getMemorizationCardSettings:Is,getMemorizationDetailedRetentionStats:Nt,getMemorizationSettings:Rs,getMonthlyStats:gs,getNearMasteryStats:lr,getOvercomeWeakWords:ys,getRecentlyMasteredWords:ps,getRetentionRateWithAI:Ot,getRetentionTrend:Ds,getStudyCalendarData:ks,getStudySettings:ms,getTodayIncorrectWords:$t,getTodayStats:Et,getTotalAnsweredCount:Ns,getTotalMasteredWordsCount:Kt,getUniqueQuestionedWordsCount:ur,getWeeklyStats:hs,getWordDetailedData:qt,getWordProgress:Wt,isWordSkipExcluded:vs,loadProgress:et,loadProgressSync:Me,recordConfusion:bs,recordMemorizationBehavior:Ps,recordWordSkip:Xt,resetAllProgress:Ss,saveCustomQuestionSet:zt,saveMemorizationCardSettings:Ms,saveMemorizationSettings:As,saveProgress:at,updateProgressCache:nt,updateWordProgress:mt},Symbol.toStringTag,{value:"Module"}));function ot(r){return r[Math.floor(Math.random()*r.length)]}function Ta(){const r=localStorage.getItem("progress-data");if(!r)return{totalSessions:0,averageAccuracy:0,strongCategories:[],weakCategories:[],recentImprovement:!1,consistencyScore:0};try{const s=JSON.parse(r).results||[],n=s.slice(-10),a=n.length>0?n.reduce((y,v)=>y+v.score/v.total*100,0)/n.length:0,o=new Map;s.forEach(y=>{if(y.category){const v=o.get(y.category)||{correct:0,total:0};v.correct+=y.score,v.total+=y.total,o.set(y.category,v)}});const l=[],i=[];o.forEach((y,v)=>{const k=y.total>0?y.correct/y.total*100:0;k>=80&&l.push(v),k<60&&i.push(v)});const c=n.slice(0,5),d=n.slice(-5),m=c.length>0?c.reduce((y,v)=>y+v.score/v.total*100,0)/c.length:0,g=(d.length>0?d.reduce((y,v)=>y+v.score/v.total*100,0)/d.length:0)>m+5,S=new Set(s.map(y=>new Date(y.date).toDateString())),b=Math.min(100,S.size*5);return{totalSessions:s.length,averageAccuracy:a,strongCategories:l,weakCategories:i,recentImprovement:g,consistencyScore:b}}catch{return{totalSessions:0,averageAccuracy:0,strongCategories:[],weakCategories:[],recentImprovement:!1,consistencyScore:0}}}function _s(){const r=new Date().getHours();return r>=5&&r<12?"morning":r>=12&&r<17?"afternoon":r>=17&&r<21?"evening":"night"}class $a{generateCorrectComment(t){const s=[],n=Ta();return t.attemptCount===1?(t.responseTime<3e3&&s.push(ot(["é€Ÿã„ï¼","åå¿œãŒé‹­ã„ãï¼","å³ç­”ã ãªï¼"])),s.push(ot(["ã‚ˆã—ï¼","ã„ã„ãï¼","æ­£è§£ã ï¼"]))):t.attemptCount===2?s.push(ot(["2å›ç›®ã§æ­£è§£ã‹ã€‚","ã‚„ã£ã¨æ­£è§£ã—ãŸãªã€‚"])):(s.push(`${t.attemptCount}å›ç›®ã§æ­£è§£ã‹ã€‚`),s.push("ã‚‚ã£ã¨æ—©ãæ±ºã‚ã‚ï¼")),t.difficulty==="advanced"&&t.attemptCount===1?s.push(ot(["ä¸Šç´šå˜èªã‚’ä¸€ç™ºã§æ±ºã‚ãŸï¼","é›£ã—ã„å˜èªã‚‚ã‚¯ãƒªã‚¢ã ãªï¼"])):t.difficulty==="beginner"&&t.attemptCount>1&&s.push("åˆç´šã§ã‚‚ãŸã¤ããªï¼"),t.correctStreak>=10?(s.push(`é©šç•°ã®${t.correctStreak}é€£ç¶šæ­£è§£ï¼`),s.push(ot(["å®Œå…¨ã«æ³¢ã«ä¹—ã£ã¦ã‚‹ãªï¼","ã“ã®ã¾ã¾çªã£èµ°ã‚Œï¼"]))):t.correctStreak>=5?(s.push(`${t.correctStreak}é€£ç¶šæ­£è§£ï¼`),s.push(ot(["èª¿å­ãŒå‡ºã¦ããŸãªï¼","ã„ã„æµã‚Œã ï¼"]))):t.correctStreak>=3&&s.push("3é€£ç¶šã ã€‚"),n.recentImprovement&&n.totalSessions>=10&&s.push(ot(["æœ€è¿‘ã®æˆé•·ãŒè‘—ã—ã„ãï¼","å‰ã‚ˆã‚Šç¢ºå®Ÿã«å¼·ããªã£ã¦ã‚‹ï¼"])),t.isWeakCategory&&t.isCorrect&&(s.push(`è‹¦æ‰‹ãª${t.category}ã§æ­£è§£ï¼`),s.push(ot(["æˆé•·ã‚’æ„Ÿã˜ã‚‹ãï¼","å¼±ç‚¹ã‚’æ½°ã—ãŸãªï¼"]))),t.todayQuestions>=50&&t.todayAccuracy>=80&&s.push("ä»Šæ—¥ã¯çµ¶å¥½èª¿ã ãªï¼"),t.timeOfDay==="night"&&t.todayQuestions>=30&&s.push("å¤œé…ãã¾ã§ã‚ˆãé ‘å¼µã£ã¦ã‚‹ï¼"),t.hasSeenBefore&&t.previousAttempts>2&&(s.push(`å‰ã¯${t.previousAttempts}å›ã‚‚ã‹ã‹ã£ãŸå˜èªã ãï¼`),s.push("ã‚ˆã†ã‚„ãè¦šãˆãŸãªï¼")),t.learningPhase==="ENCODING"?s.push("æ–°è¦è¨˜æ†¶ã‚’è„³ã«åˆ»ã¿è¾¼ã‚“ã§ã‚‹ãï¼"):t.learningPhase==="INITIAL_CONSOLIDATION"?s.push("è¨˜æ†¶ãŒå®šç€ã—ã¦ãã¦ã‚‹ãªï¼"):t.learningPhase==="LONG_TERM_RETENTION"?s.push("é•·æœŸè¨˜æ†¶ã«ç§»è¡Œä¸­ã ï¼"):t.learningPhase==="MASTERED"&&s.push("å®Œå…¨ã«ãƒã‚¹ã‚¿ãƒ¼ã—ãŸãªï¼"),s.push("ã“ã®èª¿å­ã ï¼ğŸ’ª"),s.join(" ")}generateIncorrectComment(t){const s=[];return t.attemptCount===1?s.push("é•ã†ï¼"):s.push("ã¾ãŸé–“é•ãˆãŸï¼"),t.difficulty==="beginner"&&(s.push("åˆç´šã§é–“é•ãˆã‚‹ã¨ã¯â€¦"),s.push("åŸºç¤ã‹ã‚‰ã‚„ã‚Šç›´ã›ï¼")),t.incorrectStreak>=3&&(s.push(`${t.incorrectStreak}é€£ç¶šãƒŸã‚¹ï¼`),s.push("ãŸã‚‹ã‚“ã§ã‚‹ãï¼")),t.hasSeenBefore&&(s.push(`å‰ã«ã‚‚é–“é•ãˆãŸ${t.word}ã ãï¼`),s.push("ä½•åº¦ã‚„ã‚‰ã›ã‚‹æ°—ã ï¼")),t.todayAccuracy<60&&(s.push("ä»Šæ—¥ã®æ­£ç­”ç‡ãŒä½ã„ï¼"),s.push("é›†ä¸­ã—ã‚ï¼")),t.timeOfDay==="night"&&t.todayQuestions>=40?(s.push("ç–²ã‚Œã¦ã‚‹ãªã‚‰ä¼‘ã‚ï¼"),s.push("ã ãŒæ˜æ—¥ã¯å€ã‚„ã‚‹ã‚“ã ãï¼")):s.push("æ°—åˆã‚’å…¥ã‚Œã‚ï¼ğŸ”¥"),s.join(" ")}}class Ea{generateCorrectComment(t){const s=[];return s.push("æ­£è§£ã§ã™ï¼"),t.attemptCount===1?t.responseTime<3e3?s.push("ç´ æ—©ã„åˆ¤æ–­ã§ã—ãŸã­ âœ¨"):s.push("ã—ã£ã‹ã‚Šè€ƒãˆã‚‰ã‚Œã¾ã—ãŸã­"):t.attemptCount===2?(s.push("2å›ç›®ã§æ­£è§£ã§ãã¾ã—ãŸ"),s.push("è½ã¡ç€ã„ã¦è€ƒãˆã‚‰ã‚Œã¾ã—ãŸã­")):t.attemptCount>=3&&(s.push(`${t.attemptCount}å›ç›®ã§æ­£è§£ã§ãã¾ã—ãŸ`),s.push("ç²˜ã‚Šå¼·ãå–ã‚Šçµ„ã‚ã¾ã—ãŸã­")),t.difficulty==="advanced"&&(s.push(`${t.word}ã¯é›£ã—ã„å˜èªã§ã—ãŸãŒã€`),s.push("è¦‹äº‹ã«æ­£è§£ã—ã¾ã—ãŸï¼")),t.correctStreak>=5?(s.push(`${t.correctStreak}å•é€£ç¶šæ­£è§£ã§ã™ï¼`),s.push("ç´ æ™´ã‚‰ã—ã„é›†ä¸­åŠ›ã§ã™ã­ ğŸŒ¸")):t.correctStreak>=3&&s.push("èª¿å­ãŒå‡ºã¦ãã¾ã—ãŸã­"),t.isWeakCategory&&(s.push(`è‹¦æ‰‹ãª${t.category}ã§æ­£è§£ï¼`),s.push("å°‘ã—ãšã¤å¾—æ„ã«ãªã£ã¦ãã¦ã„ã¾ã™ã‚ˆ ğŸ˜Š")),t.hasSeenBefore&&t.previousAttempts>2&&(s.push("å‰å›ã‚ˆã‚Šæ—©ãæ­£è§£ã§ãã¾ã—ãŸã­"),s.push("ç¢ºå®Ÿã«æˆé•·ã—ã¦ã„ã¾ã™")),t.todayQuestions>=50&&(s.push(`ä»Šæ—¥ã¯ã‚‚ã†${t.todayQuestions}å•ã‚‚é ‘å¼µã£ã¦ã„ã¾ã™ã­`),s.push("ç„¡ç†ã—ã™ããªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã­")),t.learningPhase==="ENCODING"?s.push("è¨˜æ†¶ã®ç¬¦å·åŒ–ãŒé€²ã‚“ã§ã„ã¾ã™ ğŸ“"):t.learningPhase==="INITIAL_CONSOLIDATION"?s.push("è¨˜æ†¶ãŒå®šç€ã—ã¦ãã¦ã„ã¾ã™ã­ âœ¨"):t.learningPhase==="LONG_TERM_RETENTION"?s.push("é•·æœŸè¨˜æ†¶ã«ç§»è¡Œã§ãã¦ã„ã¾ã™ ğŸŒŸ"):t.learningPhase==="MASTERED"&&s.push("å®Œå…¨ã«ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ãŸã­ ğŸ‰"),s.join(" ")}generateIncorrectComment(t){const s=[];return t.attemptCount===1?s.push("æƒœã—ã„ã§ã™"):s.push("é›£ã—ã‹ã£ãŸã§ã™ã­"),s.push("ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™"),t.difficulty==="advanced"?(s.push(`${t.word}ã¯ä¸Šç´šå˜èªãªã®ã§`),s.push("ä½•åº¦ã‹å¾©ç¿’ã—ã¾ã—ã‚‡ã†")):t.difficulty==="beginner"&&(s.push("åŸºç¤çš„ãªå˜èªãªã®ã§"),s.push("ã‚†ã£ãã‚Šè¦šãˆç›´ã—ã¾ã—ã‚‡ã†")),t.incorrectStreak>=3&&(s.push("å°‘ã—ç–²ã‚Œã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿ"),s.push("æ·±å‘¼å¸ã—ã¦ã¿ã¾ã—ã‚‡ã† ğŸŒ±")),t.hasSeenBefore&&(s.push(`${t.word}ã¯è¦æ³¨æ„ã®å˜èªã§ã™ã­`),s.push("ä¸€ç·’ã«è¦šãˆç›´ã—ã¾ã—ã‚‡ã†")),t.timeOfDay==="night"&&(s.push("å¤œã¯é›†ä¸­ã—ã¥ã‚‰ã„ã“ã¨ã‚‚ã‚ã‚Šã¾ã™"),s.push("ç„¡ç†ã›ãšä¼‘æ†©ã‚‚å¤§åˆ‡ã§ã™ã‚ˆ")),s.push("æ¬¡ã¯æ­£è§£ã§ãã¾ã™ã‚ˆ ğŸ˜Š"),s.join(" ")}}class _a{generateCorrectComment(t){const s=[];if(s.push("æ­£è§£ã€‚"),s.push(`å¿œç­”æ™‚é–“: ${(t.responseTime/1e3).toFixed(1)}ç§’`),t.attemptCount>1&&s.push(`è©¦è¡Œå›æ•°: ${t.attemptCount}`),t.correctStreak>0){s.push(`é€£ç¶šæ­£è§£: ${t.correctStreak}`);const n=Math.min(100,t.userAccuracy+2);s.push(`æ­£ç­”ç‡: ${t.userAccuracy.toFixed(0)}% â†’ ${n.toFixed(0)}%`)}if(t.difficulty==="advanced"&&(s.push("é›£æ˜“åº¦: ä¸Šç´š"),s.push("æœŸå¾…æ­£ç­”ç‡ã‚’ä¸Šå›ã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹")),t.isWeakCategory){s.push(`è‹¦æ‰‹ã‚«ãƒ†ã‚´ãƒªãƒ¼(${t.category})ã§æ­£è§£`);const n=Math.min(100,t.categoryAccuracy+3);s.push(`ã‚«ãƒ†ã‚´ãƒªãƒ¼æ­£ç­”ç‡: ${t.categoryAccuracy.toFixed(0)}% â†’ ${n.toFixed(0)}%`)}return s.push("ğŸ“Š"),s.join(" ")}generateIncorrectComment(t){const s=[];if(s.push("ä¸æ­£è§£ã€‚"),s.push(`è©¦è¡Œå›æ•°: ${t.attemptCount}`),t.incorrectStreak>0){s.push(`é€£ç¶šä¸æ­£è§£: ${t.incorrectStreak}`);const n=Math.max(0,t.userAccuracy-2);s.push(`æ­£ç­”ç‡å½±éŸ¿: ${t.userAccuracy.toFixed(0)}% â†’ ${n.toFixed(0)}%`)}return t.difficulty==="beginner"&&(s.push("åŸºç¤ãƒ¬ãƒ™ãƒ«ä¸æ­£è§£æ¤œå‡º"),s.push("å„ªå…ˆå¾©ç¿’å¯¾è±¡ã«è¿½åŠ ")),t.hasSeenBefore&&(s.push(`æ—¢å‡ºå˜èª: ${t.previousAttempts+1}å›ç›®ã®ä¸æ­£è§£`),s.push("ç¿’å¾—é›£æ˜“åº¦ã‚¹ã‚³ã‚¢: é«˜")),s.push("æ¬¡å›å‡ºé¡Œç¢ºç‡: 80%"),s.join(" ")}}class La{generateCorrectComment(t){const s=[],n=["ãƒŠã‚¤ã‚¹ï¼","ã‚ˆã—ï¼","ã„ã„ãï¼","ã‚„ã£ãŸï¼"];return s.push(n[Math.floor(Math.random()*n.length)]),t.attemptCount===1?s.push("ä¸€ç™ºã§æ±ºã‚ãŸï¼"):t.attemptCount===2?s.push("ç«‹ã¦ç›´ã—ãŸãªï¼"):(s.push(`${t.attemptCount}å›ç›®ã§æ±ºã‚ãŸï¼`),s.push("ã‚‚ã£ã¨æ—©ãè¡Œã“ã†ï¼")),t.correctStreak>=5?(s.push(`${t.correctStreak}é€£ç¶šï¼`),s.push("ãŠå‰ã¯ç„¡æ•µã ï¼ğŸ”¥")):t.correctStreak>=3&&s.push("æ³¢ã«ä¹—ã£ã¦ããŸãï¼"),t.difficulty==="advanced"&&(s.push(`${t.word}ã‚’å€’ã—ãŸï¼`),s.push("ãŠå‰ã¯å¼·ã„ï¼ğŸ’ª")),t.isWeakCategory&&(s.push(`è‹¦æ‰‹ãª${t.category}ã‚’å…‹æœï¼`),s.push("ã“ã‚ŒãŒæˆé•·ã ï¼")),t.todayQuestions>=50&&t.todayAccuracy>=80&&(s.push(`ä»Šæ—¥ã¯${t.todayQuestions}å•ã‚¯ãƒªã‚¢ï¼`),s.push("çµ¶å¥½èª¿ã ï¼ğŸ†")),s.push("ã‚‚ã£ã¨è¡Œã‘ã‚‹ãï¼"),s.join(" ")}generateIncorrectComment(t){const s=[];return s.push("æƒœã—ã„ï¼"),t.incorrectStreak<3?(s.push("ã ãŒã¾ã çµ‚ã‚ã£ã¦ãªã„ï¼"),s.push("ã‚‚ã†ä¸€ä¸ï¼")):(s.push("é€£ç¶šãƒŸã‚¹ï¼"),s.push("ã ãŒå‹è² ã¯ã“ã‚Œã‹ã‚‰ã ï¼")),t.difficulty==="beginner"&&(s.push("ç„¦ã£ãŸãªï¼"),s.push("è½ã¡ç€ã‘ï¼")),t.hasSeenBefore&&(s.push(`ã¾ãŸ${t.word}ã‹ï¼`),s.push("ä»Šåº¦ã“ããƒªãƒ™ãƒ³ã‚¸ã ï¼ğŸ’ª")),t.todayAccuracy<60?(s.push("èª¿å­ãŒæ‚ªã„ãªï¼"),s.push("ã ãŒè² ã‘ã‚‹ãªï¼"),s.push("ã“ã“ã‹ã‚‰é€†è»¢ã ï¼ğŸ”¥")):s.push("ãŠå‰ãªã‚‰ã§ãã‚‹ï¼"),s.join(" ")}}class Wa{generateCorrectComment(t){const s=[];return s.push("æ­£è§£ã§ã™ã€‚"),s.push(`${t.word}ã¨ã„ã†è¨€è‘‰ãŒã€ã‚ãªãŸã®ä¸€éƒ¨ã«ãªã‚Šã¾ã—ãŸ`),t.attemptCount>1&&s.push("è¿·ã„ãŒç†è§£ã‚’æ·±ã‚ã¾ã™"),t.correctStreak>=5?(s.push(`${t.correctStreak}å•é€£ç¶šæ­£è§£ã€‚`),s.push("è¨˜æ†¶ã®å®šç€ãŒç¢ºå®Ÿã«ãªã‚Šã¾ã—ãŸ ğŸŒ™")):t.correctStreak>=3&&s.push("çŸ¥è­˜ãŒæ ¹ã‚’å¼µã‚Šå§‹ã‚ã¦ã„ã¾ã™ ğŸŒ±"),t.difficulty==="advanced"&&(s.push("é›£ã—ã„è¨€è‘‰ã‚’ç†è§£ã—ã¾ã—ãŸã­"),s.push("çŸ¥æµãŒæ·±ã¾ã‚Šã¾ã™")),t.isWeakCategory&&(s.push("è‹¦æ‰‹ã‚’å…‹æœã—ã¾ã—ãŸ"),s.push("æˆé•·ã¨ã¯å¤‰åŒ–ã‚’å—ã‘å…¥ã‚Œã‚‹ã“ã¨ã§ã™")),t.todayQuestions>=50&&(s.push(`ä»Šæ—¥ã¯${t.todayQuestions}å•ã®çµŒé¨“ã‚’ç©ã¿ã¾ã—ãŸ`),s.push("ä¸€æ—¥ä¸€æ—¥ãŒæœªæ¥ã¸ã®æŠ•è³‡ã§ã™ ğŸ“–")),s.join(" ")}generateIncorrectComment(t){const s=[];return s.push("é–“é•ã„ã¯å­¦ã³ã®å§‹ã¾ã‚Šã§ã™ã€‚"),t.attemptCount===1?s.push("å†åº¦æŒ‘æˆ¦ã—ã¾ã—ã‚‡ã†"):(s.push("ã¾ã ç†è§£ã®é€”ä¸­ã§ã™"),s.push("ç„¦ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ ğŸŒ±")),t.difficulty==="beginner"&&s.push("åŸºç¤ã«æˆ»ã‚‹ã“ã¨ã¯æ¥ã§ã¯ã‚ã‚Šã¾ã›ã‚“"),t.incorrectStreak>=3&&(s.push("é€£ç¶šã§é–“é•ãˆã¾ã—ãŸ"),s.push("ä¼‘æ¯ã‚‚å­¦ã³ã®ä¸€éƒ¨ã§ã™")),t.hasSeenBefore&&(s.push(`${t.word}ã¯ã‚ãªãŸã®èª²é¡Œã§ã™`),s.push("ä½•åº¦ã§ã‚‚å‘ãåˆã„ã¾ã—ã‚‡ã†")),t.todayAccuracy<60&&(s.push("æ­£ç­”ç‡ãŒä¸‹ãŒã£ã¦ã„ã¾ã™"),s.push("ã—ã‹ã—é“ã¯ç¶šã„ã¦ã„ã¾ã™")),s.push("è¨˜æ†¶ã¨ã¯ç¹°ã‚Šè¿”ã—ã®èŠ¸è¡“ã§ã™ ğŸ“–"),s.join(" ")}}function Pr(r,t){let s;switch(r){case"drill-sergeant":s=new $a;break;case"kind-teacher":s=new Ea;break;case"analyst":s=new _a;break;case"enthusiastic-coach":s=new La;break;case"wise-sage":s=new Wa;break}return t.isCorrect?s.generateCorrectComment(t):s.generateIncorrectComment(t)}const Oa={"drill-sergeant":{avatar:"ğŸ‘¹",name:"é¬¼è»æ›¹",description:"å³ã—ãé›ãˆã‚‹",tone:"å³ã—ãã€å¦¥å”ãªã—ã€çµæœé‡è¦–"},"kind-teacher":{avatar:"ğŸ˜Š",name:"å„ªã—ã„å…ˆç”Ÿ",description:"ä¸å¯§ã«ã‚µãƒãƒ¼ãƒˆ",tone:"å„ªã—ãã€ä¸å¯§ã€ã§ã‚‚æ­£ç¢º"},analyst:{avatar:"ğŸ¤–",name:"å†·é™ãªåˆ†æå®˜",description:"ãƒ‡ãƒ¼ã‚¿ã§åˆ¤æ–­",tone:"æ„Ÿæƒ…ãªã—ã€äº‹å®Ÿã®ã¿ã€çµ±è¨ˆé‡è¦–"},"enthusiastic-coach":{avatar:"ğŸ˜¼",name:"ç†±è¡€ã‚³ãƒ¼ãƒ",description:"ç†±ãå¿œæ´",tone:"ç†±ãã€ãƒã‚¸ãƒ†ã‚£ãƒ–ã€æŒ‘æˆ¦çš„"},"wise-sage":{avatar:"ğŸ§™",name:"è³¢è€…",description:"é•·æœŸè¦–ç‚¹ã§å°ã",tone:"è½ã¡ç€ãã€é•·æœŸè¦–ç‚¹ã€æœ¬è³ªé‡è¦–"}};function Tr(){return localStorage.getItem("lastLoginDate")}function qa(){const r=localStorage.getItem("loginStreak");return r?parseInt(r,10):0}function za(){const r=Tr();if(!r)return 0;const t=new Date().toISOString().split("T")[0],s=new Date(r),a=new Date(t).getTime()-s.getTime();return Math.floor(a/(1e3*60*60*24))}function Fa(){const r=new Date().toISOString().split("T")[0],t=localStorage.getItem(`studyStats-${r}`);if(!t)return{count:0,accuracy:0};const s=JSON.parse(t);return{count:s.count||0,accuracy:s.correct&&s.count?s.correct/s.count*100:0}}function Qa(r){const t=_s(),s=za(),n=qa(),{count:a,accuracy:o}=Fa(),l={lastLoginDate:Tr(),todayStudyCount:a,todayAccuracy:o};return s>=3?Ga(r,s):n>=7&&a===0?Ba(r,n):Ua(r,t,l)}function Ga(r,t){switch(r){case"drill-sergeant":return t>=7?`${t}æ—¥ã‚‚ç©ºã‘ã‚‹ã¨ã¯ä½•äº‹ã ï¼ä»Šã™ãå¾©ç¿’ã‚’é–‹å§‹ã—ã‚ï¼`:`${t}æ—¥ã¶ã‚Šã‹ã€‚é…ã‚Œã‚’å–ã‚Šæˆ»ã™ãï¼`;case"kind-teacher":return t>=7?`ğŸ˜ƒ ãŠä¹…ã—ã¶ã‚Šã§ã™ï¼${t}æ—¥çµŒã£ã¦ã„ã¾ã™ãŒã€ç„¦ã‚‰ãšå°‘ã—ãšã¤æ€ã„å‡ºã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚`:`ğŸ˜ƒ ${t}æ—¥ã¶ã‚Šã§ã™ã­ã€‚ã‚†ã£ãã‚Šå¾©ç¿’ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚`;case"analyst":return t>=7?`ğŸ¤– å‰å›ã‹ã‚‰${t}æ—¥çµŒéã€‚è¨˜æ†¶å®šç€ç‡ã¯æ¨å®š40-60%ã€‚ä½“ç³»çš„ãªå¾©ç¿’ã‚’æ¨å¥¨ã—ã¾ã™ã€‚`:`ğŸ¤– ${t}æ—¥ã®é–“éš”ã€‚å¿˜å´æ›²ç·šã‚’è€ƒæ…®ã—ãŸå¾©ç¿’ãŒå¿…è¦ã§ã™ã€‚`;case"enthusiastic-coach":return t>=7?`ğŸ˜¼ ${t}æ—¥ã¶ã‚Šã®ã‚«ãƒ ãƒãƒƒã‚¯ï¼ä»Šæ—¥ã‹ã‚‰å†ã‚¹ã‚¿ãƒ¼ãƒˆã ï¼å…¨åŠ›ã§è¡Œããï¼`:`ğŸ˜¼ å¾…ã£ã¦ãŸãœï¼${t}æ—¥ã®é…ã‚Œã¯ä»Šæ—¥å–ã‚Šæˆ»ãã†ï¼`;case"wise-sage":return t>=7?`ğŸ§™ ${t}æ—¥ã®ä¼‘æ¯ã‚‚å­¦ã³ã®ä¸€éƒ¨ã˜ã‚ƒã€‚ç„¦ã‚‰ãšã€ç€å®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚`:`ğŸ§™ ${t}æ—¥ã®ç©ºç™½ã‚‚ã€ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã®æ™‚é–“ã ã£ãŸã®ã˜ã‚ƒã‚ã†ã€‚ã•ã‚ã€ã‚†ã£ãã‚Šå†é–‹ã˜ã‚ƒã€‚`;default:return`ãŠå¸°ã‚Šãªã•ã„ï¼${t}æ—¥ã¶ã‚Šã§ã™ã­ã€‚`}}function Ba(r,t){switch(r){case"drill-sergeant":return`${t}æ—¥é€£ç¶šï¼ç´ æ™´ã‚‰ã—ã„ç¶™ç¶šåŠ›ã ï¼ä»Šæ—¥ã‚‚æ²¹æ–­ã™ã‚‹ãªï¼`;case"kind-teacher":return`ğŸ˜ƒ ${t}æ—¥é€£ç¶šãƒ­ã‚°ã‚¤ãƒ³ã€ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼ç¶™ç¶šã¯åŠ›ãªã‚Šã§ã™ã€‚`;case"analyst":return`ğŸ¤– ${t}æ—¥é€£ç¶šã€‚ç¶™ç¶šç‡100%ã€‚çµ±è¨ˆçš„ã«å­¦ç¿’åŠ¹æœã¯æœ€å¤§åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚`;case"enthusiastic-coach":return`ğŸ˜¼ ${t}æ—¥é€£ç¶šé”æˆï¼ã“ã®å‹¢ã„ã§çªãé€²ã‚ï¼è¨˜éŒ²æ›´æ–°ã ï¼`;case"wise-sage":return`ğŸ§™ ${t}æ—¥ã®ç¶™ç¶šã€è¦‹äº‹ã˜ã‚ƒã€‚åƒé‡Œã®é“ã‚‚ä¸€æ­©ã‹ã‚‰ã€ã˜ã‚ƒãªã€‚`;default:return""}}function Ua(r,t,s){const{todayStudyCount:n,todayAccuracy:a}=s;switch(r){case"drill-sergeant":return Ha(t,n);case"kind-teacher":return Va(t,n);case"analyst":return Ja(t,n,a);case"enthusiastic-coach":return Ya(t,n);case"wise-sage":return Xa(t,n);default:return null}}function Ha(r,t,s){switch(r){case"morning":return t===0?"æœã ãï¼è„³ãŒä¸€ç•ªå†´ãˆã¦ã‚‹æ™‚é–“ã ï¼ä»Šã™ãå­¦ç¿’ã‚’é–‹å§‹ã—ã‚ï¼":t>=20?"æœã‹ã‚‰ç´ æ™´ã‚‰ã—ã„ãƒšãƒ¼ã‚¹ã ï¼ã“ã®èª¿å­ã‚’ç¶­æŒã—ã‚ï¼":"æœã®å­¦ç¿’ã¯åŠ¹æœçš„ã ï¼ã‚‚ã£ã¨ã‚„ã‚Œã‚‹ã¯ãšã ï¼";case"afternoon":return t===0?"åˆå¾Œã«ãªã£ãŸãï¼ä»Šæ—¥ã¯ã¾ã ä½•ã‚‚ã‚„ã£ã¦ãªã„ã®ã‹ï¼Ÿã•ã£ã•ã¨å§‹ã‚ã‚ï¼":t>=20?"åˆå¾Œã‚‚é †èª¿ã ãªï¼åˆå‰ä¸­ã®å‹¢ã„ã‚’è½ã¨ã™ãªï¼":"åˆå¾Œã¯é›†ä¸­åŠ›ãŒè½ã¡ã‚„ã™ã„ã€‚æ°—åˆã‚’å…¥ã‚Œç›´ã›ï¼";case"evening":return t===0?"ã‚‚ã†å¤•æ–¹ã ãï¼ä»Šæ—¥ã®åˆ†ã¯ä»Šæ—¥ä¸­ã«çµ‚ã‚ã‚‰ã›ã‚ï¼":t>=30?"ä»Šæ—¥ã¯ã‚ˆãé ‘å¼µã£ãŸï¼ã‚ã¨å°‘ã—ã§å®Œç’§ã ï¼":"å¤•æ–¹ã¯å¾©ç¿’ã®ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚¿ã‚¤ãƒ ã ï¼è¿½ã„è¾¼ã¿ã‚’ã‹ã‘ã‚ï¼";case"night":return t===0?"å¤œã«ãªã£ã¦ã—ã¾ã£ãŸãï¼å°‘ã—ã§ã‚‚ã„ã„ã‹ã‚‰å­¦ç¿’ã—ã‚ï¼0ã‚ˆã‚Š1ã ï¼":t>=30?"å¤œé…ãã¾ã§ã‚ˆãé ‘å¼µã£ãŸï¼æ—©ãä¼‘ã‚“ã§æ˜æ—¥ã«å‚™ãˆã‚ï¼":"å¤œã¯è»½ã‚ã®å¾©ç¿’ãŒåŠ¹æœçš„ã ï¼ç„¡ç†ã¯ã™ã‚‹ãªï¼";default:return"ã•ã‚ã€å­¦ç¿’ã‚’é–‹å§‹ã™ã‚‹ãï¼"}}function Va(r,t,s){switch(r){case"morning":return t===0?"ğŸ˜ƒ ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼æœã¯è¨˜æ†¶åŠ›ãŒé«˜ã¾ã‚‹æ™‚é–“ã§ã™ã‚ˆã€‚ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼":t>=20?"ğŸ˜ƒ æœã‹ã‚‰ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼ã§ã‚‚ç„¡ç†ã¯ã—ãªã„ã§ãã ã•ã„ã­ã€‚":"ğŸ˜ƒ æœã®å­¦ç¿’ã€é †èª¿ã§ã™ã­ï¼ã“ã®èª¿å­ã§é€²ã‚ã¾ã—ã‚‡ã†ã€‚";case"afternoon":return t===0?"ğŸ˜ƒ ã“ã‚“ã«ã¡ã¯ï¼åˆå¾Œã¯å°‘ã—çœ ããªã‚Šã‚„ã™ã„ã®ã§ã€è»½ã‚ã®å¾©ç¿’ãŒãŠã™ã™ã‚ã§ã™ã‚ˆã€‚":t>=20?"ğŸ˜ƒ åˆå¾Œã‚‚ã‚ˆãé ‘å¼µã£ã¦ã„ã¾ã™ã­ï¼ä¼‘æ†©ã‚‚å¿˜ã‚Œãšã«å–ã£ã¦ãã ã•ã„ã­ã€‚":"ğŸ˜ƒ åˆå¾Œã‚‚é †èª¿ã§ã™ã­ã€‚ãƒã‚¤ãƒšãƒ¼ã‚¹ã§å¤§ä¸ˆå¤«ã§ã™ã‚ˆã€‚";case"evening":return t===0?"ğŸ˜ƒ ã“ã‚“ã°ã‚“ã¯ã€‚å¤•æ–¹ã¯å¾©ç¿’ã«æœ€é©ãªæ™‚é–“ã§ã™ã€‚ä»Šæ—¥å­¦ã‚“ã ã“ã¨ã‚’è»½ãè¦‹ç›´ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ":t>=30?"ğŸ˜ƒ ä»Šæ—¥ã¯æœ¬å½“ã«ã‚ˆãé ‘å¼µã‚Šã¾ã—ãŸã­ï¼ã‚‚ã†ååˆ†ã§ã™ã‚ˆã€‚":"ğŸ˜ƒ å¤•æ–¹ã®å¾©ç¿’ã€è‰¯ã„ã§ã™ã­ï¼ç„¦ã‚‰ãšã‚†ã£ãã‚Šé€²ã‚ã¾ã—ã‚‡ã†ã€‚";case"night":return t===0?"ğŸ˜ƒ å¤œé…ãã¾ã§ãŠç–²ã‚Œæ§˜ã§ã™ã€‚ç„¡ç†ã›ãšã€ã§ãã‚‹ç¯„å›²ã§å¤§ä¸ˆå¤«ã§ã™ã‚ˆã€‚":t>=30?"ğŸ˜ƒ ä»Šæ—¥ã¯ååˆ†é ‘å¼µã‚Šã¾ã—ãŸï¼ãã‚ãã‚ä¼‘ã‚“ã§ã€æ˜æ—¥ã«å‚™ãˆã¾ã—ã‚‡ã†ã­ã€‚":"ğŸ˜ƒ å¤œã®å­¦ç¿’ã‚‚å¤§åˆ‡ã§ã™ãŒã€ç¡çœ ã‚‚åŒã˜ãã‚‰ã„å¤§åˆ‡ã§ã™ã‚ˆã€‚";default:return"ğŸ˜ƒ ä¸€ç·’ã«é ‘å¼µã‚Šã¾ã—ã‚‡ã†ã­ï¼"}}function Ja(r,t,s){switch(r){case"morning":return t===0?"ğŸ¤– ç¾åœ¨æ™‚åˆ»ï¼šæœã€‚è„³ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼šæœ€é©ã€‚æ–°è¦å­¦ç¿’åŠ¹ç‡ï¼š+30%ã€‚å­¦ç¿’é–‹å§‹ã‚’æ¨å¥¨ã€‚":t>=20?`ğŸ¤– æœã®å­¦ç¿’${t}å•å®Œäº†ã€‚æ­£ç­”ç‡${s.toFixed(1)}%ã€‚è‰¯å¥½ãªãƒšãƒ¼ã‚¹ã€‚`:"ğŸ¤– æœã®å­¦ç¿’é€²è¡Œä¸­ã€‚èªçŸ¥æ©Ÿèƒ½ãŒé«˜ã„æ™‚é–“å¸¯ã‚’æ´»ç”¨ã—ã¦ãã ã•ã„ã€‚";case"afternoon":return t===0?"ğŸ¤– åˆå¾Œã®æ™‚é–“å¸¯ã€‚é›†ä¸­åŠ›ï¼šã‚„ã‚„ä½ä¸‹å‚¾å‘ã€‚çŸ­æ™‚é–“é›†ä¸­å‹ã®å­¦ç¿’ã‚’æ¨å¥¨ã€‚":t>=20?`ğŸ¤– æœ¬æ—¥${t}å•å­¦ç¿’æ¸ˆã¿ã€‚åˆå¾Œã®ç”Ÿç”£æ€§ï¼šç¶­æŒã•ã‚Œã¦ã„ã¾ã™ã€‚`:"ğŸ¤– åˆå¾Œã®å­¦ç¿’ç¶™ç¶šä¸­ã€‚15åˆ†Ã—3ã‚»ãƒƒãƒˆã®åˆ†å‰²å­¦ç¿’ãŒåŠ¹æœçš„ã§ã™ã€‚";case"evening":return t===0?"ğŸ¤– å¤•æ–¹ã®æ™‚é–“å¸¯ã€‚å¾©ç¿’åŠ¹ç‡ï¼šæœ€é«˜ãƒ¬ãƒ™ãƒ«ã€‚ä»Šæ—¥ã®å­¦ç¿’å†…å®¹ã®å®šç€ã«æœ€é©ã€‚":t>=30?`ğŸ¤– æœ¬æ—¥${t}å•é”æˆã€‚ååˆ†ãªå­¦ç¿’é‡ã§ã™ã€‚ä¼‘æ¯ã‚’æ¨å¥¨ã€‚`:"ğŸ¤– å¤•æ–¹ã®å¾©ç¿’ã‚¿ã‚¤ãƒ ã€‚æœã®å­¦ç¿’å†…å®¹ã®å†ç¢ºèªãŒè¨˜æ†¶å®šç€ç‡ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚";case"night":return t===0?"ğŸ¤– å¤œé–“ã€‚æ–°è¦å­¦ç¿’ã‚ˆã‚Šå¾©ç¿’ã‚’æ¨å¥¨ã€‚ç¡çœ å‰ã®è»½ã„å¾©ç¿’ã¯è¨˜æ†¶ã®å›ºå®šåŒ–ã«æœ‰åŠ¹ã€‚":t>=30?`ğŸ¤– æœ¬æ—¥${t}å•å®Œäº†ã€‚å­¦ç¿’ç›®æ¨™é”æˆã€‚22-23æ™‚ã®å°±å¯ã§è¨˜æ†¶å®šç€ç‡ãŒå‘ä¸Šã—ã¾ã™ã€‚`:"ğŸ¤– å¤œé–“å­¦ç¿’ä¸­ã€‚éåº¦ãªå­¦ç¿’ã¯ç¡çœ ã®è³ªã‚’ä½ä¸‹ã•ã›ã¾ã™ã€‚é©åº¦ãªå­¦ç¿’ã‚’æ¨å¥¨ã€‚";default:return"ğŸ¤– å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’è¨˜éŒ²ä¸­ã€‚ç¶™ç¶šçš„ãªå­¦ç¿’ãŒæœ€ã‚‚åŠ¹ç‡çš„ã§ã™ã€‚"}}function Ya(r,t,s){switch(r){case"morning":return t===0?"ğŸ˜¼ æœã ï¼æ–°ã—ã„ä¸€æ—¥ã®å§‹ã¾ã‚Šã ï¼ä»Šæ—¥ã‚‚æœ€é«˜ã®å­¦ç¿’ã‚’ã—ã‚ˆã†ï¼":t>=20?"ğŸ˜¼ æœã‹ã‚‰çµ¶å¥½èª¿ã ãªï¼ã“ã®å‹¢ã„ã§ä»Šæ—¥ã‚‚å®Œç’§ã«ã‚„ã‚Šé‚ã’ã‚ˆã†ï¼":"ğŸ˜¼ æœã®å­¦ç¿’ã€æœ€é«˜ã ï¼ã‚‚ã£ã¨ã‚‚ã£ã¨è¡Œã‘ã‚‹ãï¼";case"afternoon":return t===0?"ğŸ˜¼ åˆå¾Œã‚‚å…ƒæ°—å‡ºã—ã¦ã„ã“ã†ï¼ä»Šã‹ã‚‰ã§ã‚‚é…ããªã„ãï¼å…¨åŠ›ã§è¡Œã‘ï¼":t>=20?"ğŸ˜¼ åˆå¾Œã‚‚ç´ æ™´ã‚‰ã—ã„ãƒšãƒ¼ã‚¹ã ï¼ãŠå‰ãªã‚‰çµ¶å¯¾ã§ãã‚‹ï¼":"ğŸ˜¼ åˆå¾Œã®å­¦ç¿’ã‚‚æ°—åˆååˆ†ã ãªï¼ã“ã®èª¿å­ã“ã®èª¿å­ï¼";case"evening":return t===0?"ğŸ˜¼ å¤•æ–¹ã ãï¼ä»Šæ—¥ã®ç›®æ¨™ã¯ã¾ã é”æˆã—ã¦ãªã„ã ã‚ï¼Ÿã•ã‚ã€ã‚„ã‚ã†ï¼":t>=30?"ğŸ˜¼ ä»Šæ—¥ã¯å®Œç’§ã ï¼ãŠå‰ã®åŠªåŠ›ã¯å¿…ãšå ±ã‚ã‚Œã‚‹ï¼èª‡ã‚Šã«æ€ãˆï¼":"ğŸ˜¼ å¤•æ–¹ã®è¿½ã„è¾¼ã¿ã€è‰¯ã„ãï¼ãƒ©ã‚¹ãƒˆã‚¹ãƒ‘ãƒ¼ãƒˆã ï¼";case"night":return t===0?"ğŸ˜¼ å¤œã ã‘ã©è«¦ã‚ã‚‹ãªï¼ãŸã£ãŸ10åˆ†ã§ã‚‚ã„ã„ã€ä»Šæ—¥ã®åˆ†ã‚’ã‚„ã‚ã†ï¼":t>=30?"ğŸ˜¼ å¤œé…ãã¾ã§ãŠç–²ã‚Œæ§˜ï¼ä»Šæ—¥ã®ãŠå‰ã¯æœ€é«˜ã ã£ãŸï¼ã‚†ã£ãã‚Šä¼‘ã‚ï¼":"ğŸ˜¼ å¤œã®å­¦ç¿’ã‚‚é ‘å¼µã£ã¦ã‚‹ãªï¼ç„¡ç†ã¯ã™ã‚‹ãªã‚ˆã€ã§ã‚‚é ‘å¼µã‚Œï¼";default:return"ğŸ˜¼ ã•ã‚ã€ä»Šæ—¥ã‚‚å…¨åŠ›ã§è¡Œããï¼ãŠå‰ãªã‚‰çµ¶å¯¾ã§ãã‚‹ï¼"}}function Xa(r,t,s){switch(r){case"morning":return t===0?"ğŸ§™ æœã®é™ã‘ã•ã¯å­¦ã³ã«æœ€é©ã˜ã‚ƒã€‚å¿ƒã‚’è½ã¡ç€ã‘ã¦ã€ã‚†ã£ãã‚Šå§‹ã‚ã‚‹ãŒã‚ˆã„ã€‚":t>=20?"ğŸ§™ æœã‹ã‚‰è‰¯ã„ãƒšãƒ¼ã‚¹ã˜ã‚ƒã®ã†ã€‚ç„¦ã‚‰ãšã€ç€å®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚":"ğŸ§™ æœã®å­¦ç¿’ã€é †èª¿ã˜ã‚ƒãªã€‚ç„¡ç†ã›ãšã€è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§é€²ã‚€ã®ã˜ã‚ƒã€‚";case"afternoon":return t===0?"ğŸ§™ åˆå¾Œã¯å°‘ã—ä¼‘ã‚“ã§ã‹ã‚‰å§‹ã‚ã‚‹ã®ã‚‚è‰¯ã„ãã€‚ç„¦ã‚‹å¿…è¦ã¯ãªã„ã€‚":t>=20?"ğŸ§™ åˆå¾Œã‚‚ç€å®Ÿã«é€²ã‚“ã§ãŠã‚‹ã®ã†ã€‚ç¶™ç¶šã“ããŒåŠ›ã˜ã‚ƒã€‚":"ğŸ§™ åˆå¾Œã®å­¦ç¿’ã‚‚å¤§åˆ‡ã˜ã‚ƒãŒã€ä¼‘æ¯ã‚‚å¿˜ã‚Œã¬ã‚ˆã†ã«ãªã€‚";case"evening":return t===0?"ğŸ§™ å¤•æš®ã‚Œæ™‚ã¯ä¸€æ—¥ã‚’æŒ¯ã‚Šè¿”ã‚‹æ™‚é–“ã˜ã‚ƒã€‚å­¦ã³ã‚‚åŒã˜ãã€å¾©ç¿’ãŒå¤§åˆ‡ã˜ã‚ƒãã€‚":t>=30?"ğŸ§™ ä»Šæ—¥ã¯ã‚ˆãåŠ±ã‚“ã ã®ã†ã€‚å­¦ã³ã¯é‡ã‚ˆã‚Šè³ªã˜ã‚ƒã€‚ååˆ†ã˜ã‚ƒã‚ã†ã€‚":"ğŸ§™ å¤•æ–¹ã®å¾©ç¿’ã€è‰¯ã„ç¿’æ…£ã˜ã‚ƒã€‚æ€¥ãŒãšã€ç¢ºå®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚";case"night":return t===0?"ğŸ§™ å¤œã¯å¿ƒç©ã‚„ã‹ã«éã”ã™ãŒè‰¯ã„ã€‚è»½ã„å¾©ç¿’ã ã‘ã§ã‚‚ååˆ†ã˜ã‚ƒã€‚":t>=30?"ğŸ§™ ä»Šæ—¥ã®å­¦ã³ã¯ååˆ†ã˜ã‚ƒã€‚è‰¯ãç¡çœ ãŒæ˜æ—¥ã¸ã®åŠ›ã¨ãªã‚‹ã€‚ã‚†ã£ãã‚Šä¼‘ã‚€ãŒã‚ˆã„ã€‚":"ğŸ§™ å¤œæ›´ã‹ã—ã¯ã»ã©ã»ã©ã«ãªã€‚ç¡çœ ã‚‚å­¦ã³ã®ä¸€éƒ¨ã˜ã‚ƒãã€‚";default:return"ğŸ§™ å­¦ã³ã¨ã¯é•·ã„æ—…ã˜ã‚ƒã€‚ä¸€æ­©ãšã¤ã€ç€å®Ÿã«é€²ã‚ã°è‰¯ã„ã€‚"}}function Ka(r,t,s){if(Math.random()>.1)return null;const n=Za(r,t,s);return n.length===0?null:n[Math.floor(Math.random()*n.length)]}function Za(r,t,s){const n=[];r==="drill-sergeant"&&(t&&s>=5&&(n.push({mainTeacher:"drill-sergeant",otherTeacher:"kind-teacher",message:"ğŸ˜ˆã€Œã‚ˆã—ï¼ãã®èª¿å­ã ï¼ã€ ğŸ˜ƒã€Œã¡ã‚‡ã€ã¡ã‚‡ã£ã¨è¤’ã‚ã™ãã§ã¯...ã€ ğŸ˜ˆã€Œã†ã‚‹ã•ã„ï¼è‰¯ã„ã‚‚ã®ã¯è‰¯ã„ã‚“ã ï¼ã€",type:"banter"}),n.push({mainTeacher:"drill-sergeant",otherTeacher:"wise-sage",message:"ğŸ˜ˆã€Œå®Œç’§ã ï¼ã€ ğŸ§™ã€Œãµã‚€ã€é¬¼è»æ›¹æ®¿ã‚‚å¬‰ã—ãã†ã˜ã‚ƒã®ã†ã€ ğŸ˜ˆã€Œã¹ã€åˆ¥ã«...ã€",type:"banter"})),t||(n.push({mainTeacher:"drill-sergeant",otherTeacher:"kind-teacher",message:"ğŸ˜ˆã€Œä½•åº¦åŒã˜é–“é•ã„ã‚’...ï¼ã€ ğŸ˜ƒã€Œã¾ã‚ã¾ã‚ã€è½ã¡ç€ã„ã¦ã€‚èª°ã«ã§ã‚‚è‹¦æ‰‹ã¯ã‚ã‚Šã¾ã™ã‹ã‚‰ã€ ğŸ˜ˆã€Œç”˜ã‚„ã‹ã™ãªï¼ã€",type:"argument"}),n.push({mainTeacher:"drill-sergeant",otherTeacher:"analyst",message:"ğŸ˜ˆã€ŒãŸã‚‹ã‚“ã§ã‚‹ãï¼ã€ ğŸ¤–ã€Œçµ±è¨ˆçš„ã«ã¯è¨±å®¹ç¯„å›²å†…ã®ãƒŸã‚¹ã§ã™ã€ ğŸ˜ˆã€Œãƒ‡ãƒ¼ã‚¿ã˜ã‚ƒãªã„ã€æ°—æŒã¡ã®å•é¡Œã ï¼ã€",type:"argument"})),n.push({mainTeacher:"drill-sergeant",otherTeacher:"enthusiastic-coach",message:"ğŸ˜¼ï¼ˆé€šã‚Šã™ãŒã‚Šï¼‰ã€ŒãŠã£ã€é¬¼è»æ›¹ã®ç‰¹è¨“ã‹ï¼é ‘å¼µã‚Œã‚ˆï¼ã€ ğŸ˜ˆã€Œ...ä½™è¨ˆãªå£å‡ºã—ã™ã‚‹ãªã€",type:"passerby"})),r==="kind-teacher"&&(t&&(n.push({mainTeacher:"kind-teacher",otherTeacher:"drill-sergeant",message:"ğŸ˜ƒã€Œç´ æ™´ã‚‰ã—ã„ã§ã™ã­ï¼ã€ ğŸ˜ˆï¼ˆé ãã‹ã‚‰ï¼‰ã€Œã¾ã ã¾ã æ²¹æ–­ã™ã‚‹ãªï¼ã€ ğŸ˜ƒã€Œ...èã“ãˆã¦ã¾ã™ï¼Ÿã€",type:"passerby"}),n.push({mainTeacher:"kind-teacher",otherTeacher:"wise-sage",message:"ğŸ˜ƒã€Œã‚ˆãã§ãã¾ã—ãŸï¼ã€ ğŸ§™ã€Œã†ã‚€ã€ç€å®Ÿãªæˆé•·ã˜ã‚ƒã€ ğŸ˜ƒã€Œè³¢è€…å…ˆç”Ÿã‚‚ãã†æ€ã‚ã‚Œã¾ã™ã‚ˆã­ã€",type:"support"})),t||n.push({mainTeacher:"kind-teacher",otherTeacher:"enthusiastic-coach",message:"ğŸ˜ƒã€Œå¤§ä¸ˆå¤«ã€æ¬¡ã¯å¿…ãšã§ãã¾ã™ã‚ˆã€ ğŸ˜¼ã€Œãã†ãã†ï¼å¤±æ•—ã¯æˆåŠŸã®æ¯ã ï¼ã€ ğŸ˜ƒã€Œç†±è¡€ã‚³ãƒ¼ãƒã‚‚å¿œæ´ã—ã¦ã¾ã™ã‚ˆã€",type:"support"}),n.push({mainTeacher:"kind-teacher",message:"ğŸ˜ƒã€Œã‚ã€ãŠèŒ¶ã‚’å…¥ã‚Œå¿˜ã‚Œã¦...ã€ ğŸ˜ˆï¼ˆé ãã‹ã‚‰ï¼‰ã€Œä»•äº‹ä¸­ã«ä½•ã—ã¦ã‚‹ï¼ã€ ğŸ˜ƒã€Œã™ã€ã™ã¿ã¾ã›ã‚“ï¼ã€",type:"joke"})),r==="analyst"&&(s>=10&&n.push({mainTeacher:"analyst",otherTeacher:"enthusiastic-coach",message:"ğŸ¤–ã€Œ10é€£ç¶šæ­£è§£ã€‚çµ±è¨ˆçš„ã«æœ‰æ„ã§ã™ã€ ğŸ˜¼ã€Œã™ã’ãƒ¼ï¼æœ€é«˜ã ï¼ã€ ğŸ¤–ã€Œ...æ„Ÿæƒ…è¡¨ç¾ã¯ä¸è¦ã§ã™ã€",type:"banter"}),n.push({mainTeacher:"analyst",otherTeacher:"drill-sergeant",message:"ğŸ¤–ã€Œãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãã¨...ã€ ğŸ˜ˆã€Œç†å±ˆã¯ã„ã„ï¼æ°—åˆã ï¼ã€ ğŸ¤–ã€Œéç§‘å­¦çš„ã§ã™ã€ ğŸ˜ˆã€Œã†ã‚‹ã•ã„ï¼ã€",type:"argument"}),n.push({mainTeacher:"analyst",otherTeacher:"kind-teacher",message:"ğŸ¤–ã€Œæ­£ç­”ç‡73.4%ã€ ğŸ˜ƒã€Œã‚ã®...ã‚‚ã†å°‘ã—å„ªã—ãä¼ãˆã‚‰ã‚Œã¾ã›ã‚“ã‹ï¼Ÿã€ ğŸ¤–ã€Œäº‹å®Ÿã‚’è¿°ã¹ã¦ã„ã‚‹ã ã‘ã§ã™ã€",type:"banter"}),n.push({mainTeacher:"analyst",message:"ğŸ¤–ã€Œ...ã‚³ãƒ¼ãƒ’ãƒ¼ã®ã‚«ãƒ•ã‚§ã‚¤ãƒ³å«æœ‰é‡ã¯...ã€ ğŸ˜ƒã€Œåˆ†æå®˜å…ˆç”Ÿã€ä»Šã¯æˆæ¥­ä¸­ã§ã™ã‚ˆã€ ğŸ¤–ã€Œå¤±ç¤¼ã—ã¾ã—ãŸã€",type:"joke"})),r==="enthusiastic-coach"&&(t&&s>=5&&(n.push({mainTeacher:"enthusiastic-coach",otherTeacher:"wise-sage",message:"ğŸ˜¼ã€Œæœ€ã£é«˜ã ããï¼ï¼ã€ ğŸ§™ã€Œ...å°‘ã—å£°ãŒå¤§ãã„ã‹ã®ã†ã€ ğŸ˜¼ã€Œã†ã‚‹ã•ãã¦æ‚ªã‹ã£ãŸãªï¼ã€",type:"banter"}),n.push({mainTeacher:"enthusiastic-coach",otherTeacher:"drill-sergeant",message:"ğŸ˜¼ã€Œã‚ˆã£ã—ã‚ƒãƒ¼ï¼ã€ ğŸ˜ˆã€Œé¨’ãŒã—ã„...ã ãŒã€æ‚ªããªã„ãªã€ ğŸ˜¼ã€ŒãŠã£ã€é¬¼è»æ›¹ã«è¤’ã‚ã‚‰ã‚ŒãŸï¼ã€",type:"support"})),t||n.push({mainTeacher:"enthusiastic-coach",otherTeacher:"kind-teacher",message:"ğŸ˜¼ã€Œãƒ‰ãƒ³ãƒã‚¤ï¼æ¬¡ã æ¬¡ï¼ã€ ğŸ˜ƒã€Œãã†ã§ã™ã­ã€ç„¦ã‚‰ãšã«ã€ ğŸ˜¼ã€ŒäºŒäººã§å¿œæ´ã—ã¦ã‚‹ãï¼ã€",type:"support"}),n.push({mainTeacher:"enthusiastic-coach",message:"ğŸ˜¼ã€Œä»Šæ—¥ã®ç­‹ãƒˆãƒ¬ã¯...ã€ ğŸ¤–ã€Œãã‚Œã¯è‹±èªå­¦ç¿’ã¨ç„¡é–¢ä¿‚ã§ã™ã€ ğŸ˜¼ã€Œä½“ãŒè³‡æœ¬ã ã‚ï¼ï¼Ÿã€",type:"joke"})),r==="wise-sage"&&(t&&n.push({mainTeacher:"wise-sage",otherTeacher:"drill-sergeant",message:"ğŸ§™ã€Œè‰¯ãæˆé•·ã˜ã‚ƒã€ ğŸ˜ˆã€Œå½“ãŸã‚Šå‰ã ã€ä¿ºã®æ•™ãˆå­ã ã‹ã‚‰ãªã€ ğŸ§™ã€Œ...ãŠä¸»ã‚‚æ•™ãˆã¦ãŠã£ãŸã®ã‹ï¼Ÿã€",type:"banter"}),n.push({mainTeacher:"wise-sage",otherTeacher:"analyst",message:"ğŸ§™ã€Œæ™‚ã«ã¯æ„Ÿè¦šã‚‚å¤§äº‹ã˜ã‚ƒãã€ ğŸ¤–ã€Œæ„Ÿè¦šã¯æ¸¬å®šä¸å¯èƒ½ã§ã™ã€ ğŸ§™ã€Œ...è‹¥ã„ã®ã†ã€",type:"argument"}),n.push({mainTeacher:"wise-sage",otherTeacher:"enthusiastic-coach",message:"ğŸ§™ã€Œç„¦ã‚‰ãšã€ã˜ã£ãã‚Šã¨...ã€ ğŸ˜¼ã€ŒãŸã¾ã«ã¯å…¨åŠ›ç–¾èµ°ã‚‚å¤§äº‹ã£ã™ã‚ˆï¼ã€ ğŸ§™ã€Œ...ãã‚Œã‚‚ä¸€ç†ã‚ã‚‹ã‹ã€",type:"banter"}),n.push({mainTeacher:"wise-sage",message:"ğŸ§™ã€Œæ˜”ã¯ã®ã†...ã€ ğŸ˜ƒğŸ˜ˆğŸ˜¼ğŸ¤–ã€Œã€Œã€Œã€Œã¾ãŸæ˜”è©±ï¼ï¼Ÿã€ã€ã€ã€ ğŸ§™ã€Œ...æœ€è¿‘ã®è‹¥è€…ã¯ã€",type:"joke"}));const a=[{mainTeacher:r,message:"ğŸ˜ƒã€ŒãŠæ˜¼ã¯ä½•é£Ÿã¹ã¾ã™ï¼Ÿã€ ğŸ˜ˆã€Œæ™‚é–“ã®ç„¡é§„ã ã€ ğŸ˜¼ã€Œä¿ºã¯ã‚«ãƒ„ä¸¼ï¼ã€ ğŸ¤–ã€Œæ „é¤Šãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®ã™ã¹ãã§ã™ã€ ğŸ§™ã€Œ...ã‚ã—ã¯è•éº¦ãŒã„ã„ã®ã†ã€",type:"joke"},{mainTeacher:r,message:"ğŸ˜ˆã€Œ...èª°ã ã€è·å“¡å®¤ã§ã‚³ãƒ¼ãƒ’ãƒ¼ã“ã¼ã—ãŸã®ã¯ï¼ã€ ğŸ˜ƒã€Œã™ã€ã™ã¿ã¾ã›ã‚“...ã€ ğŸ˜¼ã€Œãƒ‰ãƒ³ãƒã‚¤ï¼ã€ ğŸ¤–ã€Œæ¸…æƒæ–¹æ³•ã‚’æç¤ºã—ã¾ã™ã€",type:"joke"},{mainTeacher:r,message:"ğŸ§™ã€Œ...å°åˆ·æ©ŸãŒå‹•ã‹ã‚“ã®ã˜ã‚ƒãŒã€ ğŸ¤–ã€ŒITæ‹…å½“ã‚’å‘¼ã³ã¾ã™ã€ ğŸ˜ƒã€Œç§ãŒè¦‹ã¦ã¿ã¾ã™ã­ã€ ğŸ˜ˆã€Œã•ã£ã•ã¨ç›´ã›ï¼ã€ ğŸ˜¼ã€Œã¿ã‚“ãªã§å”åŠ›ã ï¼ã€",type:"joke"},{mainTeacher:r,message:"ğŸ˜¼ã€Œä»Šæ—¥ã®æˆæ¥­ã©ã†ã ã£ãŸï¼Ÿã€ ğŸ˜ƒã€Œã¿ã‚“ãªé ‘å¼µã£ã¦ã¾ã—ãŸã‚ˆã€ ğŸ˜ˆã€Œã¾ã ã¾ã ã ã€ ğŸ¤–ã€Œãƒ‡ãƒ¼ã‚¿ã§è¦‹ã‚‹ã¨æ”¹å–„å‚¾å‘ã§ã™ã€ ğŸ§™ã€Œãã‚Œãã‚Œã®æˆé•·ãŒã‚ã‚‹ã®ã†ã€",type:"banter"}];return Math.random()<.05&&n.push(...a),n}function ei(){const r=new Date().getHours();if(Math.random()>.05)return null;if(r>=6&&r<9){const t=["ğŸ˜ƒã€ŒãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ã€ ğŸ˜ˆã€Œæœã‹ã‚‰å…ƒæ°—ã ãªã€ ğŸ˜¼ã€Œã‚ˆã£ã—ã‚ƒã€ä»Šæ—¥ã‚‚å…¨åŠ›ã ï¼ã€","ğŸ§™ã€Œã†ã‚€ã€è‰¯ã„æœã˜ã‚ƒã®ã†ã€ ğŸ¤–ã€Œæ°—æ¸©18åº¦ã€å­¦ç¿’ã«æœ€é©ã§ã™ã€ ğŸ˜ƒã€Œå¤©æ°—ã‚‚è‰¯ã„ã§ã™ã­ã€","ğŸ˜ˆã€Œé…åˆ»ã™ã‚‹ãªï¼ã€ ğŸ˜ƒã€Œã¾ã€ã¾ã é–‹å§‹10åˆ†å‰ã§ã™ã‚ˆ...ã€"];return t[Math.floor(Math.random()*t.length)]}if(r>=12&&r<13){const t=["ğŸ˜¼ã€Œè…¹æ¸›ã£ãŸã€œï¼ã€ ğŸ˜ƒã€ŒãŠå¼å½“è²·ã£ã¦ãã¾ã—ãŸã‚ˆã€ ğŸ˜ˆã€Œæ˜¼ä¼‘ã¿ã¯30åˆ†ã ãã€","ğŸ§™ã€Œä»Šæ—¥ã®å®šé£Ÿã¯ä½•ã‹ã®ã†ã€ ğŸ¤–ã€Œã‚«ãƒ­ãƒªãƒ¼è¨ˆç®—ãŒå¿…è¦ã§ã™ã€ ğŸ˜ƒã€Œã¿ã‚“ãªã§é£Ÿã¹ã¾ã—ã‚‡ã†ã€","ğŸ˜ˆã€Œé£Ÿå¾Œã¯ä¼‘ã‚€ãªï¼ã€ ğŸ˜ƒã€Œæ¶ˆåŒ–ã«æ‚ªã„ã§ã™ã‚ˆ...ã€ ğŸ˜¼ã€Œå°‘ã—ã¯ä¼‘ã‚‚ã†ãœï¼ã€"];return t[Math.floor(Math.random()*t.length)]}if(r>=17&&r<19){const t=["ğŸ˜ƒã€Œä»Šæ—¥ã‚‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸã€ ğŸ˜ˆã€Œã¾ã çµ‚ã‚ã£ã¦ãªã„ã€ ğŸ˜¼ã€Œã„ã‚„ã€ååˆ†é ‘å¼µã£ãŸã£ã¦ï¼ã€","ğŸ§™ã€Œæ—¥ãŒæš®ã‚Œã¦ããŸã®ã†ã€ ğŸ¤–ã€Œ17æ™‚32åˆ†ã€å®šåˆ»ã§ã™ã€ ğŸ˜ƒã€Œã¿ã‚“ãªé ‘å¼µã‚Šã¾ã—ãŸã­ã€","ğŸ˜¼ã€Œä»Šæ—¥ã®åçœä¼šã™ã‚‹ï¼Ÿã€ ğŸ˜ƒã€Œã„ã„ã§ã™ã­ã€ ğŸ˜ˆã€Œç„¡é§„è©±ã¯ã™ã‚‹ãªã€ ğŸ§™ã€Œãã‚Œã‚‚å¤§åˆ‡ã˜ã‚ƒãã€"];return t[Math.floor(Math.random()*t.length)]}if(r>=22){const t=["ğŸ˜ƒã€Œã‚‚ã†é…ã„ã§ã™ã­...ã€ ğŸ˜ˆã€Œå¸°ã‚Œï¼æ˜æ—¥ã«å‚™ãˆã‚ï¼ã€ ğŸ§™ã€Œç„¡ç†ã¯ã„ã‹ã‚“ãã€","ğŸ¤–ã€Œ22æ™‚ã‚’è¶…éã€‚ç¡çœ æ™‚é–“ç¢ºä¿ã‚’æ¨å¥¨ã€ ğŸ˜ƒã€Œãã†ã§ã™ã­ã€å¸°ã‚Šã¾ã—ã‚‡ã†ã€","ğŸ˜¼ã€Œå¤œé…ãã¾ã§ãŠç–²ã‚Œï¼ã€ ğŸ˜ƒã€Œæ˜æ—¥ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ã€ ğŸ˜ˆã€Œ...æ—©ãå¯ã‚ã€"];return t[Math.floor(Math.random()*t.length)]}return null}function ti(r){return r===10?"ğŸ˜¼ã€Œ10é€£ç¶šï¼ï¼ã€ ğŸ˜ˆã€Œã‚ˆã—ï¼ã€ ğŸ˜ƒã€Œã™ã”ã„ï¼ã€ ğŸ¤–ã€Œçµ±è¨ˆçš„ã«å„ªç§€ã€ ğŸ§™ã€Œè¦‹äº‹ã˜ã‚ƒã€":r===20?"ğŸ˜ˆã€Œ20é€£ç¶šã ã¨...ï¼ï¼Ÿã€ ğŸ˜ƒã€Œä¿¡ã˜ã‚‰ã‚Œã¾ã›ã‚“ï¼ã€ ğŸ˜¼ã€Œæœ€ã£é«˜ã ï¼ã€ ğŸ¤–ã€Œç•°å¸¸å€¤ã§ã™ï¼ˆè¤’ã‚è¨€è‘‰ï¼‰ã€ ğŸ§™ã€Œå¤©æ‰ã‹...ã€":r===50?"ğŸ˜ˆğŸ˜ƒğŸ˜¼ğŸ¤–ğŸ§™ã€Œã€Œã€Œã€Œã€Œ50é€£ç¶šï¼ï¼ï¼ï¼ï¼ã€ã€ã€ã€ã€ï¼ˆå…¨å“¡ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚ªãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰":null}function si(){const r=new Date,t=r.getMonth()+1,s=r.getDate(),n=r.getDay();return n===1?"ğŸ˜ƒã€Œä»Šé€±ã‚‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ã€ ğŸ˜ˆã€Œæœˆæ›œã‹ã‚‰é£›ã°ã›ï¼ã€ ğŸ˜¼ã€Œé€±ã®å§‹ã¾ã‚Šã ï¼ã€":n===5?"ğŸ˜¼ã€Œé‡‘æ›œã ï¼ã‚ã¨å°‘ã—ï¼ã€ ğŸ˜ƒã€Œã§ã‚‚æ°—ã‚’æŠœã‹ãšã«ã€ ğŸ˜ˆã€Œæœ€å¾Œã¾ã§æ°—åˆã ï¼ã€":t===12&&s===25?"ğŸ˜ƒã€Œãƒ¡ãƒªãƒ¼ã‚¯ãƒªã‚¹ãƒã‚¹ï¼ã€ ğŸ˜ˆã€Œæµ®ã‹ã‚Œã‚‹ãªã€ ğŸ˜¼ã€ŒãŸã¾ã«ã¯ã„ã„ã ã‚ï¼ã€ ğŸ§™ã€Œã»ã£ã»ã£ã»ã€":t===1&&s===1?"ğŸ˜ƒğŸ˜ˆğŸ˜¼ğŸ¤–ğŸ§™ã€Œã€Œã€Œã€Œã€Œã‚ã‘ã¾ã—ã¦ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã€ã€ã€ã€ã€":null}const ri=[{type:"common-mistake",message:`ğŸ˜ƒã€Œ"I'm exciting"ã£ã¦è¨€ã£ã¦ã¾ã›ã‚“ã‹ï¼Ÿæ­£ã—ãã¯"I'm excited"ã§ã™ã‚ˆã€‚è‡ªåˆ†ãŒãƒ¯ã‚¯ãƒ¯ã‚¯ã—ã¦ã‚‹æ™‚ã¯edå½¢ã§ã™ï¼ã€`,teacher:"kind-teacher"},{type:"common-mistake",message:`ã€Œ"I'm boring"ã¯ã€Œç§ã¯é€€å±ˆãªäººé–“ã ã€ã¨ã„ã†æ„å‘³ã ãï¼"I'm bored"ãŒæ­£è§£ã ï¼é–“é•ãˆã‚‹ãªï¼ã€`,teacher:"drill-sergeant"},{type:"common-mistake",message:'ğŸ¤–ã€Œ"funny"ã¨"fun"ã¯ç•°ãªã‚Šã¾ã™ã€‚"funny"ã¯ã€Œé¢ç™½ã„ï¼ˆç¬‘ãˆã‚‹ï¼‰ã€ã€"fun"ã¯ã€Œæ¥½ã—ã„ã€ã€‚ä½¿ã„åˆ†ã‘ãŒé‡è¦ã§ã™ã€‚ã€',teacher:"analyst"},{type:"common-mistake",message:'ğŸ˜ƒã€Œ"advice"ã¯æ•°ãˆã‚‰ã‚Œãªã„åè©ãªã®ã§ã€"an advice"ã¨ã¯è¨€ãˆã¾ã›ã‚“ã€‚"a piece of advice"ã¨è¨€ã„ã¾ã—ã‚‡ã†ï¼ã€',teacher:"kind-teacher"},{type:"common-mistake",message:'ã€Œ"How do you think?"ã¯é–“é•ã„ã ï¼"What do you think?"ãŒæ­£è§£ï¼ä½•åº¦è¨€ã‚ã›ã‚‹ï¼ã€',teacher:"drill-sergeant"},{type:"common-mistake",message:'ğŸ˜¼ã€Œ"see a dream"ã˜ã‚ƒãªã„ãï¼"have a dream"ã ï¼å¤¢ã¯è¦‹ã‚‹ã‚“ã˜ã‚ƒãªãã¦æŒã¤ã‚“ã ï¼ã€',teacher:"enthusiastic-coach"},{type:"common-mistake",message:'ğŸ§™ã€Œ"say"ã¨"tell"ã®é•ã„ã˜ã‚ƒãŒ..."say"ã¯å†…å®¹ã‚’ã€"tell"ã¯ç›¸æ‰‹ã‚’å¼·èª¿ã™ã‚‹ã®ã˜ã‚ƒã€‚"tell me"ã¨ã¯è¨€ãˆã‚‹ãŒ"say me"ã¨ã¯è¨€ãˆã¬ãã€‚ã€',teacher:"wise-sage"},{type:"common-mistake",message:'ğŸ˜ƒã€Œ"enjoy"ã®å¾Œã¯å¿…ãš-ingå½¢ã§ã™ã‚ˆï¼"enjoy to study"ã§ã¯ãªã"enjoy studying"ã§ã™ã€‚ã€',teacher:"kind-teacher"},{type:"common-mistake",message:'ğŸ¤–ã€Œ"remember to do"ï¼ˆã“ã‚Œã‹ã‚‰ã™ã‚‹ã“ã¨ã‚’è¦šãˆã¦ã„ã‚‹ï¼‰ã¨"remember doing"ï¼ˆã—ãŸã“ã¨ã‚’è¦šãˆã¦ã„ã‚‹ï¼‰ã¯æ„å‘³ãŒç•°ãªã‚Šã¾ã™ã€‚ã€',teacher:"analyst"},{type:"common-mistake",message:`ã€Œ"I'm agree"ã¯é–“é•ã„ã ï¼"agree"ã¯å‹•è©ã ã‹ã‚‰"I agree"ã ï¼åŸºæœ¬ã‚’å¿˜ã‚Œã‚‹ãªï¼ã€`,teacher:"drill-sergeant"}],ni=[{type:"fun-fact",message:'ğŸ§™ã€Œæ¥é ­è¾"re-"ã¯ã€Œå†ã³ã€ã®æ„å‘³ã˜ã‚ƒã€‚returnï¼ˆæˆ»ã‚‹ï¼‰ã€reviewï¼ˆå¾©ç¿’ï¼‰ã€repeatï¼ˆç¹°ã‚Šè¿”ã™ï¼‰ãªã©ã€è¦šãˆã‚„ã™ã„ãã€‚ã€',teacher:"wise-sage"},{type:"fun-fact",message:"ğŸ¤–ã€Œé•·æ–‡èª­è§£ã®ã‚³ãƒ„ï¼šæœ€åˆã¨æœ€å¾Œã®æ®µè½ã€å„æ®µè½ã®æœ€åˆã®æ–‡ã‚’èª­ã‚ã°å…¨ä½“ã®æµã‚ŒãŒã¤ã‹ã‚ã¾ã™ã€‚ã€",teacher:"analyst"},{type:"fun-fact",message:'ğŸ˜ƒã€Œ"however"ï¼ˆã—ã‹ã—ï¼‰ã€"therefore"ï¼ˆã—ãŸãŒã£ã¦ï¼‰ã€"moreover"ï¼ˆã•ã‚‰ã«ï¼‰ãªã©ã®æ¥ç¶šè©ã‚’è¦šãˆã‚‹ã¨ã€è«–ç†å±•é–‹ãŒè¦‹ãˆã‚„ã™ããªã‚Šã¾ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"fun-fact",message:'ğŸ˜¼ã€Œæ¥å°¾è¾"-tion"ã‚’ã¤ã‘ã‚‹ã¨å‹•è©ãŒåè©ã«ãªã‚‹ãï¼educateâ†’educationã€communicateâ†’communicationã ï¼ã€',teacher:"enthusiastic-coach"},{type:"fun-fact",message:'ğŸ§™ã€Œ"compare A with B"ï¼ˆAã¨Bã‚’æ¯”è¼ƒã™ã‚‹ï¼‰ã¨"compare A to B"ï¼ˆAã‚’Bã«ä¾‹ãˆã‚‹ï¼‰ã¯æ„å‘³ãŒé•ã†ãã€‚è©¦é¨“ã§ã‚ˆãå‡ºã‚‹ã€‚ã€',teacher:"wise-sage"},{type:"fun-fact",message:"ğŸ¤–ã€ŒåŒç¾©èªã‚’å¢—ã‚„ã™ã¨è¡¨ç¾åŠ›ãŒä¸ŠãŒã‚Šã¾ã™ã€‚important=significant=crucialã€show=demonstrate=illustrate ãªã©ã€‚ã€",teacher:"analyst"},{type:"fun-fact",message:'ğŸ˜ƒã€Œæ¥é ­è¾"un-"ã€"in-"ã€"dis-"ã¯å¦å®šã®æ„å‘³ã€‚unhappyã€impossibleã€disagreeãªã©ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è¦šãˆã¾ã—ã‚‡ã†ï¼ã€',teacher:"kind-teacher"},{type:"fun-fact",message:'ã€Œ"not only A but also B"ï¼ˆAã ã‘ã§ãªãBã‚‚ï¼‰ã¯é »å‡ºæ§‹æ–‡ã ï¼ã‚»ãƒƒãƒˆã§è¦šãˆã‚ï¼ã€',teacher:"drill-sergeant"},{type:"fun-fact",message:'ğŸ§™ã€Œ"although"ã¨"though"ã¯ã»ã¼åŒã˜æ„å‘³ï¼ˆã€œã ã‘ã‚Œã©ã‚‚ï¼‰ã˜ã‚ƒãŒã€thoughã®æ–¹ãŒã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ã˜ã‚ƒãªã€‚ã€',teacher:"wise-sage"},{type:"fun-fact",message:'ğŸ˜¼ã€Œæ¥å°¾è¾"-able"ã¯ã€Œã€œã§ãã‚‹ã€ã®æ„å‘³ã ï¼readableï¼ˆèª­ã‚ã‚‹ï¼‰ã€comfortableï¼ˆå¿«é©ãªï¼‰ã£ã¦æ„Ÿã˜ã ãï¼ã€',teacher:"enthusiastic-coach"}],ai=[{type:"cultural",message:"ğŸ˜ƒã€Œè‹±æ–‡ã‚¨ãƒƒã‚»ã‚¤ã¯çµè«–ã‚’æœ€åˆã«æ›¸ãã®ãŒåŸºæœ¬ã€‚Introductionâ†’Bodyâ†’Conclusionã®3éƒ¨æ§‹æˆã§ã™ã‚ˆã€‚ã€",teacher:"kind-teacher"},{type:"cultural",message:'ğŸ§™ã€Œè‹±èªã®è«–ç†å±•é–‹ã¯"ä¸»å¼µâ†’ç†ç”±â†’å…·ä½“ä¾‹"ãŒåŸºæœ¬ã˜ã‚ƒã€‚For example, For instance ã‚’ä½¿ã„ã“ãªãã†ã€‚ã€',teacher:"wise-sage"},{type:"cultural",message:"ğŸ¤–ã€Œå­¦è¡“çš„ãªæ–‡ç« ã§ã¯ã€contractionsï¼ˆçŸ­ç¸®å½¢ï¼‰ã¯ä½¿ã„ã¾ã›ã‚“ã€‚don'tâ†’do notã€it'sâ†’it is ã¨æ›¸ãã¾ã™ã€‚ã€",teacher:"analyst"},{type:"cultural",message:"ğŸ˜¼ã€Œæ„è¦‹ã‚’è¿°ã¹ã‚‹è¡¨ç¾ï¼I think, In my opinion, From my perspective ãªã©ã€ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å¢—ã‚„ãã†ï¼ã€",teacher:"enthusiastic-coach"},{type:"cultural",message:'ğŸ˜ƒã€Œç†ç”±ã‚’è¿°ã¹ã‚‹æ™‚ã¯"because"ã ã‘ã˜ã‚ƒãªãã€"since"ã€"as"ã€"due to"ãªã©ã‚‚ä½¿ãˆã¾ã™ã‚ˆã€‚ã€',teacher:"kind-teacher"},{type:"cultural",message:'ã€Œå—å‹•æ…‹ã‚’ä½¿ã„ã“ãªã›ï¼"The experiment was conducted"ãªã©ã€å®¢è¦³çš„ãªè¡¨ç¾ã«å¿…è¦ã ï¼ã€',teacher:"drill-sergeant"},{type:"cultural",message:'ğŸ§™ã€Œå¯¾æ¯”ã®è¡¨ç¾ï¼š"on the other hand"ï¼ˆä¸€æ–¹ã§ï¼‰ã€"in contrast"ï¼ˆå¯¾ç…§çš„ã«ï¼‰ã¯è«–è¿°å•é¡Œã§é‡å®ã™ã‚‹ãã€‚ã€',teacher:"wise-sage"}],ii=[{type:"etymology",message:'ğŸ§™ã€Œ"pre-"ã¯ã€Œå‰ã€ã®æ„å‘³ã˜ã‚ƒã€‚previewï¼ˆäºˆç¿’ãƒ»è©¦å†™ï¼‰ã€predictï¼ˆäºˆæ¸¬ã™ã‚‹ï¼‰ã€prepareï¼ˆæº–å‚™ã™ã‚‹ï¼‰ã¨è¦šãˆã‚ˆã†ã€‚ã€',teacher:"wise-sage"},{type:"etymology",message:'ğŸ¤–ã€Œ"post-"ã¯ã€Œå¾Œã€ã€‚postponeï¼ˆå»¶æœŸã™ã‚‹ï¼‰ã€postwarï¼ˆæˆ¦å¾Œã®ï¼‰ãªã©ã€‚pre-ã¨ã‚»ãƒƒãƒˆã§è¦šãˆã‚‹ã¨åŠ¹ç‡çš„ã§ã™ã€‚ã€',teacher:"analyst"},{type:"etymology",message:'ğŸ˜ƒã€Œ"tele-"ã¯ã‚®ãƒªã‚·ãƒ£èªã§ã€Œé ã„ã€ã¨ã„ã†æ„å‘³ã€‚telephoneï¼ˆé›»è©±ï¼‰ã€televisionï¼ˆãƒ†ãƒ¬ãƒ“ï¼‰ã€telescopeï¼ˆæœ›é é¡ï¼‰ã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"etymology",message:'ğŸ§™ã€Œ"bi-"ã¯ã€Œ2ã¤ã€ã®æ„å‘³ã˜ã‚ƒã€‚bicycleï¼ˆäºŒè¼ªè»Šï¼‰ã€bilingualï¼ˆ2è¨€èªè©±ã›ã‚‹ï¼‰ã€biweeklyï¼ˆéš”é€±ã®ï¼‰ã˜ã‚ƒãªã€‚ã€',teacher:"wise-sage"},{type:"etymology",message:'ğŸ˜¼ã€Œ"auto-"ã¯ã€Œè‡ªå‹•ãƒ»è‡ªå·±ã€ã ï¼automaticï¼ˆè‡ªå‹•ã®ï¼‰ã€autobiographyï¼ˆè‡ªä¼ï¼‰ã£ã¦æ„Ÿã˜ã ãï¼ã€',teacher:"enthusiastic-coach"},{type:"etymology",message:'ğŸ¤–ã€Œ"micro-"ã¯ã€Œå°ã•ã„ã€ã€"macro-"ã¯ã€Œå¤§ãã„ã€ã€‚microscopeï¼ˆé¡•å¾®é¡ï¼‰ã€macroeconomicsï¼ˆãƒã‚¯ãƒ­çµŒæ¸ˆå­¦ï¼‰ã§ã™ã€‚ã€',teacher:"analyst"},{type:"etymology",message:'ğŸ˜ƒã€Œ"sub-"ã¯ã€Œä¸‹ã€ã®æ„å‘³ã€‚subwayï¼ˆåœ°ä¸‹é‰„ï¼‰ã€submarineï¼ˆæ½œæ°´è‰¦ï¼‰ã€subtitleï¼ˆå­—å¹•ï¼‰ã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"etymology",message:'ğŸ§™ã€Œ"super-"ã¯ã€Œä¸Šãƒ»è¶…ã€ã˜ã‚ƒã€‚superiorï¼ˆå„ªã‚ŒãŸï¼‰ã€supernaturalï¼ˆè¶…è‡ªç„¶çš„ãªï¼‰ã€superviseï¼ˆç›£ç£ã™ã‚‹ï¼‰ã˜ã‚ƒãªã€‚ã€',teacher:"wise-sage"}],oi=[{type:"grammar-tip",message:'ğŸ˜ƒã€Œ"a"ã¨"an"ã®ä½¿ã„åˆ†ã‘ã¯ã€æ¬¡ã®å˜èªã®ã€ŒéŸ³ã€ã§æ±ºã¾ã‚Šã¾ã™ã€‚"an hour"ï¼ˆhourã®hã¯ç™ºéŸ³ã—ãªã„ï¼‰ã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"grammar-tip",message:'ã€Œç¾åœ¨å®Œäº†ã¯ã€Œä»Šã«é–¢ä¿‚ãŒã‚ã‚‹éå»ã€ã ï¼"I have lost my key"ã¯ä»Šã‚‚è¦‹ã¤ã‹ã£ã¦ãªã„ã¨ã„ã†æ„å‘³ã ï¼ã€',teacher:"drill-sergeant"},{type:"grammar-tip",message:'ğŸ¤–ã€Œ"fewer"ã¯æ•°ãˆã‚‰ã‚Œã‚‹åè©ã€"less"ã¯æ•°ãˆã‚‰ã‚Œãªã„åè©ã«ä½¿ã„ã¾ã™ã€‚"fewer people"ã€"less water"ã§ã™ã€‚ã€',teacher:"analyst"},{type:"grammar-tip",message:'ğŸ§™ã€Œ"used to"ã¯éå»ã®ç¿’æ…£ã€"be used to"ã¯æ…£ã‚Œã¦ã„ã‚‹ã€"get used to"ã¯æ…£ã‚Œã‚‹ã˜ã‚ƒã€‚å…¨ã¦é•ã†ãã€‚ã€',teacher:"wise-sage"},{type:"grammar-tip",message:'ğŸ˜¼ã€Œ"will"ã¯æ„å¿—ã€"be going to"ã¯äºˆå®šã‚„äºˆæ¸¬ã ï¼ä½¿ã„åˆ†ã‘ã‚‰ã‚Œã‚‹ã¨è‹±èªã£ã½ããªã‚‹ãï¼ã€',teacher:"enthusiastic-coach"},{type:"grammar-tip",message:'ğŸ˜ƒã€Œ"some"ã¨"any"ã€è‚¯å®šæ–‡ã¯someã€ç–‘å•æ–‡ãƒ»å¦å®šæ–‡ã¯anyãŒåŸºæœ¬ã§ã™ãŒã€"Would you like some tea?"ã®ã‚ˆã†ã«å‹§ã‚ã‚‹æ™‚ã¯someã§ã™ã‚ˆï¼ã€',teacher:"kind-teacher"},{type:"grammar-tip",message:'ã€Œä¸‰å˜ç¾ã®sï¼å¿˜ã‚Œã‚‹ãªï¼"He go"ã§ã¯ãªã"He goes"ã ï¼åŸºæœ¬ä¸­ã®åŸºæœ¬ã ãï¼ã€',teacher:"drill-sergeant"}];function li(r){if(Math.random()>.08)return null;if(r){const t=[...ni,...ii,...ai];return t[Math.floor(Math.random()*t.length)].message}else{const t=[...ri,...oi];return t[Math.floor(Math.random()*t.length)].message}}function ci(r,t){const s=t&&(t.includes(" ")||t.includes("-")),n=["ğŸ˜ƒğŸ’¡ å—é¨“ãƒ†ã‚¯ï¼åŒã˜å˜èªã®ç¹°ã‚Šè¿”ã—ã‚’é¿ã‘ã‚‹ãŸã‚ã€ä»£åè©ï¼ˆit, they, thisï¼‰ã‚„åŒç¾©èªã«æ³¨ç›®ã™ã‚‹ã¨èª­è§£ãŒæ¥½ã«ãªã‚Šã¾ã™ã‚ˆã€‚","ğŸ§™ğŸ’¡ é•·æ–‡ã®ã‚³ãƒ„ï¼šè¨­å•ã‚’å…ˆã«èª­ã‚“ã§ã‹ã‚‰æœ¬æ–‡ã‚’èª­ã‚€ã¨ã€ä½•ã‚’æ¢ã›ã°ã„ã„ã‹åˆ†ã‹ã£ã¦åŠ¹ç‡çš„ã˜ã‚ƒã€‚","ğŸ¤–ğŸ’¡ çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ï¼šåˆç´šã¯ç´„1,077èªã€ä¸­ç´šã¯ç´„1,616èªã€ä¸Šç´šã¯ç´„885èªã§ã™ã€‚è¨ˆç”»çš„ã«èªå½™ã‚’å¢—ã‚„ã—ã¾ã—ã‚‡ã†ã€‚",'ğŸ’¡ æ™‚åˆ¶ã®ä¸€è‡´ï¼ä¸»ç¯€ãŒéå»å½¢ãªã‚‰å¾“å±ç¯€ã‚‚éå»å½¢ã ï¼"He said that he was tired"ã ãï¼',"ğŸ˜ƒğŸ’¡ æ•´åºå•é¡Œã®ã‚³ãƒ„ï¼ã¾ãšä¸»èªã¨å‹•è©ã‚’è¦‹ã¤ã‘ã¦ã€ä¿®é£¾èªã‚’å¾Œã‹ã‚‰ä»˜ã‘è¶³ã™ã¨è§£ãã‚„ã™ã„ã§ã™ã‚ˆã€‚",'ğŸ§™ğŸ’¡ å† è©ã®ä½¿ã„åˆ†ã‘ï¼š"a/an"ã¯åˆã‚ã¦å‡ºã‚‹ãƒ»ç‰¹å®šã§ããªã„ã‚‚ã®ã€"the"ã¯æ—¢å‡ºãƒ»ç‰¹å®šã§ãã‚‹ã‚‚ã®ã˜ã‚ƒã€‚',"ğŸ˜¼ğŸ’¡ ãƒªã‚¹ãƒ‹ãƒ³ã‚°å¯¾ç­–ï¼æ¶ˆå»æ³•ãŒæœ‰åŠ¹ã ï¼æ˜ã‚‰ã‹ã«é•ã†é¸æŠè‚¢ã‚’æ¶ˆã—ã¦ã„ãã¨æ­£è§£ç‡ãŒä¸ŠãŒã‚‹ãï¼","ğŸ¤–ğŸ’¡ åŠ¹ç‡çš„å­¦ç¿’æ³•ï¼šå˜èªã¯æ–‡è„ˆã®ä¸­ã§è¦šãˆã‚‹ã¨å®šç€ç‡ãŒ3å€ä»¥ä¸Šé«˜ã¾ã‚Šã¾ã™ã€‚ä¾‹æ–‡ã”ã¨è¦šãˆã¾ã—ã‚‡ã†ã€‚",'ğŸ˜ƒğŸ’¡ æ¯”è¼ƒè¡¨ç¾ï¼š"as...as"ï¼ˆåŒç­‰ï¼‰ã€"-er than"ï¼ˆæ¯”è¼ƒç´šï¼‰ã€"the -est"ï¼ˆæœ€ä¸Šç´šï¼‰ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã¾ã—ã‚‡ã†ï¼'];return s&&n.push("ğŸ˜¼ğŸ’¡ è¦šãˆæ–¹ï¼ç†Ÿèªã¯å‹•è©ã¨å‰ç½®è©ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’çµ„ã¿åˆã‚ã›ã¦è¦šãˆã‚‹ã¨ã„ã„ãï¼è¦–è¦šçš„ã«ã‚¤ãƒ¡ãƒ¼ã‚¸ã™ã‚‹ã¨å¿˜ã‚Œã«ãã„ãï¼"),n[Math.floor(Math.random()*n.length)]}function ts({mode:r="translation",currentScore:t=0,totalAnswered:s=0,sessionCorrect:n=0,_sessionIncorrect:a=0,_sessionReview:o=0,isReviewFocusMode:l=!1,onReviewFocus:i,onShowSettings:c,currentWord:d,onAnswerTime:m,lastAnswerCorrect:h,lastAnswerWord:g,lastAnswerDifficulty:S,correctStreak:b=0,incorrectStreak:y=0,learningPhase:v,estimatedSpeed:k,forgettingRate:D,dataSource:C="",category:w="",difficulty:E="",wordPhraseFilter:$="",grammarUnit:G,sessionStats:Y}){const[q,me]=u.useState("ai"),[Ne,be]=u.useState(()=>{const x=localStorage.getItem("aiPersonality")||"kind-teacher";return Qa(x)||"ã“ã‚“ã«ã¡ã¯ï¼ä¸€ç·’ã«å­¦ç¿’ã—ã¾ã—ã‚‡ã†ã€‚"}),[Re,A]=u.useState("");u.useEffect(()=>{if(d){const x=localStorage.getItem("aiPersonality")||"kind-teacher",f=qt(d);let N="";if(f){const{totalCount:T,correctCount:H}=f,V=T-H,L=T>0?Math.round(H/T*100):0;if(T===0)switch(x){case"drill-sergeant":N="æ–°ã—ã„å˜èªã ï¼æ°—åˆã‚’å…¥ã‚Œã¦è¦šãˆã‚ï¼";break;case"kind-teacher":N="åˆã‚ã¦ã®å˜èªã§ã™ã­ã€‚ã˜ã£ãã‚Šè€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†";break;case"analyst":N="æ–°è¦å˜èªã€‚ãƒ‡ãƒ¼ã‚¿ãªã—ã€‚åˆå›æ¸¬å®šã‚’é–‹å§‹ã—ã¾ã™";break;case"enthusiastic-coach":N="æ–°ã—ã„ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã ï¼æ€ã„åˆ‡ã£ã¦è¡Œã“ã†ï¼";break;case"wise-sage":N="åˆã‚ã¦å‡ºä¼šã†å˜èªã˜ã‚ƒãªã€‚ç„¦ã‚‰ãšå‘ãåˆãŠã†";break;default:N="åˆã‚ã¦ã®å˜èªã§ã™"}else if(T===1){const P=H===1;switch(x){case"drill-sergeant":N=P?"2å›ç›®ã ï¼å‰å›ã¯æ­£è§£ã—ãŸãã€‚ã¾ãŸã‚„ã‚Œï¼":"2å›ç›®ã ï¼å‰å›ã¯é–“é•ãˆãŸã€‚ä»Šåº¦ã“ãæ±ºã‚ã‚ï¼";break;case"kind-teacher":N=P?"2å›ç›®ã®å‡ºé¡Œã§ã™ã€‚å‰å›ã¯æ­£è§£ã§ãã¾ã—ãŸã­":"2å›ç›®ã®å‡ºé¡Œã§ã™ã€‚å‰å›ã¯é–“é•ãˆã¦ã—ã¾ã„ã¾ã—ãŸãŒã€å¤§ä¸ˆå¤«ã§ã™";break;case"analyst":N=`2å›ç›®ã®å‡ºé¡Œã€‚å‰å›: ${P?"æ­£è§£":"ä¸æ­£è§£"}`;break;case"enthusiastic-coach":N=P?"2å›ç›®ï¼å‰å›ã¯å®Œç’§ã ã£ãŸãªï¼":"2å›ç›®ã®ãƒãƒ£ãƒ³ã‚¹ï¼å‰å›ã®ãƒªãƒ™ãƒ³ã‚¸ã ï¼";break;case"wise-sage":N=P?"2åº¦ç›®ã®å‡ºä¼šã„ã˜ã‚ƒã€‚å‰å›ã¯ã†ã¾ãã„ã£ãŸã®ã†":"2åº¦ç›®ã˜ã‚ƒãªã€‚å‰å›ã®çµŒé¨“ã‚’æ´»ã‹ãã†";break;default:N="2å›ç›®ã®å‡ºé¡Œã§ã™"}}else switch(x){case"drill-sergeant":L>=80?N=`${T}å›ç›®ã ã€‚æ­£ç­”ç‡${L}%ï¼ã„ã„èª¿å­ã ï¼`:L>=50?N=`${T}å›ç›®ã€‚æ­£ç­”ç‡${L}%ã€‚ã‚‚ã£ã¨ä¸Šã’ã‚ï¼`:N=`${T}å›ç›®ã€‚æ­£ç­”ç‡${L}%ï¼è¦šãˆãŒæ‚ªã„ãï¼`;break;case"kind-teacher":L>=80?N=`${T}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${L}%ã€ã‚ˆãè¦šãˆã¦ã„ã¾ã™ã­`:L>=50?N=`${T}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${L}%ã€å°‘ã—ãšã¤è¦šãˆã¦ãã¦ã„ã¾ã™`:N=`${T}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${L}%ã€ç¹°ã‚Šè¿”ã—ç·´ç¿’ã—ã¾ã—ã‚‡ã†`;break;case"analyst":N=`${T}å›ç›®ã®å‡ºé¡Œã€‚æ­£ç­”ç‡: ${L}% (æ­£è§£${H}/ä¸æ­£è§£${V})`;break;case"enthusiastic-coach":L>=80?N=`${T}å›ç›®ï¼æ­£ç­”ç‡${L}%ï¼å®Œç’§ã«è¿‘ã„ãï¼`:N=`${T}å›ç›®ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼æ­£ç­”ç‡${L}%ã€ã¾ã ä¼¸ã³ã‚‹ãï¼`;break;case"wise-sage":L>=80?N=`${T}å›ç›®ã˜ã‚ƒãªã€‚æ­£ç­”ç‡${L}%ã€ã‚ˆãå®šç€ã—ã¦ãŠã‚‹`:N=`${T}å›ç›®ã˜ã‚ƒã€‚æ­£ç­”ç‡${L}%ã€ç„¦ã‚‰ãšç€å®Ÿã«ãª`;break;default:N=`${T}å›ç›®ã®å‡ºé¡Œã§ã™ã€‚æ­£ç­”ç‡${L}%`}}else N="æ–°ã—ã„å•é¡Œã§ã™";be(N),A("")}},[d]),u.useEffect(()=>{if(h===void 0||!g||!d||g!==d)return;const x=localStorage.getItem("aiPersonality")||"kind-teacher",f=Et(r||"translation"),N=f.todayTotalAnswered,T=f.todayAccuracy,H=s>0?(n||0)/s*100:0,L={isCorrect:h,word:g,difficulty:S||E||"intermediate",category:w||"å…¨åˆ†é‡",attemptCount:1,responseTime:0,correctStreak:b,incorrectStreak:y,userAccuracy:H,categoryAccuracy:H,isWeakCategory:!1,hasSeenBefore:!1,previousAttempts:0,todayQuestions:N,todayAccuracy:T,planProgress:0,timeOfDay:_s(),learningPhase:v,estimatedSpeed:k,forgettingRate:D};let P=Pr(x,L);if(Math.random()<.15){const ve=[];if(Math.random()<.33){const _=ci(x,d);_&&ve.push(_)}else if(Math.random()<.5){const _=si();_&&ve.push(_)}else{const _=ei();_&&ve.push(_)}ve.length>0&&(P=`${P}

${ve[0]}`)}A(P)},[m,h,g,S,b,y,r,s,n,w,E]);const Q=u.useRef(null),O=u.useRef(null),ae=u.useRef(null),[Z,te]=u.useState(()=>{const x=localStorage.getItem(`learning-limit-${r}`);return x?parseInt(x):null}),[Ie,ye]=u.useState(()=>{const x=localStorage.getItem(`review-limit-${r}`);return x?parseInt(x):null}),[we,Se]=u.useState(()=>{const x=localStorage.getItem("memorization-still-learning-limit");return x?parseInt(x):null}),[Ge,Ce]=u.useState(()=>{const x=localStorage.getItem("memorization-incorrect-limit");return x?parseInt(x):null}),[We,_e]=u.useState(!1);u.useEffect(()=>{if((r==="translation"||r==="spelling"||r==="grammar")&&Y&&i){const{incorrect:x,review:f}=Y,N=x+f;(Z!==null&&N>=Z||Ie!==null&&f>=Ie)&&(l||i())}},[Y,Z,Ie,l,r,i]);const[Fe,Ee]=u.useState(()=>{if(r==="grammar"){const{retentionRate:x,appearedCount:f}=Qt();return{retentionRate:x,appearedCount:f}}else{const{retentionRate:x,appearedCount:f}=Ot();return{retentionRate:x,appearedCount:f}}}),[Pe,le]=u.useState(()=>r==="grammar"?Lt():r==="memorization"?Nt():_t()),[$e,Be]=u.useState(null),[He,je]=u.useState([]);u.useEffect(()=>{r==="grammar"&&Ts().then(x=>{if(G){const f=G.match(/g(\d+)-(?:unit|u)(\d+)/);if(f){const N=`ä¸­${f[1]}_Unit${f[2]}`,T=x.filter(H=>H.unit===N);je(T)}else je(x)}else je(x)})},[r,m,G]),u.useEffect(()=>{if(r==="grammar"){const{retentionRate:x,appearedCount:f}=Qt();Ee({retentionRate:x,appearedCount:f}),le(Lt())}else if(r==="memorization"){le(Nt());const x=Nt();Ee({retentionRate:x.basicRetentionRate,appearedCount:x.appearedWords})}else{const{retentionRate:x,appearedCount:f}=Ot();Ee({retentionRate:x,appearedCount:f}),le(_t())}},[m,r]),u.useEffect(()=>{Be(d?qt(d):null)},[d,m]),u.useEffect(()=>{if(Q.current){const x=Math.round(Pe.masteredPercentage);Q.current.style.setProperty("--segment-width",String(x)),Q.current.setAttribute("data-width",String(x))}if(O.current){const x=Math.round(Pe.learningPercentage);O.current.style.setProperty("--segment-width",String(x)),O.current.setAttribute("data-width",String(x))}if(ae.current){const x=Math.round(Pe.strugglingPercentage);ae.current.style.setProperty("--segment-width",String(x)),ae.current.setAttribute("data-width",String(x))}},[Pe,q,r]);const{todayAccuracy:ze,todayTotalAnswered:Ue}=u.useMemo(()=>Et(r),[r]);u.useMemo(()=>Ns(r),[r]),u.useMemo(()=>Kt(),[]);const{retentionRate:Le}=Fe,j=Pe;return u.useMemo(()=>s>0?Math.round(t/s*100):0,[t,s]),e.jsxs("div",{className:"score-board-compact",children:[e.jsxs("div",{className:"score-board-tabs grid grid-cols-3 sm:grid-cols-5 gap-1 sm:gap-2",children:[e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${q==="ai"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>me("ai"),title:"AIã‚³ãƒ¡ãƒ³ãƒˆ",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ¤– AI"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ¤–"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${q==="plan"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>me("plan"),title:"ãƒ—ãƒ©ãƒ³",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“‹ ãƒ—ãƒ©ãƒ³"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“‹"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${q==="breakdown"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>me("breakdown"),title:"å­¦ç¿’çŠ¶æ³",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“ˆ å­¦ç¿’çŠ¶æ³"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“ˆ"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${q==="history"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>me("history"),title:"å±¥æ­´",children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“œ å±¥æ­´"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“œ"})]}),e.jsxs("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${q==="settings"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>{c?c():me("settings")},title:"å­¦ç¿’è¨­å®š",children:[e.jsx("span",{className:"hidden sm:inline",children:"âš™ï¸ å­¦ç¿’è¨­å®š"}),e.jsx("span",{className:"sm:hidden",children:"âš™ï¸"})]})]}),q==="ai"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsx("div",{className:"ai-comment-container",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("div",{className:"text-2xl flex-shrink-0",children:(()=>{const x=localStorage.getItem("aiPersonality")||"kind-teacher";return{"kind-teacher":"ğŸ˜ƒ","drill-sergeant":"ğŸ‘¹","enthusiastic-coach":"ğŸ˜¼",analyst:"ğŸ¤–","wise-sage":"ğŸ§™"}[x]||"ğŸ˜ƒ"})()}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-sm text-gray-700 leading-snug break-words",children:(Re||Ne).replace(/^[ğŸ˜ƒğŸ‘¹ğŸ˜¼ğŸ¤–ğŸ§™]+ã€Œ?/gu,"").replace(/ã€$/gu,"").replace(/[âœ¨ğŸŒ¸ğŸ˜ŠğŸŒ±ğŸ’ªğŸ”¥ğŸ“ŠğŸ†]/gu,"").trim()})})]})})})}),q==="plan"&&e.jsx("div",{className:"score-board-content",children:e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:[e.jsxs("div",{className:"plan-text-line",children:[e.jsxs("span",{className:"stat-text-label",children:["ğŸ“š ",C||"å…¨å•é¡Œé›†"]}),e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("span",{className:"stat-text-label",children:w||"å…¨åˆ†é‡"}),e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("span",{className:"stat-text-label",children:E==="all"?"å…¨é›£æ˜“åº¦":E==="basic"?"åŸºç¤":E==="standard"?"æ¨™æº–":E==="advanced"?"ç™ºå±•":E}),(r==="translation"||r==="spelling"||r==="memorization")&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("button",{onClick:()=>_e(!0),className:"stat-text-label cursor-pointer hover:text-primary transition-colors",title:"å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š",children:"âš™ï¸ ä¸Šé™è¨­å®š"})]}),$&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"stat-text-divider",children:"ï½œ"}),e.jsx("span",{className:"stat-text-label",children:$==="all"?"å˜èªãƒ»ç†Ÿèª":$==="word"?"å˜èªã®ã¿":$==="phrase"?"ç†Ÿèªã®ã¿":"å˜èªãƒ»ç†Ÿèª"})]})]}),We&&(r==="translation"||r==="spelling")&&e.jsx("div",{className:"plan-settings-modal",children:e.jsxs("div",{className:"plan-settings-content",children:[e.jsx("h4",{children:"ğŸ¯ å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š"}),e.jsx("p",{className:"plan-settings-description",children:"0ã‚’é¸æŠã™ã‚‹ã¨ç„¡åˆ¶é™ã«å‡ºé¡Œã—ã¾ã™"}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"å­¦ç¿’ä¸­ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"å­¦ç¿’ä¸­ã®èªæ•°ä¸Šé™",value:Z||0,onChange:x=>{const f=parseInt(x.target.value),N=f===0?null:f;te(N),N===null?localStorage.removeItem(`learning-limit-${r}`):localStorage.setItem(`learning-limit-${r}`,N.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"è¦å¾©ç¿’ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"è¦å¾©ç¿’ã®èªæ•°ä¸Šé™",value:Ie||0,onChange:x=>{const f=parseInt(x.target.value),N=f===0?null:f;ye(N),N===null?localStorage.removeItem(`review-limit-${r}`):localStorage.setItem(`review-limit-${r}`,N.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsx("button",{className:"plan-settings-close",onClick:()=>_e(!1),children:"é–‰ã˜ã‚‹"})]})}),We&&r==="memorization"&&e.jsx("div",{className:"plan-settings-modal",children:e.jsxs("div",{className:"plan-settings-content",children:[e.jsx("h4",{children:"ğŸ¯ å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š"}),e.jsx("p",{className:"plan-settings-description",children:"0ã‚’é¸æŠã™ã‚‹ã¨ç„¡åˆ¶é™ã«å‡ºé¡Œã—ã¾ã™"}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"ã¾ã ã¾ã ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"ã¾ã ã¾ã ã®èªæ•°ä¸Šé™",value:we||0,onChange:x=>{const f=parseInt(x.target.value),N=f===0?null:f;Se(N),N===null?localStorage.removeItem("memorization-still-learning-limit"):localStorage.setItem("memorization-still-learning-limit",N.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsxs("div",{className:"plan-setting-item",children:[e.jsx("label",{children:"åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™:"}),e.jsxs("select",{"aria-label":"åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™",value:Ge||0,onChange:x=>{const f=parseInt(x.target.value),N=f===0?null:f;Ce(N),N===null?localStorage.removeItem("memorization-incorrect-limit"):localStorage.setItem("memorization-incorrect-limit",N.toString())},className:"select-input",children:[e.jsx("option",{value:0,children:"è¨­å®šç„¡ã—"}),e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:30,children:"30"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:150,children:"150"}),e.jsx("option",{value:200,children:"200"})]}),e.jsx("p",{className:"setting-help",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ç¹°ã‚Šè¿”ã—å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šã¾ã™"})]}),e.jsx("button",{className:"plan-settings-close",onClick:()=>_e(!1),children:"é–‰ã˜ã‚‹"})]})})]})}),q==="breakdown"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsxs("div",{className:"retention-breakdown-container",children:[e.jsxs("div",{className:"retention-breakdown-header",children:[e.jsx("div",{className:"retention-title",children:"ğŸ“Š å­¦ç¿’çŠ¶æ³ã®å†…è¨³"}),j.appearedWords>0?e.jsx("div",{className:"retention-subtitle",children:r==="memorization"?e.jsxs(e.Fragment,{children:[j.appearedWords,"èªç¢ºèªï¼š ğŸŸ¢è¦šãˆã¦ã‚‹"," ",j.masteredCount,"èª ğŸŸ¡ã¾ã ã¾ã  ",j.learningCount,"èª ğŸ”´åˆ†ã‹ã‚‰ãªã„ ",j.strugglingCount,"èª",i&&e.jsx("span",{className:`review-mode-icon ${l?"active":""}`,onClick:i,title:l?"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰è§£é™¤":"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰é–‹å§‹",children:"ğŸ”¥"})]}):r==="grammar"?e.jsxs(e.Fragment,{children:[j.appearedWords,"å•å‡ºé¡Œï¼š ğŸŸ¢å®šç€ ",j.masteredCount,"å• ğŸŸ¡å­¦ç¿’ä¸­ ",j.learningCount,"å• ğŸ”´è¦å¾©ç¿’"," ",j.strugglingCount,"å•",i&&e.jsx("span",{className:`review-mode-icon ${l?"active":""}`,onClick:i,title:l?"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰è§£é™¤":"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰é–‹å§‹",children:"ğŸ”¥"})]}):e.jsxs(e.Fragment,{children:[j.appearedWords,"å•å‡ºé¡Œï¼š ğŸŸ¢å®šç€ ",j.masteredCount,"èª ğŸŸ¡å­¦ç¿’ä¸­ ",j.learningCount,"èª ğŸ”´è¦å¾©ç¿’"," ",j.strugglingCount,"èª",(r==="translation"||r==="spelling")&&i&&e.jsx("span",{className:`review-mode-icon ${l?"active":""}`,onClick:i,title:l?"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰è§£é™¤":"å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰é–‹å§‹",children:"ğŸ”¥"})]})}):e.jsx("div",{className:"retention-subtitle",children:r==="memorization"?"ã¾ã èªå¥ã‚’ç¢ºèªã—ã¦ã„ã¾ã›ã‚“":"ã¾ã å•é¡Œã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã›ã‚“"})]}),j.appearedWords>0&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"retention-progress-bar",children:r==="memorization"?e.jsxs(e.Fragment,{children:[j.masteredPercentage>0&&e.jsx("div",{ref:Q,className:"retention-segment retention-mastered","data-width":Math.round(j.masteredPercentage),title:`ğŸŸ¢ è¦šãˆã¦ã‚‹: ${j.masteredCount}èª (${Math.round(j.masteredPercentage)}%)`,children:j.masteredPercentage>=10&&e.jsxs("span",{children:[Math.round(j.masteredPercentage),"%"]})}),j.learningCount>0&&e.jsx("div",{ref:O,className:"retention-segment retention-learning","data-width":Math.round(j.learningPercentage),title:`ğŸŸ¡ ã¾ã ã¾ã : ${j.learningCount}èª (${Math.round(j.learningPercentage)}%)`,children:j.learningPercentage>=10&&e.jsxs("span",{children:[Math.round(j.learningPercentage),"%"]})}),j.strugglingCount>0&&e.jsx("div",{ref:ae,className:"retention-segment retention-struggling","data-width":Math.round(j.strugglingPercentage),title:`ğŸ”´ åˆ†ã‹ã‚‰ãªã„: ${j.strugglingCount}èª (${Math.round(j.strugglingPercentage)}%)`,children:j.strugglingPercentage>=10&&e.jsxs("span",{children:[Math.round(j.strugglingPercentage),"%"]})})]}):e.jsxs(e.Fragment,{children:[j.masteredPercentage>0&&e.jsx("div",{ref:Q,className:"retention-segment retention-mastered","data-width":Math.round(j.masteredPercentage),title:`ğŸŸ¢ å®šç€: ${j.masteredCount}èª (${Math.round(j.masteredPercentage)}%)`,children:j.masteredPercentage>=10&&e.jsxs("span",{children:[Math.round(j.masteredPercentage),"%"]})}),j.learningPercentage>0&&e.jsx("div",{ref:O,className:"retention-segment retention-learning","data-width":Math.round(j.learningPercentage),title:`ğŸŸ¡ å­¦ç¿’ä¸­: ${j.learningCount}èª (${Math.round(j.learningPercentage)}%)`,children:j.learningPercentage>=10&&e.jsxs("span",{children:[Math.round(j.learningPercentage),"%"]})}),j.strugglingPercentage>0&&e.jsx("div",{ref:ae,className:"retention-segment retention-struggling","data-width":Math.round(j.strugglingPercentage),title:`ğŸ”´ è¦å¾©ç¿’: ${j.strugglingCount}èª (${Math.round(j.strugglingPercentage)}%)`,children:j.strugglingPercentage>=10&&e.jsxs("span",{children:[Math.round(j.strugglingPercentage),"%"]})})]})})})]})})}),q==="history"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsx("div",{className:"history-compact",children:r==="grammar"?e.jsx("div",{className:"word-detail-container",children:He.length>0?e.jsx("div",{className:"grammar-units-list",children:He.map(x=>{const f=(x.correctCount||0)+(x.incorrectCount||0),N=x.masteredCount||0,T=x.answeredQuestions||0,H=T>0?Math.round(N/T*100):0,V=x.historyIcons||"";let L="ğŸŸ¢",P="å®šç€æ¸ˆ";N===0&&T>0?(L="ğŸ”´",P="è¦å¾©ç¿’"):H<80&&T>0&&(L="ğŸŸ¡",P="å­¦ç¿’ä¸­");const ve=x.unit.match(/ä¸­(\d+)/),_=ve?`${ve[1]}å¹´`:x.unit,J=x.unit.match(/Unit(\d+)/),R=J?`Unit${J[1]}`:"",F=R?`${_} ${R}ï¼š${x.title}`:`${_}ï¼š${x.title}`;return e.jsxs("div",{className:"grammar-unit-card",children:[e.jsxs("div",{className:"word-detail-title",children:["ğŸ“Š ",F," ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿",e.jsxs("span",{className:"word-status-badge",children:[L," ",P]})]}),e.jsxs("div",{className:"word-detail-stats",children:[e.jsx("span",{className:"word-stat-label",children:"æ­£è§£:"}),e.jsxs("strong",{className:"word-stat-value",children:[x.correctCount,"/",f,"å›"]}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"}),V&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"word-stat-label",children:"å±¥æ­´:"}),e.jsx("span",{className:"word-history-icons",children:V}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"})]}),e.jsx("span",{className:"word-stat-label",children:"å®šç€ç‡:"}),e.jsxs("strong",{className:"word-stat-value word-retention-rate",children:[H,"%"]})]})]},x.unit)})}):e.jsxs("div",{className:"word-detail-empty",children:[e.jsx("p",{children:"ã¾ã æ–‡æ³•å•é¡Œã®è§£ç­”ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"stat-text-sub",children:"å•é¡Œã‚’è§£ãã¨å˜å…ƒã”ã¨ã®æˆç¸¾ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"})]})}):d&&$e?e.jsxs("div",{className:"word-detail-container",children:[e.jsxs("div",{className:"word-detail-title",children:["ğŸ“Š ",d," ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿",e.jsxs("span",{className:"word-status-badge",children:[$e.statusIcon," ",$e.statusLabel]})]}),e.jsxs("div",{className:"word-detail-stats",children:[e.jsx("span",{className:"word-stat-label",children:"æ­£è§£:"}),e.jsxs("strong",{className:"word-stat-value",children:[$e.correctCount,"/",$e.totalCount,"å›"]}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"}),$e.accuracyHistory&&$e.accuracyHistory.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"word-stat-label",children:"å±¥æ­´:"}),e.jsx("span",{className:"word-history-icons",children:$e.accuracyHistory}),e.jsx("span",{className:"word-stat-divider",children:"ï½œ"})]}),e.jsx("span",{className:"word-stat-label",children:"å®šç€ç‡:"}),e.jsxs("strong",{className:"word-stat-value word-retention-rate",children:[$e.retentionRate,"%"]})]})]}):d&&!$e?e.jsx("div",{className:"word-detail-empty",children:e.jsx("p",{children:"ã“ã®å˜èªã®ãƒ‡ãƒ¼ã‚¿ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“"})}):e.jsx("div",{className:"word-detail-empty",children:e.jsx("p",{children:"å•é¡Œã‚’é–‹å§‹ã™ã‚‹ã¨ã€ç¾åœ¨ã®å˜èªã®ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"})})})})}),q==="settings"&&e.jsx("div",{className:"score-board-content",children:e.jsx("div",{className:"bg-white rounded-lg p-3 shadow-md border border-gray-200",children:e.jsx("div",{className:"settings-tab-container",children:e.jsx("div",{className:"word-detail-empty",children:e.jsx("p",{children:"ã“ã®ã‚¿ãƒ–ã®è¨­å®šã¯å­¦ç¿’è¨­å®šãƒ‘ãƒãƒ«ã‹ã‚‰è¡Œãˆã¾ã™"})})})})})]})}const os=[{id:"beginner-basic",name:"åˆç´šåŸºç¤",requiredWords:600,requiredAccuracy:70,description:"åŸºæœ¬çš„ãªå˜èª",icon:"ğŸŒ±"},{id:"beginner-complete",name:"åˆç´šå®Œäº†",requiredWords:1077,requiredAccuracy:70,description:"åˆç´šãƒ¬ãƒ™ãƒ«å®Œå…¨ç¿’å¾—",icon:"ğŸŒ¿"},{id:"intermediate-half",name:"ä¸­ç´šåŠåˆ†",requiredWords:1900,requiredAccuracy:75,description:"ä¸­ç´šãƒ¬ãƒ™ãƒ«50%",icon:"ğŸŒ³"},{id:"intermediate-complete",name:"ä¸­ç´šå®Œäº†",requiredWords:2693,requiredAccuracy:75,description:"ä¸­ç´šãƒ¬ãƒ™ãƒ«å®Œå…¨ç¿’å¾—",icon:"ğŸ“"},{id:"advanced-half",name:"ä¸Šç´šåŠåˆ†",requiredWords:3150,requiredAccuracy:80,description:"ä¸Šç´šãƒ¬ãƒ™ãƒ«50%",icon:"ğŸ“š"},{id:"advanced-complete",name:"ä¸Šç´šå®Œäº†",requiredWords:3578,requiredAccuracy:80,description:"ä¸Šç´šãƒ¬ãƒ™ãƒ«å®Œå…¨ç¿’å¾—",icon:"ğŸš€"},{id:"master",name:"ãƒã‚¹ã‚¿ãƒ¼",requiredWords:4e3,requiredAccuracy:85,description:"å…¨ãƒ¬ãƒ™ãƒ«åˆ¶è¦‡",icon:"â­"}];function di(){const r=localStorage.getItem("user-goal-level");if(r){const t=JSON.parse(r),s=os.find(n=>n.id===t);if(s)return s}return os.find(t=>t.id==="intermediate-complete")||os[0]}function $r(r){const t=r||di(),s=Me(),n=Kt();let a=0,o=0;Object.values(s.wordProgress).forEach(b=>{a+=b.correctCount,o+=b.correctCount+b.incorrectCount});const l=o>0?a/o*100:0,i=Math.min(100,n/t.requiredWords*100),c=Math.min(100,l/t.requiredAccuracy*100),d=(i+c)/2,m=n>=t.requiredWords&&l>=t.requiredAccuracy,h=ui(n,t.requiredWords,l,t.requiredAccuracy),g=Math.max(0,t.requiredWords-n),S=h>0?Math.ceil(g/h):0;return{goal:t,currentWords:n,currentAccuracy:Math.round(l),wordsProgress:Math.round(i),accuracyProgress:Math.round(c),overallProgress:Math.round(d),isAchieved:m,estimatedDaysToAchieve:h,recommendedDailyWords:Math.min(50,S)}}function ui(r,t,s,n){if(r>=t&&s>=n)return 0;const a=Me(),l=Date.now()-7*24*60*60*1e3;let i=0;Object.values(a.wordProgress).forEach(y=>{y.lastStudied>=l&&y.masteryLevel==="mastered"&&i++});const c=i/7,d=Math.max(5,c),h=Math.max(0,t-r)/d,S=Math.max(0,n-s)*2,b=Math.ceil(h+S);return Math.max(1,b)}function Po(r=!0){const t=$r();if(t.isAchieved)return`ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼${t.goal.name}ãƒ¬ãƒ™ãƒ«ã‚’é”æˆã—ã¾ã—ãŸï¼`;const s=[];if(s.push(`${t.goal.icon} ${t.goal.name}ã¾ã§ ${t.overallProgress}%`),t.currentWords<t.goal.requiredWords){const n=t.goal.requiredWords-t.currentWords;s.push(`ã‚ã¨${n}èª`)}return t.estimatedDaysToAchieve>0&&(t.estimatedDaysToAchieve<=7?s.push(`ã‚ã¨${t.estimatedDaysToAchieve}æ—¥ã§é”æˆï¼`):t.estimatedDaysToAchieve<=30?s.push(`ç´„${Math.ceil(t.estimatedDaysToAchieve/7)}é€±é–“ã§é”æˆè¦‹è¾¼ã¿`):s.push(`ç´„${Math.ceil(t.estimatedDaysToAchieve/30)}ãƒ¶æœˆã§é”æˆè¦‹è¾¼ã¿`)),r&&(t.overallProgress>=80?s.push("ã‚‚ã†å°‘ã—ã§é”æˆã§ã™ï¼é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼"):t.overallProgress>=50?s.push("é †èª¿ã«é€²ã‚“ã§ã„ã¾ã™ï¼ã“ã®èª¿å­ã§ç¶šã‘ã¾ã—ã‚‡ã†ï¼"):t.overallProgress>=25&&s.push("ç€å®Ÿã«é€²æ­©ã—ã¦ã„ã¾ã™ï¼")),s.join(" ")}const mi={accept:["except"],except:["accept"],affect:["effect"],effect:["affect"],dessert:["desert"],desert:["dessert"],quiet:["quite"],quite:["quiet"],lose:["loose"],loose:["lose"],advice:["advise"],advise:["advice"],breath:["breathe"],breathe:["breath"],cloth:["clothe","clothes"],clothe:["cloth","clothes"],clothes:["cloth","clothe"],borrow:["lend"],lend:["borrow"],teach:["learn"],learn:["teach"],speak:["talk","say","tell"],talk:["speak","say","tell"],say:["speak","talk","tell"],tell:["speak","talk","say"],see:["look","watch"],look:["see","watch"],watch:["see","look"],hear:["listen"],listen:["hear"],bring:["take"],take:["bring"],come:["go"],go:["come"],in:["on","at"],on:["in","at"],at:["in","on"],for:["to","of"],to:["for","of"],of:["for","to"],already:["all ready"],"all ready":["already"],altogether:["all together"],"all together":["altogether"],everyday:["every day"],"every day":["everyday"]};function Er(r){const t=r.toLowerCase();return mi[t]||[]}function hi(){const r=Me(),t=[],s=new Set;return Object.entries(r.wordProgress).forEach(([n])=>{if(s.has(n.toLowerCase()))return;const a=Er(n);if(a.length===0)return;const o=[n,...a].map(g=>g.toLowerCase()),l=Array.from(new Set(o));let i=0,c=0;l.forEach(g=>{const S=r.wordProgress[g];S&&(i+=S.incorrectCount,c+=S.correctCount+S.incorrectCount)});const d=c>0?i/c:0,m=Math.min(100,d*100*Math.log1p(c));let h="spelling";["speak","talk","say","tell","see","look","watch"].includes(n.toLowerCase())?h="meaning":["in","on","at","for","to","of"].includes(n.toLowerCase())&&(h="grammar"),t.push({words:l,type:h,description:gi(l,h),confusionScore:Math.round(m),totalErrors:i,needsReview:m>30||d>.3}),l.forEach(g=>s.add(g))}),t.filter(n=>n.totalErrors>0).sort((n,a)=>a.confusionScore-n.confusionScore)}function gi(r,t){return t==="spelling"?`ã‚¹ãƒšãƒ«ãŒä¼¼ã¦ã„ã‚‹: ${r.join(", ")}`:t==="meaning"?`æ„å‘³ãŒä¼¼ã¦ã„ã‚‹: ${r.join(", ")}`:`æ–‡æ³•çš„ã«æ··åŒã—ã‚„ã™ã„: ${r.join(", ")}`}function pi(r){const t=Me(),s={},n=[];r.words.forEach(l=>{const i=t.wordProgress[l];if(i){const c=i.correctCount+i.incorrectCount,d=c>0?i.correctCount/c*100:0;s[l]=d,n.push(d)}});const a=n.length>0?n.reduce((l,i)=>l+i,0)/n.length:0,o=n.length>0?n.reduce((l,i)=>l+Math.pow(i-a,2),0)/n.length:0;return{groupRetention:Math.round(a),individualRetentions:s,variance:Math.round(o)}}function fi(r){const t=pi(r);return t.groupRetention<50?`âš ï¸ ${r.words.join(", ")} ã®åŒºåˆ¥ãŒæ›–æ˜§ã§ã™ã€‚é›†ä¸­çš„ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚`:t.variance>500?`ğŸ“Š ${r.words.join(", ")} ã§å®šç€åº¦ã«ã°ã‚‰ã¤ããŒã‚ã‚Šã¾ã™ã€‚å¼±ã„å˜èªã‚’é‡ç‚¹çš„ã«ã€‚`:t.groupRetention<70?`ğŸ’ª ${r.words.join(", ")} ã‚’ã‚‚ã†å°‘ã—ç·´ç¿’ã™ã‚‹ã¨å®Œç’§ã§ã™ï¼`:`âœ… ${r.words.join(", ")} ã®åŒºåˆ¥ãŒã—ã£ã‹ã‚Šã§ãã¦ã„ã¾ã™ï¼`}function xi(r){const t=/^[^:]+:\s*[""](.+?)[""]$/,s=r.match(t);if(s)return s[1].trim();const n=/^[^:]+:\s*(.+)$/,a=r.match(n);return a?a[1].trim():r}function Ze(r,t={}){if(!("speechSynthesis"in window)){p.warn("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯Web Speech APIã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“");return}const s=xi(r);if(window.speechSynthesis.speaking||window.speechSynthesis.pending){window.speechSynthesis.cancel(),setTimeout(()=>{Hs(s,t)},50);return}Hs(s,t)}function Hs(r,t){const s=new SpeechSynthesisUtterance(r),n=localStorage.getItem("speechRate"),a=localStorage.getItem("voiceGender");s.lang=t.lang||"en-US",s.rate=t.rate||(n?parseFloat(n):.85),s.pitch=t.pitch||1,s.volume=t.volume||1;const l=window.speechSynthesis.getVoices().filter(c=>c.lang.startsWith("en-")),i=["Google US English","Google UK English Female","Google UK English Male","Samantha","Alex","Microsoft Aria Online","Microsoft Guy Online","Karen","Daniel"];if(a==="female"){const c=l.find(d=>i.some(m=>d.name.includes(m)))||l.find(d=>d.name.toLowerCase().includes("female")||d.name.toLowerCase().includes("woman")||d.name.toLowerCase().includes("samantha")||d.name.toLowerCase().includes("karen")||d.name.toLowerCase().includes("aria"));c&&(s.voice=c)}else if(a==="male"){const c=l.find(d=>i.some(m=>d.name.includes(m)))||l.find(d=>d.name.toLowerCase().includes("male")||d.name.toLowerCase().includes("man")||d.name.toLowerCase().includes("alex")||d.name.toLowerCase().includes("daniel")||d.name.toLowerCase().includes("guy"));c&&(s.voice=c)}else{const c=l.find(d=>i.some(m=>d.name.includes(m)));c&&(s.voice=c)}s.onerror=c=>{p.error("éŸ³å£°åˆæˆã‚¨ãƒ©ãƒ¼:",c)},window.speechSynthesis.speak(s)}function qe(){return"speechSynthesis"in window}function yi(){"speechSynthesis"in window&&window.speechSynthesis.cancel()}function vi(){"speechSynthesis"in window&&window.speechSynthesis.speaking&&window.speechSynthesis.pause()}function wi(){"speechSynthesis"in window&&window.speechSynthesis.paused&&window.speechSynthesis.resume()}function bi(){return"speechSynthesis"in window&&window.speechSynthesis.speaking}function ji(){return"speechSynthesis"in window&&window.speechSynthesis.paused}const Ct=({word:r,sets:t,onAddWord:s,onRemoveWord:n,onOpenManagement:a,size:o="medium",variant:l="icon"})=>{const[i,c]=u.useState(!1),d=t.filter(y=>y.words.some(v=>v.word===r.word)),m=d.length>0,h={small:"text-sm px-2 py-1",medium:"text-base px-3 py-1.5",large:"text-lg px-4 py-2"},g={small:"text-base",medium:"text-lg",large:"text-xl"},S=y=>{if(y.stopPropagation(),t.length===0){a();return}if(t.length===1){const v=t[0];m?n(v.id,r):s(v.id,r)}else c(!i)},b=(y,v)=>{v?n(y,r):s(y,r)};return e.jsxs("div",{className:"relative inline-block",children:[e.jsxs("button",{onClick:S,className:`
          ${h[o]}
          ${m?"bg-green-500 hover:bg-green-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"}
          rounded-md font-medium transition-colors duration-200
          flex items-center gap-1
        `,title:m?`${d.length}å€‹ã®ã‚»ãƒƒãƒˆã«è¿½åŠ æ¸ˆã¿`:"ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã«è¿½åŠ ",children:[e.jsx("span",{className:g[o],children:m?"âœ“":"+"}),l!=="icon"&&e.jsx("span",{children:m?"è¿½åŠ æ¸ˆã¿":"è¿½åŠ "})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>c(!1)}),e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 z-50 max-h-80 overflow-y-auto",children:[e.jsx("div",{className:"p-2 border-b border-gray-200",children:e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"ã‚»ãƒƒãƒˆã‚’é¸æŠ"})}),e.jsx("div",{className:"p-2",children:t.map(y=>{const v=y.words.some(k=>k.word===r.word);return e.jsxs("button",{onClick:()=>{b(y.id,v),c(!1)},className:`
                      w-full text-left px-3 py-2 rounded-md mb-1
                      flex items-center justify-between
                      ${v?"bg-green-50 text-green-700":"hover:bg-gray-100:bg-gray-700 text-gray-700"}
                    `,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx("span",{children:y.icon||"ğŸ“–"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:y.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[y.words.length,"èª"]})]})]}),e.jsx("span",{className:"text-lg ml-2",children:v?"âœ“":"+"})]},y.id)})}),e.jsx("div",{className:"p-2 border-t border-gray-200",children:e.jsx("button",{onClick:()=>{c(!1),a()},className:"w-full text-left px-3 py-2 rounded-md hover:bg-gray-100:bg-gray-700 text-blue-600 text-sm font-medium",children:"â• æ–°ã—ã„ã‚»ãƒƒãƒˆã‚’ä½œæˆ"})})]})]})]})};function Vs({question:r,allQuestions:t,currentIndex:s,answered:n,selectedAnswer:a,onAnswer:o,onNext:l,onPrevious:i,onDifficultyRate:c,customQuestionSets:d=[],onAddWordToCustomSet:m,onRemoveWordFromCustomSet:h,onOpenCustomSetManagement:g,onFullscreen:S}){const b=u.useMemo(()=>hr(r,t,s),[r.word,t,s]),[y,v]=u.useState(null),[k,D]=u.useState(new Set),[C,w]=u.useState(""),[E,$]=u.useState(0),[,G]=u.useState(()=>{const Q=sessionStorage.getItem("currentCorrectStreak");return Q?parseInt(Q,10):0}),Y=u.useRef(0),q=u.useRef(0),me=u.useRef(null),Ne=u.useRef(!1);u.useEffect(()=>{v(null),D(new Set),w(""),$(0)},[s]);const be=Q=>{D(O=>{const ae=new Set(O);return n?ae.size>0?new Set:new Set(b.map((Z,te)=>te)):(ae.has(Q)?ae.delete(Q):ae.add(Q),ae)})};u.useEffect(()=>{const Q=localStorage.getItem("autoShowDetails")!=="false";n&&a&&a!==r.meaning&&Q&&D(new Set(b.map((O,ae)=>ae)))},[n,a,r.meaning,b]),u.useEffect(()=>{if(n&&a){const Q=localStorage.getItem("aiPersonality")||"kind-teacher",O=a===r.meaning,ae=parseInt(sessionStorage.getItem("currentCorrectStreak")||"0",10);let Z=Pr(Q,{isCorrect:O,word:r.word,difficulty:"intermediate",category:"",attemptCount:E+1,responseTime:0,correctStreak:0,incorrectStreak:0,userAccuracy:0,categoryAccuracy:0,isWeakCategory:!1,hasSeenBefore:!1,previousAttempts:0,todayQuestions:0,todayAccuracy:0,planProgress:0,timeOfDay:_s()});const te=[];if(O&&Math.random()<.1){const we=$r();we.estimatedDaysToAchieve>0&&we.estimatedDaysToAchieve<=30&&(we.overallProgress>=90?te.push(`ğŸ¯ ${we.goal.name}ã¾ã§ã‚ã¨å°‘ã—ï¼`):we.overallProgress>=75&&te.push(`ğŸ“ˆ ã“ã®ãƒšãƒ¼ã‚¹ãªã‚‰${we.estimatedDaysToAchieve}æ—¥ã§${we.goal.name}é”æˆã§ã™ï¼`))}if(!O){const we=Er(r.word);we.length>0&&te.push(`ğŸ’¡ ã€Œ${r.word}ã€ã¨ã€Œ${we.join(", ")}ã€ã‚’æ··åŒã—ã‚„ã™ã„ã®ã§æ³¨æ„ï¼`)}if(!O&&Math.random()<.05){const Se=hi().find(Ge=>Ge.words.includes(r.word.toLowerCase())&&Ge.needsReview);Se&&te.push(fi(Se))}const Ie=Ka(Q,O,ae);if(Ie&&te.push(Ie.message),O){const we=ti(ae+1);we&&te.push(we)}const ye=li(O);if(ye&&te.push(ye),O){const we=ae+1;G(we),sessionStorage.setItem("currentCorrectStreak",String(we))}else G(0),sessionStorage.setItem("currentCorrectStreak","0");te.length>0&&(Z=`${Z} ${te[0]}`),w(Z)}else w("")},[n,a,r,E]);const Re=()=>{D(new Set),$(0),l()};u.useEffect(()=>{const Q=te=>{const Ie=te.target;Ie.closest(".choice-btn")||Ie.closest(".toggle-details-btn")||Ie.closest(".rating-btn")||Ie.closest(".inline-nav-btn")||Ie.closest(".question-text")||(Y.current=te.touches[0].clientX,Ne.current=!0)},O=te=>{Y.current!==0&&(q.current=te.touches[0].clientX)},ae=()=>{if(Y.current===0){Ne.current=!1;return}const te=Y.current-q.current;Math.abs(te)>80&&(te>0?n?Re():l():s>0&&i()),Y.current=0,q.current=0,setTimeout(()=>{Ne.current=!1},300)},Z=me.current;if(Z)return Z.addEventListener("touchstart",Q,{passive:!0}),Z.addEventListener("touchmove",O,{passive:!0}),Z.addEventListener("touchend",ae),()=>{Z.removeEventListener("touchstart",Q),Z.removeEventListener("touchmove",O),Z.removeEventListener("touchend",ae)}},[n,s,l,i]),u.useEffect(()=>{const Q=O=>{if(!n&&["1","2","3","4"].includes(O.key)){const ae=parseInt(O.key)-1;if(ae<b.length){O.preventDefault();const Z=b[ae].text,te=b[ae].question;Z===r.meaning||$(ye=>ye+1),o(Z,r.meaning,te)}}else!n&&O.key===" "?(O.preventDefault(),l()):O.key==="Enter"&&(O.preventDefault(),n?Re():l())};return window.addEventListener("keydown",Q),()=>{window.removeEventListener("keydown",Q)}},[n,b,r,o,E]);const A=Q=>{const O="w-full min-h-11 sm:min-h-14 p-2 sm:p-4 text-sm sm:text-base rounded-xl border-2 cursor-pointer transition-all duration-300 flex flex-col items-center text-center touch-manipulation select-none shadow-sm",ae="hover:border-blue-600 hover:bg-gray-100:bg-gray-800 hover:-translate-y-1 hover:shadow-lg",Z="active:bg-gray-200:bg-gray-700 active:translate-y-0";return Q==="åˆ†ã‹ã‚‰ãªã„"?n?Q===a?`${O} bg-red-600 border-red-600 text-white`:`${O} bg-gray-100 text-gray-600 border-gray-400`:`${O} bg-gray-100 text-gray-600 border-gray-400 ${ae} ${Z}`:n?Q===r.meaning?`${O} bg-green-600 border-green-600 text-white`:Q===a&&Q!==r.meaning?`${O} bg-red-600 border-red-600 text-white`:`${O} bg-gray-50 text-gray-900 border-gray-300`:`${O} bg-gray-50 text-gray-900 border-gray-300 ${ae} ${Z}`};return e.jsxs("div",{className:"question-card",ref:me,children:[S&&e.jsx("button",{onClick:S,className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsxs("div",{className:"question-nav-row",children:[e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg transition flex items-center justify-center text-xl sm:text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:i,disabled:s===0,title:"å‰ã¸",children:"â†"}),e.jsxs("div",{className:`question-content-inline ${qe()?"clickable-pronunciation":""}`,onClick:Q=>{qe()&&(Q.preventDefault(),Q.stopPropagation(),Ze(r.word,{rate:.85}))},onTouchEnd:Q=>{qe()&&(Q.preventDefault(),Q.stopPropagation(),Ze(r.word,{rate:.85}))},title:qe()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":"",children:[e.jsxs("div",{className:`text-2xl sm:text-3xl md:text-4xl font-bold text-gray-900 break-words ${r.word.includes(" ")?"phrase-text":""} ${qe()?"clickable-word":""}`,children:[r.word,qe()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"})]}),r.reading&&e.jsxs("div",{className:"question-reading text-sm sm:text-base text-gray-600 mt-1",children:["ã€",r.reading,"ã€‘"]}),r.difficulty&&e.jsx("div",{className:`difficulty-badge ${r.difficulty}`,children:r.difficulty==="beginner"?"åˆç´š":r.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"}),m&&h&&g&&d&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx(Ct,{word:{word:r.word,meaning:r.meaning,katakana:r.reading,source:"translation"},sets:d,onAddWord:m,onRemoveWord:h,onOpenManagement:g,size:"medium",variant:"both"})})]}),e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition flex items-center justify-center text-xl sm:text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:Re,title:"æ¬¡ã¸",children:"â†’"})]}),e.jsx("div",{className:"choices",children:b.map((Q,O)=>{const ae=k.has(O),Z=Q.question;return e.jsxs("div",{className:"choice-wrapper",children:[e.jsx("button",{className:A(Q.text),onClick:te=>{if(n){te.preventDefault(),te.stopPropagation(),Z&&be(O);return}Q.text===r.meaning||$(ye=>ye+1),o(Q.text,r.meaning,Z)},disabled:!1,children:e.jsx("div",{className:"choice-content",children:e.jsx("div",{className:"choice-text",children:Q.text})})}),n&&Z&&ae&&e.jsxs("div",{className:"choice-details",children:[e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"èªå¥:"}),e.jsx("span",{className:"detail-text",children:Z.word})]}),Z.reading&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"èª­ã¿:"}),e.jsx("span",{className:"detail-text",children:Z.reading})]}),Z.meaning&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"æ„å‘³:"}),e.jsx("span",{className:"detail-text",children:Z.meaning})]}),Z.etymology&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"ğŸ“š èªæºç­‰:"}),e.jsx("span",{className:"detail-text",children:Z.etymology})]}),Z.relatedWords&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"ğŸ”— é–¢é€£èª:"}),e.jsx("span",{className:"detail-text",children:Z.relatedWords})]}),Z.relatedFields&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"ğŸ·ï¸ åˆ†é‡:"}),e.jsx("span",{className:"detail-text",children:Z.relatedFields})]}),Z.difficulty&&e.jsxs("div",{className:"choice-detail-item",children:[e.jsx("span",{className:"detail-label",children:"é›£æ˜“åº¦:"}),e.jsx("span",{className:"detail-text",children:Z.difficulty})]})]})]},O)})})]})}const Js=[0,5,10,20,30,50,100,150,200];function Ls({learningLimit:r,reviewLimit:t,onLearningLimitChange:s,onReviewLimitChange:n,idPrefix:a=""}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:`${a}learning-limit`,children:"ğŸ¯ å­¦ç¿’ä¸­ã®ä¸Šé™:"}),e.jsx("select",{id:`${a}learning-limit`,value:r,onChange:o=>s(parseInt(o.target.value)),className:"select-input",children:Js.map(o=>e.jsx("option",{value:o,children:o===0?"è¨­å®šç„¡ã—":o},o))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:`${a}review-limit`,children:"âš ï¸ è¦å¾©ç¿’ã®ä¸Šé™:"}),e.jsx("select",{id:`${a}review-limit`,value:t,onChange:o=>n(parseInt(o.target.value)),className:"select-input",children:Js.map(o=>e.jsx("option",{value:o,children:o===0?"è¨­å®šç„¡ã—":o},o))})]})]})}function Ws(r){const[t,s]=u.useState(()=>{const i=localStorage.getItem(`learning-limit-${r}`);return i?parseInt(i):30}),[n,a]=u.useState(()=>{const i=localStorage.getItem(`review-limit-${r}`);return i?parseInt(i):10}),o=u.useCallback(i=>{const c=Math.max(0,i)||30;s(c),localStorage.setItem(`learning-limit-${r}`,c.toString())},[r]),l=u.useCallback(i=>{const c=Math.max(0,i)||10;a(c),localStorage.setItem(`review-limit-${r}`,c.toString())},[r]);return{learningLimit:t,reviewLimit:n,setLearningLimit:o,setReviewLimit:l}}var pt=(r=>(r.ENCODING="encoding",r.INITIAL_CONSOLIDATION="initial",r.INTRADAY_REVIEW="intraday",r.SHORT_TERM="short_term",r.LONG_TERM="long_term",r))(pt||{});const Ys={encodingTime:3e4,initialConsolidation:36e5,intradayWindow:864e5,shortTermWindow:6048e5,longTermThreshold:6048e5,correctRateThreshold:.8,responseTimeThreshold:1500},Ni=1e3,Si=100,ki=100,Ci=0,Di=6e4,Mi=1e3;class Ii{constructor(t,s){Xe(this,"thresholds");Xe(this,"cache");Xe(this,"CACHE_DURATION",5e3);const n={...Ys,...s};t?this.thresholds=this.adjustThresholds(n,t):this.thresholds=n,this.cache=new Map}adjustThresholds(t,s){return{encodingTime:t.encodingTime,initialConsolidation:t.initialConsolidation/s.learningSpeed,intradayWindow:t.intradayWindow,shortTermWindow:t.shortTermWindow/s.learningSpeed,longTermThreshold:t.longTermThreshold/s.learningSpeed,correctRateThreshold:t.correctRateThreshold,responseTimeThreshold:t.responseTimeThreshold*s.learningSpeed}}detectPhase(t,s){const n=Date.now(),a=this.cache.get(t);if(a&&n-a.timestamp<this.CACHE_DURATION)return a.phase;const o=this.detectPhaseWithReason(t,s);return this.cache.set(t,{phase:o.phase,timestamp:n}),o.phase}detectPhaseWithReason(t,s){const n=Date.now(),a=this.sanitizeTimestamp(s.lastReviewTime,n),o=this.sanitizeTimestamp(s.lastCorrectTime,n),l=this.sanitizeResponseTime(s.averageResponseTime),i=n-a,c=i/864e5,d=s.reviewCount>0?s.correctCount/s.reviewCount:0,m={reviewCount:s.reviewCount,correctCount:s.correctCount,correctRate:d,daysSinceLastReview:c,timeSinceLastReview:i,averageResponseTime:l};if(s.reviewCount===0)return{phase:"encoding",reason:"åˆè¦‹å˜èªï¼ˆreviewCount=0ï¼‰",matchedCondition:1,metrics:m};if(i<this.thresholds.encodingTime)return{phase:"encoding",reason:`ä½œæ¥­è¨˜æ†¶æ®µéšï¼ˆ${Math.round(i/1e3)}ç§’å‰ï¼‰`,matchedCondition:2,metrics:m};if(s.correctCount===0)return{phase:"encoding",reason:"ä¸€åº¦ã‚‚æ­£ç­”ã—ã¦ã„ãªã„",matchedCondition:3,metrics:m};if(c>Ni)return{phase:"encoding",reason:`è¶…é•·æœŸæ”¾ç½®ï¼ˆ${Math.round(c)}æ—¥å‰ï¼‰`,matchedCondition:101,metrics:m};if(s.consecutiveCorrect>=Si)return{phase:"long_term",reason:`å®Œå…¨ç¿’å¾—ï¼ˆ${s.consecutiveCorrect}å›é€£ç¶šæ­£ç­”ï¼‰`,matchedCondition:102,metrics:m};if(s.consecutiveWrong>=ki)return{phase:"encoding",reason:`å­¦ç¿’æ–¹æ³•è¦è¦‹ç›´ã—ï¼ˆ${s.consecutiveWrong}å›é€£ç¶šèª¤ç­”ï¼‰`,matchedCondition:103,metrics:m};const h=(n-o)/36e5;if(s.correctCount===1&&n-o<this.thresholds.initialConsolidation)return{phase:"initial",reason:`åˆæœŸçµ±åˆæ®µéšï¼ˆåˆå›æ­£ç­”å¾Œ${Math.round(h*60)}åˆ†ï¼‰`,matchedCondition:4,metrics:m};if(this.isSameDay(n,o)&&s.correctCount>=2)return{phase:"intraday",reason:`åŒæ—¥å¾©ç¿’æ®µéšï¼ˆä»Šæ—¥${s.correctCount}å›æ­£ç­”ï¼‰`,matchedCondition:5,metrics:m};if(c>=1&&c<=7){if(d>=.5&&d<this.thresholds.correctRateThreshold)return{phase:"short_term",reason:`çŸ­æœŸè¨˜æ†¶æ®µéšï¼ˆ${Math.round(c)}æ—¥å‰ã€æ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:6,metrics:m};if(d<.5)return{phase:"encoding",reason:`å¿˜å´ã«ã‚ˆã‚Šãƒªã‚»ãƒƒãƒˆï¼ˆæ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:6,metrics:m}}return c>7?d>=this.thresholds.correctRateThreshold&&l<this.thresholds.responseTimeThreshold?{phase:"long_term",reason:`é•·æœŸè¨˜æ†¶ç¢ºç«‹ï¼ˆ${Math.round(c)}æ—¥å‰ã€æ­£ç­”ç‡${Math.round(d*100)}%ã€å¿œç­”${Math.round(l)}msï¼‰`,matchedCondition:7,metrics:m}:d>=.5&&d<this.thresholds.correctRateThreshold?{phase:"short_term",reason:`ã¾ã ä¸å®‰å®šï¼ˆæ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:7,metrics:m}:{phase:"encoding",reason:`å®Œå…¨å¿˜å´ï¼ˆæ­£ç­”ç‡${Math.round(d*100)}%ï¼‰`,matchedCondition:7,metrics:m}:{phase:"short_term",reason:"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåˆ¤å®š",matchedCondition:0,metrics:m}}canTransition(t,s,n){const a=this.detectPhase(t,s);if(a===n)return!0;const o=["encoding","initial","intraday","short_term","long_term"],l=o.indexOf(a),i=o.indexOf(n);return i>l?i-l===1:!0}isSameDay(t,s){const n=new Date(t),a=new Date(s);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()&&n.getDate()===a.getDate()}sanitizeResponseTime(t){return t<=Ci||t>Di||isNaN(t)?Mi:t}sanitizeTimestamp(t,s){return t>s?(console.warn(`æœªæ¥ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’æ¤œå‡º: ${t}`),s):t<0||isNaN(t)?s:t}clearCache(){this.cache.clear()}updateThresholds(t){this.thresholds=this.adjustThresholds(Ys,t),this.clearCache()}}var jt=(r=>(r.IMMEDIATE="immediate",r.EARLY="early",r.MID="mid",r.END="end",r))(jt||{}),vt=(r=>(r.MEMORIZATION="memorization",r.TRANSLATION="translation",r.SPELLING="spelling",r.GRAMMAR="grammar",r))(vt||{});const Ai={memorization:{consolidationThreshold:3,enableImmediateReview:!0,enableEarlyReview:!0,enableMidReview:!0,enableEndReview:!0,newQuestionRatio:.6},translation:{consolidationThreshold:2,enableImmediateReview:!0,enableEarlyReview:!1,enableMidReview:!1,enableEndReview:!0,newQuestionRatio:.7},spelling:{consolidationThreshold:4,enableImmediateReview:!0,enableEarlyReview:!0,enableMidReview:!0,enableEndReview:!0,newQuestionRatio:.5},grammar:{consolidationThreshold:3,enableImmediateReview:!0,enableEarlyReview:!0,enableMidReview:!1,enableEndReview:!0,newQuestionRatio:.6}},It={immediate:10,early:20,mid:30,end:50},Ri=72e5,Pi=10;class Ti{constructor(t){Xe(this,"queues");Xe(this,"currentQuestionNumber",0);Xe(this,"sessionStartTime",Date.now());Xe(this,"wordAttempts",new Map);Xe(this,"acquisitionProgress",new Map);Xe(this,"tabConfigs");if(this.queues={immediate:[],early:[],mid:[],end:[]},this.tabConfigs={...Ai},t)for(const[s,n]of Object.entries(t))this.tabConfigs[s]={...this.tabConfigs[s],...n}}enqueueNewWord(t,s,n){const a=Date.now();this.currentQuestionNumber++;const o=this.tabConfigs[n];if(this.acquisitionProgress.has(t)||this.acquisitionProgress.set(t,{todayFirstSeen:a,todayCorrectCount:0,todayWrongCount:0,isAcquisitionComplete:!1,currentQueue:null,queuedAt:0,todayReviews:[]}),o.enableImmediateReview&&this.shouldEnqueueImmediate(s)){const l=this.calculateImmediateGap(s);this.enqueueToImmediate(t,s,n,l)}}enqueueToImmediate(t,s,n,a){const o=Date.now();if(this.isDuplicateInQueue(t,"immediate"))return;const l={word:t,queueType:"immediate",enqueuedAt:o,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:this.currentQuestionNumber+a,targetTime:o+6e4,priority:100,difficulty:s,category:n};this.enqueueWithLimit(this.queues.immediate,l,It.immediate);const i=this.acquisitionProgress.get(t);i.currentQueue="immediate",i.queuedAt=o}enqueueToEarly(t,s,n){const a=Date.now();if(!this.tabConfigs[n].enableEarlyReview||this.isDuplicateInQueue(t,"early"))return;const l=this.calculateEarlyGap(s),i={word:t,queueType:"early",enqueuedAt:a,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:this.currentQuestionNumber+l,targetTime:a+6e5,priority:80,difficulty:s,category:n};this.enqueueWithLimit(this.queues.early,i,It.early);const c=this.acquisitionProgress.get(t);c.currentQueue="early",c.queuedAt=a}enqueueToMid(t,s,n){const a=Date.now();if(!this.tabConfigs[n].enableMidReview||this.isDuplicateInQueue(t,"mid"))return;const l=this.calculateMidGap(s),i={word:t,queueType:"mid",enqueuedAt:a,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:this.currentQuestionNumber+l,targetTime:a+36e5,priority:60,difficulty:s,category:n};this.enqueueWithLimit(this.queues.mid,i,It.mid);const c=this.acquisitionProgress.get(t);c.currentQueue="mid",c.queuedAt=a}enqueueToEnd(t,s,n){const a=Date.now();if(!this.tabConfigs[n].enableEndReview||this.isDuplicateInQueue(t,"end"))return;const l={word:t,queueType:"end",enqueuedAt:a,enqueuedQuestionNumber:this.currentQuestionNumber,targetQuestionNumber:1/0,targetTime:1/0,priority:40,difficulty:s,category:n};this.enqueueWithLimit(this.queues.end,l,It.end);const i=this.acquisitionProgress.get(t);i.currentQueue="end",i.queuedAt=a}getNextReviewQuestion(){this.cleanupExpiredEntries();const t=Date.now(),s=this.currentQuestionNumber,n=[];for(const a of this.queues.immediate)(s>=a.targetQuestionNumber||t>=a.targetTime)&&n.push(a);for(const a of this.queues.early)(s>=a.targetQuestionNumber||t>=a.targetTime)&&n.push(a);for(const a of this.queues.mid)(s>=a.targetQuestionNumber||t>=a.targetTime)&&n.push(a);if(n.sort((a,o)=>o.priority-a.priority),n.length>0){const a=n[0];return this.removeFromQueue(a),a}return null}handleCorrectAnswer(t,s,n,a,o){if(!this.trackWordAttempts(t))return;const l=this.getAcquisitionProgress(t);l.todayCorrectCount++,l.todayReviews.push({timestamp:Date.now(),queueType:s,isCorrect:!0,responseTime:n});let i=a,c=o;if(i===void 0||c===void 0){const d=this.findWordInQueues(t);d&&(i=d.difficulty,c=d.category)}i!==void 0&&c!==void 0&&(s==="immediate"&&this.shouldEnqueueEarly(t,l)?this.enqueueToEarly(t,i,c):s==="early"&&this.shouldEnqueueMid(t,l)?this.enqueueToMid(t,i,c):s==="mid"&&this.shouldEnqueueEnd(t,l)&&this.enqueueToEnd(t,i,c)),this.isAcquisitionComplete(t,l)&&(l.isAcquisitionComplete=!0,console.log(`âœ… è¨˜æ†¶ç²å¾—å®Œäº†: ${t}`))}handleWrongAnswer(t,s,n,a,o){if(!this.trackWordAttempts(t))return;const l=this.getAcquisitionProgress(t);l.todayWrongCount++,l.todayReviews.push({timestamp:Date.now(),queueType:s,isCorrect:!1,responseTime:n});let i=a,c=o;if(i===void 0||c===void 0){const d=this.findWordInQueues(t);d&&(i=d.difficulty,c=d.category)}i!==void 0&&c!==void 0&&(this.removeFromAllQueues(t),s!=="immediate"&&console.log(`âŒ èª¤ç­”ã«ã‚ˆã‚Šå³æ™‚å¾©ç¿’ã‚­ãƒ¥ãƒ¼ã«æˆ»ã—ã¾ã™: ${t}`),this.enqueueToImmediate(t,Math.min(i+1,5),c,1))}startSessionEndReview(){const t=[...this.queues.end];return t.length===0?(console.log("çµ‚äº†æ™‚å¾©ç¿’ãªã—"),[]):(console.log(`çµ‚äº†æ™‚å¾©ç¿’ã‚’é–‹å§‹ã—ã¾ã™ï¼ˆ${t.length}èªï¼‰`),t)}generateAcquisitionReport(){const t=Array.from(this.acquisitionProgress.keys()),s=[],n=[];for(const a of t)this.acquisitionProgress.get(a).isAcquisitionComplete?s.push(a):n.push(a);return{totalWords:t.length,completed:s.length,incomplete:n.length,completionRate:t.length>0?s.length/t.length:0,incompleteWords:n}}getQueueStatistics(){var t,s,n,a;return{immediate:{size:this.queues.immediate.length,oldestEntry:(t=this.queues.immediate[0])==null?void 0:t.enqueuedAt,averageWaitTime:this.calculateAverageWaitTime(this.queues.immediate)},early:{size:this.queues.early.length,oldestEntry:(s=this.queues.early[0])==null?void 0:s.enqueuedAt,averageWaitTime:this.calculateAverageWaitTime(this.queues.early)},mid:{size:this.queues.mid.length,oldestEntry:(n=this.queues.mid[0])==null?void 0:n.enqueuedAt,averageWaitTime:this.calculateAverageWaitTime(this.queues.mid)},end:{size:this.queues.end.length,oldestEntry:(a=this.queues.end[0])==null?void 0:a.enqueuedAt,averageWaitTime:0}}}getAcquisitionProgress(t){return this.acquisitionProgress.has(t)||this.acquisitionProgress.set(t,{todayFirstSeen:Date.now(),todayCorrectCount:0,todayWrongCount:0,isAcquisitionComplete:!1,currentQueue:null,queuedAt:0,todayReviews:[]}),this.acquisitionProgress.get(t)}incrementQuestionNumber(){this.currentQuestionNumber++}reset(){this.queues={immediate:[],early:[],mid:[],end:[]},this.currentQuestionNumber=0,this.sessionStartTime=Date.now(),this.wordAttempts.clear(),this.acquisitionProgress.clear()}getQueueInfo(t){const s=this.findWordInQueues(t);return s?{queueType:s.queueType,questionNumber:s.targetQuestionNumber}:null}getQueueSizes(){return{immediate:this.queues.immediate.length,early:this.queues.early.length,mid:this.queues.mid.length,end:this.queues.end.length}}exportQueues(){return{immediate:[...this.queues.immediate],early:[...this.queues.early],mid:[...this.queues.mid],end:[...this.queues.end]}}clearQueues(){this.queues.immediate=[],this.queues.early=[],this.queues.mid=[],this.queues.end=[]}recordAnswer(t,s,n){const o=this.getAcquisitionProgress(t).currentQueue||"immediate";s?this.handleCorrectAnswer(t,o,n):this.handleWrongAnswer(t,o,n)}shouldEnqueueImmediate(t){return t>=3}shouldEnqueueEarly(t,s){return s.todayCorrectCount>=1}shouldEnqueueMid(t,s){return s.todayCorrectCount>=2}shouldEnqueueEnd(t,s){return s.todayCorrectCount>=3}calculateImmediateGap(t){return t>=4?1:t===3?2:3}calculateEarlyGap(t){return t>=4?5:t===3?7:10}calculateMidGap(t){return t>=4?20:t===3?25:30}isAcquisitionComplete(t,s){const n=this.findWordInQueues(t);if(!n)return!1;const o=this.tabConfigs[n.category].consolidationThreshold;if(s.todayCorrectCount<o||new Set(s.todayReviews.filter(c=>c.isCorrect).map(c=>c.queueType)).size<2)return!1;const i=s.todayReviews.slice(-2);return!(i.length<2||!i.every(c=>c.isCorrect))}isDuplicateInQueue(t,s){return this.queues[s].some(n=>n.word===t)}enqueueWithLimit(t,s,n){t.length>=n&&(console.warn(`ã‚­ãƒ¥ãƒ¼ãŒæº€æ¯ã§ã™ï¼ˆ${n}èªï¼‰ã€‚å¤ã„ã‚¨ãƒ³ãƒˆãƒªã‚’å‰Šé™¤ã—ã¾ã™ã€‚`),t.shift()),t.push(s)}removeFromQueue(t){const s=t.queueType,n=this.queues[s],a=n.findIndex(o=>o.word===t.word);a!==-1&&n.splice(a,1)}removeFromAllQueues(t){for(const s of Object.keys(this.queues))this.queues[s]=this.queues[s].filter(n=>n.word!==t)}findWordInQueues(t){for(const s of Object.keys(this.queues)){const n=this.queues[s].find(a=>a.word===t);if(n)return n}return null}cleanupExpiredEntries(){const t=Date.now();for(const s of Object.keys(this.queues))this.queues[s]=this.queues[s].filter(n=>t-n.enqueuedAt>Ri?(console.warn(`æœŸé™åˆ‡ã‚Œã‚¨ãƒ³ãƒˆãƒªã‚’å‰Šé™¤: ${n.word}`),!1):!0)}trackWordAttempts(t){this.wordAttempts.has(t)||this.wordAttempts.set(t,0);const s=this.wordAttempts.get(t)+1;return this.wordAttempts.set(t,s),s>=Pi?(console.error(`åŒã˜å˜èªã®è©¦è¡Œå›æ•°ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸ: ${t}`),this.removeFromAllQueues(t),!1):!0}calculateAverageWaitTime(t){if(t.length===0)return 0;const s=Date.now();return t.reduce((a,o)=>a+(s-o.enqueuedAt),0)/t.length}}const $i={minEaseFactor:1.3,maxEaseFactor:2.5,easeFactorIncrement:.1,easeFactorDecrement:.2,initialInterval:1,forgettingCurveDecay:.5,confidenceWeight:.15};class Ei{constructor(t){Xe(this,"retentionData",new Map);Xe(this,"config");this.config={...$i,...t}}getRetentionStatus(t){return this.retentionData.has(t)||this.retentionData.set(t,this.createInitialStatus()),this.retentionData.get(t)}recordReview(t,s){const n=this.getRetentionStatus(t);n.totalReviews++,n.lastReviewDate=s.timestamp,n.lastResponseTime=s.responseTime;const a=.3;return n.averageResponseTime=n.averageResponseTime*(1-a)+s.responseTime*a,s.isCorrect?(n.totalCorrect++,n.consecutiveCorrect++,n.consecutiveWrong=0,this.updateSM2OnCorrect(n,s.confidence)):(n.consecutiveCorrect=0,n.consecutiveWrong++,this.updateSM2OnWrong(n)),n.retentionRate=this.estimateRetentionRate(n),n.forgettingIndex=this.calculateForgettingIndex(n),n}getDueWords(t,s=Date.now()){const n=[];for(const a of t){const o=this.getRetentionStatus(a);if(s>=o.nextReviewDate){const i=(s-o.nextReviewDate)/864e5*o.forgettingIndex;n.push({word:a,priority:i})}}return n.sort((a,o)=>o.priority-a.priority),n.map(a=>a.word)}getReviewSchedule(t,s=7){const n=new Map,a=Date.now();for(const o of t){const l=this.getRetentionStatus(o),i=[];let c=l.nextReviewDate;const d=a+s*864e5;for(;c<=d;)i.push(new Date(c)),c+=l.sm2.interval*864e5;i.length>0&&n.set(o,i)}return n}getRetentionStatistics(t){const s=Date.now();let n=0,a=0,o=0,l=0,i=0,c=0;for(const m of t){const h=this.getRetentionStatus(m);n+=h.retentionRate,a+=h.sm2.easeFactor,o+=h.sm2.interval,s>=h.nextReviewDate&&(l++,(s-h.nextReviewDate)/864e5>1&&i++),h.consecutiveCorrect>=5&&h.sm2.interval>=30&&c++}const d=t.length||1;return{averageRetentionRate:n/d,averageEaseFactor:a/d,averageInterval:o/d,dueCount:l,overdueCount:i,wellLearnedCount:c}}estimateRetentionRate(t){const s=Date.now(),n=(s-t.lastReviewDate)/864e5,a=(t.nextReviewDate-s)/864e5;if(a>=0){const o=Math.exp(-this.config.forgettingCurveDecay*n/t.sm2.interval);return Math.max(.1,Math.min(1,o))}else{const o=-a,l=Math.exp(-this.config.forgettingCurveDecay*(n+o)/t.sm2.interval);return Math.max(.05,Math.min(.9,l))}}reset(){this.retentionData.clear()}importRetentionData(t){this.retentionData=new Map(t)}exportRetentionData(){return new Map(this.retentionData)}createInitialStatus(){return{lastReviewDate:Date.now(),nextReviewDate:Date.now()+this.config.initialInterval*864e5,sm2:{interval:this.config.initialInterval,repetition:0,easeFactor:2.5},retentionRate:1,forgettingIndex:1,totalReviews:0,totalCorrect:0,consecutiveCorrect:0,consecutiveWrong:0,averageResponseTime:0,lastResponseTime:0}}updateSM2OnCorrect(t,s){const n=t.sm2;n.repetition++;const a=this.mapConfidenceToQuality(s),o=n.easeFactor+(.1-(5-a)*(.08+(5-a)*.02));n.easeFactor=Math.max(this.config.minEaseFactor,Math.min(this.config.maxEaseFactor,o)),n.repetition===1?n.interval=1:n.repetition===2?n.interval=6:n.interval=Math.round(n.interval*n.easeFactor),t.lastResponseTime>3e3&&t.lastResponseTime>t.averageResponseTime*1.5&&(n.interval=Math.max(1,Math.round(n.interval*.8))),t.nextReviewDate=t.lastReviewDate+n.interval*864e5}updateSM2OnWrong(t){const s=t.sm2;s.repetition=0,s.easeFactor=Math.max(this.config.minEaseFactor,s.easeFactor-this.config.easeFactorDecrement),s.interval=1,t.nextReviewDate=t.lastReviewDate+s.interval*864e5}mapConfidenceToQuality(t){return Math.max(0,Math.min(5,t))}calculateForgettingIndex(t){const a=(t.totalReviews>0?1-t.totalCorrect/t.totalReviews:0)*2,o=t.averageResponseTime>2e3?(t.averageResponseTime-2e3)/5e3:0,l=Math.min(t.consecutiveWrong*.3,1.5),i=1+a+o+l;return Math.max(.5,Math.min(5,i))}}const _i={minSampleSize:20,confidenceThreshold:.7,learningSpeedWindow:7,forgettingSpeedWindow:30},Xs={learningSpeed:1,forgettingSpeed:1,consolidationThreshold:3,responseTimeProfile:{averageResponseTime:2e3,fastThreshold:1e3,slowThreshold:3e3,consistencyScore:.5},confidenceLevel:0,sampleSize:0,lastUpdated:Date.now()};class Li{constructor(t){Xe(this,"config");Xe(this,"parameters");Xe(this,"historyCache",[]);this.config={..._i,...t},this.parameters={...Xs}}addHistory(t){this.historyCache.push(t),this.historyCache.length>100&&this.historyCache.shift()}estimateParameters(t){const s=t||this.historyCache;return s.length<this.config.minSampleSize?(this.parameters.sampleSize=s.length,this.parameters.confidenceLevel=0,{...this.parameters}):(this.parameters.learningSpeed=this.estimateLearningSpeed(s),this.parameters.forgettingSpeed=this.estimateForgettingSpeed(s),this.parameters.consolidationThreshold=this.estimateConsolidationThreshold(s),this.parameters.responseTimeProfile=this.estimateResponseTimeProfile(s),this.parameters.confidenceLevel=this.calculateConfidenceLevel(s.length),this.parameters.sampleSize=s.length,this.parameters.lastUpdated=Date.now(),{...this.parameters})}getParameters(){return{...this.parameters}}importParameters(t){this.parameters={...t}}clearHistory(){this.historyCache=[]}estimateLearningSpeed(t){const s=new Map,n=new Map;for(const l of t){const i=l.word;s.has(i)||s.set(i,0),s.set(i,s.get(i)+1),l.isCorrect&&!n.has(i)&&n.set(i,s.get(i))}const a=Array.from(n.values());if(a.length===0)return 1;const o=a.reduce((l,i)=>l+i,0)/a.length;return o<=2?1.8:o<=2.5?1.5:o<=3.5?1:o<=5?.7:.5}estimateForgettingSpeed(t){const s=new Map,n=[];for(const o of t){const l=o.word;if(o.isCorrect)s.set(l,o.timestamp);else if(s.has(l)){const i=s.get(l),c=(o.timestamp-i)/864e5;n.push(c),s.delete(l)}}if(n.length===0)return 1;const a=n.reduce((o,l)=>o+l,0)/n.length;return a>=7?.6:a>=5?.8:a>=3?1:a>=1?1.5:2}estimateConsolidationThreshold(t){const s=new Map,n=new Map,a=[];for(const l of t){const i=l.word;if(s.has(i)||(s.set(i,0),n.set(i,0)),l.isCorrect){const c=s.get(i)+1;s.set(i,c);const d=Math.max(n.get(i),c);n.set(i,d),c===5&&a.push(this.getWordTotalReviews(i,t))}else s.set(i,0)}if(a.length===0)return 3;const o=a.reduce((l,i)=>l+i,0)/a.length;return Math.max(2,Math.min(5,Math.round(o*.6)))}estimateResponseTimeProfile(t){const s=t.map(m=>m.responseTime);if(s.length===0)return Xs.responseTimeProfile;const n=s.reduce((m,h)=>m+h,0)/s.length,a=s.reduce((m,h)=>m+Math.pow(h-n,2),0)/s.length,o=Math.sqrt(a),l=Math.max(500,n-o),i=Math.min(5e3,n+o),c=o/n,d=Math.max(0,Math.min(1,1-c));return{averageResponseTime:Math.round(n),fastThreshold:Math.round(l),slowThreshold:Math.round(i),consistencyScore:Math.round(d*100)/100}}calculateConfidenceLevel(t){return t<this.config.minSampleSize?0:t<50?(t-this.config.minSampleSize)/(50-this.config.minSampleSize)*.7:t<100?.7+(t-50)/50*.2:.9+Math.min((t-100)/200*.1,.1)}getWordTotalReviews(t,s){return s.filter(n=>n.word===t).length}}const _r={acquisitionRatio:.6,retentionRatio:.4,adaptiveAdjustment:!0,sessionQuestionNumber:0};class Wi{constructor(t=_r){Xe(this,"strategy");Xe(this,"personalParams",null);this.strategy={...t}}setPersonalParameters(t){this.personalParams=t}updateStrategy(t){this.strategy={...this.strategy,...t}}selectNextQuestion(t){if(t.length===0)return null;const s=t.map(a=>this.calculatePriority(a));s.sort((a,o)=>o.priority-a.priority);const n=s.find(a=>a.candidate.queueType!==void 0);return n?n.candidate:this.selectByStrategy(s)}calculatePriority(t){const s={queuePriority:this.calculateQueuePriority(t),phasePriority:this.calculatePhasePriority(t),timingPriority:this.calculateTimingPriority(t),personalPriority:this.calculatePersonalPriority(t)},n=Object.values(s).reduce((o,l)=>o+l,0),a=this.generatePriorityReason(t,s);return{candidate:t,priority:n,breakdown:s,reason:a}}calculateQueuePriority(t){if(!t.queueType)return 0;let n={[jt.IMMEDIATE]:40,[jt.EARLY]:30,[jt.MID]:20,[jt.END]:10}[t.queueType]||0;if(t.questionNumber!==void 0){const a=Math.max(0,5-t.questionNumber*.5);n+=a}return Math.min(40,n)}calculatePhasePriority(t){return{[pt.ENCODING]:25,[pt.INITIAL_CONSOLIDATION]:30,[pt.INTRADAY_REVIEW]:20,[pt.SHORT_TERM]:15,[pt.LONG_TERM]:10}[t.phase]||0}calculateTimingPriority(t){const s=Date.now();if(!t.nextReviewTime)return 15;const n=s-t.nextReviewTime;if(n>=0){const o=n/36e5;return Math.min(20,10+o*2)}const a=Math.abs(n)/(1e3*60*60);return a<=1?10-a*5:0}calculatePersonalPriority(t){if(!this.personalParams)return 5;let s=5;return t.reviewCount===0&&this.personalParams.learningSpeed<.8&&(s-=2),t.reviewCount===0&&this.personalParams.learningSpeed>1.2&&(s+=2),t.reviewCount>0&&this.personalParams.forgettingSpeed>1.2&&(s+=3),t.reviewCount>0&&this.personalParams.forgettingSpeed<.8&&(s-=2),Math.max(0,Math.min(10,s))}selectByStrategy(t){var l,i;if(t.length===0)return null;const s=t.filter(c=>c.candidate.reviewCount===0),n=t.filter(c=>c.candidate.reviewCount>0);if(s.length===0)return((l=n[0])==null?void 0:l.candidate)||null;if(n.length===0)return((i=s[0])==null?void 0:i.candidate)||null;let a=this.strategy.acquisitionRatio;return this.strategy.adaptiveAdjustment&&this.strategy.sessionQuestionNumber!==void 0&&(a=this.calculateAdaptiveRatio(this.strategy.sessionQuestionNumber)),Math.random()<a?s[0].candidate:n[0].candidate}calculateAdaptiveRatio(t){return t<=10?.7:t<=20?.6:t<=30?.5:.4}generatePriorityReason(t,s){const n=[];if(t.queueType&&n.push(`ã‚­ãƒ¥ãƒ¼: ${t.queueType}`),n.push(`ãƒ•ã‚§ãƒ¼ã‚º: ${t.phase}`),t.nextReviewTime){const o=Date.now()-t.nextReviewTime,l=Math.abs(o/(1e3*60*60));o>=0?n.push(`é…å»¶: ${l.toFixed(1)}æ™‚é–“`):n.push(`äºˆå®šã¾ã§: ${l.toFixed(1)}æ™‚é–“`)}return t.reviewCount===0?n.push("æ–°è¦å˜èª"):n.push(`å¾©ç¿’${t.reviewCount}å›ç›®`),n.join(", ")}getAllPriorities(t){return t.map(s=>this.calculatePriority(s)).sort((s,n)=>n.priority-s.priority)}}function Ks(r,t){return t?{word:r,reviewCount:t.correctCount+t.incorrectCount,correctCount:t.correctCount,wrongCount:t.incorrectCount,lastReviewTime:t.lastStudied||0,lastCorrectTime:t.consecutiveCorrect>0?t.lastStudied:0,averageResponseTime:t.averageResponseTime||0,consecutiveCorrect:t.consecutiveCorrect,consecutiveWrong:t.consecutiveIncorrect}:{word:r,reviewCount:0,correctCount:0,wrongCount:0,lastReviewTime:0,lastCorrectTime:0,averageResponseTime:0,consecutiveCorrect:0,consecutiveWrong:0}}function ss(r=vt.MEMORIZATION,t){const s=u.useRef(null),n=u.useRef(null),a=u.useRef(null),o=u.useRef(null),l=u.useRef(null),[i,c]=u.useState(0),[d,m]=u.useState({currentPhase:null,personalParams:null,queueSizes:{immediate:0,early:0,mid:0,end:0},sessionProgress:{totalQuestions:0,newWords:0,reviews:0}});u.useEffect(()=>{p.info("[useAdaptiveLearning] Initializing adaptive learning algorithms",{category:r,sessionId:t}),s.current=new Ii,n.current=new Ti,a.current=new Ei,o.current=new Li,l.current=new Wi({..._r,sessionQuestionNumber:0});try{localStorage.getItem(`adaptive-learning-queues-${r}`)&&n.current&&p.debug("[useAdaptiveLearning] Restored queues from localStorage")}catch(y){p.error("[useAdaptiveLearning] Failed to restore queues:",y)}try{if(o.current){const y=o.current.estimateParameters();m(v=>({...v,personalParams:y})),l.current&&l.current.setPersonalParameters(y),p.info("[useAdaptiveLearning] Personal parameters estimated:",y)}}catch(y){p.error("[useAdaptiveLearning] Failed to estimate personal parameters:",y)}return()=>{try{if(n.current){const y=n.current.exportQueues();localStorage.setItem(`adaptive-learning-queues-${r}`,JSON.stringify(y)),p.debug("[useAdaptiveLearning] Saved queues to localStorage")}}catch(y){p.error("[useAdaptiveLearning] Failed to save queues:",y)}}},[r,t]);const h=u.useCallback(y=>{if(!l.current||!s.current||!n.current)return p.warn("[useAdaptiveLearning] Algorithms not initialized"),y.length>0?y[0]:null;try{const v=y.map(D=>{const C=Wt(D.word),w=Ks(D.word,C),E=s.current.detectPhase(D.word,w),$=n.current.getQueueInfo(D.word);return{id:D.word,word:D.word,category:r,phase:E,reviewCount:w.reviewCount,correctCount:w.correctCount,lastReviewTime:w.lastReviewTime||Date.now(),queueType:$==null?void 0:$.queueType,questionNumber:$==null?void 0:$.questionNumber,difficulty:parseInt(D.difficulty)||3}});l.current.updateStrategy({sessionQuestionNumber:i});const k=l.current.selectNextQuestion(v);if(k){const D=y.find(C=>C.word===k.word);return c(C=>C+1),m(C=>({...C,currentPhase:k.phase,sessionProgress:{totalQuestions:C.sessionProgress.totalQuestions+1,newWords:C.sessionProgress.newWords+(k.reviewCount===0?1:0),reviews:C.sessionProgress.reviews+(k.reviewCount>0?1:0)}})),p.debug("[useAdaptiveLearning] Selected question:",{word:k.word,phase:k.phase,queueType:k.queueType}),D||null}return null}catch(v){return p.error("[useAdaptiveLearning] Error selecting question:",v),y.length>0?y[0]:null}},[r,i]),g=u.useCallback((y,v,k)=>{try{if(s.current){const D=Wt(y),C=Ks(y,D),w=s.current.detectPhase(y,C);m(E=>({...E,currentPhase:w}))}if(n.current){n.current.recordAnswer(y,v,k);const D=n.current.getQueueSizes();m(C=>({...C,queueSizes:D}))}if(a.current&&a.current.recordReview(y,{isCorrect:v,confidence:v?3:0,responseTime:k,timestamp:Date.now()}),o.current&&(o.current.addHistory({word:y,timestamp:Date.now(),isCorrect:v,responseTime:k,reviewNumber:1,daysSinceFirstSeen:0}),i>0&&i%20===0)){const D=o.current.estimateParameters();m(C=>({...C,personalParams:D})),l.current&&l.current.setPersonalParameters(D),p.info("[useAdaptiveLearning] Personal parameters updated:",D)}p.debug("[useAdaptiveLearning] Recorded answer:",{word:y,isCorrect:v,responseTime:k})}catch(D){p.error("[useAdaptiveLearning] Error recording answer:",D)}},[i]),S=u.useCallback(()=>{p.info("[useAdaptiveLearning] Resetting adaptive learning algorithms"),c(0),m({currentPhase:null,personalParams:null,queueSizes:{immediate:0,early:0,mid:0,end:0},sessionProgress:{totalQuestions:0,newWords:0,reviews:0}}),n.current&&n.current.clearQueues(),o.current&&o.current.clearHistory()},[]),b=u.useCallback(()=>{var y;return{sessionQuestionCount:i,state:d,queues:((y=n.current)==null?void 0:y.exportQueues())||null,personalParams:d.personalParams}},[i,d]);return{selectNextQuestion:h,recordAnswer:g,state:d,reset:S,getDebugInfo:b}}function Oi({quizState:r,_categoryList:t,selectedCategory:s,onCategoryChange:n,selectedDifficulty:a,onDifficultyChange:o,selectedWordPhraseFilter:l="all",onWordPhraseFilterChange:i,selectedPhraseTypeFilter:c="all",onPhraseTypeFilterChange:d,selectedDataSource:m="all",onDataSourceChange:h,questionSets:g=[],onStartQuiz:S,onAnswer:b,onNext:y,onPrevious:v,onSkip:k,onDifficultyRate:D,onReviewFocus:C,sessionStats:w,isReviewFocusMode:E=!1,errorPrediction:$,customQuestionSets:G=[],onAddWordToCustomSet:Y,onRemoveWordFromCustomSet:q,onOpenCustomSetManagement:me}){var _,J;const{questions:Ne,currentIndex:be,answered:Re,selectedAnswer:A}=r,Q=Ne.length>0,O=Q?Ne[be]:null,[ae,Z]=u.useState(!1),[te,Ie]=u.useState(!1),[ye,we]=u.useState(Date.now()),[Se,Ge]=u.useState(void 0),[Ce,We]=u.useState(void 0),[_e,Fe]=u.useState(0),[Ee,Pe]=u.useState(0),le=ss(vt.TRANSLATION),{learningLimit:$e,reviewLimit:Be,setLearningLimit:He,setReviewLimit:je}=Ws("translation"),[ze,Ue]=u.useState(()=>localStorage.getItem("autoNext")==="true"),[Le,j]=u.useState(()=>{const R=localStorage.getItem("autoNextDelay");return R?parseInt(R,10):1500}),[x,f]=u.useState(()=>localStorage.getItem("autoShowDetails")!=="false"),N=async(R,F)=>{const B=R===F;Ge(B),We(O==null?void 0:O.word),B?(Fe(de=>de+1),Pe(0)):(Pe(de=>de+1),Fe(0)),await b(R,F),we(Date.now()),O!=null&&O.word&&le.recordAnswer(O.word,B,3e3),ze&&B&&setTimeout(()=>{We(void 0),y()},Le)},T=()=>{We(void 0),y()},H=async()=>{k&&(await k(),we(Date.now()))},V=localStorage.getItem("learning-schedule-90days"),L=!!V;let P=null;if(L)try{const R=JSON.parse(V),F=Math.floor((Date.now()-R.startDate)/(1e3*60*60*24)),B=Math.min(F+1,R.totalDays),de=Math.round(B/R.totalDays*100);P={currentDay:B,totalDays:R.totalDays,progressPercent:de,phase:R.phase}}catch(R){p.error("Failed to parse learning plan:",R)}const ve=()=>{Ie(!te)};return te&&Q&&O?e.jsx("div",{className:"fixed inset-0 z-50 bg-gray-50 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-8",children:[e.jsx("button",{onClick:ve,className:"fixed top-4 right-4 z-50 p-3 bg-gray-800 text-white rounded-full shadow-lg hover:bg-gray-700:bg-gray-600 transition","aria-label":"å…¨ç”»é¢çµ‚äº†",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"w-full max-w-4xl px-4",children:e.jsx(Vs,{question:O,questionNumber:be+1,allQuestions:Ne,currentIndex:be,answered:Re,selectedAnswer:A,onAnswer:N,onNext:k?Re?T:H:T,onPrevious:v,onDifficultyRate:D,errorPrediction:$,customQuestionSets:G,onAddWordToCustomSet:Y,onRemoveWordFromCustomSet:q,onOpenCustomSetManagement:me,onFullscreen:ve})})]})}):e.jsxs("div",{className:"quiz-view",children:[L&&P&&e.jsx("div",{className:"plan-progress-banner",children:e.jsxs("div",{className:"plan-progress-content",children:[e.jsx("span",{className:"plan-progress-icon",children:"ğŸ“š"}),e.jsxs("div",{className:"plan-progress-info",children:[e.jsx("div",{className:"plan-progress-title",children:"å­¦ç¿’ãƒ—ãƒ©ãƒ³é€²è¡Œä¸­"}),e.jsxs("div",{className:"plan-progress-detail",children:[P.currentDay,"æ—¥ç›® / ",P.totalDays,"æ—¥ (Phase ",P.phase,") -"," ",P.progressPercent,"%å®Œäº†"]})]})]})}),Q&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(ts,{mode:"translation",currentScore:r.score,totalAnswered:r.totalAnswered,sessionCorrect:w==null?void 0:w.correct,sessionIncorrect:w==null?void 0:w.incorrect,sessionReview:w==null?void 0:w.review,sessionMastered:w==null?void 0:w.mastered,sessionStats:w,onReviewFocus:C,isReviewFocusMode:E,onShowSettings:()=>Z(!0),currentWord:O==null?void 0:O.word,onAnswerTime:ye,lastAnswerCorrect:Se,lastAnswerWord:Ce,lastAnswerDifficulty:O==null?void 0:O.difficulty,correctStreak:_e,incorrectStreak:Ee,learningPhase:le.state.currentPhase??void 0,estimatedSpeed:(_=le.state.personalParams)==null?void 0:_.learningSpeed,dataSource:((J=g==null?void 0:g.find(R=>R.id===m))==null?void 0:J.name)||"å…¨å•é¡Œé›†",category:s==="å…¨åˆ†é‡"?"å…¨åˆ†é‡":s,difficulty:a,wordPhraseFilter:l})})}),ae&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>Z(!1),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 text-sm shadow-sm:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"category-select-quiz",children:"ğŸ“š é–¢é€£åˆ†é‡:"}),e.jsxs("select",{id:"category-select-quiz",value:s,onChange:R=>n(R.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®åˆ†é‡"}),Qr.map(R=>e.jsx("option",{value:R,children:R},R))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-select-quiz",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-select-quiz",value:a,onChange:R=>o(R.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®ãƒ¬ãƒ™ãƒ«"}),e.jsx("option",{value:"beginner",children:"åˆç´š"}),e.jsx("option",{value:"intermediate",children:"ä¸­ç´š"}),e.jsx("option",{value:"advanced",children:"ä¸Šç´š"})]})]}),h&&g&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"data-source-select-quiz",children:"ğŸ“š å‡ºé¡Œå…ƒ:"}),e.jsx("select",{id:"data-source-select-quiz",value:m,onChange:R=>h(R.target.value),className:"select-input",children:g.map(R=>e.jsx("option",{value:R.id,children:R.name},R.id))})]}),i&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"word-phrase-filter-quiz",children:"ğŸ“– å˜èª/ç†Ÿèª:"}),e.jsxs("select",{id:"word-phrase-filter-quiz",value:l,onChange:R=>i(R.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"words-only",children:"å˜èªã®ã¿"}),e.jsx("option",{value:"phrases-only",children:"ç†Ÿèªã®ã¿"})]})]}),d&&l==="phrases-only"&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"phrase-type-filter-quiz",children:"ğŸ·ï¸ ç†Ÿèªã‚¿ã‚¤ãƒ—:"}),e.jsxs("select",{id:"phrase-type-filter-quiz",value:c,onChange:R=>d(R.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"phrasal-verb",children:"å¥å‹•è©"}),e.jsx("option",{value:"idiom",children:"ã‚¤ãƒ‡ã‚£ã‚ªãƒ "}),e.jsx("option",{value:"collocation",children:"ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³"}),e.jsx("option",{value:"other",children:"ãã®ä»–"})]})]}),e.jsx(Ls,{learningLimit:$e,reviewLimit:Be,onLearningLimitChange:He,onReviewLimitChange:je,idPrefix:"quiz-"}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-next-toggle",checked:ze,onChange:R=>{Ue(R.target.checked),localStorage.setItem("autoNext",R.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-next-toggle",className:"checkbox-label",children:["æ­£è§£æ™‚è‡ªå‹•ã§æ¬¡ã¸ï¼š",ze?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})}),ze&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"auto-next-delay",children:"â±ï¸ æ¬¡ã¸ã®é…å»¶æ™‚é–“ï¼š"}),e.jsxs("div",{className:"slider-row",children:[e.jsx("input",{type:"range",id:"auto-next-delay",min:"500",max:"3000",step:"100",value:Le,onChange:R=>{const F=parseInt(R.target.value,10);j(F),localStorage.setItem("autoNextDelay",F.toString())},className:"slider-input"}),e.jsxs("span",{className:"slider-value",children:[(Le/1e3).toFixed(1),"ç§’"]})]})]}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-show-details-toggle",checked:x,onChange:R=>{f(R.target.checked),localStorage.setItem("autoShowDetails",R.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-show-details-toggle",className:"checkbox-label",children:["ä¸æ­£è§£æ™‚è‡ªå‹•ã§è©³ç´°ã‚’é–‹ãï¼š",x?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})})]}),e.jsx("div",{className:"question-container",children:O&&e.jsx(e.Fragment,{children:e.jsx(Vs,{question:O,questionNumber:be+1,allQuestions:Ne,currentIndex:be,answered:Re,selectedAnswer:A,onAnswer:N,onNext:k?Re?T:H:T,onPrevious:v,onDifficultyRate:D,errorPrediction:$,customQuestionSets:G,onAddWordToCustomSet:Y,onRemoveWordFromCustomSet:q,onOpenCustomSetManagement:me,onFullscreen:ve})})})]})]})}function qi(r){const[t,s]=u.useState({questions:[],currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedLetters:[],correctWord:""}),[n,a]=u.useState([]),[o,l]=u.useState([]),[i,c]=u.useState([]),[d,m]=u.useState(0),[h,g]=u.useState([]),S=u.useRef(0);return u.useEffect(()=>{r.length>0&&s({questions:r,currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedLetters:[],correctWord:""})},[r]),u.useEffect(()=>{if(t.questions.length>0){const w=t.questions[t.currentIndex].word.toLowerCase();if(w.includes(" ")){const E=w.split(/\s+/);c(E),m(0),g([]);const G=[...E[0].split("")].sort(()=>Math.random()-.5);a(G),s(Y=>({...Y,correctWord:w.replace(/\s+/g,""),answered:!1}))}else{c([]),m(0),g([]);const $=[...w.split("")].sort(()=>Math.random()-.5);a($),s(G=>({...G,correctWord:w,answered:!1}))}l([]),S.current=Date.now()}},[t.currentIndex,t.questions]),{spellingState:t,setSpellingState:s,shuffledLetters:n,selectedSequence:o,setSelectedSequence:l,phraseWords:i,currentWordIndex:d,completedWords:h,handleLetterClick:C=>{if(t.answered){if(o.includes(`${C}`))l(o.filter(E=>E!==`${C}`));else{const E=[...o,`${C}`];l(E)}return}if(o.includes(`${C}`))return;const w=[...o,`${C}`];return l(w),w.length===n.length?w:null},checkAnswer:C=>{const w=C.map($=>n[parseInt($)]).join(""),E=Date.now()-S.current;if(i.length>0){const $=i[d];if(w===$){const Y=[...h,w];if(g(Y),d<i.length-1){const q=d+1;m(q);const Ne=[...i[q].split("")].sort(()=>Math.random()-.5);return a(Ne),l([]),{isPartialCorrect:!0,isComplete:!1,userWord:w,responseTime:E}}else{const q=Y.join("");return{isPartialCorrect:!0,isComplete:!0,isCorrect:q===t.correctWord,userWord:q,responseTime:E}}}else return{isPartialCorrect:!1,isComplete:!0,isCorrect:!1,userWord:[...h,w].join(""),responseTime:E}}else return{isComplete:!0,isCorrect:w===t.correctWord,userWord:w,responseTime:E}},moveToNextQuestion:()=>{s(C=>({...C,currentIndex:C.currentIndex+1,answered:!1}))},updateScore:C=>{s(w=>({...w,score:C?w.score+1:w.score,totalAnswered:w.totalAnswered+1,answered:!0}))},resetAnswer:()=>{if(l([]),s(C=>({...C,answered:!1})),i.length>0){const w=[...i[d].split("")].sort(()=>Math.random()-.5);a(w)}else{const E=[...t.questions[t.currentIndex].word.toLowerCase().split("")].sort(()=>Math.random()-.5);a(E)}S.current=Date.now()}}}function zi(){const[r,t]=u.useState({correct:0,incorrect:0,review:0,mastered:0});return{sessionStats:r,setSessionStats:t,resetStats:()=>{t({correct:0,incorrect:0,review:0,mastered:0})},updateStats:a=>{t(o=>({...o,correct:o.correct+(a==="correct"?1:0),incorrect:o.incorrect+(a==="incorrect"?1:0),review:o.review+(a==="review"?1:0),mastered:o.mastered+(a==="mastered"?1:0)}))}}}function Fi({questions:r,_categoryList:t,selectedCategory:s,onCategoryChange:n,selectedDifficulty:a,onDifficultyChange:o,selectedWordPhraseFilter:l="all",onWordPhraseFilterChange:i,selectedPhraseTypeFilter:c="all",onPhraseTypeFilterChange:d,selectedDataSource:m="all",onDataSourceChange:h,onStartQuiz:g,onReviewFocus:S,isReviewFocusMode:b=!1,customQuestionSets:y=[],onAddWordToCustomSet:v,onRemoveWordFromCustomSet:k,onOpenCustomSetManagement:D}){var oe,ie,ue;const{spellingState:C,setSpellingState:w,shuffledLetters:E,selectedSequence:$,setSelectedSequence:G,phraseWords:Y,completedWords:q,handleLetterClick:me,checkAnswer:Ne,moveToNextQuestion:be,updateScore:Re}=qi(r),{sessionStats:A,resetStats:Q,updateStats:O}=zi(),ae=ss(vt.SPELLING),[Z,te]=u.useState(!1),[Ie,ye]=u.useState(!1),[we,Se]=u.useState(Date.now()),[Ge,Ce]=u.useState(void 0),[We,_e]=u.useState(void 0),[Fe,Ee]=u.useState(0),[Pe,le]=u.useState(0),{learningLimit:$e,reviewLimit:Be,setLearningLimit:He,setReviewLimit:je}=Ws("spelling"),[ze,Ue]=u.useState(()=>localStorage.getItem("autoNext")==="true"),[Le,j]=u.useState(()=>{const W=localStorage.getItem("autoNextDelay");return W?parseInt(W,10):1500}),x=u.useRef(null),f=u.useRef(0),N=u.useRef(0),T=u.useRef([]);u.useEffect(()=>{r.length>0&&(f.current=Date.now(),T.current=[],Q())},[r,Q]),u.useEffect(()=>{if(!C.answered&&x.current){const W=setTimeout(()=>{var U;(U=x.current)==null||U.focus()},100);return()=>clearTimeout(W)}},[C.answered,C.currentIndex,C.questions.length]);const H=(W,U)=>{const ee=me(U);ee&&ee.length===E.length&&setTimeout(()=>V(ee),300)},V=async W=>{const U=Ne(W);U&&(U.isPartialCorrect&&!U.isComplete||U.isComplete&&await L(U.userWord,U.isCorrect||!1,U.responseTime))},L=async(W,U,ee)=>{var z;const I=C.questions[C.currentIndex];if(Ce(U),_e(I.word),U?(Ee(re=>re+1),le(0)):(le(re=>re+1),Ee(0)),I){await mt(I.word,U,ee,void 0,"spelling"),Se(Date.now()),ae.recordAnswer(I.word,U,ee);const K=(z=(await et()).wordProgress)==null?void 0:z[I.word];let X=U?"correct":"incorrect";K&&K.masteryLevel==="mastered"?X="mastered":!U&&K&&K.incorrectCount>=2&&(X="review"),O(X),yt({status:X,word:I.word,timestamp:Date.now()},"spelling"),K&&K.skippedCount&&K.skippedCount>0&&(U?Sr(I.word):Nr(I.word))}if(!U&&I){T.current.push(I.word),A.correct+A.incorrect;{const re=C.questions.slice(C.currentIndex+1);if(re.length>1){const K=localStorage.getItem("learning-limit-spelling"),X=localStorage.getItem("review-limit-spelling"),pe=K?parseInt(K):null,Ae=X?parseInt(X):null,De=es(re,{isReviewFocusMode:b||!1,learningLimit:pe,reviewLimit:Ae,mode:"spelling"});w(Te=>({...Te,questions:[...Te.questions.slice(0,Te.currentIndex+1),...De]}))}}}Re(U),I&&St({id:kt(),questionSetId:"spelling-quiz-single",questionSetName:"ã‚¹ãƒšãƒ«ã‚¯ã‚¤ã‚º",score:U?1:0,total:1,percentage:U?100:0,date:Date.now(),timeSpent:Math.floor(ee/1e3),incorrectWords:U?[]:[I.word],mode:"spelling"})},P=()=>{_e(void 0),be()},ve=async()=>{const W=C.questions[C.currentIndex];if(!W)return;if(C.answered){P();return}const U=Date.now()-N.current;console.log("[SpellingView] Skipå‡¦ç†é–‹å§‹:",{word:W.word,responseTime:U,currentScore:C.score,totalAnswered:C.totalAnswered}),Ce(!0),_e(W.word),Ee(ee=>ee+1),le(0),Xt(W.word,30),jr(W.word),await mt(W.word,!0,U,void 0,"spelling"),Se(Date.now()),G([]),w(ee=>({...ee,totalAnswered:ee.totalAnswered+1,score:ee.score+1,answered:!1})),O("correct"),O("mastered"),yt({status:"correct",word:W.word,timestamp:Date.now()},"spelling"),console.log("[SpellingView] Skipå‡¦ç†å®Œäº†:",{word:W.word,newScore:C.score+1,newTotalAnswered:C.totalAnswered+1}),St({id:kt(),questionSetId:"spelling-quiz-single",questionSetName:"ã‚¹ãƒšãƒ«ã‚¯ã‚¤ã‚º",score:1,total:1,percentage:100,date:Date.now(),timeSpent:Math.floor(U/1e3),incorrectWords:[],mode:"spelling",difficulty:W.difficulty}),P()},_=()=>{G([]),w(W=>({...W,currentIndex:W.currentIndex>0?W.currentIndex-1:0,answered:!1})),N.current=Date.now()},J=()=>{if($.length>0){const W=$.slice(0,-1);G(W)}},R=C.questions.length>0,F=R?C.questions[C.currentIndex]:null,B=$.map(W=>E[parseInt(W)]).join(""),de=F?{word:F.word,meaning:F.meaning,katakana:F.reading,source:"spelling"}:null,fe=localStorage.getItem("learning-schedule-90days"),M=!!fe;let se=null;if(M)try{const W=JSON.parse(fe),U=Math.floor((Date.now()-W.startDate)/(1e3*60*60*24)),ee=Math.min(U+1,W.totalDays),I=Math.round(ee/W.totalDays*100);se={currentDay:ee,totalDays:W.totalDays,progressPercent:I,phase:W.phase}}catch(W){p.error("Failed to parse learning plan:",W)}return e.jsxs("div",{className:"spelling-view",children:[M&&se&&e.jsx("div",{className:"plan-progress-banner",children:e.jsxs("div",{className:"plan-progress-content",children:[e.jsx("span",{className:"plan-progress-icon",children:"ğŸ“š"}),e.jsxs("div",{className:"plan-progress-info",children:[e.jsx("div",{className:"plan-progress-title",children:"å­¦ç¿’ãƒ—ãƒ©ãƒ³é€²è¡Œä¸­"}),e.jsxs("div",{className:"plan-progress-detail",children:[se.currentDay,"æ—¥ç›® / ",se.totalDays,"æ—¥ (Phase ",se.phase,") -"," ",se.progressPercent,"%å®Œäº†"]})]})]})}),!R&&e.jsx("div",{className:"quiz-controls",children:e.jsx("button",{onClick:g,className:"w-64 px-8 py-4 text-lg font-bold bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all duration-300 shadow-xl:bg-primary-hover",children:"ğŸ¯ ã‚¯ã‚¤ã‚ºé–‹å§‹"})}),R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(ts,{mode:"spelling",currentScore:C.score,totalAnswered:C.totalAnswered,sessionCorrect:A.correct,sessionIncorrect:A.incorrect,sessionReview:A.review,sessionMastered:A.mastered,sessionStats:A,onReviewFocus:S,isReviewFocusMode:b,onShowSettings:()=>te(!0),currentWord:(oe=C.questions[C.currentIndex])==null?void 0:oe.word,onAnswerTime:we,lastAnswerCorrect:Ge,lastAnswerWord:We,lastAnswerDifficulty:(ie=C.questions[C.currentIndex])==null?void 0:ie.difficulty,correctStreak:Fe,incorrectStreak:Pe,learningPhase:ae.state.currentPhase??void 0,estimatedSpeed:(ue=ae.state.personalParams)==null?void 0:ue.learningSpeed,dataSource:m==="all"?"å…¨å•é¡Œé›†":m==="junior"?"é«˜æ ¡å—é¨“":"é«˜æ ¡å—é¨“æ¨™æº–",category:s==="å…¨åˆ†é‡"?"å…¨åˆ†é‡":s,difficulty:a,wordPhraseFilter:l})})}),Z&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>te(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-200 hover:border-gray-400 transition-all duration-200 text-sm shadow-sm:bg-gray-600:border-gray-500",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"category-select-spelling",children:"ğŸ“š é–¢é€£åˆ†é‡:"}),e.jsxs("select",{id:"category-select-spelling",value:s,onChange:W=>n(W.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®åˆ†é‡"}),Qr.map(W=>e.jsx("option",{value:W,children:W},W))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-select-spelling",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-select-spelling",value:a,onChange:W=>o(W.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®ãƒ¬ãƒ™ãƒ«"}),e.jsx("option",{value:"beginner",children:"åˆç´š"}),e.jsx("option",{value:"intermediate",children:"ä¸­ç´š"}),e.jsx("option",{value:"advanced",children:"ä¸Šç´š"})]})]}),h&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"data-source-select-spelling",children:"ğŸ“š å•é¡Œé›†:"}),e.jsxs("select",{id:"data-source-select-spelling",value:m,onChange:W=>h(W.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"junior",children:"é«˜æ ¡å—é¨“"}),e.jsx("option",{value:"intermediate",children:"é«˜æ ¡å—é¨“æ¨™æº–"})]})]}),i&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"word-phrase-filter-spelling",children:"ğŸ“– å˜èª/ç†Ÿèª:"}),e.jsxs("select",{id:"word-phrase-filter-spelling",value:l,onChange:W=>i(W.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"words-only",children:"å˜èªã®ã¿"}),e.jsx("option",{value:"phrases-only",children:"ç†Ÿèªã®ã¿"})]})]}),d&&l==="phrases-only"&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"phrase-type-filter-spelling",children:"ğŸ·ï¸ ç†Ÿèªã‚¿ã‚¤ãƒ—:"}),e.jsxs("select",{id:"phrase-type-filter-spelling",value:c,onChange:W=>{d&&d(W.target.value)},className:"select-input",children:[e.jsx("option",{value:"all",children:"ã™ã¹ã¦"}),e.jsx("option",{value:"phrasal-verb",children:"å¥å‹•è©"}),e.jsx("option",{value:"idiom",children:"ã‚¤ãƒ‡ã‚£ã‚ªãƒ "}),e.jsx("option",{value:"collocation",children:"ã‚³ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³"}),e.jsx("option",{value:"other",children:"ãã®ä»–"})]})]}),e.jsx(Ls,{learningLimit:$e,reviewLimit:Be,onLearningLimitChange:He,onReviewLimitChange:je,idPrefix:"spelling-quiz-"})]}),F&&e.jsxs("div",{className:"question-card relative",children:[e.jsx("button",{onClick:()=>ye(!0),className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsxs("div",{className:"question-nav-row meaning-row",children:[e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:_,disabled:C.currentIndex===0,title:"å‰ã¸",children:"â†"}),e.jsxs("div",{className:"meaning-display",children:[e.jsxs("div",{className:"meaning-line",children:[e.jsx("span",{className:"text-xl text-gray-600",children:"æ„å‘³:"}),e.jsx("span",{className:"text-4xl font-bold text-gray-900 ml-2",children:F.meaning})]}),de&&v&&k&&D&&y&&e.jsx("div",{className:"mt-3 flex justify-center",children:e.jsx(Ct,{word:de,sets:y,onAddWord:v,onRemoveWord:k,onOpenManagement:D,size:"medium",variant:"both"})}),e.jsxs("div",{className:"meaning-meta",children:[F.difficulty&&e.jsx("div",{className:`difficulty-badge ${F.difficulty}`,children:F.difficulty==="beginner"?"åˆç´š":F.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"}),F.word.includes(" ")&&e.jsxs("div",{className:"phrase-hint",children:["ğŸ’¡ ç†Ÿèª(",Y.length,"èª): å˜èªã”ã¨ã«å…¥åŠ›ã—ã¦ãã ã•ã„",q.length>0&&e.jsxs("span",{className:"phrase-progress",children:[" ","(å®Œæˆ: ",q.join(" "),")"]})]})]})]}),e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:C.answered?P:ve,disabled:C.currentIndex>=C.questions.length-1,title:C.answered?"æ¬¡ã¸":"ã‚¹ã‚­ãƒƒãƒ—",children:"â†’"})]}),e.jsx("div",{className:"question-content-inline",children:e.jsxs("div",{className:"user-word-display",children:[e.jsx("div",{className:"user-word-label",children:"ã‚ãªãŸã®ç­”ãˆ:"}),e.jsx("div",{className:"user-word-text",children:Y.length>0?e.jsxs(e.Fragment,{children:[q.join(" "),q.length>0&&" ",B||"ï¼ˆä¸¦ã³æ›¿ãˆï¼‰"]}):B||"ï¼ˆä¸¦ã³æ›¿ãˆï¼‰"})]})}),e.jsx("div",{className:"letter-cards",ref:x,tabIndex:0,onKeyDown:W=>{if(C.answered)W.key==="Enter"&&(W.preventDefault(),P());else{const U=W.key.toLowerCase();if(U.length===1&&U>="a"&&U<="z"){W.preventDefault();const ee=E.findIndex((I,z)=>I===U&&!$.includes(`${z}`));ee!==-1&&H(U,ee)}else W.key==="Backspace"?(W.preventDefault(),J()):(W.key===" "||W.key==="Enter")&&(W.preventDefault(),ve())}},children:E.map((W,U)=>{const ee=$.includes(`${U}`),I=$.indexOf(`${U}`)+1;let z="";return C.answered&&ee&&(z=$.map(X=>E[parseInt(X)]).join("")===C.correctWord?"correct":"incorrect"),e.jsxs("button",{className:`letter-card ${ee?"selected":""} ${C.answered?"practice-mode":""} ${z}`,onClick:()=>H(W,U),children:[W,ee&&e.jsx("span",{className:"selection-number",children:I})]},U)})}),!C.answered&&e.jsxs("div",{className:"spelling-reset-button-container",children:[$.length>0&&e.jsx("button",{className:"btn-reset-selection",onClick:J,children:"âŒ« 1æ–‡å­—æˆ»ã™"}),e.jsx("button",{className:"btn-skip-word",onClick:ve,children:"â­ï¸ åˆ†ã‹ã‚‰ãªã„ (ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼)"})]}),C.answered&&e.jsxs("div",{className:"result-display",children:[e.jsxs("div",{className:"correct-answer",children:[B===C.correctWord?"âœ… æ­£è§£: ":B===""?"â­ï¸ ã‚¹ã‚­ãƒƒãƒ— - æ­£è§£: ":"âŒ ä¸æ­£è§£ - æ­£è§£: ",e.jsxs("strong",{className:qe()?"clickable-word":"",onClick:W=>{W.stopPropagation(),qe()&&F&&Ze(F.word,{rate:.85})},title:qe()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":void 0,children:[(F==null?void 0:F.word)||C.correctWord,qe()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"}),(F==null?void 0:F.reading)&&e.jsxs("span",{className:"pronunciation-hint",children:["(",F.reading,")"]})]})]}),e.jsxs("div",{className:"question-details-spelling",children:[F.reading&&e.jsxs("div",{className:"detail-row clickable-row",onClick:()=>qe()&&Ze(F.word,{rate:.85}),title:"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ ğŸ”Š",children:[e.jsx("span",{className:"detail-label",children:"èª­ã¿:"}),e.jsx("span",{className:"detail-content",children:F.reading})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"æ„å‘³:"}),e.jsx("span",{className:"detail-content",children:F.meaning})]}),F.etymology&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"ğŸ“š èªæºç­‰è§£èª¬:"}),e.jsx("span",{className:"detail-content",children:F.etymology})]}),F.relatedWords&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"ğŸ”— é–¢é€£èª:"}),e.jsx("span",{className:"detail-content",children:F.relatedWords})]}),F.relatedFields&&e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"ğŸ·ï¸ é–¢é€£åˆ†é‡:"}),e.jsx("span",{className:"detail-content",children:F.relatedFields})]}),F.difficulty&&e.jsxs("div",{className:"detail-row clickable-row",onClick:()=>qe()&&Ze(F.word,{rate:.85}),title:"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ ğŸ”Š",children:[e.jsx("span",{className:"detail-label",children:"é›£æ˜“åº¦:"}),e.jsx("div",{className:`difficulty-badge ${F.difficulty}`,children:F.difficulty==="beginner"?"åˆç´š":F.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})]})]})]})]})]}):e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"ğŸ“– æ¡ä»¶ã‚’é¸æŠã—ã¦ã€Œã‚¯ã‚¤ã‚ºé–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„"})})]})}function Qi(r){const t=r.split("/").pop()||"",n=t.replace(/\.txt$/,"").split("_");return n.length>=3?n.slice(2).join("_"):t}const Gi=[{id:"beginner-morning-routine",level:"beginner",topic:"daily-life",wordCount:50,filePath:"/data/passages-for-phrase-work/beginner_50_Morning-Routine.txt"},{id:"beginner-supermarket-shopping",level:"beginner",topic:"daily-life",wordCount:1910,filePath:"/data/passages-for-phrase-work/beginner_1910_Shopping-at-the-Supermarket.txt"},{id:"beginner-cafe-day",level:"beginner",topic:"food-culture",wordCount:1380,filePath:"/data/passages-for-phrase-work/beginner_1380_A-Day-at-the-Cafe.txt"},{id:"beginner-conversation-daily",level:"beginner",topic:"communication",wordCount:3018,filePath:"/data/passages-for-phrase-work/beginner_3018_Daily-Conversations.txt"},{id:"beginner-weather-seasons",level:"beginner",topic:"nature",wordCount:2111,filePath:"/data/passages-for-phrase-work/beginner_2111_Weather-and-Seasons.txt"},{id:"beginner-wildlife-park-guide",level:"beginner",topic:"animals",wordCount:2097,filePath:"/data/passages-for-phrase-work/beginner_2097_Wildlife-Park-Guide.txt"},{id:"intermediate-exchange-student-australia",level:"intermediate",topic:"culture-exchange",wordCount:3199,filePath:"/data/passages-for-phrase-work/intermediate_3199_Exchange-Student-in-Australia.txt"},{id:"intermediate-homestay-america",level:"intermediate",topic:"culture-exchange",wordCount:3148,filePath:"/data/passages-for-phrase-work/intermediate_3148_Homestay-in-America.txt"},{id:"intermediate-career-day",level:"intermediate",topic:"education-career",wordCount:2895,filePath:"/data/passages-for-phrase-work/intermediate_2895_Career-Day-at-School.txt"},{id:"intermediate-hospital-visit",level:"intermediate",topic:"health",wordCount:2721,filePath:"/data/passages-for-phrase-work/intermediate_2721_A-Visit-to-the-Hospital.txt"},{id:"intermediate-science-museum",level:"intermediate",topic:"science-education",wordCount:3265,filePath:"/data/passages-for-phrase-work/intermediate_3265_Science-Museum-Experience.txt"},{id:"intermediate-community-events",level:"intermediate",topic:"community",wordCount:2216,filePath:"/data/passages-for-phrase-work/intermediate_2216_Community-Events.txt"},{id:"intermediate-school-events-year",level:"intermediate",topic:"school-life",wordCount:2558,filePath:"/data/passages-for-phrase-work/intermediate_2558_A-Year-of-School-Events.txt"},{id:"intermediate-school-news",level:"intermediate",topic:"school-life",wordCount:1937,filePath:"/data/passages-for-phrase-work/intermediate_1937_School-News.txt"},{id:"advanced-environmental-issues",level:"advanced",topic:"environment",wordCount:4263,filePath:"/data/passages-for-phrase-work/advanced_4263_Environmental-Issues-and-Solutions.txt"},{id:"advanced-family-gathering",level:"advanced",topic:"culture-family",wordCount:4493,filePath:"/data/passages-for-phrase-work/advanced_4493_Family-Gathering-Traditions.txt"},{id:"advanced-health-statistics",level:"advanced",topic:"health-data",wordCount:3422,filePath:"/data/passages-for-phrase-work/advanced_3422_Health-Statistics-Analysis.txt"},{id:"advanced-historical-figures",level:"advanced",topic:"history",wordCount:3115,filePath:"/data/passages-for-phrase-work/advanced_3115_Historical-Figures-Study.txt"},{id:"advanced-international-exchange",level:"advanced",topic:"culture-global",wordCount:3813,filePath:"/data/passages-for-phrase-work/advanced_3813_Cultural-Exchange-Insights.txt"},{id:"advanced-school-festival",level:"advanced",topic:"school-events",wordCount:4419,filePath:"/data/passages-for-phrase-work/advanced_4419_School-Festival-Planning.txt"},{id:"advanced-summer-vacation-stories",level:"advanced",topic:"personal-growth",wordCount:3255,filePath:"/data/passages-for-phrase-work/advanced_3255_Summer-Vacation-Stories.txt"},{id:"advanced-technology-future",level:"advanced",topic:"technology-innovation",wordCount:3161,filePath:"/data/passages-for-phrase-work/advanced_3161_Technology-and-Future.txt"}],Os=Gi.map(r=>({...r,title:Qi(r.filePath),level:r.level}));function Lr(){return Os}async function Wr(r){try{const t=Os.find(l=>l.id===r);if(!t)return p.error(`Passage not found: ${r}`),"";const n=`/data/passages-original/${t.filePath.split("/").pop()||""}`,a=await fetch(n);return a.ok?await a.text():(p.log(`Original file not found: ${n}`),"")}catch(t){return p.error(`Error loading original passage ${r}:`,t),""}}async function Bi(r){const t=Os.find(s=>s.id===r);if(!t)return p.error(`Passage not found: ${r}`),null;try{const s=await fetch(t.filePath);if(!s.ok)throw new Error(`Failed to fetch: ${s.statusText}`);const n=await s.text(),a=Ui(n);return{...t,content:n,sections:a}}catch(s){return p.error(`Error loading passage ${r}:`,s),null}}function Ui(r){const t=r.split(`
`),s=[];let n=null;for(const a of t){const o=a.trim();o&&(!a.startsWith("    ")&&o.length>0&&o.length<80?(n&&s.push(n),n={title:o,paragraphs:[]}):a.startsWith("    ")&&n&&n.paragraphs.push(o))}return n&&s.push(n),s}function gt(r){const t=r.toLowerCase().trim();if(t.endsWith("ing")&&t.length>4){const s=t.slice(0,-3);return s.endsWith("n")||s.endsWith("m")||s.endsWith("t")?s.slice(0,-1):s+"e"}if(t.endsWith("ed")&&t.length>3){const s=t.slice(0,-2);return s.endsWith("i")?s.slice(0,-1)+"y":s}return t.endsWith("es")&&t.length>3?t.slice(0,-2):t.endsWith("s")&&t.length>2&&!t.endsWith("ss")?t.slice(0,-1):t}async function Or(r){try{let t=`/data/passages/passages-translations/${r}-ja.txt`;console.log(`[å…¨è¨³] Attempting to load: ${t} for passageId: ${r}`);let s=await fetch(t);if(s.ok||(t=`/data/passages-translations/${r}-ja.txt`,console.log(`[å…¨è¨³] Trying old path: ${t}`),s=await fetch(t)),!s.ok)return console.log(`[å…¨è¨³] File not found (${s.status}): ${t}`),"";const n=await s.text();return console.log(`[å…¨è¨³] Successfully loaded ${n.length} characters from ${t}`),n}catch(t){return console.error(`[å…¨è¨³] Error loading full translation for ${r}:`,t),""}}async function Hi(r){try{const t=Lr().find(i=>i.id===r);if(!t)return[];const n=`/data/passages-for-phrase-work-ja/${(t.filePath.split("/").pop()||"").replace(/\.txt$/,"-ja.txt")}`,a=await fetch(n);if(!a.ok)return p.log(`No Japanese phrase file found: ${n}`),[];const l=(await a.text()).split(`
`).map(i=>i.trim()).filter(i=>i.length>0);return p.log(`Loaded ${l.length} Japanese phrases from ${n}`),l}catch(t){return p.error(`Error loading Japanese phrases for ${r}:`,t),[]}}async function Vi(r,t){const s=await Bi(r);if(!s)return null;const[n,a,o]=await Promise.all([Hi(r),Or(r),Wr(r)]);let l=0;const i=[];return s.sections.forEach(d=>{d.paragraphs.forEach(m=>{if(m.match(/^([^:]+):\s*"([^"]+)"$/)){const g=m.trim(),S=g.split(/\s+/),b=S.map(v=>{let k=v,D="";if(k.startsWith('"')&&(D='"',k=k.substring(1)),/^(Ms|Mr|Mrs|Dr|Prof|St|Ave|Inc|Ltd|etc)\.$|^[A-Z]\.$|^vs\.$|^e\.g\.$|^i\.e\.$/.test(k)){const E=gt(k.replace(/\.$/,"")),$=t.get(E),G=($==null?void 0:$.meaning)||"",Y=[];return D&&Y.push({word:D,meaning:"",isUnknown:!1}),Y.push({word:k,meaning:G==="-"?"":G,isUnknown:!1}),Y}const w=k.match(/([.,!?;:â€”"])$/);if(w){const E=k.replace(/[.,!?;:â€”"]$/,""),$=w[1];if(!E){const Ne=[];return D&&Ne.push({word:D,meaning:"",isUnknown:!1}),Ne.push({word:$,meaning:"",isUnknown:!1}),Ne}const G=gt(E),Y=t.get(G),q=(Y==null?void 0:Y.meaning)||"",me=[];return D&&me.push({word:D,meaning:"",isUnknown:!1}),me.push({word:E,meaning:q==="-"?"":q,isUnknown:!1}),me.push({word:$,meaning:"",isUnknown:!1}),me}else{const E=gt(k),$=t.get(E),G=($==null?void 0:$.meaning)||"",Y=[];return D&&Y.push({word:D,meaning:"",isUnknown:!1}),Y.push({word:k,meaning:G==="-"?"":G,isUnknown:!1}),Y}}).flat(),y=n[l]||"";l++,i.push({english:g,japanese:y,phraseMeaning:y,words:S,segments:b})}else{const g=m.trim(),S=g.split(/\s+/),b=S.map(v=>{if(/^(Ms|Mr|Mrs|Dr|Prof|St|Ave|Inc|Ltd|etc)\.$|^[A-Z]\.$|^vs\.$|^e\.g\.$|^i\.e\.$/.test(v)){const C=gt(v.replace(/\.$/,"")),w=t.get(C),E=(w==null?void 0:w.meaning)||"";return{word:v,meaning:E==="-"?"":E,isUnknown:!1}}const D=v.match(/([.,!?;:â€”])$/);if(D){const C=v.replace(/[.,!?;:â€”]$/,""),w=D[1];if(!C)return{word:w,meaning:"",isUnknown:!1};const E=gt(C),$=t.get(E),G=($==null?void 0:$.meaning)||"";return[{word:C,meaning:G==="-"?"":G,isUnknown:!1},{word:w,meaning:"",isUnknown:!1}]}else{const C=gt(v),w=t.get(C),E=(w==null?void 0:w.meaning)||"";return{word:v,meaning:E==="-"?"":E,isUnknown:!1}}}).flat(),y=n[l]||"";l++,i.push({english:g,japanese:y,phraseMeaning:y,words:S,segments:b})}})}),{id:s.id,title:s.title,level:s.level,actualWordCount:s.wordCount,phrases:i,translation:a,originalText:o}}async function Ji(r){var t;try{const s=await fetch(`/data/passages-phrase-learning/${r}.json`);if(!s.ok)return p.log(`No phrase learning JSON found for ${r}, will use .txt conversion`),null;const n=await s.json();p.log(`Loaded phrase learning JSON for ${r}, phrases: ${((t=n.phrases)==null?void 0:t.length)||0}`);const[a,o]=await Promise.all([Or(r),Wr(r)]);return{...n,phrases:n.phrases||[],translation:a,originalText:o}}catch{return p.log(`Skipping phrase learning JSON for ${r} (file may be old or moved), will use .txt conversion`),null}}async function Yi(r){var n;const t=Lr(),s=[];p.log(`Loading ${t.length} passages...`);for(const a of t){let o=await Ji(a.id);o||(o=await Vi(a.id,r)),o?(p.log(`âœ“ Loaded passage: ${a.id} (${((n=o.phrases)==null?void 0:n.length)||0} phrases)`),s.push(o)):p.error(`âœ— Failed to load passage: ${a.id}`)}return p.log(`Total passages loaded: ${s.length}`),s}const Zs=new Set(["be","am","is","are","was","were","been","being","have","has","had","having","do","does","did","done","doing","can","could","will","would","shall","should","may","might","must","go","goes","went","gone","going","get","gets","got","gotten","getting","make","makes","made","making","take","takes","took","taken","taking","see","sees","saw","seen","seeing","come","comes","came","coming","want","wants","wanted","wanting","use","uses","used","using","find","finds","found","finding","give","gives","gave","given","giving","tell","tells","told","telling","work","works","worked","working","call","calls","called","calling","try","tries","tried","trying","ask","asks","asked","asking","need","needs","needed","needing","feel","feels","felt","feeling","become","becomes","became","becoming","leave","leaves","left","leaving","put","puts","putting","mean","means","meant","meaning","keep","keeps","kept","keeping","let","lets","letting","begin","begins","began","begun","beginning","seem","seems","seemed","seeming","help","helps","helped","helping","talk","talks","talked","talking","turn","turns","turned","turning","start","starts","started","starting","show","shows","showed","shown","showing","hear","hears","heard","hearing","play","plays","played","playing","run","runs","ran","running","move","moves","moved","moving","like","likes","liked","liking","live","lives","lived","living","believe","believes","believed","believing","bring","brings","brought","bringing","happen","happens","happened","happening","write","writes","wrote","written","writing","sit","sits","sat","sitting","stand","stands","stood","standing","lose","loses","lost","losing","pay","pays","paid","paying","meet","meets","met","meeting","include","includes","included","including","continue","continues","continued","continuing","set","sets","setting","learn","learns","learned","learning","change","changes","changed","changing","lead","leads","led","leading","understand","understands","understood","understanding","watch","watches","watched","watching","follow","follows","followed","following","stop","stops","stopped","stopping","create","creates","created","creating","speak","speaks","spoke","spoken","speaking","read","reads","reading","spend","spends","spent","spending","grow","grows","grew","grown","growing","open","opens","opened","opening","walk","walks","walked","walking","win","wins","won","winning","teach","teaches","taught","teaching","offer","offers","offered","offering","remember","remembers","remembered","remembering","consider","considers","considered","considering","appear","appears","appeared","appearing","buy","buys","bought","buying","serve","serves","served","serving","die","dies","died","dying","send","sends","sent","sending","build","builds","built","building","stay","stays","stayed","staying","fall","falls","fell","fallen","falling","cut","cuts","cutting","reach","reaches","reached","reaching","kill","kills","killed","killing","raise","raises","raised","raising","pass","passes","passed","passing","sell","sells","sold","selling","decide","decides","decided","deciding","return","returns","returned","returning","explain","explains","explained","explaining","hope","hopes","hoped","hoping","develop","develops","developed","developing","carry","carries","carried","carrying","break","breaks","broke","broken","breaking","receive","receives","received","receiving","agree","agrees","agreed","agreeing","support","supports","supported","supporting","hit","hits","hitting","produce","produces","produced","producing","eat","eats","ate","eaten","eating","cover","covers","covered","covering","catch","catches","caught","catching","draw","draws","drew","drawn","drawing","wake","wakes","woke","woken","waking","brush","brushes","brushed","brushing","wash","washes","washed","washing","prepare","prepares","prepared","preparing","check","checks","checked","checking"]),qr=new Set(["in","on","at","to","for","with","from","by","about","as","into","like","through","after","over","between","out","against","during","without","before","under","around","among","of","up"]),Xi=new Set(["and","but","or","so","yet","for","nor","because","although","if","when","while","since","unless","that","which","who","whom","whose","where"]),Ki=new Set(["the","a","an","this","that","these","those","my","your","his","her","its","our","their","some","any","no","every","each","either","neither","much","many","more","most","few","little","several"]),Zi=new Set(["i","you","he","she","it","we","they","me","him","her","us","them","myself","yourself","himself","herself","itself","ourselves","themselves"]),eo=new Set(["good","new","first","last","long","great","little","own","other","old","right","big","high","different","small","large","next","early","young","important","few","public","bad","same","able","ready","usual","toast","juice"]),to=new Set(["not","so","up","out","just","now","how","then","more","also","here","well","only","very","even","back","there","down","still","in","as","too","when","never","really","usually","finally","first","after","before"]);function so(r){return{S:"#3b82f6",V:"#ef4444",O:"#10b981",C:"#f59e0b",M:"#8b5cf6",Prep:"#6366f1",Conj:"#ec4899",Det:"#14b8a6",Adj:"#f97316",Adv:"#a855f7",Unknown:"#6b7280"}[r]}function ro(r){return{S:"ä¸»èª",V:"å‹•è©",O:"ç›®çš„èª",C:"è£œèª",M:"ä¿®é£¾èª",Prep:"å‰ç½®è©",Conj:"æ¥ç¶šè©",Det:"å† è©ãƒ»é™å®šè©",Adj:"å½¢å®¹è©",Adv:"å‰¯è©",Unknown:"ä¸æ˜"}[r]}function no(r,t,s){var a;const n=r.toLowerCase();return/^[.,!?;:]$/.test(r)?"Unknown":Zs.has(n)?"V":qr.has(n)?"Prep":Xi.has(n)?"Conj":Ki.has(n)?"Det":eo.has(n)?"Adj":to.has(n)?"Adv":Zi.has(n)?t===0||t>0&&Zs.has((a=s[t+1])==null?void 0:a.toLowerCase())?"S":"O":"Unknown"}function ao(r){return{".":"æ–‡ã®çµ‚ã‚ã‚Š",",":"åŒºåˆ‡ã‚Šãƒ»åˆ—æŒ™","!":"æ„Ÿå˜†ãƒ»å¼·èª¿","?":"ç–‘å•",";":"é–¢é€£ã™ã‚‹æ–‡ã®åŒºåˆ‡ã‚Š",":":"èª¬æ˜ãƒ»ä¾‹ç¤ºã®å°å…¥","-":"è£œè¶³èª¬æ˜ãƒ»è¨€ã„æ›ãˆ","â€”":"å¼·ã„åŒºåˆ‡ã‚Šãƒ»æŒ¿å…¥","â€“":"ç¯„å›²ãƒ»é–¢ä¿‚",'"':"å¼•ç”¨","'":"å¼•ç”¨ãƒ»æ‰€æœ‰æ ¼","(":"è£œè¶³æƒ…å ±ã®é–‹å§‹",")":"è£œè¶³æƒ…å ±ã®çµ‚äº†"}[r]||"å¥èª­ç‚¹"}function At(r){const t=r.match(/\b[\w']+\b|[.,!?;:\-â€”â€“"'()]/g)||[],s=[];let n=!1,a=!1;for(let o=0;o<t.length;o++){const l=t[o];if(/^[.,!?;:\-â€”â€“"'()]$/.test(l)){s.push({word:l,tag:"Unknown",color:"#6b7280",description:ao(l)});continue}let i=no(l,o,t);i==="Unknown"&&(o===0&&/^[A-Z]/.test(l)&&!a?(i="S",a=!0):n&&!a?i="O":(o>0&&qr.has(t[o-1].toLowerCase()),i="M")),i==="V"&&(n=!0),i==="S"&&(a=!0),s.push({word:l,tag:i,color:so(i),description:ro(i)})}return s}const io=[{words:["wake","up"],meaning:"èµ·ãã‚‹",type:"phrasal-verb"},{words:["get","up"],meaning:"èµ·åºŠã™ã‚‹",type:"phrasal-verb"},{words:["wake","up"],meaning:"ç›®ã‚’è¦šã¾ã™",type:"phrasal-verb"},{words:["brush","my","teeth"],meaning:"æ­¯ã‚’ç£¨ã",type:"phrasal-verb"},{words:["wash","my","face"],meaning:"é¡”ã‚’æ´—ã†",type:"phrasal-verb"},{words:["have","breakfast"],meaning:"æœé£Ÿã‚’é£Ÿã¹ã‚‹",type:"phrasal-verb"},{words:["go","to","school"],meaning:"å­¦æ ¡ã«è¡Œã",type:"phrasal-verb"},{words:["come","back"],meaning:"å¸°ã£ã¦ãã‚‹",type:"phrasal-verb"},{words:["come","home"],meaning:"å¸°å®…ã™ã‚‹",type:"phrasal-verb"},{words:["do","homework"],meaning:"å®¿é¡Œã‚’ã™ã‚‹",type:"phrasal-verb"},{words:["go","to","bed"],meaning:"å¯ã‚‹",type:"phrasal-verb"},{words:["at","seven"],meaning:"7æ™‚ã«",type:"time-expression"},{words:["in","the","morning"],meaning:"æœã«",type:"time-expression"},{words:["in","the","afternoon"],meaning:"åˆå¾Œã«",type:"time-expression"},{words:["in","the","evening"],meaning:"å¤•æ–¹ã«",type:"time-expression"},{words:["at","night"],meaning:"å¤œã«",type:"time-expression"},{words:["every","morning"],meaning:"æ¯æœ",type:"determiner-noun"},{words:["every","day"],meaning:"æ¯æ—¥",type:"determiner-noun"},{words:["every","night"],meaning:"æ¯æ™©",type:"determiner-noun"},{words:["every","week"],meaning:"æ¯é€±",type:"determiner-noun"}];function oo(r){const t=[],s=r.map(n=>n.toLowerCase());for(const n of io){const a=n.words.map(o=>o.toLowerCase());for(let o=0;o<=s.length-a.length;o++){let l=!0;for(let i=0;i<a.length;i++)if(s[o+i]!==a[i]){l=!1;break}l&&t.push({...n,words:r.slice(o,o+a.length)})}}return t}const lo=[{name:"too ~ to ...",meaning:"ã€œã™ãã¦...ã§ããªã„",pattern:/\btoo\s+\w+\s+to\s+\w+/i,explanation:"ã€Œtoo + å½¢å®¹è©/å‰¯è© + to + å‹•è©ã€ã®å½¢ã§ã€ã€Œã€œã™ãã¦...ã§ããªã„ã€ã¨ã„ã†æ„å‘³"},{name:"so ~ that ...",meaning:"ã¨ã¦ã‚‚ã€œãªã®ã§...",pattern:/\bso\s+\w+\s+that\b/i,explanation:"ã€Œso + å½¢å®¹è©/å‰¯è© + that ~ã€ã®å½¢ã§ã€ã€Œã¨ã¦ã‚‚ã€œãªã®ã§...ã€ã¨ã„ã†æ„å‘³"},{name:"so that ...",meaning:"ã€œã™ã‚‹ãŸã‚ã«",pattern:/\bso\s+that\b/i,explanation:"ã€Œso that ~ã€ã®å½¢ã§ã€ã€Œã€œã™ã‚‹ãŸã‚ã«ã€ã¨ã„ã†ç›®çš„ã‚’è¡¨ã™"},{name:"It is ~ for ... to",meaning:"...ãŒã€œã™ã‚‹ã®ã¯",pattern:/\bit\s+is\s+\w+\s+for\s+\w+\s+to\b/i,explanation:"ã€ŒIt is + å½¢å®¹è© + for + äºº + to + å‹•è©ã€ã®å½¢ã§ã€ã€Œ(äºº)ãŒã€œã™ã‚‹ã®ã¯...ã ã€ã¨ã„ã†æ„å‘³"},{name:"It is ~ to ...",meaning:"ã€œã™ã‚‹ã“ã¨ã¯...ã ",pattern:/\bit\s+is\s+\w+\s+to\s+\w+/i,explanation:"ã€ŒIt is + å½¢å®¹è© + to + å‹•è©ã€ã®å½¢ã§ã€ã€Œã€œã™ã‚‹ã“ã¨ã¯...ã ã€ã¨ã„ã†æ„å‘³"},{name:"It is ~ that ...",meaning:"...ãªã®ã¯ã€œã  (å¼·èª¿)",pattern:/\bit\s+is\s+\w+\s+that\b/i,explanation:"å¼·èª¿æ§‹æ–‡ã€‚ã€ŒIt is ~ that ...ã€ã®å½¢ã§ã€ç‰¹å®šã®éƒ¨åˆ†ã‚’å¼·èª¿ã™ã‚‹"},{name:"not only ~ but also ...",meaning:"ã€œã ã‘ã§ãªã...ã‚‚",pattern:/\bnot\s+only\s+.+\s+but\s+also\b/i,explanation:"ã€Œnot only A but also Bã€ã®å½¢ã§ã€ã€ŒAã ã‘ã§ãªãBã‚‚ã€ã¨ã„ã†æ„å‘³"},{name:"either ~ or ...",meaning:"ã€œã‹...ã‹ã©ã¡ã‚‰ã‹",pattern:/\beither\s+.+\s+or\b/i,explanation:"ã€Œeither A or Bã€ã®å½¢ã§ã€ã€ŒAã‹Bã‹ã©ã¡ã‚‰ã‹ã€ã¨ã„ã†é¸æŠã‚’è¡¨ã™"},{name:"neither ~ nor ...",meaning:"ã€œã‚‚...ã‚‚ãªã„",pattern:/\bneither\s+.+\s+nor\b/i,explanation:"ã€Œneither A nor Bã€ã®å½¢ã§ã€ã€ŒAã‚‚Bã‚‚ãªã„ã€ã¨ã„ã†å¦å®šã‚’è¡¨ã™"},{name:"both ~ and ...",meaning:"ã€œã‚‚...ã‚‚ä¸¡æ–¹",pattern:/\bboth\s+.+\s+and\b/i,explanation:"ã€Œboth A and Bã€ã®å½¢ã§ã€ã€ŒAã‚‚Bã‚‚ä¸¡æ–¹ã€ã¨ã„ã†æ„å‘³"},{name:"as ~ as ...",meaning:"...ã¨åŒã˜ãã‚‰ã„ã€œ",pattern:/\bas\s+\w+\s+as\b/i,explanation:"ã€Œas + å½¢å®¹è©/å‰¯è© + as ...ã€ã®å½¢ã§ã€ã€Œ...ã¨åŒã˜ãã‚‰ã„ã€œã€ã¨ã„ã†åŒç­‰æ¯”è¼ƒ"},{name:"not as ~ as ...",meaning:"...ã»ã©ã€œãªã„",pattern:/\bnot\s+as\s+\w+\s+as\b/i,explanation:"ã€Œnot as + å½¢å®¹è©/å‰¯è© + as ...ã€ã®å½¢ã§ã€ã€Œ...ã»ã©ã€œãªã„ã€ã¨ã„ã†æ„å‘³"},{name:"one of the ~est",meaning:"æœ€ã‚‚ã€œãªã‚‚ã®ã®1ã¤",pattern:/\bone\s+of\s+the\s+\w+est\b/i,explanation:"ã€Œone of the + æœ€ä¸Šç´š + è¤‡æ•°åè©ã€ã®å½¢ã§ã€ã€Œæœ€ã‚‚ã€œãªã‚‚ã®ã®1ã¤ã€ã¨ã„ã†æ„å‘³"},{name:"make/let/have + äºº + å‹•è©",meaning:"äººã«ã€œã•ã›ã‚‹",pattern:/\b(make|let|have|help)\s+\w+\s+\w+/i,explanation:"ä½¿å½¹å‹•è©ã®æ§‹æ–‡ã€‚ã€Œmake/let/have + äºº + å‹•è©ã®åŸå½¢ã€ã§ã€Œäººã«ã€œã•ã›ã‚‹ã€"},{name:"be used to ~ing",meaning:"ã€œã™ã‚‹ã“ã¨ã«æ…£ã‚Œã¦ã„ã‚‹",pattern:/\b(am|is|are|was|were)\s+used\s+to\s+\w+ing\b/i,explanation:"ã€Œbe used to + å‹•åè©ã€ã®å½¢ã§ã€ã€Œã€œã™ã‚‹ã“ã¨ã«æ…£ã‚Œã¦ã„ã‚‹ã€ã¨ã„ã†æ„å‘³"},{name:"used to + å‹•è©",meaning:"æ˜”ã¯ã€œã—ãŸã‚‚ã®ã ",pattern:/\bused\s+to\s+\w+/i,explanation:"ã€Œused to + å‹•è©ã®åŸå½¢ã€ã®å½¢ã§ã€ã€Œæ˜”ã¯ã€œã—ãŸã‚‚ã®ã ã€ã¨ã„ã†éå»ã®ç¿’æ…£ã‚’è¡¨ã™"}];function co(r){const t=[];for(const s of lo)s.pattern.test(r)&&t.push(s);return t}function er(r){return{beginner:"åˆç´š",intermediate:"ä¸­ç´š",advanced:"ä¸Šç´š",Advanced:"ä¸Šç´š",åˆç´š:"åˆç´š",ä¸­ç´š:"ä¸­ç´š",ä¸Šç´š:"ä¸Šç´š"}[r]||r}function zr({onSaveUnknownWords:r,customQuestionSets:t=[],onAddWordToCustomSet:s,onRemoveWordFromCustomSet:n,onOpenCustomSetManagement:a}){var Le;const[o,l]=u.useState([]),[i,c]=u.useState(null),[d,m]=u.useState([]),[h,g]=u.useState([]),[S,b]=u.useState("all"),[y,v]=u.useState(null),[k,D]=u.useState(new Map),[C,w]=u.useState(new Map),[E,$]=u.useState(null),[G,Y]=u.useState(!1),[q,me]=u.useState(!0),[Ne,be]=u.useState("reading"),[Re,A]=u.useState(0),[Q,O]=u.useState(!1),[ae,Z]=u.useState(!1),[te,Ie]=u.useState(null),[ye,we]=u.useState(null),[Se,Ge]=u.useState(!1),[Ce,We]=u.useState(!1),[_e,Fe]=u.useState(!0);u.useEffect(()=>{if(o.length>0){const j="reading-unknown-words-state";try{const x=o.map(f=>({id:f.id,unknownWords:f.phrases.flatMap((N,T)=>N.segments.map((H,V)=>H.isUnknown?`${T}-${V}`:null).filter(Boolean))}));localStorage.setItem(j,JSON.stringify(x))}catch(x){p.warn("åˆ†ã‹ã‚‰ãªã„å˜èªã®çŠ¶æ…‹ä¿å­˜ã«å¤±æ•—:",x)}}},[o]),u.useEffect(()=>{p.log("[é•·æ–‡] è¾æ›¸ã®èª­ã¿è¾¼ã¿ã‚’é–‹å§‹..."),fetch("/data/vocabulary/high-school-entrance-words.csv").then(j=>{if(!j.ok)throw new Error(`CSVèª­ã¿è¾¼ã¿å¤±æ•—: ${j.status}`);return j.text()}).then(j=>{const x=j.split(`
`),f=new Map;x.slice(1).forEach(N=>{if(!N.trim())return;const T=N.split(",").map(H=>H.trim());if(T.length>=7){const H=T[0].toLowerCase().trim();f.set(H,{word:T[0],reading:T[1],meaning:T[2],etymology:T[3],relatedWords:T[4],relatedFields:T[5],difficulty:T[6]})}}),p.log(`[é•·æ–‡] ãƒ¡ã‚¤ãƒ³è¾æ›¸: ${f.size}å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`),D(f)}).catch(j=>{}),fetch("/data/dictionaries/reading-passages-dictionary.json").then(j=>{if(!j.ok)throw new Error(`JSONèª­ã¿è¾¼ã¿å¤±æ•—: ${j.status}`);return j.json()}).then(j=>{const x=new Map;Object.entries(j).forEach(([f,N])=>{x.set(f.toLowerCase(),N)}),w(x),p.log(`[é•·æ–‡] é•·æ–‡èª­è§£è¾æ›¸: ${x.size}å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`)}).catch(j=>{p.error("[é•·æ–‡] Error loading reading dictionary:",j)})},[]);const Ee=u.useCallback(j=>{const x=j.toLowerCase().replace(/[.,!?;:"']/g,"").trim();if(k.has(x)||C.has(x))return x;if(x.endsWith("es")){const f=x.slice(0,-2);if(k.has(f)||C.has(f))return f}if(x.endsWith("s")){const f=x.slice(0,-1);if(k.has(f)||C.has(f))return f}if(x.endsWith("ed")){const f=x.slice(0,-2);if(k.has(f)||C.has(f))return f;if(k.has(f+"e")||C.has(f+"e"))return f+"e";if(f.length>2&&f[f.length-1]===f[f.length-2]){const N=f.slice(0,-1);if(k.has(N)||C.has(N))return N}}if(x.endsWith("ing")){const f=x.slice(0,-3);if(k.has(f)||C.has(f))return f;if(k.has(f+"e")||C.has(f+"e"))return f+"e";if(f.length>2&&f[f.length-1]===f[f.length-2]){const N=f.slice(0,-1);if(k.has(N)||C.has(N))return N}}if(x.endsWith("ly")){const f=x.slice(0,-2);if(k.has(f)||C.has(f))return f}if(x.endsWith("er")){const f=x.slice(0,-2);if(k.has(f)||C.has(f))return f}if(x.endsWith("est")){const f=x.slice(0,-3);if(k.has(f)||C.has(f))return f}return x},[k,C]),Pe=u.useCallback((j,x)=>{if(x&&typeof x=="string"&&x.trim()&&x!=="-")return x;if(x&&typeof x=="object"&&"meaning"in x&&typeof x.meaning=="string")return x.meaning;const f=j.toLowerCase();if(f==="who")return"(é–¢ä¿‚ä»£åè©)ãã®äººã¯";if(f==="whom")return"(é–¢ä¿‚ä»£åè©)ãã®äººã‚’";if(f==="which")return"(é–¢ä¿‚ä»£åè©)ãã®ç‰©ç­‰ã¯ãƒ»ã‚’";if(f==="that")return"(é–¢ä¿‚ä»£åè©)ãã®äººãƒ»ç‰©ç­‰ã¯ãƒ»ã‚’";const N=Ee(j),T=k.get(N),H=C.get(N);return(T==null?void 0:T.meaning)||(H==null?void 0:H.meaning)||""},[Ee,k,C]);u.useEffect(()=>{const j=setInterval(()=>{Q&&!bi()&&!ji()&&(O(!1),Z(!1))},500);return()=>clearInterval(j)},[Q]),u.useEffect(()=>{if(k.size===0){p.log("[é•·æ–‡] è¾æ›¸ã®èª­ã¿è¾¼ã¿ã‚’å¾…æ©Ÿä¸­...");return}p.log(`[é•·æ–‡] ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã‚’é–‹å§‹... (è¾æ›¸: ${k.size}å˜èª)`);try{localStorage.removeItem("reading-passages-data")}catch{}const j="reading-unknown-words-state";let x=[];try{const f=localStorage.getItem(j);f&&(x=JSON.parse(f))}catch(f){p.warn("[é•·æ–‡] ä¿å­˜æ¸ˆã¿é€²æ—ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",f)}Fe(!0),Yi(k).then(f=>{var N,T;if(f&&f.length>0){p.log(`[é•·æ–‡] ${f.length}ä»¶ã®ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);const H=f.map(P=>{const ve=x.find(_=>_.id===P.id);return ve!=null&&ve.unknownWords&&ve.unknownWords.length>0?{...P,phrases:P.phrases.map((_,J)=>({..._,segments:_.segments.map((R,F)=>{var B;return{...R,isUnknown:((B=ve.unknownWords)==null?void 0:B.includes(`${J}-${F}`))??!1}})}))}:P}),V={åˆç´š:1,beginner:1,ä¸­ç´š:2,intermediate:2,ä¸Šç´š:3,advanced:3,Advanced:3},L=H.sort((P,ve)=>{const _=V[P.level||""]||999,J=V[ve.level||""]||999;if(_!==J)return _-J;const R=P.actualWordCount||0,F=ve.actualWordCount||0;return R-F});l(L),p.log(`[é•·æ–‡] ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨­å®šå®Œäº†: ${L.length}ä»¶`),L.length>0&&(c(L[0].id),m(new Array(((N=L[0].phrases)==null?void 0:N.length)||0).fill(!1)),g(new Array(((T=L[0].phrases)==null?void 0:T.length)||0).fill(!1)),p.log(`[é•·æ–‡] åˆæœŸãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã‚’é¸æŠ: ${L[0].id}`)),Fe(!1)}else p.error("[é•·æ–‡] loadAllPassagesAsReadingFormatãŒç©ºã®é…åˆ—ã‚’è¿”ã—ã¾ã—ãŸ"),v("ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ã™ï¼‰"),Fe(!1)}).catch(f=>{p.error("[é•·æ–‡] Error loading passages:",f),v("ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: "+f.message),Fe(!1)})},[k]);const le=u.useMemo(()=>o.find(j=>j.id===i),[o,i]),$e=u.useMemo(()=>{const j=S==="all"?o:o.filter(f=>f.level===S),x={åˆç´š:1,beginner:1,ä¸­ç´š:2,intermediate:2,ä¸Šç´š:3,advanced:3,Advanced:3};return j.sort((f,N)=>{const T=x[f.level||""]||999,H=x[N.level||""]||999;if(T!==H)return T-H;const V=f.actualWordCount||0,L=N.actualWordCount||0;return V-L})},[o,S]),Be=u.useCallback(j=>{var f,N;c(j);const x=o.find(T=>T.id===j);x&&(m(new Array(((f=x.phrases)==null?void 0:f.length)||0).fill(!1)),g(new Array(((N=x.phrases)==null?void 0:N.length)||0).fill(!1)),A(0))},[o]);u.useCallback((j,x)=>{if(x.preventDefault(),x.stopPropagation(),!le||!qe())return;const N=le.phrases[j].segments.filter(H=>H.word&&H.word.trim()!=="").map(H=>H.word).join(" ");Ze(N,{rate:.85});const T=x.currentTarget;T.classList.add("speaking"),setTimeout(()=>{T.classList.remove("speaking")},600)},[le]);const He=(j,x)=>{if(x.preventDefault(),x.stopPropagation(),E&&E.word===j){$(null);return}const f=j.toLowerCase().replace(/[.,!?;:"']/g,"").trim(),T=(V=>{if(k.has(V))return V;if(V.endsWith("es")&&k.has(V.slice(0,-2)))return V.slice(0,-2);if(V.endsWith("s")&&k.has(V.slice(0,-1)))return V.slice(0,-1);if(V.endsWith("ed")){const L=V.slice(0,-2);if(k.has(L))return L;if(k.has(L+"e"))return L+"e";if(L.length>2&&L[L.length-1]===L[L.length-2]){const P=L.slice(0,-1);if(k.has(P))return P}}if(V.endsWith("ing")){const L=V.slice(0,-3);if(k.has(L))return L;if(k.has(L+"e"))return L+"e";if(L.length>2&&L[L.length-1]===L[L.length-2]){const P=L.slice(0,-1);if(k.has(P))return P}}return V.endsWith("ly")&&k.has(V.slice(0,-2))||V.endsWith("er")&&k.has(V.slice(0,-2))?V.slice(0,-2):V.endsWith("est")&&k.has(V.slice(0,-3))?V.slice(0,-3):null})(f),H=T?k.get(T):null;if(H){const V=x.currentTarget.getBoundingClientRect();$({word:H.word,meaning:H.meaning,reading:H.reading,etymology:H.etymology,relatedWords:H.relatedWords,x:V.left+window.scrollX,y:V.bottom+window.scrollY+5})}else{const V=C.get(T||f);if(V){const L=x.currentTarget.getBoundingClientRect();$({word:V.word,meaning:V.meaning,reading:V.reading||"",etymology:V.etymology||"",relatedWords:V.relatedWords||"",x:L.left+window.scrollX,y:L.bottom+window.scrollY+5})}else p.warn(`Word not found in dictionary: ${f}`)}},je=()=>{if(!le)return;const j=[];if(le.phrases.forEach(x=>{x.segments.forEach(f=>{f.isUnknown&&f.word.trim()!==""&&(j.some(N=>N.word.toLowerCase()===f.word.toLowerCase())||j.push({word:f.word,meaning:f.meaning,reading:f.reading||"",etymology:f.etymology||"",relatedWords:f.relatedWords||"",relatedFields:f.relatedFields||"",difficulty:f.difficulty||"intermediate"}))})}),j.length===0){alert(`åˆ†ã‹ã‚‰ãªã„å˜èªãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
å˜èªã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãƒãƒ¼ã‚¯ã—ã¦ãã ã•ã„ã€‚`);return}r&&r(j),l(x=>x.map(f=>f.id===le.id?{...f,phrases:f.phrases.map(N=>({...N,segments:N.segments.map(T=>({...T,isUnknown:!1}))}))}:f)),alert(`${j.length}å€‹ã®å˜èªã‚’ã€Œ${le.title}ã€ã‹ã‚‰ä¿å­˜ã—ã¾ã—ãŸï¼`)},ze=()=>{le&&(l(j=>j.map(x=>x.id===le.id?{...x,phrases:x.phrases.map(f=>({...f,segments:f.segments.map(N=>({...N,isUnknown:!1}))}))}:x)),m(new Array(le.phrases.length).fill(!1)),g(new Array(le.phrases.length).fill(!1)))};if(y)return e.jsx("div",{className:"error-message",children:y});if(_e)return e.jsx("div",{className:"empty-container",children:"èª­ã¿è¾¼ã¿ä¸­..."});if(o.length===0)return e.jsx("div",{className:"empty-container",children:"ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"});if($e.length===0)return e.jsxs("div",{className:"comprehensive-reading-view",children:[e.jsx("div",{className:"reading-header",children:e.jsxs("div",{className:"filter-controls",children:[e.jsx("label",{htmlFor:"difficulty-filter",children:"é›£æ˜“åº¦: "}),e.jsxs("select",{id:"difficulty-filter",value:S,onChange:j=>b(j.target.value),title:"é›£æ˜“åº¦ã‚’é¸æŠ",children:[e.jsx("option",{value:"all",children:"å…¨ã¦"}),e.jsx("option",{value:"åˆç´š",children:"åˆç´š"}),e.jsx("option",{value:"ä¸­ç´š",children:"ä¸­ç´š"}),e.jsx("option",{value:"ä¸Šç´š",children:"ä¸Šç´š"})]})]})}),e.jsx("div",{className:"empty-container",children:"é¸æŠã—ãŸé›£æ˜“åº¦ã®ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚åˆ¥ã®é›£æ˜“åº¦ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"})]});const Ue=((Le=le==null?void 0:le.phrases)==null?void 0:Le.reduce((j,x)=>j+x.segments.filter(f=>f.isUnknown).length,0))||0;return e.jsxs("div",{className:"comprehensive-reading-view",children:[!q&&G&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>Y(!1),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 text-sm shadow-sm:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-filter",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-filter",value:S,onChange:j=>b(j.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦"}),e.jsx("option",{value:"åˆç´š",children:"åˆç´š"}),e.jsx("option",{value:"ä¸­ç´š",children:"ä¸­ç´š"}),e.jsx("option",{value:"ä¸Šç´š",children:"ä¸Šç´š"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"passage-select",children:"ğŸ“– ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸:"}),e.jsx("select",{id:"passage-select",value:i||"",onChange:j=>Be(j.target.value),className:"select-input",children:$e.map(j=>e.jsxs("option",{value:j.id,children:[er(j.level||"beginner"),"_",j.actualWordCount,"èª_",j.title]},j.id))})]})]}),q&&e.jsxs("div",{className:"reading-sub-tabs grid grid-cols-6 gap-1 sm:gap-2",children:[e.jsx("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${Ne==="reading"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>be("reading"),children:"ğŸ“– èª­è§£"}),e.jsx("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${Ne==="fullText"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>be("fullText"),children:"ğŸ“„ å…¨æ–‡"}),e.jsx("button",{className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${Ne==="fullTranslation"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,onClick:()=>be("fullTranslation"),children:"ğŸ“ å…¨è¨³"}),e.jsxs("button",{onClick:je,className:"px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium bg-success text-white rounded-t-lg border-b-2 border-success transition-all duration-200 hover:bg-success-hover disabled:opacity-50 disabled:cursor-not-allowed:bg-success-hover",disabled:Ue===0,title:"æœªçŸ¥èªã‚’ä¿å­˜",children:["ğŸ’¾ ä¿å­˜ (",Ue,")"]}),e.jsx("button",{onClick:ze,className:"px-4 py-2 text-sm font-medium bg-warning text-warning-dark border-2 border-warning rounded-lg transition-all duration-200 hover:bg-warning-hover hover:shadow-md:bg-warning-hover",title:"ãƒªã‚»ãƒƒãƒˆ",children:"ğŸ”„ ãƒªã‚»ãƒƒãƒˆ"}),e.jsx("button",{className:"px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 border-2 border-transparent rounded-lg transition-all duration-200 hover:bg-gray-300:bg-gray-600",onClick:()=>Y(!G),title:"å­¦ç¿’è¨­å®šã‚’é–‹ã",children:"âš™ï¸ å­¦ç¿’è¨­å®š"})]}),q&&G&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>Y(!1),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 text-sm shadow-sm:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"difficulty-filter-reading",children:"â­ é›£æ˜“åº¦:"}),e.jsxs("select",{id:"difficulty-filter-reading",value:S,onChange:j=>b(j.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦"}),e.jsx("option",{value:"åˆç´š",children:"åˆç´š"}),e.jsx("option",{value:"ä¸­ç´š",children:"ä¸­ç´š"}),e.jsx("option",{value:"ä¸Šç´š",children:"ä¸Šç´š"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"passage-select-reading",children:"ğŸ“– ãƒ‘ãƒƒã‚»ãƒ¼ã‚¸:"}),e.jsx("select",{id:"passage-select-reading",value:i||"",onChange:j=>Be(j.target.value),className:"select-input",children:$e.map(j=>e.jsxs("option",{value:j.id,children:[er(j.level||"beginner"),"_",j.actualWordCount,"èª_",j.title]},j.id))})]})]}),E&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"word-popup-overlay",onClick:()=>$(null)}),e.jsxs("div",{className:"word-popup","data-popup-x":E.x,"data-popup-y":E.y,children:[e.jsx("button",{className:"popup-close",onClick:()=>$(null),title:"é–‰ã˜ã‚‹",children:"âœ•"}),e.jsx("div",{className:"popup-word",children:E.word}),E.reading&&e.jsx("div",{className:"popup-reading",children:E.reading}),e.jsx("div",{className:"popup-meaning",children:E.meaning}),E.etymology&&e.jsxs("div",{className:"popup-etymology",children:[e.jsx("strong",{children:"èªæº:"})," ",E.etymology]}),E.relatedWords&&e.jsxs("div",{className:"popup-related",children:[e.jsx("strong",{children:"é–¢é€£èª:"})," ",E.relatedWords]})]})]}),q&&le&&le.phrases&&le.phrases.length>0&&e.jsxs("div",{className:"passage-content",children:[e.jsx("h3",{className:"passage-title",children:le.title}),Ne==="reading"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"reading-full-text-area",children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"ğŸ“– å…¨æ–‡"}),e.jsx("div",{className:"full-text-content",children:(()=>{if(le.originalText){const x=le.originalText.split(/([.!?])\s+/).filter(N=>N.trim()),f=[];for(let N=0;N<x.length;N+=2){const T=x[N],H=x[N+1]||"";f.push((T+H).trim())}return e.jsx("div",{className:"sentences-container",children:f.map((N,T)=>e.jsxs("span",{className:`sentence-clickable ${te===T?"selected-reading":""}`,onClick:()=>{Ie(T);const H=At(N);we({text:N,grammarAnalysis:H,showMeanings:!1})},children:[N," "]},T))})}if(le.title.toLowerCase().includes("conversation")){const x=[];return le.phrases.forEach(f=>{let N=f.segments.map(T=>T.word).join(" ").trim();!N||N==="-"||(N=N.replace(/\s+([.,!?;:"])/g,"$1"),x.push(N))}),e.jsx("div",{className:"sentences-container",children:x.map((f,N)=>e.jsxs("span",{className:`sentence-clickable ${te===N?"selected-reading":""}`,onClick:()=>{Ie(N);const T=At(f);we({text:f,grammarAnalysis:T,showMeanings:!1})},children:[f," "]},N))})}else{let x="",f=!0;le.phrases.forEach(H=>{H.segments.forEach(V=>{let L=V.word.trim();L&&L!=="-"&&(/^[.,!?;:]$/.test(L)?(x+=L,f=/^[.!?]$/.test(L)):(L==='"'||L==="'"||(f&&L.length>0&&(L=L.charAt(0).toUpperCase()+L.slice(1),f=!1),x.length>0&&!x.endsWith(" ")&&!x.endsWith('"')&&!x.endsWith("'")&&(x+=" ")),x+=L))})}),x=x.replace(/\s+"/g,'"').replace(/\s+'/g,"'");const N=x.split(/([.!?])\s+/).filter(H=>H.trim()),T=[];for(let H=0;H<N.length;H+=2){const V=N[H],L=N[H+1]||"";T.push((V+L).trim())}return e.jsx("div",{className:"sentences-container",children:T.map((H,V)=>e.jsxs("span",{className:`sentence-clickable ${te===V?"selected-reading":""}`,onClick:()=>{Ie(V);const L=At(H);we({text:H,grammarAnalysis:L,showMeanings:!1})},children:[H," "]},V))})}})()})]}),te!==null&&ye&&e.jsxs("div",{className:"selected-sentence-analysis mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"m-0 text-lg font-semibold",children:"ğŸ“ é¸æŠã—ãŸæ–‡ã®èª­è§£"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 text-sm bg-primary text-white rounded hover:bg-primary-hover",onClick:()=>Ze(ye.text),title:"ã“ã®æ–‡ã‚’ç™ºéŸ³",children:"ğŸ”Š ç™ºéŸ³"}),e.jsx("button",{className:"px-3 py-1 text-sm bg-info text-white rounded hover:bg-info-hover",onClick:()=>we({...ye,showMeanings:!ye.showMeanings}),children:ye.showMeanings?"æ„å‘³ã‚’éš ã™":"æ„å‘³ã‚’è¡¨ç¤º"})]})]}),e.jsx("div",{className:"selected-sentence-text mb-4",children:ye.text}),e.jsxs("div",{className:"grammar-structure mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h5",{className:"text-sm font-semibold m-0",children:"ğŸ”¤ æ–‡æ³•æ§‹é€ :"}),e.jsx("button",{className:"px-2 py-1 text-xs bg-gray-200 rounded hover:bg-gray-300:bg-gray-600",onClick:()=>Ge(!Se),children:Se?"å‡¡ä¾‹ã‚’éš ã™":"å‡¡ä¾‹ã‚’è¡¨ç¤º"})]}),Se&&e.jsxs("div",{className:"grammar-legend mb-3 p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:justify-between sm:items-center mb-2",children:[e.jsx("h6",{className:"text-xs font-semibold m-0",children:"ğŸ“– æ–‡æ³•ã‚¿ã‚°ä¸€è¦§"}),e.jsx("button",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200:bg-blue-800",onClick:()=>We(!Ce),children:Ce?"ç°¡æ˜“è¡¨ç¤º":"ğŸ“š ã•ã‚‰ã«è©³ã—ã"})]}),Ce?e.jsxs("div",{className:"detailed-grammar-explanation text-xs space-y-3 break-words",children:[e.jsxs("div",{className:"explanation-section",children:[e.jsx("h6",{className:"font-semibold text-sm mb-2",children:"ğŸ¯ æ–‡ã®éª¨æ ¼ (å¿…é ˆè¦ç´ )"}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"S",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"S",children:"[S]"})}),e.jsx("strong",{children:"ä¸»èª (Subject)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œèª°ãŒã€ã€Œä½•ãŒã€"}),"ã‚’è¡¨ã™ã€‚æ–‡ã®ä¸»å½¹ã€‚",e.jsx("br",{}),"ä¾‹: ",e.jsx("em",{children:"I"})," study English. / ",e.jsx("em",{children:"The cat"})," is cute."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"V",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"V",children:"[V]"})}),e.jsx("strong",{children:"å‹•è© (Verb)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œã€œã™ã‚‹ã€ã€Œã€œã§ã‚ã‚‹ã€"}),"ã‚’è¡¨ã™ã€‚ä¸»èªã®å‹•ä½œã‚„çŠ¶æ…‹ã€‚",e.jsx("br",{}),"ä¾‹: I ",e.jsx("em",{children:"study"})," English. / The cat ",e.jsx("em",{children:"is"})," cute."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"O",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"O",children:"[O]"})}),e.jsx("strong",{children:"ç›®çš„èª (Object)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œä½•ã‚’ã€ã€Œèª°ã‚’ã€"}),"ã‚’è¡¨ã™ã€‚å‹•è©ã®å¯¾è±¡ã€‚",e.jsx("br",{}),"ä¾‹: I study ",e.jsx("em",{children:"English"}),". / I like ",e.jsx("em",{children:"cats"}),"."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"C",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"C",children:"[C]"})}),e.jsx("strong",{children:"è£œèª (Complement)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œã©ã†ã§ã‚ã‚‹ã€ã€Œä½•ã§ã‚ã‚‹ã€"}),"ã‚’è¡¨ã™ã€‚ä¸»èªã‚„ç›®çš„èªã®çŠ¶æ…‹ãƒ»æ€§è³ªã€‚",e.jsx("br",{}),"ä¾‹: The cat is ",e.jsx("em",{children:"cute"}),". / I am ",e.jsx("em",{children:"a student"}),"."]})]})]}),e.jsxs("div",{className:"explanation-section",children:[e.jsx("h6",{className:"font-semibold text-sm mb-2",children:"âœ¨ æ–‡ã‚’è©³ã—ãã™ã‚‹è¦ç´ "}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"M",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"M",children:"[M]"})}),e.jsx("strong",{children:"ä¿®é£¾èª (Modifier)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"ã€Œã©ã‚“ãªã€ã€Œã©ã®ã‚ˆã†ã«ã€ã€Œã„ã¤ã€ã€Œã©ã“ã§ã€"}),"ã‚’è¡¨ã™ã€‚æ–‡ã‚’è±Šã‹ã«ã™ã‚‹ã€‚",e.jsx("br",{}),"ä¾‹: I wake up at ",e.jsx("em",{children:"seven"}),". / I read a ",e.jsx("em",{children:"good"})," book."]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adj",children:"[Adj]"})}),e.jsx("strong",{children:"å½¢å®¹è© (Adjective)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"åè©ã‚’è©³ã—ãèª¬æ˜"}),"ã™ã‚‹èªã€‚",e.jsx("br",{}),"ä¾‹: a ",e.jsx("em",{children:"beautiful"})," flower / ",e.jsx("em",{children:"happy"})," students"]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adv",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adv",children:"[Adv]"})}),e.jsx("strong",{children:"å‰¯è© (Adverb)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"å‹•è©ãƒ»å½¢å®¹è©ãƒ»å‰¯è©ã‚’è©³ã—ãèª¬æ˜"}),"ã™ã‚‹èªã€‚",e.jsx("br",{}),"ä¾‹: run ",e.jsx("em",{children:"quickly"})," / ",e.jsx("em",{children:"very"})," happy / ",e.jsx("em",{children:"always"})," ","study"]})]})]}),e.jsxs("div",{className:"explanation-section",children:[e.jsx("h6",{className:"font-semibold text-sm mb-2",children:"ğŸ”— ã¤ãªããƒ»é™å®šã™ã‚‹è¦ç´ "}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Prep",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Prep",children:"[Prep]"})}),e.jsx("strong",{children:"å‰ç½®è© (Preposition)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"åè©ã®å‰ã«ç½®ã„ã¦å ´æ‰€ãƒ»æ™‚é–“ãƒ»æ–¹æ³•"}),"ãªã©ã‚’ç¤ºã™ã€‚",e.jsx("br",{}),"ä¾‹: ",e.jsx("em",{children:"at"})," school / ",e.jsx("em",{children:"in"})," the morning / ",e.jsx("em",{children:"with"})," ","friends"]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Conj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Conj",children:"[Conj]"})}),e.jsx("strong",{children:"æ¥ç¶šè© (Conjunction)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"èªãƒ»å¥ãƒ»æ–‡ã‚’ã¤ãªã"}),"èªã€‚",e.jsx("br",{}),"ä¾‹: I ",e.jsx("em",{children:"and"})," you / study ",e.jsx("em",{children:"but"})," tired /"," ",e.jsx("em",{children:"because"})," I like it"]})]}),e.jsxs("div",{className:"explanation-item mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Det",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Det",children:"[Det]"})}),e.jsx("strong",{children:"é™å®šè© (Determiner)"})]}),e.jsxs("p",{className:"ml-6 text-gray-600",children:[e.jsx("strong",{children:"åè©ã®ç¯„å›²ãƒ»æ•°é‡ã‚’é™å®š"}),"ã™ã‚‹èªã€‚å† è©ãƒ»æŒ‡ç¤ºè©ãƒ»æ•°é‡è©ãªã©ã€‚",e.jsx("br",{}),"ä¾‹: ",e.jsx("em",{children:"the"})," book / ",e.jsx("em",{children:"my"})," cat / ",e.jsx("em",{children:"every"})," day /"," ",e.jsx("em",{children:"some"})," water"]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"S",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"S",children:"[S]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ä¸»èª (Subject)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"V",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"V",children:"[V]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å‹•è© (Verb)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"O",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"O",children:"[O]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ç›®çš„èª (Object)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"C",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"C",children:"[C]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"è£œèª (Complement)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"M",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"M",children:"[M]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ä¿®é£¾èª (Modifier)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Prep",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Prep",children:"[Prep]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å‰ç½®è© (Preposition)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Conj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Conj",children:"[Conj]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"æ¥ç¶šè© (Conjunction)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Det",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Det",children:"[Det]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"é™å®šè© (Determiner)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adj",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adj",children:"[Adj]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å½¢å®¹è© (Adjective)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Adv",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Adv",children:"[Adv]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"å‰¯è© (Adverb)"})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"grammar-tag","data-tag":"Unknown",children:e.jsx("span",{className:"grammar-tag-label","data-tag":"Unknown",children:"[?]"})}),e.jsx("span",{className:"flex-1 min-w-0 break-words",children:"ãã®ä»–"})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ye.grammarAnalysis.filter(j=>!/^[.,!?;:\-â€”â€“"'()]$/.test(j.word)).map((j,x)=>e.jsxs("div",{className:"grammar-tag","data-tag":j.tag,title:j.description,children:[e.jsx("span",{className:"font-semibold",children:j.word}),e.jsxs("span",{className:"ml-1 text-xs grammar-tag-label","data-tag":j.tag,children:["[",j.tag,"]"]})]},x))}),ye.grammarAnalysis.some(j=>/^[.,!?;:\-â€”â€“"'()]$/.test(j.word))&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{className:"text-xs font-semibold mb-2 text-gray-600",children:"ğŸ“Œ è¨˜å·ã®æ„å‘³:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ye.grammarAnalysis.filter(j=>/^[.,!?;:\-â€”â€“"'()]$/.test(j.word)).map((j,x)=>e.jsxs("div",{className:"punctuation-card",title:j.description,children:[e.jsx("span",{className:"font-bold text-lg",children:j.word}),e.jsx("span",{className:"ml-2 text-xs text-gray-600",children:j.description})]},x))})]})]}),(()=>{const j=ye.grammarAnalysis.map(f=>f.word),x=oo(j);return x.length===0?null:e.jsxs("div",{className:"phrasal-expressions-section mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ”— ç†Ÿèª:"}),e.jsx("div",{className:"space-y-2",children:x.map((f,N)=>e.jsxs("div",{className:"phrasal-expression-card",children:[e.jsx("div",{className:"phrasal-expression-words",children:f.words.map((T,H)=>{const V=Pe(T,void 0);return e.jsxs("div",{className:"phrasal-word-item",children:[e.jsx("div",{className:"phrasal-word",children:T}),e.jsx("div",{className:"phrasal-word-meaning",children:V||"-"})]},H)})}),e.jsxs("div",{className:"phrasal-expression-divider",children:[e.jsx("div",{className:"phrasal-divider-line"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"phrasal-type-label",children:"ç†Ÿèª"}),s&&n&&a&&e.jsx(Ct,{word:{word:f.words.join(" "),meaning:f.meaning,source:"reading",sourceDetail:le==null?void 0:le.title},sets:t,onAddWord:s,onRemoveWord:n,onOpenManagement:a,size:"small"})]})]}),e.jsx("div",{className:"phrasal-expression-meaning",children:f.meaning})]},N))})]})})(),(()=>{const j=co(ye.text);return j.length===0?null:e.jsxs("div",{className:"grammar-patterns-section mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ“ é‡è¦æ§‹æ–‡:"}),e.jsx("div",{className:"space-y-2",children:j.map((x,f)=>e.jsxs("div",{className:"grammar-pattern-card",children:[e.jsxs("div",{className:"pattern-header",children:[e.jsx("div",{className:"pattern-name",children:x.name}),e.jsx("div",{className:"pattern-meaning",children:x.meaning})]}),e.jsx("div",{className:"pattern-sentence",children:ye.text}),e.jsxs("div",{className:"pattern-explanation",children:["ğŸ’¡ ",x.explanation]})]},f))})]})})(),ye.showMeanings&&e.jsxs("div",{className:"word-cards-container",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ“š å˜èªã®æ„å‘³:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ye.grammarAnalysis.filter(j=>!/^[.,!?;:\-â€”â€“"'()]$/.test(j.word)).map((j,x)=>{const f=Pe(j.word,void 0);return e.jsxs("div",{className:"word-card",onDoubleClick:N=>He(j.word,N),title:"ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—: è©³ç´°è¡¨ç¤º",children:[e.jsx("div",{className:"word-card-word",children:j.word}),f&&f!=="-"&&e.jsx("div",{className:"word-card-meaning text-xs",children:f})]},x)})})]})]})]}),Ne==="fullText"&&e.jsxs("div",{className:"full-text-display",children:[e.jsx("h3",{children:"ğŸ“„ å…¨æ–‡"}),e.jsxs("div",{className:"full-text-controls",children:[e.jsx("button",{className:"px-6 py-3 text-base font-medium bg-primary text-white border-2 border-primary rounded-lg transition-all duration-200 hover:bg-primary-hover hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed:bg-primary-hover",onClick:()=>{const j=le.phrases.map(x=>x.segments.map(N=>N.word).join(" ").replace(/^[A-Z][a-z]*(?:\s+\d+)?:\s*/,"").replace(/"/g,"")).join(" ").replace(/\s+([.,!?;:])/g,"$1");Ze(j),O(!0),Z(!1)},disabled:Q&&!ae,title:"å…¨æ–‡ã‚’ç™ºéŸ³",children:"ğŸ”Š ç™ºéŸ³"}),e.jsx("button",{className:"px-6 py-3 text-base font-medium bg-warning text-warning-dark border-2 border-warning rounded-lg transition-all duration-200 hover:bg-warning-hover hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed:bg-warning-hover",onClick:()=>{ae?(wi(),Z(!1)):(vi(),Z(!0))},disabled:!Q,title:ae?"ç™ºéŸ³ã‚’å†é–‹":"ç™ºéŸ³ã‚’ä¸€æ™‚åœæ­¢",children:ae?"â–¶ï¸ å†é–‹":"â¸ï¸ ä¸€æ™‚åœæ­¢"}),e.jsx("button",{className:"px-6 py-3 text-base font-medium bg-error text-white border-2 border-error rounded-lg transition-all duration-200 hover:bg-error-hover hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed:bg-error-hover",onClick:()=>{yi(),O(!1),Z(!1)},disabled:!Q,title:"ç™ºéŸ³ã‚’åœæ­¢",children:"â¹ï¸ åœæ­¢"})]}),e.jsx("div",{className:"full-text-content",children:(()=>{if(le.originalText)return e.jsx("div",{className:"paragraph-en",children:le.originalText});if(le.title.toLowerCase().includes("conversation")){const x=[];return le.phrases.forEach(f=>{let N=f.segments.map(T=>T.word).join(" ").trim();!N||N==="-"||(N=N.replace(/\s+([.,!?;:"])/g,"$1"),x.push(N))}),e.jsx("div",{children:x.map((f,N)=>e.jsx("p",{className:"paragraph-en conversation-line",children:f},N))})}else{const f=le.phrases[0].segments.map(B=>B.word).join(" ").trim(),N=f.length<100&&!/[.!?]$/.test(f);let T="",H=!0;le.phrases.forEach((B,de)=>{de===0&&N||B.segments.forEach(fe=>{let M=fe.word.trim();M&&M!=="-"&&(/^[.,!?;:]$/.test(M)?(T+=M,H=/^[.!?]$/.test(M)):(M==='"'||M==="'"||(H&&M.length>0&&(M=M.charAt(0).toUpperCase()+M.slice(1),H=!1),T.length>0&&!T.endsWith(" ")&&!T.endsWith('"')&&!T.endsWith("'")&&(T+=" ")),T+=M))})}),T=T.replace(/\s+"/g,'"').replace(/\s+'/g,"'");const V=T.split(/([.!?])\s+/).filter(B=>B.trim()),L=[];for(let B=0;B<V.length;B+=2){const de=V[B],fe=V[B+1]||"";L.push((de+fe).trim())}const P=[];let ve=[],_=0;const J=60;L.forEach((B,de)=>{const fe=B.split(/\s+/).length;ve.push(B),_+=fe,(_>=J||de===L.length-1)&&(P.push(ve.join(" ")),ve=[],_=0)}),ve.length>0&&P.push(ve.join(" "));const R=L,F=B=>{Ie(B);const de=R[B],fe=At(de);we({text:de,grammarAnalysis:fe,showMeanings:!1})};return e.jsxs("div",{children:[e.jsx("div",{className:"sentences-container",children:R.map((B,de)=>e.jsxs("span",{className:`sentence-clickable ${te===de?"selected":""}`,onClick:()=>F(de),children:[B," "]},de))}),te!==null&&ye&&e.jsxs("div",{className:"selected-sentence-analysis",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"m-0",children:"ğŸ“– é¸æŠã—ãŸæ–‡ã®èª­è§£"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 text-sm bg-primary text-white rounded hover:bg-primary-hover",onClick:()=>Ze(ye.text),title:"ã“ã®æ–‡ã‚’ç™ºéŸ³",children:"ğŸ”Š ç™ºéŸ³"}),e.jsx("button",{className:"px-3 py-1 text-sm bg-info text-white rounded hover:bg-info-hover",onClick:()=>we({...ye,showMeanings:!ye.showMeanings}),children:ye.showMeanings?"æ„å‘³ã‚’éš ã™":"æ„å‘³ã‚’è¡¨ç¤º"})]})]}),e.jsx("div",{className:"selected-sentence-text",children:ye.text}),e.jsxs("div",{className:"grammar-structure mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ”¤ æ–‡æ³•æ§‹é€ :"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ye.grammarAnalysis.map((B,de)=>e.jsxs("div",{className:"grammar-tag","data-tag":B.tag,title:B.description,children:[e.jsx("span",{className:"font-semibold",children:B.word}),e.jsxs("span",{className:"ml-1 text-xs grammar-tag-label","data-tag":B.tag,children:["[",B.tag,"]"]})]},de))})]}),ye.showMeanings&&e.jsxs("div",{className:"word-cards-container mt-4",children:[e.jsx("h5",{className:"text-sm font-semibold mb-2",children:"ğŸ“š å˜èªã®æ„å‘³:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ye.grammarAnalysis.filter(B=>!/^[.,!?;:]$/.test(B.word)).map((B,de)=>{const fe=Pe(B.word,void 0);return e.jsxs("div",{className:"word-card",onDoubleClick:M=>He(B.word,M),title:"ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—: è©³ç´°è¡¨ç¤º",children:[e.jsx("div",{className:"word-card-word",children:B.word}),fe&&fe!=="-"&&e.jsx("div",{className:"word-card-meaning text-xs",children:fe})]},de)})})]})]})]})}})()})]}),Ne==="fullTranslation"&&e.jsx("div",{className:"full-translation-display",children:e.jsx("div",{className:"full-translation-content",children:(()=>{var x;if(console.log("[å…¨è¨³ã‚¿ãƒ–] currentPassage.id:",le.id),console.log("[å…¨è¨³ã‚¿ãƒ–] currentPassage.translation exists:",!!le.translation),console.log("[å…¨è¨³ã‚¿ãƒ–] currentPassage.translation length:",((x=le.translation)==null?void 0:x.length)||0),le.translation){const f=le.translation.split(/\n+/).map(N=>N.trim()).filter(N=>N.length>0);return e.jsx("div",{className:"full-translation-text",children:f.map((N,T)=>e.jsx("p",{className:"paragraph-ja",children:N},T))})}if(le.title.toLowerCase().includes("conversation")){const f=[];return le.phrases.forEach(N=>{let T=N.phraseMeaning||"";T=T.replace(/\[è¦ä¿®æ­£\]/g,"").trim(),!(!T||T==="-")&&f.push(T)}),f.map((N,T)=>e.jsx("p",{className:"paragraph-ja conversation-line",children:N},T))}else{const f=[];let N="";le.phrases.forEach(V=>{let L=V.phraseMeaning||"";if(L){if(L=L.replace(/\[è¦ä¿®æ­£\]/g,"").trim(),!L)return;const P=V.segments.map(_=>_.word).join(" ").trim(),ve=/[.!?]$/.test(P);/[ã€‚ï¼ï¼Ÿ]$/.test(L)?(N+=L,ve&&(f.push(N.trim()),N="")):ve?(N+=L+"ã€‚",f.push(N.trim()),N=""):N+=L+"ã€"}}),N.trim()&&f.push(N.trim()+"ã€‚");const T=[],H=4;for(let V=0;V<f.length;V+=H){const L=f.slice(V,V+H);T.push(L.join(""))}return T.map((V,L)=>e.jsx("p",{className:"paragraph-ja",children:V},L))}})()})})]}),e.jsx("style",{children:`
        .comprehensive-reading-view {
          max-width: 1200px;
          margin: 0 auto;
          padding: 20px;
          width: 100%;
        }

        @media (max-width: 768px) {
          .comprehensive-reading-view {
            max-width: 100%;
            margin: 0;
            padding: 8px;
          }
        }

        .reading-header {
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          margin-bottom: 20px;
        }

        .dark-mode .reading-header {
          background: var(--gray-800);
        }

        .reading-header h2 {
          margin: 0 0 20px 0;
        }

        .filter-controls, .passage-selector {
          margin-bottom: 15px;
        }

        .filter-controls label, .passage-selector label {
          font-weight: bold;
          margin-right: 10px;
          color: #333;
        }

        .dark-mode .filter-controls label,
        .dark-mode .passage-selector label {
          color: var(--gray-200);
        }

        .filter-controls select, .passage-selector select {
          padding: 8px 12px;
          border: 1px solid #ddd;
          border-radius: 4px;
          font-size: 14px;
          background: white;
          color: #333;
        }

        .dark-mode .filter-controls select,
        .dark-mode .passage-selector select {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-200);
        }

        .passage-stats {
          display: flex;
          gap: 10px;
          margin: 15px 0;
          flex-wrap: wrap;
        }

        .stat-badge {
          display: inline-block;
          padding: 6px 12px;
          background: #f0f0f0;
          border-radius: 4px;
          font-size: 14px;
          color: #333;
        }

        .dark-mode .stat-badge {
          background: var(--gray-700);
          color: var(--gray-200);
        }

        .stat-badge.unknown-count {
          background: #fff3cd;
          color: #856404;
          font-weight: bold;
        }

        .dark-mode .stat-badge.unknown-count {
          background: var(--yellow-500);
          color: var(--black);
        }

        .action-buttons {
          display: flex;
          gap: 10px;
          margin-top: 15px;
        }

        .action-buttons button {
          padding: 10px 20px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 14px;
          font-weight: bold;
          transition: all 0.3s;
        }

        .btn-primary {
          background: #007bff;
          color: white;
        }

        .btn-primary:hover {
          background: #0056b3;
        }

        .btn-info {
          background: #17a2b8;
          color: white;
        }

        .btn-info:hover {
          background: #138496;
        }

        .btn-success {
          background: #28a745;
          color: white;
        }

        .btn-success:hover {
          background: #218838;
        }

        .btn-success:disabled {
          background: #ccc;
          cursor: not-allowed;
        }

        .btn-secondary {
          background: #6c757d;
          color: white;
        }

        .btn-secondary:hover {
          background: #545b62;
        }

        .passage-content {
          background: white;
          padding: 30px;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .dark-mode .passage-content {
          background: var(--gray-800);
          color: var(--gray-100);
        }

        .passage-title {
          text-align: center;
          color: #333;
          margin-bottom: 30px;
          font-size: 24px;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .dark-mode .passage-title {
          color: var(--white);
        }

        .passage-body {
          line-height: 1.5;
          font-family: 'Times New Roman', Georgia, serif;
          color: #333;
        }

        .dark-mode .passage-body {
          color: var(--gray-200);
        }

        .phrase-block {
          margin-bottom: 8px;
          padding: 8px 12px;
          background: #ffffff;
          border-left: 3px solid #007bff;
          border-radius: 2px;
        }

        .dark-mode .phrase-block {
          background: var(--gray-700);
          border-left-color: var(--blue-400);
        }

        .phrase-english {
          font-size: 16px;
          line-height: 1.6;
          margin-bottom: 6px;
          font-family: 'Times New Roman', 'Georgia', serif;
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          align-items: flex-start;
        }

        .word-card {
          display: inline-flex;
          flex-direction: column;
          align-items: center;
          padding: 2px 5px;
          margin: 1px;
          background: #f8f9fa;
          border: 1px solid #dee2e6;
          border-radius: 4px;
          cursor: pointer;
          transition: all 0.2s;
          min-width: 60px;
        }

        .dark-mode .word-card {
          background: var(--gray-700);
          border-color: var(--gray-600);
        }

        .word-card:hover {
          background: #e7f3ff;
          border-color: #007bff;
        }

        .dark-mode .word-card:hover {
          background: var(--gray-600);
          border-color: var(--blue-400);
        }

        .word-card.unknown {
          background: #ffc107;
          color: #000;
          border-color: #ff9800;
          font-weight: bold;
        }

        .word-card.phrase-card {
          background: #e8f5e9;
          border-color: #4caf50;
        }

        .dark-mode .word-card.phrase-card {
          background: var(--gray-700);
          border-color: var(--green-400);
        }

        .word-card.phrase-card:hover {
          background: #c8e6c9;
        }

        .dark-mode .word-card.phrase-card:hover {
          background: var(--gray-600);
        }

        .word-card.punctuation-card {
          min-width: 20px;
          background: transparent;
          border: none;
          cursor: default;
          padding: 2px 4px;
        }

        .word-card.punctuation-card:hover {
          background: transparent;
          border: none;
        }

        .word-card-word {
          font-size: 16px;
          font-weight: 500;
          color: #333;
          text-align: center;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .dark-mode .word-card-word {
          color: var(--gray-200);
        }

        .phrase-card .word-card-word {
          font-size: 15px;
          color: #2e7d32;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .dark-mode .phrase-card .word-card-word {
          color: var(--green-400);
        }

        .word-card-meaning {
          font-size: 12px;
          color: #666;
          margin-top: 1px;
          text-align: center;
          padding: 1px 3px;
          background: rgba(255, 255, 255, 0.8);
          border-radius: 2px;
          min-height: 14px;
        }

        .dark-mode .word-card-meaning {
          color: var(--gray-300);
          background: rgba(48, 48, 48, 0.8);
        }

        .word-segment {
          display: inline-block;
          padding: 2px 4px;
          margin: 0 2px;
          cursor: pointer;
          border-radius: 3px;
          transition: all 0.2s;
          font-family: 'Times New Roman', Georgia, serif;
        }

        .word-segment:hover {
          background: #e7f3ff;
        }

        .word-segment.unknown {
          background: #ffc107;
          color: #000;
          font-weight: bold;
        }

        .show-translation-btn {
          background: #f8f9fa;
          border: 1px solid #ddd;
          padding: 8px 16px;
          border-radius: 4px;
          cursor: pointer;
          color: #666;
          font-size: 14px;
        }

        .show-translation-btn:hover {
          background: #e9ecef;
        }

        .phrase-translation {
          margin-top: 10px;
          padding: 15px;
          background: white;
          border-radius: 4px;
          border: 1px solid #dee2e6;
        }

        .dark-mode .phrase-translation {
          background: var(--gray-800);
          border-color: var(--gray-600);
        }

        .translation-text {
          font-size: 16px;
          color: #333;
          margin-bottom: 10px;
          font-weight: 500;
        }

        .dark-mode .translation-text {
          color: var(--gray-200);
        }

        .word-meanings {
          display: flex;
          flex-wrap: wrap;
          gap: 10px;
          font-size: 14px;
          color: #666;
        }

        .dark-mode .word-meanings {
          color: var(--gray-300);
        }

        .word-meaning-pair {
          background: #e7f3ff;
          padding: 4px 8px;
          border-radius: 3px;
        }

        .dark-mode .word-meaning-pair {
          background: var(--gray-700);
          color: var(--gray-200);
        }

        .error-message, .empty-container {
          text-align: center;
          padding: 50px;
          font-size: 18px;
          color: #666;
        }

        .dark-mode .error-message,
        .dark-mode .empty-container {
          color: var(--gray-300);
        }

        .error-message {
          color: #dc3545;
        }

        .dark-mode .error-message {
          color: var(--red-400);
        }

        /* å˜èªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .word-popup-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: transparent;
          z-index: 999;
        }

        .word-popup {
          position: absolute;
          left: var(--popup-x, 0);
          top: var(--popup-y, 0);
          background: white;
          border: 2px solid #007bff;
          border-radius: 8px;
          padding: 16px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
          z-index: 1000;
          max-width: 400px;
          min-width: 250px;
        }

        .dark-mode .word-popup {
          background: var(--gray-800);
          border-color: var(--blue-400);
          color: var(--gray-200);
        }

        .popup-close {
          position: absolute;
          top: 8px;
          right: 8px;
          background: #f8f9fa;
          border: none;
          border-radius: 4px;
          width: 24px;
          height: 24px;
          cursor: pointer;
          font-size: 16px;
          line-height: 1;
          color: #666;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .popup-close:hover {
          background: #e9ecef;
          color: #000;
        }

        .popup-word {
          font-size: 20px;
          font-weight: bold;
          color: #007bff;
          margin-bottom: 4px;
          padding-right: 30px;
        }

        .popup-reading {
          font-size: 14px;
          color: #666;
          margin-bottom: 8px;
        }

        .popup-meaning {
          font-size: 16px;
          color: #333;
          margin-bottom: 12px;
          padding: 8px;
          background: #f0f8ff;
          border-radius: 4px;
        }

        .popup-etymology {
          font-size: 13px;
          color: #555;
          margin-bottom: 8px;
          padding: 6px;
          background: #f8f9fa;
          border-radius: 4px;
        }

        .popup-related {
          font-size: 13px;
          color: #555;
          padding: 6px;
          background: #f8f9fa;
          border-radius: 4px;
        }

        .popup-etymology strong,
        .popup-related strong {
          color: #007bff;
        }

        .full-text-display, .full-translation-display {
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
          margin-top: 20px;
        }

        .dark-mode .full-text-display,
        .dark-mode .full-translation-display {
          background: var(--gray-800);
          color: var(--gray-100);
        }

        .full-text-display h3, .full-translation-display h3 {
          margin: 0 0 15px 0;
          color: #667eea;
        }

        .dark-mode .full-text-display h3,
        .dark-mode .full-translation-display h3 {
          color: var(--blue-400);
        }

        .full-text-content {
          font-size: 1.1em;
          line-height: 1.8;
          color: #333;
          font-family: 'Times New Roman', 'Georgia', serif;
        }

        .full-text-content .paragraph-en {
          margin-bottom: 1.5em;
          text-indent: 2em;
          text-align: left;
        }

        .full-text-content .paragraph-en:first-child {
          margin-top: 0;
        }

        /* ä¼šè©±å½¢å¼ã®è¡Œã‚¹ã‚¿ã‚¤ãƒ« */
        .full-text-content .conversation-line {
          text-indent: 0;
          margin-bottom: 1em;
          padding-left: 1em;
          border-left: 3px solid #667eea;
        }

        .full-translation-content {
          font-size: 1.05em;
          line-height: 2;
          color: #333;
        }

        .full-translation-text {
          white-space: pre-wrap;
          line-height: 2;
        }

        .full-translation-content .paragraph-ja {
          margin-bottom: 1.5em;
          text-indent: 1em;
          text-align: left;
        }

        .full-translation-content .paragraph-ja:first-child {
          margin-top: 0;
        }

        /* ä¼šè©±å½¢å¼ã®æ—¥æœ¬èªè¨³ã‚¹ã‚¿ã‚¤ãƒ« */
        .full-translation-content .conversation-line {
          text-indent: 0;
          margin-bottom: 1em;
          padding-left: 1em;
          border-left: 3px solid #667eea;
        }

        .translation-line {
          margin-bottom: 10px;
          padding: 8px;
          background: #f8f9fa;
          border-radius: 4px;
        }
      `})]})}const uo=Object.freeze(Object.defineProperty({__proto__:null,default:zr},Symbol.toStringTag,{value:"Module"}));function Fr(r){var ue,W,U,ee;const[t,s]=u.useState(()=>localStorage.getItem("grammar-quiz-type")||"verb-form"),[n,a]=u.useState(()=>localStorage.getItem("grammar-grade")||"all"),[o,l]=u.useState([]),[i,c]=u.useState(!1),[d,m]=u.useState(!1),h=ss(vt.GRAMMAR),[g,S]=u.useState(Date.now()),[b,y]=u.useState(void 0),[v,k]=u.useState(void 0),[D,C]=u.useState(0),[w,E]=u.useState(0),{learningLimit:$,reviewLimit:G,setLearningLimit:Y,setReviewLimit:q}=Ws("grammar"),[me,Ne]=u.useState(!1),be=()=>{Ne(!me)},[Re,A]=u.useState(()=>localStorage.getItem("autoNext-grammar")==="true"),[Q,O]=u.useState(()=>{const I=localStorage.getItem("autoNextDelay-grammar");return I?parseInt(I,10):1500}),[ae,Z]=u.useState(()=>localStorage.getItem("autoReadAloud-grammar")==="true"),[te,Ie]=u.useState(!1),[ye,we]=u.useState(!1),[Se,Ge]=u.useState([]),[Ce,We]=u.useState(0),[_e,Fe]=u.useState(null),[Ee,Pe]=u.useState([]),[le,$e]=u.useState([]),[Be,He]=u.useState(""),[je,ze]=u.useState(!1),[Ue,Le]=u.useState(!1),[j,x]=u.useState(0),[f,N]=u.useState(0),[T,H]=u.useState({correct:0,incorrect:0,review:0,mastered:0}),[V,L]=u.useState(null),P=Se[Ce],ve=(P==null?void 0:P.type)==="sentenceOrdering"||t==="sentence-ordering",_=P!=null&&P.id?(()=>{const I=P.id.match(/^g(\d+)-u(\d+)/);if(I)return`g${I[1]}-unit${I[2]}`})():void 0,J=u.useRef({quizType:t,grade:n}),R=u.useRef(Date.now()),F=u.useCallback(()=>{Ce<Se.length-1&&(We(I=>I+1),Fe(null),Pe([]),ze(!1),Le(!1),R.current=Date.now(),k(void 0))},[Ce,Se.length]),B=u.useCallback(async()=>{var I,z;we(!0),L(null);try{let re=[],K=null;if(n==="all")re=["1","2","3"];else if(n.match(/^[123]$/))re=[n];else if(n.endsWith("-all"))re=[n.charAt(0)];else if(n.match(/^g\d+-unit\d+$/)){const Ae=(I=n.match(/^g(\d+)-unit(\d+)$/))==null?void 0:I[1],De=(z=n.match(/^g(\d+)-unit(\d+)$/))==null?void 0:z[2];Ae&&De!==void 0&&(re=[Ae],K=parseInt(De))}const X=[];for(const Ae of re)for(let De=0;De<10;De++)if(!(K!==null&&De!==K))try{const Te=await fetch(`/data/grammar/grammar_grade${Ae}_unit${De}.json`);if(Te.ok){const Ye=await Te.json();if(Ye.enabled===!1){p.log(`grammar_grade${Ae}_unit${De}.json is disabled: ${Ye.disabledReason||"No reason provided"}`);continue}X.push(Ye)}else p.log(`grammar_grade${Ae}_unit${De}.json returned status ${Te.status}, skipping...`)}catch(Te){p.log(`Failed to fetch grammar_grade${Ae}_unit${De}.json:`,Te)}if(X.length===0)throw new Error(`å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼ˆå­¦å¹´: ${n}, å½¢å¼: ${t}ï¼‰`);let pe=[];if(X.forEach(Ae=>{const De=Ae.questions||[],Te={"verb-form":"verbForm","fill-in-blank":"fillInBlank","sentence-ordering":"sentenceOrdering"};if(t==="all"||t==="random")pe.push(...De);else{const Ye=Te[t]||t,xe=De.filter(ke=>ke.type===Ye);pe.push(...xe)}}),pe.length===0)throw new Error("é¸æŠã•ã‚ŒãŸæ¡ä»¶ã«è©²å½“ã™ã‚‹å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“");if(p.log(`Total questions: ${pe.length}`),pe.length===0)throw new Error("å•é¡Œãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");pe=pe.sort(()=>Math.random()-.5),Ge(pe),We(0),Fe(null),Pe([]),$e([]),ze(!1),Le(!1),x(0),N(0),H({correct:0,incorrect:0,review:0,mastered:0}),Ie(!0),we(!1)}catch(re){p.error("ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",re),L(re instanceof Error?re.message:String(re)),we(!1)}},[t,n]),de=u.useCallback(async()=>{if(je)F();else{x(pe=>pe+1),N(pe=>pe+1),H(pe=>({...pe,correct:pe.correct+1,mastered:pe.mastered+1}));const I=Date.now()-R.current,{updateWordProgress:z,addSessionHistory:re}=await rt(async()=>{const{updateWordProgress:pe,addSessionHistory:Ae}=await Promise.resolve().then(()=>Tt);return{updateWordProgress:pe,addSessionHistory:Ae}},void 0),K=P.id?`grammar_${P.id}`:P.question?`grammar_${P.question.slice(0,50).replace(/[^a-zA-Z0-9]/g,"_")}`:`grammar_unknown_${Date.now()}`;await z(K,!0,I,void 0,"grammar"),re({status:"correct",word:K,timestamp:Date.now()},"grammar"),S(Date.now()),Ce<Se.length-1?(We(pe=>pe+1),Fe(null),Pe([]),ze(!1),Le(!1),R.current=Date.now()):ze(!1)}},[je,Ce,Se.length,P,F]);u.useEffect(()=>{localStorage.setItem("grammar-quiz-type",t)},[t]),u.useEffect(()=>{localStorage.setItem("grammar-grade",n)},[n]),u.useEffect(()=>{(async()=>{const z=[],re=n.match(/^g?(\d+)/),K=re?re[1]:null;if(!K||n==="all"){l([]);return}for(let X=0;X<10;X++)try{const pe=await fetch(`/data/grammar/grammar_grade${K}_unit${X}.json`);if(pe.ok){const Ae=await pe.json();if(Ae.enabled===!1)continue;z.push({value:`g${K}-unit${X}`,label:`ä¸­${K}_Unit${X}_${Ae.title}`})}}catch{}l(z)})()},[n,t]),u.useEffect(()=>{const I=J.current,z=I.quizType!==t||I.grade!==n;te&&z&&B(),J.current={quizType:t,grade:n}},[t,n,B,te]),u.useEffect(()=>{if(ve&&P&&P.words){const I=[...P.words].sort(()=>Math.random()-.5);$e(I),Pe([]),ze(!1),Le(!1)}},[Ce,Se,ve,P]),u.useEffect(()=>{Fe(null),He(""),ze(!1),Le(!1)},[Ce]),u.useEffect(()=>{const I=z=>{te&&!je&&z.key==="Enter"&&(z.preventDefault(),de())};return window.addEventListener("keydown",I),()=>{window.removeEventListener("keydown",I)}},[te,je,de]);const fe=async I=>{var he;if(je||ve)return;Fe(I),ze(!0);const z=I===P.correctAnswer,re=I==="åˆ†ã‹ã‚‰ãªã„";y(z),k(P.question||P.sentence),z?(C(ne=>ne+1),E(0)):(E(ne=>ne+1),C(0)),ae&&P.sentence&&setTimeout(()=>{const ne=new SpeechSynthesisUtterance(P.sentence);ne.lang="en-US",ne.rate=.9,window.speechSynthesis.speak(ne)},300),N(ne=>ne+1);const K=Date.now()-R.current;if(z){x(ge=>ge+1);const ne=P&&j>=2;H(ge=>({...ge,correct:ge.correct+1,mastered:ne?ge.mastered+1:ge.mastered}))}else H(re?ne=>({...ne,incorrect:ne.incorrect+1,review:ne.review+1}):ne=>({...ne,incorrect:ne.incorrect+1}));const{updateWordProgress:X,loadProgress:pe,addSessionHistory:Ae,addQuizResult:De}=await rt(async()=>{const{updateWordProgress:ne,loadProgress:ge,addSessionHistory:Ve,addQuizResult:Oe}=await Promise.resolve().then(()=>Tt);return{updateWordProgress:ne,loadProgress:ge,addSessionHistory:Ve,addQuizResult:Oe}},void 0),Te=P.id?`grammar_${P.id}`:P.question?`grammar_${P.question.slice(0,50).replace(/[^a-zA-Z0-9]/g,"_")}`:`grammar_unknown_${Date.now()}`,{generateId:Ye}=await rt(async()=>{const{generateId:ne}=await Promise.resolve().then(()=>kn);return{generateId:ne}},void 0);await De({id:Ye(),questionSetId:"grammar-set",questionSetName:"æ–‡æ³•å•é¡Œ",score:z?1:0,total:1,percentage:z?100:0,date:Date.now(),timeSpent:Math.floor(K/1e3),incorrectWords:z?[]:[Te],mode:"grammar",category:void 0,difficulty:P.difficulty}),await X(Te,z,K,void 0,"grammar"),h.recordAnswer(Te,z,K);const ke=(he=(await pe()).wordProgress)==null?void 0:he[Te];let ce=z?"correct":"incorrect";if(ke&&ke.masteryLevel==="mastered"?ce="mastered":!z&&ke&&ke.incorrectCount>=2&&(ce="review"),Ae({status:ce,word:Te,timestamp:Date.now()},"grammar"),S(Date.now()),!z&&!me){const ne=Se.slice(Ce+1);if(ne.length>1){const ge=localStorage.getItem("learning-limit-grammar"),Ve=localStorage.getItem("review-limit-grammar"),Oe=ge?parseInt(ge):null,Je=Ve?parseInt(Ve):null,Ke=es(ne,{isReviewFocusMode:!1,learningLimit:Oe,reviewLimit:Je,mode:"grammar"});Ge([...Se.slice(0,Ce+1),...Ke])}}},M=(I,z)=>{je||!ve||(z?($e(re=>re.filter(K=>K!==I)),Pe(re=>{var X;const K=[...re,I];return K.length===((X=P.words)==null?void 0:X.length)&&!je&&setTimeout(async()=>{var Ve;ze(!0);const pe=K.join(" "),Ae=(P.correctAnswer||P.correctOrder||P.sentence||"").replace(/[.!?]/g,"").trim(),De=pe.toLowerCase()===Ae.toLowerCase();N(Oe=>Oe+1);const Te=Date.now()-R.current;if(ae&&setTimeout(()=>{const Oe=new SpeechSynthesisUtterance(Ae);Oe.lang="en-US",Oe.rate=.9,window.speechSynthesis.speak(Oe)},300),De){x(Je=>Je+1);const Oe=j>=2;H(Je=>({...Je,correct:Je.correct+1,mastered:Oe?Je.mastered+1:Je.mastered}))}else H(Oe=>({...Oe,incorrect:Oe.incorrect+1}));const{updateWordProgress:Ye,loadProgress:xe,addSessionHistory:ke}=await rt(async()=>{const{updateWordProgress:Oe,loadProgress:Je,addSessionHistory:Ke}=await Promise.resolve().then(()=>Tt);return{updateWordProgress:Oe,loadProgress:Je,addSessionHistory:Ke}},void 0),ce=P.id?`grammar_${P.id}`:P.question?`grammar_${P.question.slice(0,50).replace(/[^a-zA-Z0-9]/g,"_")}`:`grammar_unknown_${Date.now()}`;await Ye(ce,De,Te,void 0,"grammar");const ne=(Ve=(await xe()).wordProgress)==null?void 0:Ve[ce];let ge=De?"correct":"incorrect";ne&&ne.masteryLevel==="mastered"?ge="mastered":!De&&ne&&ne.incorrectCount>=2&&(ge="review"),ke({status:ge,word:ce,timestamp:Date.now()},"grammar"),S(Date.now())},100),K})):(Pe(re=>re.filter(K=>K!==I)),$e(re=>[...re,I])))},se=()=>{Le(!Ue)},oe=()=>{Ce>0&&(We(I=>I-1),Fe(null),Pe([]),ze(!1),Le(!1),R.current=Date.now())},ie=()=>{var I;return!P||!je?!1:ve?Ee.join(" ")===((I=P.words)==null?void 0:I.join(" ")):_e===P.correctAnswer};return u.useEffect(()=>{te||B()},[t,n,B,te]),e.jsxs("div",{className:"quiz-view",children:[V&&e.jsxs("div",{className:"error-message",children:[e.jsxs("p",{children:["âŒ ",V]}),e.jsx("button",{onClick:B,className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"å†è©¦è¡Œ"})]}),!V&&te&&P&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(ts,{mode:"grammar",currentScore:j,totalAnswered:f,sessionCorrect:T.correct,sessionIncorrect:T.incorrect,sessionReview:T.review,sessionMastered:T.mastered,sessionStats:T,onReviewFocus:be,isReviewFocusMode:me,onShowSettings:()=>c(!0),onAnswerTime:g,lastAnswerCorrect:b,lastAnswerWord:v,lastAnswerDifficulty:P==null?void 0:P.difficulty,correctStreak:D,incorrectStreak:w,learningPhase:h.state.currentPhase??void 0,estimatedSpeed:(ue=h.state.personalParams)==null?void 0:ue.learningSpeed,dataSource:n.startsWith("g")&&n.includes("-unit")?` æ–‡æ³•å•é¡Œé›†ï½œ${n.replace("g","").replace("-unit","-unit")}`:` ${n==="all"?"å…¨å­¦å¹´":`${n}å¹´`}`,category:`å‡ºé¡Œå½¢å¼: ${t==="all"?"å…¨ç¨®é¡":t==="verb-form"?"å‹•è©å¤‰åŒ–":t==="fill-in-blank"?"ç©´åŸ‹ã‚":t==="sentence-ordering"?"ä¸¦ã³æ›¿ãˆ":"å…¨ç¨®é¡"}`,difficulty:"",wordPhraseFilter:"all",grammarUnit:_})})}),i&&e.jsxs("div",{className:"study-settings-panel",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h3",{children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm font-medium bg-gray-200 text-gray-700 border-2 border-transparent rounded-lg transition-all duration-200 hover:bg-gray-300:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"grade-select-active",children:"ğŸ“š å­¦å¹´ãƒ»å˜å…ƒ:"}),e.jsxs("select",{id:"grade-select-active",value:n,onChange:I=>a(I.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨å­¦å¹´ã®å†…å®¹"}),e.jsx("option",{value:"1",children:"1å¹´ã®å†…å®¹"}),o.filter(I=>I.value.startsWith("g1-")).map(I=>e.jsxs("option",{value:I.value,children:["1å¹´_",I.label.replace(/^ä¸­\d+_/,"")]},I.value)),e.jsx("option",{value:"2",children:"2å¹´ã®å†…å®¹"}),o.filter(I=>I.value.startsWith("g2-")).map(I=>e.jsxs("option",{value:I.value,children:["2å¹´_",I.label.replace(/^ä¸­\d+_/,"")]},I.value)),e.jsx("option",{value:"3",children:"3å¹´ã®å†…å®¹"}),o.filter(I=>I.value.startsWith("g3-")).map(I=>e.jsxs("option",{value:I.value,children:["3å¹´_",I.label.replace(/^ä¸­\d+_/,"")]},I.value))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"quiz-type-select-active",children:"ğŸ“ å•é¡Œã®ç¨®é¡:"}),e.jsxs("select",{id:"quiz-type-select-active",value:t,onChange:I=>s(I.target.value),className:"select-input",children:[e.jsx("option",{value:"all",children:"å…¨ã¦ã®ç¨®é¡"}),e.jsx("option",{value:"verb-form",children:"å‹•è©å¤‰åŒ–"}),e.jsx("option",{value:"fill-in-blank",children:"ç©´åŸ‹ã‚"}),e.jsx("option",{value:"sentence-ordering",children:"ä¸¦ã³æ›¿ãˆ"})]})]}),e.jsx(Ls,{learningLimit:$,reviewLimit:G,onLearningLimitChange:Y,onReviewLimitChange:q,idPrefix:"grammar-quiz-"}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-next-toggle-grammar-quiz",checked:Re,onChange:I=>{A(I.target.checked),localStorage.setItem("autoNext-grammar",I.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-next-toggle-grammar-quiz",className:"checkbox-label",children:["æ­£è§£æ™‚è‡ªå‹•ã§æ¬¡ã¸ï¼š",Re?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})}),Re&&e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"auto-next-delay-grammar-quiz",children:"â±ï¸ æ¬¡ã¸ã®é…å»¶æ™‚é–“ï¼š"}),e.jsxs("div",{className:"slider-row",children:[e.jsx("input",{type:"range",id:"auto-next-delay-grammar-quiz",min:"500",max:"3000",step:"100",value:Q,onChange:I=>{const z=parseInt(I.target.value,10);O(z),localStorage.setItem("autoNextDelay-grammar",z.toString())},className:"slider-input"}),e.jsxs("span",{className:"slider-value",children:[(Q/1e3).toFixed(1),"ç§’"]})]})]}),e.jsx("div",{className:"filter-group",children:e.jsxs("div",{className:"checkbox-row",children:[e.jsx("input",{type:"checkbox",id:"auto-read-aloud-toggle-grammar-quiz",checked:ae,onChange:I=>{Z(I.target.checked),localStorage.setItem("autoReadAloud-grammar",I.target.checked.toString())}}),e.jsxs("label",{htmlFor:"auto-read-aloud-toggle-grammar-quiz",className:"checkbox-label",children:["å›ç­”æ™‚è‡ªå‹•ã§èª­ã¿ä¸Šã’ï¼š",ae?"æœ‰åŠ¹":"ç„¡åŠ¹"]})]})})]}),e.jsx("div",{className:"question-container",children:e.jsxs("div",{className:"question-card relative",children:[e.jsx("button",{onClick:()=>m(!0),className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsx("div",{className:"comment-bar-container"}),e.jsxs("div",{className:"question-nav-row",children:[e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-orange-500 hover:bg-orange-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:oe,disabled:Ce===0,title:"å‰ã¸",children:"â†"}),e.jsxs("div",{className:"question-content-inline",children:[e.jsxs("div",{className:`question-text ${Ue?"hint-active":""} ${je?"":"clickable"}`,onClick:je?void 0:se,title:je?"":"ã‚¿ãƒƒãƒ—ã—ã¦ãƒ’ãƒ³ãƒˆã‚’è¡¨ç¤º ğŸ’¡",children:[P.japanese,!je&&e.jsx("span",{className:"hint-icon",children:"ğŸ’¡"})]}),P.difficulty&&e.jsx("div",{className:`difficulty-badge ${P.difficulty}`,children:P.difficulty==="beginner"?"åˆç´š":P.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})]}),e.jsx("button",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 bg-green-500 hover:bg-green-600 text-white font-bold rounded-lg transition flex items-center justify-center text-2xl disabled:opacity-30 disabled:cursor-not-allowed",onClick:de,disabled:Ce>=Se.length-1,title:je?"æ¬¡ã¸":"ã‚¹ã‚­ãƒƒãƒ— (Enter)",children:"â†’"})]}),Ue&&!je&&e.jsx("div",{className:"hint-box",children:P.hint}),P.passage&&e.jsxs("div",{className:"passage-context",children:[e.jsx("div",{className:"passage-label",children:"ğŸ“– æ–‡è„ˆ"}),e.jsxs("div",{className:"passage-content",children:[e.jsx("div",{className:"passage-english",children:P.passage}),P.passageJapanese&&e.jsx("div",{className:"passage-japanese",children:P.passageJapanese})]})]}),ve?e.jsxs("div",{className:"word-area",children:[e.jsxs("div",{className:"selected-words-area",children:[e.jsxs("div",{className:"area-label-with-reset",children:[e.jsxs("span",{className:"area-label",children:["é¸æŠã—ãŸå˜èª (",Ee.length,"èª)"]}),!je&&e.jsx("button",{className:`reset-ordering-button ${Ee.length===0?"disabled":""}`,onClick:()=>{if(Ee.length>0){const I=Ee[Ee.length-1];Pe(z=>z.slice(0,-1)),$e(z=>[...z,I])}},disabled:Ee.length===0,title:Ee.length===0?"å˜èªã‚’é¸æŠã—ã¦ãã ã•ã„":"æœ€å¾Œã®å˜èªã‚’æˆ»ã™",children:"â†¶ 1ã¤æˆ»ã‚‹"})]}),e.jsxs("div",{className:"word-container",children:[Ee.map((I,z)=>e.jsx("button",{className:"word-button selected",onClick:()=>M(I,!1),disabled:je,children:I},`selected-${z}`)),Ee.length===0&&e.jsx("div",{className:"placeholder",children:"ã“ã“ã«å˜èªã‚’ä¸¦ã¹ã¦ãã ã•ã„"})]})]}),e.jsxs("div",{className:"remaining-words-area",children:[e.jsxs("div",{className:"area-label",children:["ä½¿ãˆã‚‹å˜èª (",le.length,"èª)"]}),e.jsx("div",{className:"word-container",children:le.map((I,z)=>e.jsx("button",{className:"word-button remaining",onClick:()=>M(I,!0),disabled:je,children:I},`remaining-${z}`))})]})]}):e.jsxs("div",{className:"choices-area",children:[P.conversation?e.jsxs(e.Fragment,{children:[P.japanese&&P.japanese.includes("A:")&&P.japanese.includes("B:")&&e.jsx("div",{className:"japanese-conversation",children:P.japanese.split(/([AB]:)/).map((I,z)=>I==="A:"||I==="B:"?e.jsx("span",{className:"conversation-speaker",children:I},z):I.trim()?e.jsx("span",{className:"conversation-text",children:I.trim()},z):null)}),e.jsx("div",{className:"conversation-display",children:(P.conversation||((W=P.dialogue)==null?void 0:W.map(I=>`${I.speaker}: ${I.text}`))||[]).map((I,z)=>e.jsx("div",{className:"conversation-line",children:I.split("____").map((re,K,X)=>e.jsxs("span",{children:[re,K<X.length-1&&e.jsx("span",{className:"fill-in-blank-space",children:"_______"})]},K))},z))})]}):P.originalSentence||P.targetSentence?e.jsxs("div",{className:"paraphrase-display",children:[e.jsx("div",{className:"paraphrase-label",children:"ğŸ“ å…ƒã®æ–‡:"}),e.jsx("div",{className:"sentence-display original",children:P.originalSentence||P.sentence}),e.jsx("div",{className:"paraphrase-arrow",children:"â†“ è¨€ã„æ›ãˆ"}),e.jsx("div",{className:"paraphrase-label",children:"âœï¸ æ›¸ãæ›ãˆå¾Œ:"}),e.jsx("div",{className:"sentence-display target",children:(U=P.question||P.targetSentence)==null?void 0:U.split("____").map((I,z,re)=>e.jsxs("span",{children:[I,z<re.length-1&&e.jsx("span",{className:"fill-in-blank-space",children:"_______"})]},z))})]}):e.jsx("div",{className:"sentence-display",children:(ee=P.sentence)==null?void 0:ee.split("____").map((I,z,re)=>e.jsxs("span",{children:[I,z<re.length-1&&e.jsx("span",{className:"fill-in-blank-space",children:"_______"})]},z))}),P.choices&&P.choices.length>0?e.jsxs("div",{className:"choices-grid",children:[P.choices.map((I,z)=>{const re=_e===I,K=I===P.correctAnswer,X=je&&K,pe=je&&re&&!K;return e.jsxs("button",{className:`choice-button ${re?"selected":""} ${X?"correct":""} ${pe?"incorrect":""}`,onClick:()=>fe(I),disabled:je,children:[I,X&&" âœ“",pe&&" âœ—"]},z)}),e.jsxs("button",{className:`choice-button dont-know ${_e==="åˆ†ã‹ã‚‰ãªã„"?"selected":""} ${je&&_e==="åˆ†ã‹ã‚‰ãªã„"?"incorrect":""}`,onClick:()=>fe("åˆ†ã‹ã‚‰ãªã„"),disabled:je,children:["åˆ†ã‹ã‚‰ãªã„",je&&_e==="åˆ†ã‹ã‚‰ãªã„"&&" âœ—"]})]}):e.jsxs("div",{className:"text-input-container",children:[e.jsx("input",{type:"text",className:"text-answer-input",value:Be,onChange:I=>He(I.target.value),onKeyPress:I=>{I.key==="Enter"&&Be.trim()&&fe(Be.trim())},placeholder:"ç­”ãˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...",disabled:je,autoFocus:!0}),e.jsx("button",{className:"submit-answer-button",onClick:()=>fe(Be.trim()),disabled:je||!Be.trim(),children:"å›ç­”ã™ã‚‹"}),e.jsx("button",{className:`choice-button dont-know ${_e==="åˆ†ã‹ã‚‰ãªã„"?"selected":""}`,onClick:()=>fe("åˆ†ã‹ã‚‰ãªã„"),disabled:je,children:"åˆ†ã‹ã‚‰ãªã„"})]})]}),je&&e.jsx(e.Fragment,{children:ve?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`result-box ${ie()?"correct":"incorrect"}`,children:[e.jsx("div",{className:"result-header",children:ie()?"âœ… æ­£è§£ï¼":"âŒ ä¸æ­£è§£"}),e.jsx("div",{className:"result-content",children:e.jsxs("div",{className:"answer-comparison",children:[e.jsxs("div",{className:"user-answer",children:[e.jsx("strong",{children:"ã‚ãªãŸã®å›ç­”:"}),e.jsx("br",{}),Ee.join(" ")]}),!ie()&&e.jsxs("div",{className:"correct-answer",children:[e.jsx("strong",{children:"æ­£è§£:"}),e.jsx("br",{}),P.correctAnswer||P.correctOrder||P.sentence||""]})]})})]}),P.explanation&&e.jsx("div",{className:"explanation-box",children:e.jsxs("div",{className:"explanation",children:[e.jsx("strong",{children:"è§£èª¬:"}),e.jsx("br",{}),P.explanation]})})]}):e.jsx(e.Fragment,{children:P.explanation&&e.jsx("div",{className:"explanation-box",children:e.jsxs("div",{className:"explanation",children:[e.jsx("strong",{children:"è§£èª¬:"}),e.jsx("br",{}),P.explanation]})})})})]})})]})]})}const mo=Object.freeze(Object.defineProperty({__proto__:null,default:Fr},Symbol.toStringTag,{value:"Module"}));function ho({allQuestions:r,questionSets:t,customQuestionSets:s=[],onAddWordToCustomSet:n,onRemoveWordFromCustomSet:a,onOpenCustomSetManagement:o}){var fe;const[l,i]=u.useState(!1),[c,d]=u.useState("all"),[m,h]=u.useState("all"),[g,S]=u.useState("all"),[b,y]=u.useState("all"),[v,k]=u.useState(()=>{const M=localStorage.getItem("memorization-still-learning-limit");return M?parseInt(M):null}),[D,C]=u.useState(()=>{const M=localStorage.getItem("memorization-incorrect-limit");return M?parseInt(M):null}),[w,E]=u.useState({showWord:!0,showMeaning:!0,showPronunciation:!1,showExample:!1,showEtymology:!1,showRelated:!1}),[$,G]=u.useState(!1),[Y,q]=u.useState(!0),[me,Ne]=u.useState(!1),[be,Re]=u.useState(1.5),[A,Q]=u.useState(null),[O,ae]=u.useState(0),[Z,te]=u.useState([]),[Ie]=u.useState(()=>`session-${Date.now()}`),[ye,we]=u.useState(0),[Se,Ge]=u.useState(!1),[Ce,We]=u.useState({correct:0,still_learning:0,incorrect:0,total:0}),[_e,Fe]=u.useState(0),[Ee,Pe]=u.useState(void 0),[le,$e]=u.useState(void 0),[Be,He]=u.useState(0),[je,ze]=u.useState(0),Ue=u.useRef(0),[Le,j]=u.useState(!0),x=u.useRef(0),f=u.useRef(null),N=u.useRef(null),[T,H]=u.useState(!1),V=ss(vt.MEMORIZATION);u.useEffect(()=>{(async()=>{try{const se=await Is();se&&E(se);const oe=await Rs();oe&&(G(oe.autoVoice||!1),q(oe.voiceWord!==void 0?oe.voiceWord:!0),Ne(oe.voiceMeaning||!1),Re(oe.voiceDelay!==void 0?oe.voiceDelay:1.5)),j(!1)}catch(se){p.error("è¨­å®šã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",se),j(!1)}})()},[]);const L=()=>{const M=new Set;return r.forEach(se=>{se.relatedFields&&Array.isArray(se.relatedFields)&&se.relatedFields.forEach(oe=>M.add(oe))}),Array.from(M).sort()};u.useEffect(()=>{if(Le)return;(()=>{const se=r;if(se.length===0)return;let oe=se;g!=="all"&&(oe=oe.filter(ue=>ue.difficulty===g)),m!=="all"&&(oe=oe.filter(ue=>ue.relatedFields&&Array.isArray(ue.relatedFields)&&ue.relatedFields.includes(m))),b==="words"?oe=oe.filter(ue=>!ue.word.includes(" ")||ue.word.split(" ").length<=2):b==="phrases"&&(oe=oe.filter(ue=>ue.word.includes(" ")&&ue.word.split(" ").length>2));const ie=J(oe,v,D);te(ie),ie.length>0&&(Q(ie[0]),ae(0),Ue.current=Date.now())})()},[t,c,g,m,b,r,Le,Se]);const P=()=>{Ge(!Se)};u.useEffect(()=>{(v!==null&&Ce.still_learning>=v||D!==null&&Ce.incorrect>=D)&&(Se||Ge(!0))},[Ce,v,D,Se]);const ve=(M,se=2.5)=>M===0?0:M===1?1:M===2?3:M===3?7:Math.round(7*Math.pow(se,M-3)),_=(M,se,oe)=>{const U=(Date.now()-M)/(1e3*60*60*24)/(se||1)*100,ee=(1-oe/100)*50;return U+ee},J=(M,se,oe)=>{const ie=xe=>{var he;const ce=localStorage.getItem("english-progress");if(!ce)return null;try{const ge=(he=JSON.parse(ce).wordProgress)==null?void 0:he[xe];if(!ge)return null;const Ve=ge.memorizationAttempts||0,Oe=ge.memorizationCorrect||0,Je=ge.memorizationStillLearning||0,Ke=ge.memorizationStreak||0,ct=ge.lastStudied||0,Gr=ge.easinessFactor||2.5,Dt=ge.reviewInterval||ve(Ke,Gr),Mo=ge.avgResponseSpeed||0;if(Ve===0)return{category:"new",priority:3,lastStudied:ct,attempts:Ve,correct:Oe,streak:Ke,forgettingRisk:0,reviewInterval:0};const Br=Oe+Je*.5,rs=Ve>0?Br/Ve*100:0,ns=_(ct,Dt,rs);return Ke>=3||Ke>=2&&rs>=80?{category:"mastered",priority:5,lastStudied:ct,attempts:Ve,correct:Oe,streak:Ke,forgettingRisk:ns,reviewInterval:Dt}:rs>=50||Je>0?{category:"still_learning",priority:2,lastStudied:ct,attempts:Ve,correct:Oe,streak:Ke,forgettingRisk:ns,reviewInterval:Dt}:{category:"incorrect",priority:1,lastStudied:ct,attempts:Ve,correct:Oe,streak:Ke,forgettingRisk:ns,reviewInterval:Dt}}catch(ne){return p.error("çµ±è¨ˆæƒ…å ±ã®å–å¾—ã‚¨ãƒ©ãƒ¼:",ne),null}},ue=M.map(xe=>({question:xe,status:ie(xe.word)})),W={mastered:ue.filter(xe=>{var ke;return((ke=xe.status)==null?void 0:ke.category)==="mastered"}).length,still_learning:ue.filter(xe=>{var ke;return((ke=xe.status)==null?void 0:ke.category)==="still_learning"}).length,incorrect:ue.filter(xe=>{var ke;return((ke=xe.status)==null?void 0:ke.category)==="incorrect"}).length,new:ue.filter(xe=>{var ke;return((ke=xe.status)==null?void 0:ke.category)==="new"}).length},U=se!==null&&W.still_learning>=se,ee=oe!==null&&W.incorrect>=oe,I=W.mastered+W.still_learning+W.incorrect,z=W.still_learning+W.incorrect,K=(I>0?z/I:0)>=.2,X=oe!==null?oe:50,pe=Math.max(3,Math.floor(X*.6)),Ae=Math.max(2,Math.floor(X*.3)),De=W.incorrect>pe,Te=W.incorrect<=Ae;return ue.sort((xe,ke)=>{const ce=xe.status,he=ke.status;let ne=(ce==null?void 0:ce.priority)||3,ge=(he==null?void 0:he.priority)||3;if(Se)(ce==null?void 0:ce.category)==="incorrect"&&(ne=0),(he==null?void 0:he.category)==="incorrect"&&(ge=0),(ce==null?void 0:ce.category)==="still_learning"&&ne!==0&&(ne=.5),(he==null?void 0:he.category)==="still_learning"&&ge!==0&&(ge=.5),(ce==null?void 0:ce.category)==="mastered"&&ne>1&&(ne=10),(he==null?void 0:he.category)==="mastered"&&ge>1&&(ge=10),(ce==null?void 0:ce.category)==="new"&&ne>1&&(ne=8),(he==null?void 0:he.category)==="new"&&ge>1&&(ge=8);else{const Je=(ce==null?void 0:ce.forgettingRisk)||0,Ke=(he==null?void 0:he.forgettingRisk)||0;Je>=150&&(ne=.1),Ke>=150&&(ge=.1),Je>=100&&Je<150&&(ne=.2),Ke>=100&&Ke<150&&(ge=.2),(ce==null?void 0:ce.category)==="incorrect"&&ne>.2&&(De?ne=ce.lastStudied&&Date.now()-ce.lastStudied<864e5?.1:.3:ne=.3),(he==null?void 0:he.category)==="incorrect"&&ge>.2&&(De?ge=he.lastStudied&&Date.now()-he.lastStudied<864e5?.1:.3:ge=.3),(ce==null?void 0:ce.category)==="still_learning"&&ne>.3&&(ne=.8),(he==null?void 0:he.category)==="still_learning"&&ge>.3&&(ge=.8),(ce==null?void 0:ce.category)==="mastered"&&(Je>=50&&ne>1?ne=2:ne>2&&(ne=4.5)),(he==null?void 0:he.category)==="mastered"&&(Ke>=50&&ge>1?ge=2:ge>2&&(ge=4.5)),(ce==null?void 0:ce.category)==="new"&&ne>3&&(De?ne=10:Te?ne=3.5:ne=K?5:3.5),(he==null?void 0:he.category)==="new"&&ge>3&&(De?ge=10:Te?ge=3.5:ge=K?5:3.5),ee&&((ce==null?void 0:ce.category)==="incorrect"&&(ne=0),(he==null?void 0:he.category)==="incorrect"&&(ge=0)),U&&((ce==null?void 0:ce.category)==="still_learning"&&(ne=.05),(he==null?void 0:he.category)==="still_learning"&&(ge=.05))}if(ne!==ge)return ne-ge;const Ve=(ce==null?void 0:ce.lastStudied)||0,Oe=(he==null?void 0:he.lastStudied)||0;return Ve!==Oe?Ve-Oe:Math.random()-.5}).map(xe=>xe.question)};u.useEffect(()=>{if(!A||!$||N.current===A.word)return;N.current=A.word,(async()=>{if(Y&&Ze(A.word,{rate:.85}),me&&A.meaning){await new Promise(oe=>setTimeout(oe,be*1e3));const se=new SpeechSynthesisUtterance(A.meaning);se.lang="ja-JP",se.rate=.85,window.speechSynthesis.speak(se)}})()},[A,$,Y,me,be]);const R=()=>{H(!T)},F=async M=>{if(M==="showWord")return;const se={...w,[M]:!w[M]};E(se),await Ms(se)},B=async(M,se,oe,ie)=>{G(M),q(se),Ne(oe),ie!==void 0&&Re(ie),await As({autoVoice:M,voiceWord:se,voiceMeaning:oe,voiceDelay:ie!==void 0?ie:be,interleavingMode:"off",cardDisplaySettings:w})},de=u.useCallback(async M=>{if(!A)return;const se=(Date.now()-Ue.current)/1e3,oe=M==="right",ie=M==="center";if(Pe(oe),$e(A.word),oe?(He(ee=>ee+1),ze(0)):ie?(He(0),ze(0)):(ze(ee=>ee+1),He(0)),We(ee=>({correct:oe?ee.correct+1:ee.correct,still_learning:ie?ee.still_learning+1:ee.still_learning,incorrect:!oe&&!ie?ee.incorrect+1:ee.incorrect,total:ee.total+1})),se<16){const ee={word:A.word,timestamp:Date.now(),viewDuration:se,swipeDirection:M==="center"?"left":M,sessionId:Ie,consecutiveViews:ye+1};await Ps(ee),we(z=>z+1);const{updateWordProgress:I}=await rt(async()=>{const{updateWordProgress:z}=await Promise.resolve().then(()=>Tt);return{updateWordProgress:z}},void 0);await I(A.word,oe,se*1e3,void 0,"memorization",ie),V.recordAnswer(A.word,oe,se*1e3)}Fe(Date.now());const ue=!oe,W=Ce.total%3===0||v!==null&&Ce.still_learning>=v||D!==null&&Ce.incorrect>=D;if((ue||W)&&Z.length>1){const ee=Z.slice(O+1),I=es(ee,{isReviewFocusMode:!1,learningLimit:v,reviewLimit:D,mode:"memorization"}),z=[...Z.slice(0,O+1),...I];te(z)}const U=O+1;U<Z.length?(Q(Z[U]),ae(U),Ue.current=Date.now(),$e(void 0)):(Q(null),$e(void 0))},[A,O,Z,Ie,ye,Ce,v,D]);return u.useEffect(()=>{const M=f.current;if(!M)return;const se=ue=>{x.current=ue.touches[0].clientX},oe=ue=>{const U=ue.changedTouches[0].clientX-x.current;Math.abs(U)>100&&(U>0?de("right"):de("left"))},ie=ue=>{ue.key==="ArrowLeft"||ue.key==="1"?(ue.preventDefault(),de("left")):ue.key==="ArrowDown"||ue.key==="2"?(ue.preventDefault(),de("center")):(ue.key==="ArrowRight"||ue.key==="3")&&(ue.preventDefault(),de("right"))};return M.addEventListener("touchstart",se),M.addEventListener("touchend",oe),document.addEventListener("keydown",ie),()=>{M.removeEventListener("touchstart",se),M.removeEventListener("touchend",oe),document.removeEventListener("keydown",ie)}},[de]),Le?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"text-xl",children:"èª­ã¿è¾¼ã¿ä¸­..."})}):A?e.jsx("div",{className:"min-h-screen flex flex-col",children:T?e.jsx("div",{className:"fixed inset-0 z-50 bg-gray-50 overflow-y-auto",children:e.jsxs("div",{className:"min-h-screen flex items-center justify-center py-8",children:[e.jsx("button",{onClick:R,className:"fixed top-4 right-4 z-50 p-3 bg-gray-800 text-white rounded-full shadow-lg hover:bg-gray-700:bg-gray-600 transition","aria-label":"å…¨ç”»é¢çµ‚äº†",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"w-full max-w-4xl px-4",children:e.jsxs("div",{ref:f,className:"question-card",children:[e.jsx("div",{className:"mb-8 py-8 flex flex-col items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:`flex flex-col items-center ${qe()?"clickable-pronunciation":""}`,onClick:M=>{qe()&&(M.preventDefault(),M.stopPropagation(),Ze(A.word,{rate:.85}))},onTouchEnd:M=>{qe()&&(M.preventDefault(),M.stopPropagation(),Ze(A.word,{rate:.85}))},title:qe()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":"",children:[e.jsxs("div",{className:`text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 break-words text-center px-4 ${A.word.includes(" ")?"phrase-text":""} ${qe()?"clickable-word":""}`,children:[A.word,qe()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"})]}),A.reading&&e.jsxs("div",{className:"question-reading text-base sm:text-lg md:text-xl text-gray-600 mt-3 text-center",children:["ã€",A.reading,"ã€‘"]}),A.difficulty&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:`difficulty-badge ${A.difficulty}`,children:A.difficulty==="beginner"?"åˆç´š":A.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("button",{onClick:()=>de("left"),className:"flex flex-col items-center justify-center py-6 px-2 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"åˆ†ã‹ã‚‰ãªã„",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âŒ"}),e.jsx("span",{className:"text-sm sm:text-base",children:"åˆ†ã‹ã‚‰ãªã„"})]}),e.jsxs("button",{onClick:()=>de("center"),className:"flex flex-col items-center justify-center py-6 px-2 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"ã¾ã ã¾ã ",children:[e.jsx("span",{className:"text-3xl mb-2",children:"ğŸ¤”"}),e.jsx("span",{className:"text-sm sm:text-base",children:"ã¾ã ã¾ã "})]}),e.jsxs("button",{onClick:()=>de("right"),className:"flex flex-col items-center justify-center py-6 px-2 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"è¦šãˆã¦ã‚‹",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âœ…"}),e.jsx("span",{className:"text-sm sm:text-base",children:"è¦šãˆã¦ã‚‹"})]})]}),n&&a&&o&&e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx(Ct,{word:{word:A.word,meaning:A.meaning,ipa:A.reading,source:"memorization"},sets:s,onAddWord:n,onRemoveWord:a,onOpenManagement:o,size:"medium",variant:"both"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>F("showMeaning"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"æ„å‘³"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showMeaning?"â–¼":"â–¶"})]}),w.showMeaning&&e.jsx("div",{className:"flex-1 text-base sm:text-lg text-gray-900 break-words",children:A.meaning})]})}),e.jsx("button",{onClick:()=>F("showPronunciation"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"èª­ã¿"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showPronunciation?"â–¼":"â–¶"})]}),w.showPronunciation&&e.jsx("div",{className:"flex-1 text-sm sm:text-base text-gray-700 break-words",children:A.reading})]})}),A.etymology&&A.etymology.trim()!==""&&A.etymology!=="ä¸­å­¦è‹±èªã§é‡è¦ãªå˜èªã§ã™ã€‚"&&e.jsx("button",{onClick:()=>F("showEtymology"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-20 sm:w-24 flex-shrink-0 text-sm sm:text-base",children:"èªæºãƒ»è§£èª¬"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showEtymology?"â–¼":"â–¶"})]}),w.showEtymology&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:A.etymology})]})}),A.relatedWords&&A.relatedWords.trim()!==""&&e.jsx("button",{onClick:()=>F("showRelated"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"é–¢é€£èª"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showRelated?"â–¼":"â–¶"})]}),w.showRelated&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:A.relatedWords})]})})]})]})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsx(ts,{mode:"memorization",sessionCorrect:Ce.correct,sessionReview:Ce.still_learning,sessionIncorrect:Ce.incorrect,totalAnswered:Ce.total,currentWord:A==null?void 0:A.word,onAnswerTime:_e,lastAnswerCorrect:Ee,lastAnswerWord:le,lastAnswerDifficulty:A==null?void 0:A.difficulty,correctStreak:Be,incorrectStreak:je,learningPhase:V.state.currentPhase??void 0,estimatedSpeed:(fe=V.state.personalParams)==null?void 0:fe.learningSpeed,onShowSettings:()=>i(!0),dataSource:c,category:m==="all"?"å…¨åˆ†é‡":m,difficulty:g,wordPhraseFilter:b,onReviewFocus:P,isReviewFocusMode:Se})})}),l&&e.jsxs("div",{className:"mb-4 bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:"ğŸ“Š å­¦ç¿’è¨­å®š"}),e.jsx("button",{onClick:()=>i(!1),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600",children:"âœ• é–‰ã˜ã‚‹"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-datasource",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ“– å‡ºé¡Œå…ƒ:"}),e.jsxs("select",{id:"memorization-datasource",value:c,onChange:M=>d(M.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å…¨å•é¡Œé›†"}),e.jsx("option",{value:"standard",children:"é«˜æ ¡å—é¨“æ¨™æº–"}),e.jsx("option",{value:"advanced",children:"é«˜æ ¡å—é¨“ä¸Šç´š"}),e.jsx("option",{value:"comprehensive",children:"é«˜æ ¡å—é¨“ç·åˆ"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-difficulty",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ“Š é›£æ˜“åº¦:"}),e.jsxs("select",{id:"memorization-difficulty",value:g,onChange:M=>S(M.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å…¨é›£æ˜“åº¦"}),e.jsx("option",{value:"beginner",children:"åˆç´š"}),e.jsx("option",{value:"intermediate",children:"ä¸­ç´š"}),e.jsx("option",{value:"advanced",children:"ä¸Šç´š"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-category",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ·ï¸ é–¢é€£åˆ†é‡:"}),e.jsxs("select",{id:"memorization-category",value:m,onChange:M=>h(M.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å…¨åˆ†é‡"}),L().map(M=>e.jsx("option",{value:M,children:M},M))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"memorization-filter",className:"block text-sm font-medium mb-2 text-gray-700",children:"ğŸ“ å˜èªãƒ»ç†Ÿèª:"}),e.jsxs("select",{id:"memorization-filter",value:b,onChange:M=>y(M.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[e.jsx("option",{value:"all",children:"å˜èªï¼‹ç†Ÿèª"}),e.jsx("option",{value:"words",children:"å˜èªã®ã¿"}),e.jsx("option",{value:"phrases",children:"ç†Ÿèªã®ã¿"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-3 text-gray-700",children:"ğŸ¯ å‡ºé¡Œç¹°ã‚Šè¿”ã—è¨­å®š:"}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"æœªå…¥åŠ›ã®å ´åˆã¯ç„¡åˆ¶é™ã«å‡ºé¡Œã—ã¾ã™ï¼ˆæ¨å¥¨ï¼šLeitnerã‚·ã‚¹ãƒ†ãƒ æ–¹å¼ï¼‰"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:v!==null,onChange:M=>{M.target.checked?(k(50),localStorage.setItem("memorization-still-learning-limit","50")):(k(null),localStorage.removeItem("memorization-still-learning-limit"))},className:"mr-2 w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"ğŸŸ¡ ã¾ã ã¾ã ã®èªæ•°ä¸Šé™ã‚’è¨­å®š"})]}),v!==null&&e.jsxs("div",{className:"ml-6",children:[e.jsx("select",{value:v,title:"ã¾ã ã¾ã ã®èªæ•°ä¸Šé™",onChange:M=>{const se=parseInt(M.target.value);k(se),localStorage.setItem("memorization-still-learning-limit",se.toString())},className:"w-full px-3 py-2 border rounded-lg bg-white",children:[5,10,20,30,50,100,150,200].map(M=>e.jsx("option",{value:M,children:M},M))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ã€å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«è‡ªå‹•ã§åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",checked:D!==null,onChange:M=>{M.target.checked?(C(30),localStorage.setItem("memorization-incorrect-limit","30")):(C(null),localStorage.removeItem("memorization-incorrect-limit"))},className:"mr-2 w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"ğŸ”´ åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™ã‚’è¨­å®š"})]}),D!==null&&e.jsxs("div",{className:"ml-6",children:[e.jsx("select",{value:D,title:"åˆ†ã‹ã‚‰ãªã„ã®èªæ•°ä¸Šé™",onChange:M=>{const se=parseInt(M.target.value);C(se),localStorage.setItem("memorization-incorrect-limit",se.toString())},className:"w-full px-3 py-2 border rounded-lg bg-white",children:[5,10,20,30,50,100,150,200].map(M=>e.jsx("option",{value:M,children:M},M))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ã“ã®æ•°ã«é”ã—ãŸã‚‰ã€å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰ã«è‡ªå‹•ã§åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™"})]})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-3 text-gray-700",children:"ğŸ”Š è‡ªå‹•ç™ºéŸ³è¨­å®š:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:$,onChange:M=>B(M.target.checked,Y,me),className:"mr-2 w-4 h-4"}),e.jsx("span",{children:"è‡ªå‹•ã§ç™ºéŸ³ã™ã‚‹"})]}),$&&e.jsxs("div",{className:"ml-6 space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:Y,onChange:M=>B($,M.target.checked,me),className:"mr-2 w-4 h-4"}),e.jsx("span",{children:"èªå¥ã‚’èª­ã¿ä¸Šã’"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:me,onChange:M=>B($,Y,M.target.checked),className:"mr-2 w-4 h-4"}),e.jsx("span",{children:"æ„å‘³ã‚’èª­ã¿ä¸Šã’"})]}),me&&e.jsxs("div",{className:"ml-6 mt-2",children:[e.jsxs("label",{className:"block text-sm text-gray-600 mb-1",children:["â±ï¸ èªå¥ã¨æ„å‘³ã®é–“éš”: ",be.toFixed(1),"ç§’"]}),e.jsx("input",{type:"range",min:"0.5",max:"5.0",step:"0.5",value:be,onChange:M=>{const se=parseFloat(M.target.value);Re(se),B($,Y,me,se)},className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer","aria-label":"èªå¥ã¨æ„å‘³ã®é–“éš”"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"0.5ç§’"}),e.jsx("span",{children:"5.0ç§’"})]})]})]})]})]})]})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full max-w-4xl",children:[e.jsx("button",{onClick:R,className:"absolute top-2 right-2 z-10 p-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300:bg-gray-600 transition shadow-md","aria-label":"å…¨ç”»é¢è¡¨ç¤º",title:"å…¨ç”»é¢è¡¨ç¤º",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsxs("div",{ref:f,className:"question-card w-full",children:[e.jsx("div",{className:"mb-8 py-8 flex flex-col items-center justify-center min-h-[200px]",children:e.jsxs("div",{className:`flex flex-col items-center ${qe()?"clickable-pronunciation":""}`,onClick:M=>{qe()&&(M.preventDefault(),M.stopPropagation(),Ze(A.word,{rate:.85}))},onTouchEnd:M=>{qe()&&(M.preventDefault(),M.stopPropagation(),Ze(A.word,{rate:.85}))},title:qe()?"ã‚¿ãƒƒãƒ—ã—ã¦ç™ºéŸ³ã‚’èã ğŸ”Š":"",children:[e.jsxs("div",{className:`text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 break-words text-center px-4 ${A.word.includes(" ")?"phrase-text":""} ${qe()?"clickable-word":""}`,children:[A.word,qe()&&e.jsx("span",{className:"speaker-icon",children:"ğŸ”Š"})]}),A.reading&&e.jsxs("div",{className:"question-reading text-base sm:text-lg md:text-xl text-gray-600 mt-3 text-center",children:["ã€",A.reading,"ã€‘"]}),A.difficulty&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:`difficulty-badge ${A.difficulty}`,children:A.difficulty==="beginner"?"åˆç´š":A.difficulty==="intermediate"?"ä¸­ç´š":"ä¸Šç´š"})})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[e.jsxs("button",{onClick:()=>de("left"),className:"flex flex-col items-center justify-center py-6 px-2 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"åˆ†ã‹ã‚‰ãªã„",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âŒ"}),e.jsx("span",{className:"text-sm sm:text-base",children:"åˆ†ã‹ã‚‰ãªã„"})]}),e.jsxs("button",{onClick:()=>de("center"),className:"flex flex-col items-center justify-center py-6 px-2 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"ã¾ã ã¾ã ",children:[e.jsx("span",{className:"text-3xl mb-2",children:"ğŸ¤”"}),e.jsx("span",{className:"text-sm sm:text-base",children:"ã¾ã ã¾ã "})]}),e.jsxs("button",{onClick:()=>de("right"),className:"flex flex-col items-center justify-center py-6 px-2 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold rounded-xl transition shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95","aria-label":"è¦šãˆã¦ã‚‹",children:[e.jsx("span",{className:"text-3xl mb-2",children:"âœ…"}),e.jsx("span",{className:"text-sm sm:text-base",children:"è¦šãˆã¦ã‚‹"})]})]}),n&&a&&o&&e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx(Ct,{word:{word:A.word,meaning:A.meaning,ipa:A.reading,source:"memorization"},sets:s,onAddWord:n,onRemoveWord:a,onOpenManagement:o,size:"medium",variant:"both"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>F("showMeaning"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"æ„å‘³"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showMeaning?"â–¼":"â–¶"})]}),w.showMeaning&&e.jsx("div",{className:"flex-1 text-base sm:text-lg text-gray-900 break-words",children:A.meaning})]})}),e.jsx("button",{onClick:()=>F("showPronunciation"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"èª­ã¿"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showPronunciation?"â–¼":"â–¶"})]}),w.showPronunciation&&e.jsx("div",{className:"flex-1 text-sm sm:text-base text-gray-700 break-words",children:A.reading})]})}),A.etymology&&A.etymology.trim()!==""&&A.etymology!=="ä¸­å­¦è‹±èªã§é‡è¦ãªå˜èªã§ã™ã€‚"&&e.jsx("button",{onClick:()=>F("showEtymology"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-20 sm:w-24 flex-shrink-0 text-sm sm:text-base",children:"èªæºãƒ»è§£èª¬"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showEtymology?"â–¼":"â–¶"})]}),w.showEtymology&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:A.etymology})]})}),A.relatedWords&&A.relatedWords.trim()!==""&&e.jsx("button",{onClick:()=>F("showRelated"),className:"w-full text-left p-4 bg-gray-50 rounded-lg hover:bg-gray-100:bg-gray-600 transition",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700 w-16 sm:w-24 flex-shrink-0",children:"é–¢é€£èª"}),e.jsx("span",{className:"text-gray-500 flex-shrink-0",children:w.showRelated?"â–¼":"â–¶"})]}),w.showRelated&&e.jsx("div",{className:"flex-1 text-xs sm:text-sm text-gray-600 break-words",children:A.relatedWords})]})})]})]})]})})]})}):null}const go=()=>{const[r,t]=u.useState("prepositions");return e.jsxs("div",{className:"grammar-guide-view p-4 max-w-app mx-auto",children:[e.jsxs("div",{className:"grammar-guide-tabs grid grid-cols-3 gap-1 sm:gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>t("prepositions"),className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${r==="prepositions"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ“ å‰ç½®è©"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ“"})]}),e.jsxs("button",{onClick:()=>t("punctuation"),className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${r==="punctuation"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"âœï¸ è¨˜å·"}),e.jsx("span",{className:"sm:hidden",children:"âœï¸"})]}),e.jsxs("button",{onClick:()=>t("tips"),className:`px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-base font-medium transition-all duration-200 rounded-t-lg border-b-2 ${r==="tips"?"bg-primary text-white border-primary":"bg-gray-200 text-gray-700 border-transparent hover:bg-gray-300"}`,children:[e.jsx("span",{className:"hidden sm:inline",children:"ğŸ’¡ èª­è§£ã‚³ãƒ„"}),e.jsx("span",{className:"sm:hidden",children:"ğŸ’¡"})]})]}),e.jsxs("div",{className:"content-area bg-white rounded-lg p-4 shadow-md border border-gray-200",children:[r==="prepositions"&&e.jsx(po,{}),r==="punctuation"&&e.jsx(fo,{}),r==="tips"&&e.jsx(xo,{})]})]})},po=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-color mb-4",children:"å‰ç½®è©ã®ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã¨ä½¿ã„åˆ†ã‘"}),e.jsx("p",{className:"text-text-secondary mb-6",children:"è‹±èªã§æœ€ã‚‚é »ç¹ã«ä½¿ã†å‰ç½®è©ã‚’é‡è¦åº¦é †ã«ç´¹ä»‹ã—ã¾ã™ã€‚ãã‚Œãã‚Œã®ã‚³ã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€è‡ªç„¶ãªè‹±èªè¡¨ç¾ãŒèº«ã«ã¤ãã¾ã™ã€‚"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸŒŸ æœ€é‡è¦ï¼šæ™‚é–“ãƒ»å ´æ‰€ã®åŸºæœ¬3ã¤"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50/20 rounded-lg p-5 border-2 border-blue-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“¦"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:"IN"}),e.jsx("div",{className:"text-sm text-blue-700 mt-1",children:"ã€Œå›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸ“… ",e.jsx("strong",{children:"in 2024"})," â†’ å¹´ã¨ã„ã†é•·ã„æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ—“ï¸ ",e.jsx("strong",{children:"in May"})," â†’ æœˆã¨ã„ã†æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ… ",e.jsx("strong",{children:"in the morning"})," â†’ åˆå‰ã¨ã„ã†æ™‚é–“å¸¯ã®ä¸­"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ ",e.jsx("strong",{children:"in Japan"})," â†’ å›½ã¨ã„ã†åºƒã„ç©ºé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ  ",e.jsx("strong",{children:"in the room"})," â†’ éƒ¨å±‹ã¨ã„ã†å›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-5 border-2 border-green-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“„"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 mt-2",children:"ON"}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"ã€Œæ¥è§¦ãƒ»ãã£ã¤ã„ã¦ã„ã‚‹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸ“† ",e.jsx("strong",{children:"on Monday"})," â†’ æ›œæ—¥ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ“… ",e.jsx("strong",{children:"on May 1st"})," â†’ æ—¥ä»˜ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ„ ",e.jsx("strong",{children:"on Christmas"})," â†’ ãã®æ—¥ã«æ¥è§¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸª‘ ",e.jsx("strong",{children:"on the table"})," â†’ ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨é¢ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ–¼ï¸ ",e.jsx("strong",{children:"on the wall"})," â†’ å£é¢ã«æ¥è§¦"]})]})]})]})]}),e.jsxs("div",{className:"bg-orange-50/20 rounded-lg p-5 border-2 border-orange-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600 mt-2",children:"AT"}),e.jsx("div",{className:"text-sm text-orange-700 mt-1",children:"ã€Œãƒ”ãƒ³ãƒã‚¤ãƒ³ãƒˆãƒ»åœ°ç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ•– ",e.jsx("strong",{children:"at 7:00"})," â†’ 7æ™‚ã¨ã„ã†æ™‚åˆ»ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["â˜€ï¸ ",e.jsx("strong",{children:"at noon"})," â†’ æ­£åˆã¨ã„ã†ç¬é–“ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"at night"})," â†’ å¤œã¨ã„ã†æ™‚ç‚¹"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ« ",e.jsx("strong",{children:"at school"})," â†’ å­¦æ ¡ã¨ã„ã†åœ°ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸšª ",e.jsx("strong",{children:"at the door"})," â†’ ãƒ‰ã‚¢ã¨ã„ã†åœ°ç‚¹"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"â­ ãã®ä»–ã®é‡è¦ãªå‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50/20 rounded-lg p-5 border-2 border-blue-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“¦"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:"IN"}),e.jsx("div",{className:"text-sm text-blue-700 mt-1",children:"ã€Œå›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸ“… ",e.jsx("strong",{children:"in 2024"})," â†’ å¹´ã¨ã„ã†é•·ã„æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ—“ï¸ ",e.jsx("strong",{children:"in May"})," â†’ æœˆã¨ã„ã†æœŸé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ… ",e.jsx("strong",{children:"in the morning"})," â†’ åˆå‰ã¨ã„ã†æ™‚é–“å¸¯ã®ä¸­"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸŒ ",e.jsx("strong",{children:"in Japan"})," â†’ å›½ã¨ã„ã†åºƒã„ç©ºé–“ã®ä¸­"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ  ",e.jsx("strong",{children:"in the room"})," â†’ éƒ¨å±‹ã¨ã„ã†å›²ã¾ã‚ŒãŸç©ºé–“ã®ä¸­"]})]})]})]})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-5 border-2 border-green-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“„"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 mt-2",children:"ON"}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"ã€Œæ¥è§¦ãƒ»ãã£ã¤ã„ã¦ã„ã‚‹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸ“† ",e.jsx("strong",{children:"on Monday"})," â†’ æ›œæ—¥ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ“… ",e.jsx("strong",{children:"on May 1st"})," â†’ æ—¥ä»˜ã¨ã„ã†ç‰¹å®šã®æ—¥ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ„ ",e.jsx("strong",{children:"on Christmas"})," â†’ ãã®æ—¥ã«æ¥è§¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸª‘ ",e.jsx("strong",{children:"on the table"})," â†’ ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨é¢ã«æ¥è§¦"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ–¼ï¸ ",e.jsx("strong",{children:"on the wall"})," â†’ å£é¢ã«æ¥è§¦"]})]})]})]})]}),e.jsxs("div",{className:"bg-orange-50/20 rounded-lg p-5 border-2 border-orange-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600 mt-2",children:"AT"}),e.jsx("div",{className:"text-sm text-orange-700 mt-1",children:"ã€Œãƒ”ãƒ³ãƒã‚¤ãƒ³ãƒˆãƒ»åœ°ç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ•– ",e.jsx("strong",{children:"at 7:00"})," â†’ 7æ™‚ã¨ã„ã†æ™‚åˆ»ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["â˜€ï¸ ",e.jsx("strong",{children:"at noon"})," â†’ æ­£åˆã¨ã„ã†ç¬é–“ã®ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"at night"})," â†’ å¤œã¨ã„ã†æ™‚ç‚¹"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ—ºï¸"})," å ´æ‰€ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸ« ",e.jsx("strong",{children:"at school"})," â†’ å­¦æ ¡ã¨ã„ã†åœ°ç‚¹"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸšª ",e.jsx("strong",{children:"at the door"})," â†’ ãƒ‰ã‚¢ã¨ã„ã†åœ°ç‚¹"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"â­ ãã®ä»–ã®é‡è¦ãªå‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-pink-50/20 rounded-lg p-5 border-2 border-pink-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â¡ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-pink-600 mt-2",children:"TO"}),e.jsx("div",{className:"text-sm text-pink-700 mt-1",children:"ã€Œæ–¹å‘ãƒ»åˆ°é”ç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-pink-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ§­"})," æ–¹å‘ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-pink-600",children:["ğŸ« ",e.jsx("strong",{children:"to school"})," â†’ å­¦æ ¡ã¸ï¼ˆæ–¹å‘ï¼‰"]}),e.jsxs("div",{className:"text-pink-600",children:["ğŸ—¼ ",e.jsx("strong",{children:"to Tokyo"})," â†’ æ±äº¬ã¸ï¼ˆç›®çš„åœ°ï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-pink-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”„"})," ç¯„å›²ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-pink-600",children:["ğŸ“Š ",e.jsx("strong",{children:"from A to B"})," â†’ Aã‹ã‚‰Bã¾ã§ï¼ˆç¯„å›²ï¼‰"]}),e.jsxs("div",{className:"text-pink-600",children:["ğŸ• ",e.jsx("strong",{children:"from 9 to 5"})," â†’ 9æ™‚ã‹ã‚‰5æ™‚ã¾ã§"]})]})]})]})]}),e.jsxs("div",{className:"bg-purple-50/20 rounded-lg p-5 border-2 border-purple-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¯"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600 mt-2",children:"FOR"}),e.jsx("div",{className:"text-sm text-purple-700 mt-1",children:"ã€Œç›®çš„ãƒ»å¯¾è±¡ãƒ»æœŸé–“ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ’"})," ç›®çš„ãƒ»å¯¾è±¡ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-purple-600",children:["ğŸ‘¤ ",e.jsx("strong",{children:"for you"})," â†’ ã‚ãªãŸã®ãŸã‚ã«ï¼ˆå¯¾è±¡ï¼‰"]}),e.jsxs("div",{className:"text-purple-600",children:["ğŸ³ ",e.jsx("strong",{children:"for breakfast"})," â†’ æœé£Ÿã¨ã—ã¦ï¼ˆç›®çš„ï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â±ï¸"})," æœŸé–“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-purple-600",children:["â° ",e.jsx("strong",{children:"for 3 hours"})," â†’ 3æ™‚é–“ï¼ˆç¶™ç¶šæœŸé–“ï¼‰"]}),e.jsxs("div",{className:"text-purple-600",children:["ğŸ“… ",e.jsx("strong",{children:"for a week"})," â†’ 1é€±é–“ï¼ˆç¶™ç¶šæœŸé–“ï¼‰"]})]})]})]})]}),e.jsxs("div",{className:"bg-teal-50/20 rounded-lg p-5 border-2 border-teal-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¬"}),e.jsx("div",{className:"text-2xl font-bold text-teal-600 mt-2",children:"FROM"}),e.jsx("div",{className:"text-sm text-teal-700 mt-1",children:"ã€Œèµ·ç‚¹ãƒ»å‡ºç™ºç‚¹ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-teal-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," èµ·ç‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-teal-600",children:["ğŸ  ",e.jsx("strong",{children:"from home"})," â†’ å®¶ã‹ã‚‰ï¼ˆå‡ºç™ºç‚¹ï¼‰"]}),e.jsxs("div",{className:"text-teal-600",children:["ğŸ‡¯ğŸ‡µ ",e.jsx("strong",{children:"from Japan"})," â†’ æ—¥æœ¬ã‹ã‚‰ï¼ˆå‡ºèº«ï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-teal-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ•"})," æ™‚é–“ã®èµ·ç‚¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-teal-600",children:["â° ",e.jsx("strong",{children:"from 9 am"})," â†’ 9æ™‚ã‹ã‚‰ï¼ˆé–‹å§‹æ™‚åˆ»ï¼‰"]}),e.jsxs("div",{className:"text-teal-600",children:["ğŸ“… ",e.jsx("strong",{children:"from Monday"})," â†’ æœˆæ›œæ—¥ã‹ã‚‰"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸ“Œ ã‚ˆãä½¿ã†å‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-indigo-50/20 rounded-lg p-5 border-2 border-indigo-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¤"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600 mt-2",children:"WITH"}),e.jsx("div",{className:"text-sm text-indigo-700 mt-1",children:"ã€Œä¸€ç·’ã«ãƒ»ä½¿ã£ã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-indigo-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ‘¥"})," ä¼´ã†ç›¸æ‰‹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-indigo-600",children:["ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ",e.jsx("strong",{children:"with my family"})," â†’ å®¶æ—ã¨ä¸€ç·’ã«"]}),e.jsxs("div",{className:"text-indigo-600",children:["ğŸ§‘â€ğŸ¤â€ğŸ§‘ ",e.jsx("strong",{children:"with friends"})," â†’ å‹é”ã¨"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-indigo-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ› ï¸"})," ä½¿ã†é“å…·ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-indigo-600",children:["âœï¸ ",e.jsx("strong",{children:"with a pen"})," â†’ ãƒšãƒ³ã§ï¼ˆé“å…·ï¼‰"]}),e.jsxs("div",{className:"text-indigo-600",children:["ğŸ´ ",e.jsx("strong",{children:"with chopsticks"})," â†’ ç®¸ã§"]})]})]})]})]}),e.jsxs("div",{className:"bg-amber-50/20 rounded-lg p-5 border-2 border-amber-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸš—"}),e.jsx("div",{className:"text-2xl font-bold text-amber-600 mt-2",children:"BY"}),e.jsx("div",{className:"text-sm text-amber-700 mt-1",children:"ã€Œã€œã®ãã°ã«ãƒ»æ‰‹æ®µã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-amber-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸšŒ"})," æ‰‹æ®µãƒ»æ–¹æ³•ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-amber-600",children:["ğŸš† ",e.jsx("strong",{children:"by train"})," â†’ é›»è»Šã§ï¼ˆäº¤é€šæ‰‹æ®µï¼‰"]}),e.jsxs("div",{className:"text-amber-600",children:["âœ‰ï¸ ",e.jsx("strong",{children:"by email"})," â†’ ãƒ¡ãƒ¼ãƒ«ã§ï¼ˆé€šä¿¡æ‰‹æ®µï¼‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-amber-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," ãã°ã«ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-amber-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"by the sea"})," â†’ æµ·ã®ãã°ã«"]}),e.jsxs("div",{className:"text-amber-600",children:["ğŸªŸ ",e.jsx("strong",{children:"by the window"})," â†’ çª“ã®ãã°ã«"]})]})]})]})]}),e.jsxs("div",{className:"bg-rose-50/20 rounded-lg p-5 border-2 border-rose-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ”—"}),e.jsx("div",{className:"text-2xl font-bold text-rose-600 mt-2",children:"OF"}),e.jsx("div",{className:"text-sm text-rose-700 mt-1",children:"ã€Œã€œã®ï¼ˆæ‰€å±ãƒ»éƒ¨åˆ†ï¼‰ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-rose-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ‘‘"})," æ‰€å±ãƒ»æ‰€æœ‰ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-rose-600",children:["ğŸ“š ",e.jsx("strong",{children:"the book of mine"})," â†’ ç§ã®æœ¬"]}),e.jsxs("div",{className:"text-rose-600",children:["ğŸ›ï¸ ",e.jsx("strong",{children:"the capital of Japan"})," â†’ æ—¥æœ¬ã®é¦–éƒ½"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-rose-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ§©"})," éƒ¨åˆ†ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-rose-600",children:["ğŸ° ",e.jsx("strong",{children:"a piece of cake"})," â†’ ã‚±ãƒ¼ã‚­ä¸€åˆ‡ã‚Œ"]}),e.jsxs("div",{className:"text-rose-600",children:["ğŸ’§ ",e.jsx("strong",{children:"a glass of water"})," â†’ ã‚³ãƒƒãƒ—ä¸€æ¯ã®æ°´"]})]})]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸ’« ä¸­é »åº¦ã®å‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-cyan-50/20 rounded-lg p-5 border-2 border-cyan-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ’­"}),e.jsx("div",{className:"text-2xl font-bold text-cyan-600 mt-2",children:"ABOUT"}),e.jsx("div",{className:"text-sm text-cyan-700 mt-1",children:"ã€Œã€œã«ã¤ã„ã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-cyan-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“–"})," è©±é¡Œãƒ»å†…å®¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-cyan-600",children:["ğŸ“š ",e.jsx("strong",{children:"a book about history"})," â†’ æ­´å²ã«ã¤ã„ã¦ã®æœ¬"]}),e.jsxs("div",{className:"text-cyan-600",children:["ğŸ’¬ ",e.jsx("strong",{children:"talk about sports"})," â†’ ã‚¹ãƒãƒ¼ãƒ„ã«ã¤ã„ã¦è©±ã™"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-cyan-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”¢"})," ãŠãŠã‚ˆãã®æ•°ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-cyan-600",children:["â° ",e.jsx("strong",{children:"about 10 minutes"})," â†’ ç´„10åˆ†"]}),e.jsxs("div",{className:"text-cyan-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"about 50 people"})," â†’ ç´„50äºº"]})]})]})]})]}),e.jsxs("div",{className:"bg-lime-50/20 rounded-lg p-5 border-2 border-lime-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â­ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-lime-600 mt-2",children:"AFTER"}),e.jsx("div",{className:"text-sm text-lime-700 mt-1",children:"ã€Œã€œã®å¾Œã«ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-lime-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®å¾Œï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-lime-600",children:["ğŸ½ï¸ ",e.jsx("strong",{children:"after dinner"})," â†’ å¤•é£Ÿã®å¾Œ"]}),e.jsxs("div",{className:"text-lime-600",children:["ğŸ« ",e.jsx("strong",{children:"after school"})," â†’ æ”¾èª²å¾Œ"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-lime-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," é †åºï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-lime-600",children:["ğŸ”¤ ",e.jsx("strong",{children:"after you"})," â†’ ãŠå…ˆã«ã©ã†ã"]}),e.jsxs("div",{className:"text-lime-600",children:["ğŸ“ ",e.jsx("strong",{children:"one after another"})," â†’ æ¬¡ã€…ã«"]})]})]})]})]}),e.jsxs("div",{className:"bg-sky-50/20 rounded-lg p-5 border-2 border-sky-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â®ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-sky-600 mt-2",children:"BEFORE"}),e.jsx("div",{className:"text-sm text-sky-700 mt-1",children:"ã€Œã€œã®å‰ã«ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-sky-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æ™‚é–“ã®å‰ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-sky-600",children:["ğŸ½ï¸ ",e.jsx("strong",{children:"before breakfast"})," â†’ æœé£Ÿå‰"]}),e.jsxs("div",{className:"text-sky-600",children:["ğŸ„ ",e.jsx("strong",{children:"before Christmas"})," â†’ ã‚¯ãƒªã‚¹ãƒã‚¹ã®å‰"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-sky-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," é †åºãƒ»ä½ç½®ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-sky-600",children:["ğŸšª ",e.jsx("strong",{children:"before the door"})," â†’ ãƒ‰ã‚¢ã®å‰"]}),e.jsxs("div",{className:"text-sky-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"before everyone"})," â†’ ã¿ã‚“ãªã®å‰ã§"]})]})]})]})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-violet-50/20 rounded-lg p-5 border-2 border-violet-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸŒ‰"}),e.jsx("div",{className:"text-2xl font-bold text-violet-600 mt-2",children:"OVER"}),e.jsx("div",{className:"text-sm text-violet-700 mt-1",children:"ã€Œã€œã®ä¸Šã‚’è¶Šãˆã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-violet-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ¦…"})," ä¸Šæ–¹ãƒ»è¶Šãˆã‚‹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-violet-600",children:["ğŸŒ‰ ",e.jsx("strong",{children:"over the bridge"})," â†’ æ©‹ã‚’è¶Šãˆã¦"]}),e.jsxs("div",{className:"text-violet-600",children:["ğŸ”ï¸ ",e.jsx("strong",{children:"over the mountain"})," â†’ å±±ã‚’è¶Šãˆã¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-violet-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”¢"})," ä»¥ä¸Šãƒ»è¶…éï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-violet-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"over 100 people"})," â†’ 100äººä»¥ä¸Š"]}),e.jsxs("div",{className:"text-violet-600",children:["ğŸ’° ",e.jsx("strong",{children:"over $50"})," â†’ 50ãƒ‰ãƒ«ä»¥ä¸Š"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50/20 rounded-lg p-5 border-2 border-slate-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â¬‡ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-slate-600 mt-2",children:"UNDER"}),e.jsx("div",{className:"text-sm text-slate-700 mt-1",children:"ã€Œã€œã®ä¸‹ã«ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-slate-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â¬‡ï¸"})," ä¸‹æ–¹ãƒ»ä¸‹å´ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-slate-600",children:["ğŸŒ³ ",e.jsx("strong",{children:"under the tree"})," â†’ æœ¨ã®ä¸‹ã«"]}),e.jsxs("div",{className:"text-slate-600",children:["ğŸŒ‰ ",e.jsx("strong",{children:"under the bridge"})," â†’ æ©‹ã®ä¸‹ã«"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-slate-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”¢"})," æœªæº€ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-slate-600",children:["ğŸ‘¶ ",e.jsx("strong",{children:"under 18"})," â†’ 18æ­³æœªæº€"]}),e.jsxs("div",{className:"text-slate-600",children:["ğŸ’° ",e.jsx("strong",{children:"under $10"})," â†’ 10ãƒ‰ãƒ«æœªæº€"]})]})]})]})]}),e.jsxs("div",{className:"bg-fuchsia-50/20 rounded-lg p-5 border-2 border-fuchsia-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸš‡"}),e.jsx("div",{className:"text-2xl font-bold text-fuchsia-600 mt-2",children:"THROUGH"}),e.jsx("div",{className:"text-sm text-fuchsia-700 mt-1",children:"ã€Œã€œã‚’é€šã£ã¦ã€"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-fuchsia-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸšª"})," é€šéãƒ»è²«é€šï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸªŸ ",e.jsx("strong",{children:"through the window"})," â†’ çª“ã‚’é€šã£ã¦"]}),e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸŒ² ",e.jsx("strong",{children:"through the forest"})," â†’ æ£®ã‚’æŠœã‘ã¦"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-fuchsia-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â°"})," æœŸé–“å…¨ä½“ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"through the night"})," â†’ ä¸€æ™©ä¸­"]}),e.jsxs("div",{className:"text-fuchsia-600",children:["ğŸŒ§ï¸ ",e.jsx("strong",{children:"through the winter"})," â†’ å†¬ã®é–“ãšã£ã¨"]})]})]})]})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"âœ¨ çŸ¥ã£ã¦ãŠãã¨ä¾¿åˆ©ãªå‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-emerald-50/20 rounded-lg p-5 border-2 border-emerald-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â†”ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600 mt-2",children:"BETWEEN"}),e.jsx("div",{className:"text-sm text-emerald-700 mt-1",children:"ã€Œã€œã®é–“ã«ï¼ˆ2ã¤ï¼‰ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-emerald-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“"})," 2ã¤ã®é–“ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-emerald-600",children:["ğŸ«ğŸ¥ ",e.jsx("strong",{children:"between the school and hospital"})," â†’ å­¦æ ¡ã¨ç—…é™¢ã®é–“"]}),e.jsxs("div",{className:"text-emerald-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"between you and me"})," â†’ ã‚ãªãŸã¨ç§ã®é–“ã§"]})]})]})})]}),e.jsxs("div",{className:"bg-orange-50/20 rounded-lg p-5 border-2 border-orange-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ‘¥"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600 mt-2",children:"AMONG"}),e.jsx("div",{className:"text-sm text-orange-700 mt-1",children:"ã€Œã€œã®é–“ã«ï¼ˆ3ã¤ä»¥ä¸Šï¼‰ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-orange-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦"})," è¤‡æ•°ã®ä¸­ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-orange-600",children:["ğŸŒ¸ ",e.jsx("strong",{children:"among the flowers"})," â†’ èŠ±ã€…ã®ä¸­ã«"]}),e.jsxs("div",{className:"text-orange-600",children:["ğŸ‘¥ ",e.jsx("strong",{children:"among friends"})," â†’ å‹äººãŸã¡ã®é–“ã§"]})]})]})})]}),e.jsxs("div",{className:"bg-red-50/20 rounded-lg p-5 border-2 border-red-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸš«"}),e.jsx("div",{className:"text-2xl font-bold text-red-600 mt-2",children:"WITHOUT"}),e.jsx("div",{className:"text-sm text-red-700 mt-1",children:"ã€Œã€œãªã—ã§ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-red-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"âŒ"})," æ¬ å¦‚ãƒ»ä¸åœ¨ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-red-600",children:["ğŸ’§ ",e.jsx("strong",{children:"without water"})," â†’ æ°´ãªã—ã§"]}),e.jsxs("div",{className:"text-red-600",children:["ğŸ‘¤ ",e.jsx("strong",{children:"without you"})," â†’ ã‚ãªãŸãªã—ã§"]})]})]})})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-yellow-50/20 rounded-lg p-5 border-2 border-yellow-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â³"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600 mt-2",children:"DURING"}),e.jsx("div",{className:"text-sm text-yellow-700 mt-1",children:"ã€Œã€œã®é–“ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-yellow-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“…"})," æœŸé–“ä¸­ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-yellow-600",children:["ğŸŒ´ ",e.jsx("strong",{children:"during summer vacation"})," â†’ å¤ä¼‘ã¿ã®é–“"]}),e.jsxs("div",{className:"text-yellow-600",children:["ğŸ¥ ",e.jsx("strong",{children:"during the movie"})," â†’ æ˜ ç”»ã®é–“"]})]})]})})]}),e.jsxs("div",{className:"bg-teal-50/20 rounded-lg p-5 border-2 border-teal-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"â°"}),e.jsx("div",{className:"text-2xl font-bold text-teal-600 mt-2",children:"UNTIL/TILL"}),e.jsx("div",{className:"text-sm text-teal-700 mt-1",children:"ã€Œã€œã¾ã§ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-teal-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ•"})," ç¶™ç¶šã®çµ‚ç‚¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-teal-600",children:["ğŸŒ™ ",e.jsx("strong",{children:"until midnight"})," â†’ çœŸå¤œä¸­ã¾ã§"]}),e.jsxs("div",{className:"text-teal-600",children:["ğŸ“… ",e.jsx("strong",{children:"until next week"})," â†’ æ¥é€±ã¾ã§"]})]})]})})]}),e.jsxs("div",{className:"bg-blue-50/20 rounded-lg p-5 border-2 border-blue-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“†"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-2",children:"SINCE"}),e.jsx("div",{className:"text-sm text-blue-700 mt-1",children:"ã€Œã€œä»¥æ¥ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-blue-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“…"})," èµ·ç‚¹ã‹ã‚‰ç¶™ç¶šï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-blue-600",children:["ğŸ‚ ",e.jsx("strong",{children:"since last year"})," â†’ å»å¹´ã‹ã‚‰ï¼ˆãšã£ã¨ï¼‰"]}),e.jsxs("div",{className:"text-blue-600",children:["ğŸ‘¶ ",e.jsx("strong",{children:"since childhood"})," â†’ å­ä¾›ã®é ƒã‹ã‚‰"]})]})]})})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary",children:"ğŸ  å ´æ‰€ã‚’è¡¨ã™å‰ç½®è©"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-purple-50/20 rounded-lg p-5 border-2 border-purple-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ¢"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600 mt-2",children:"INSIDE"}),e.jsx("div",{className:"text-sm text-purple-700 mt-1",children:"ã€Œã€œã®å†…å´ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-purple-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“¦"})," å†…å´ãƒ»å†…éƒ¨ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-purple-600",children:["ğŸ  ",e.jsx("strong",{children:"inside the house"})," â†’ å®¶ã®ä¸­ã«"]}),e.jsxs("div",{className:"text-purple-600",children:["ğŸ“¦ ",e.jsx("strong",{children:"inside the box"})," â†’ ç®±ã®ä¸­ã«"]})]})]})})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-5 border-2 border-green-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸŒ³"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 mt-2",children:"OUTSIDE"}),e.jsx("div",{className:"text-sm text-green-700 mt-1",children:"ã€Œã€œã®å¤–å´ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-green-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸŒ²"})," å¤–å´ãƒ»å¤–éƒ¨ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-green-600",children:["ğŸ¡ ",e.jsx("strong",{children:"outside the house"})," â†’ å®¶ã®å¤–ã«"]}),e.jsxs("div",{className:"text-green-600",children:["ğŸ« ",e.jsx("strong",{children:"outside the school"})," â†’ å­¦æ ¡ã®å¤–ã«"]})]})]})})]}),e.jsxs("div",{className:"bg-cyan-50/20 rounded-lg p-5 border-2 border-cyan-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ“"}),e.jsx("div",{className:"text-2xl font-bold text-cyan-600 mt-2",children:"NEAR"}),e.jsx("div",{className:"text-sm text-cyan-700 mt-1",children:"ã€Œã€œã®è¿‘ãã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-cyan-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ¯"})," è¿‘æ¥ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-cyan-600",children:["ğŸš‰ ",e.jsx("strong",{children:"near the station"})," â†’ é§…ã®è¿‘ãã«"]}),e.jsxs("div",{className:"text-cyan-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"near the sea"})," â†’ æµ·ã®è¿‘ãã«"]})]})]})})]})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-indigo-50/20 rounded-lg p-5 border-2 border-indigo-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ‘¤"}),e.jsx("div",{className:"text-2xl font-bold text-indigo-600 mt-2",children:"BEHIND"}),e.jsx("div",{className:"text-sm text-indigo-700 mt-1",children:"ã€Œã€œã®å¾Œã‚ã«ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-indigo-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â¬…ï¸"})," å¾Œæ–¹ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-indigo-600",children:["ğŸšª ",e.jsx("strong",{children:"behind the door"})," â†’ ãƒ‰ã‚¢ã®å¾Œã‚ã«"]}),e.jsxs("div",{className:"text-indigo-600",children:["ğŸ  ",e.jsx("strong",{children:"behind the house"})," â†’ å®¶ã®è£ã«"]})]})]})})]}),e.jsxs("div",{className:"bg-pink-50/20 rounded-lg p-5 border-2 border-pink-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸŒ‰"}),e.jsx("div",{className:"text-2xl font-bold text-pink-600 mt-2",children:"ACROSS"}),e.jsx("div",{className:"text-sm text-pink-700 mt-1",children:"ã€Œã€œã‚’æ¨ªåˆ‡ã£ã¦ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-pink-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â†”ï¸"})," æ¨ªæ–­ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-pink-600",children:["ğŸ›£ï¸ ",e.jsx("strong",{children:"across the street"})," â†’ é€šã‚Šã‚’æ¨ªåˆ‡ã£ã¦"]}),e.jsxs("div",{className:"text-pink-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"across the river"})," â†’ å·ã‚’æ¸¡ã£ã¦"]})]})]})})]}),e.jsxs("div",{className:"bg-lime-50/20 rounded-lg p-5 border-2 border-lime-500",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("span",{className:"text-5xl",children:"ğŸ›¤ï¸"}),e.jsx("div",{className:"text-2xl font-bold text-lime-600 mt-2",children:"ALONG"}),e.jsx("div",{className:"text-sm text-lime-700 mt-1",children:"ã€Œã€œã«æ²¿ã£ã¦ã€"})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-lime-800 mb-2 flex items-center gap-2",children:[e.jsx("span",{children:"â¡ï¸"})," æ²¿ã£ã¦é€²ã‚€ï¼š"]}),e.jsxs("div",{className:"bg-white rounded p-2 text-sm space-y-1",children:[e.jsxs("div",{className:"text-lime-600",children:["ğŸ›£ï¸ ",e.jsx("strong",{children:"along the street"})," â†’ é€šã‚Šã«æ²¿ã£ã¦"]}),e.jsxs("div",{className:"text-lime-600",children:["ğŸŒŠ ",e.jsx("strong",{children:"along the river"})," â†’ å·æ²¿ã„ã«"]})]})]})})]})]})})]}),fo=()=>{const r=[{symbol:".",name:"Period (ãƒ”ãƒªã‚ªãƒ‰)",usage:"æ–‡ã®çµ‚ã‚ã‚Š",example:"I like cats.",explanation:"å¹³å™æ–‡ãƒ»å‘½ä»¤æ–‡ã®çµ‚ã‚ã‚Šã‚’ç¤ºã™"},{symbol:",",name:"Comma (ã‚³ãƒ³ãƒ)",usage:"åŒºåˆ‡ã‚Šãƒ»åˆ—æŒ™",example:"I bought apples, oranges, and bananas.",explanation:"å˜èªã‚„å¥ã‚’åŒºåˆ‡ã‚‹ã€‚æ¥ç¶šè©ã®å‰ã«ã‚‚ä½¿ç”¨"},{symbol:"!",name:"Exclamation Mark (æ„Ÿå˜†ç¬¦)",usage:"æ„Ÿå˜†ãƒ»å¼·èª¿",example:"What a beautiful day!",explanation:"é©šããƒ»å–œã³ãƒ»å¼·ã„æ„Ÿæƒ…ã‚’è¡¨ã™"},{symbol:"?",name:"Question Mark (ç–‘å•ç¬¦)",usage:"ç–‘å•",example:"Do you like music?",explanation:"ç–‘å•æ–‡ã®çµ‚ã‚ã‚Šã‚’ç¤ºã™"},{symbol:":",name:"Colon (ã‚³ãƒ­ãƒ³)",usage:"èª¬æ˜ãƒ»ä¾‹ç¤ºã®å°å…¥",example:"I have three pets: a dog, a cat, and a bird.",explanation:"å¾Œã‚ã«èª¬æ˜ã‚„åˆ—æŒ™ãŒç¶šãã“ã¨ã‚’ç¤ºã™"},{symbol:";",name:"Semicolon (ã‚»ãƒŸã‚³ãƒ­ãƒ³)",usage:"é–¢é€£ã™ã‚‹æ–‡ã®åŒºåˆ‡ã‚Š",example:"I love reading; my sister prefers sports.",explanation:"ãƒ”ãƒªã‚ªãƒ‰ã‚ˆã‚Šå¼±ãã€ã‚³ãƒ³ãƒã‚ˆã‚Šå¼·ã„åŒºåˆ‡ã‚Š"},{symbol:"-",name:"Hyphen (ãƒã‚¤ãƒ•ãƒ³)",usage:"è¤‡åˆèªãƒ»è£œè¶³",example:"a well-known writer",explanation:"2ã¤ä»¥ä¸Šã®å˜èªã‚’ç¹‹ã’ã‚‹"},{symbol:"â€”",name:"Em Dash (ãƒ€ãƒƒã‚·ãƒ¥)",usage:"å¼·ã„åŒºåˆ‡ã‚Šãƒ»æŒ¿å…¥",example:"My friendsâ€”John and Maryâ€”are coming.",explanation:"è£œè¶³æƒ…å ±ã‚’æŒ¿å…¥ã™ã‚‹"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-color mb-4",children:"è‹±æ–‡è¨˜å·ã®æ„å‘³ã¨ä½¿ã„æ–¹"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((t,s)=>e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-5 hover:shadow-lg transition-shadow border border-border-color",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-3",children:[e.jsx("div",{className:"text-5xl font-bold text-primary flex-shrink-0",children:t.symbol}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-text-color",children:t.name}),e.jsx("p",{className:"text-sm text-primary font-semibold",children:t.usage})]})]}),e.jsx("div",{className:"bg-blue-50/20 rounded p-3 mb-3",children:e.jsx("div",{className:"font-mono text-sm text-blue-600",children:t.example})}),e.jsx("p",{className:"text-sm text-text-secondary",children:t.explanation})]},s))})]})},xo=()=>{const r=[{icon:"ğŸ“",title:"æœ€åˆã«æ³¨é‡ˆã¨è¨­å•ã‚’ç¢ºèª",description:"æœ¬æ–‡ã‚’èª­ã‚€å‰ã«ã€æ³¨é‡ˆã¨å•é¡Œã‹ã‚‰é‡è¦ãªæ‰‹ãŒã‹ã‚Šã‚’å¾—ã‚‹",details:["æ³¨é‡ˆã¯å˜ã«é›£ã—ã„å˜èªã®æ„å‘³ã§ã¯ãªãã€å†…å®¹ç†è§£ã®ã‚«ã‚®","æ³¨é‡ˆã®å˜èªã‚’é€£æƒ³ã™ã‚‹ã¨é•·æ–‡ã®ã‚ã‚‰ã™ã˜ãŒè¦‹ãˆã¦ãã‚‹","ç­†è€…ã®ä¸»å¼µã‚„å¤§æ„ã‚’å•ã†è¨­å•ã‹ã‚‰ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’æ‹¾ã†","éƒ¨åˆ†çš„ãªé¸æŠå•é¡Œã®é¸æŠè‚¢ã«ã‚‚å…±é€šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒéš ã‚Œã¦ã„ã‚‹"]},{icon:"ğŸ¯",title:"ã‚¿ã‚¤ãƒˆãƒ«ã¨ç¬¬1æ®µè½ã§å…¨ä½“åƒã‚’æ´ã‚€",description:"è‹±èªã®æ–‡ç« ã¯ã€Œçµè«–å…ˆå‡ºã—ã€ãŒåŸºæœ¬ã€‚æœ€åˆã«å…¨ä½“ã®æ–¹å‘æ€§ãŒç¤ºã•ã‚Œã‚‹",example:{title:"The Importance of Reading Books",para1:"Reading books is one of the best ways to improve your knowledge and imagination. Many people think that reading is boring, but it actually helps you learn new things and understand the world better.",explanation:`ã‚¿ã‚¤ãƒˆãƒ«: ã€Œæœ¬ã‚’èª­ã‚€é‡è¦æ€§ã€â†’ ãƒ†ãƒ¼ãƒç¢ºå®š
ç¬¬1æ®µè½: ã€Œæœ¬ã‚’èª­ã‚€ã“ã¨ã¯çŸ¥è­˜ã¨æƒ³åƒåŠ›ã‚’é«˜ã‚ã‚‹æœ€è‰¯ã®æ–¹æ³•ã®1ã¤ã€â†’ ç­†è€…ã®ä¸»å¼µ
â†’ ã“ã®æ™‚ç‚¹ã§ã€Œæœ¬ã‚’èª­ã‚€ã“ã¨ã®è‰¯ã„ç‚¹ã«ã¤ã„ã¦è¿°ã¹ã‚‹æ–‡ç« ã€ã ã¨åˆ†ã‹ã‚‹`},details:["ã‚¿ã‚¤ãƒˆãƒ« â†’ è©±é¡Œï¼ˆãƒˆãƒ”ãƒƒã‚¯ï¼‰ã‚’ç¤ºã™","ç¬¬1æ®µè½ â†’ ç­†è€…ã®ç«‹å ´ãƒ»ä¸»å¼µã‚’æ˜ç¢ºã«ã™ã‚‹","ã€Œä½•ã«ã¤ã„ã¦ã€ã€Œã©ã†è€ƒãˆã¦ã„ã‚‹ã‹ã€ã‚’ãƒ¡ãƒ¢ã™ã‚‹ã¨æ•´ç†ã—ã‚„ã™ã„","å•é¡Œæèµ·ï¼ˆç–‘å•ï¼‰â†’ æœ¬æ–‡ã§ç­”ãˆã‚’æ¢ã™ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚å¤šã„"]},{icon:"ğŸ“",title:"æ®µè½ã®æœ€åˆã¨æœ€å¾Œã«æ³¨ç›®",description:"è‹±èªã¯ã€Œãƒ‘ãƒ©ã‚°ãƒ©ãƒ•ãƒ»ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã€‚1æ®µè½ = 1ã¤ã®ä¸»å¼µ",example:{structure:`ã€å…¸å‹çš„ãªæ®µè½æ§‹é€ ã€‘
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ç¬¬1æ–‡ï¼ˆãƒˆãƒ”ãƒƒã‚¯ã‚»ãƒ³ãƒ†ãƒ³ã‚¹ï¼‰
ã€Œé‹å‹•ã¯å¥åº·ã«è‰¯ã„ã€â† æ®µè½ã®ä¸»å¼µ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä¸­é–“éƒ¨ï¼ˆã‚µãƒãƒ¼ãƒˆï¼‰
ç†ç”±1: ä½“ãŒå¼·ããªã‚‹
ç†ç”±2: ã‚¹ãƒˆãƒ¬ã‚¹è§£æ¶ˆã«ãªã‚‹
å…·ä½“ä¾‹: æ¯æ—¥30åˆ†æ­©ãã ã‘ã§åŠ¹æœ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æœ€çµ‚æ–‡ï¼ˆã¾ã¨ã‚ï¼‰
ã€Œã ã‹ã‚‰é‹å‹•ã‚’ç¿’æ…£ã«ã™ã¹ãã€â† çµè«–
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`,tips:"ç¬¬1æ–‡ã¨æœ€çµ‚æ–‡ã ã‘èª­ã‚ã°ã€ãã®æ®µè½ã§ä½•ã‚’è¨€ã„ãŸã„ã‹ãŒåˆ†ã‹ã‚‹ï¼"},details:["ç¬¬1æ–‡ï¼ˆãƒˆãƒ”ãƒƒã‚¯ã‚»ãƒ³ãƒ†ãƒ³ã‚¹ï¼‰: ãã®æ®µè½ã§æœ€ã‚‚è¨€ã„ãŸã„ã“ã¨","ä¸­é–“éƒ¨: ç†ç”±ãƒ»å…·ä½“ä¾‹ãƒ»ãƒ‡ãƒ¼ã‚¿ï¼ˆé£›ã°ã—èª­ã¿OKï¼‰","æœ€çµ‚æ–‡: ã¾ã¨ã‚ãƒ»çµè«–ãƒ»æ¬¡ã®æ®µè½ã¸ã®æ©‹æ¸¡ã—","æ€¥ã„ã§ã„ã‚‹æ™‚ã¯å„æ®µè½ã®ç¬¬1æ–‡ã ã‘èª­ã‚€ã®ã‚‚æœ‰åŠ¹"]},{icon:"ğŸ”—",title:"ãƒ‡ã‚£ã‚¹ã‚³ãƒ¼ã‚¹ãƒãƒ¼ã‚«ãƒ¼ã‚’è¦‹é€ƒã•ãªã„",description:"æ–‡ç« ã®æµã‚Œã‚’ç¤ºã™ã¤ãªãè¨€è‘‰ãŒè«–ç†å±•é–‹ã®ã‚«ã‚®",details:["é€†æ¥: However, But, Yet, On the other hand","å› æœ: Therefore, So, Thus, As a result","ä¾‹ç¤º: For example, For instance, Such as","è¿½åŠ : In addition, Moreover, Furthermore","è¨€ã„æ›ãˆ: In other words, That is, Namely"]},{icon:"ğŸ”",title:"è¨­å•ã®ç¨®é¡åˆ¥ã®æ”»ç•¥æ³•",description:"å•é¡Œã®ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸèª­ã¿æ–¹ã‚’ä½¿ã„åˆ†ã‘ã‚‹",details:["ä¸»æ—¨å•é¡Œ: å„æ®µè½ã®ç¬¬1æ–‡ã¨æœ€çµ‚æ®µè½ã‚’é‡ç‚¹çš„ã«","è©³ç´°å•é¡Œ: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§è©²å½“ç®‡æ‰€ã‚’ç‰¹å®šã—ã¦ç²¾èª­","èªå½™å•é¡Œ: å‰å¾Œã®æ–‡è„ˆã‹ã‚‰æ„å‘³ã‚’æ¨æ¸¬","æŒ‡ç¤ºèªå•é¡Œ: ç›´å‰ã®å†…å®¹ã‚’ç¢ºèª","NOTå•é¡Œ: æœ¬æ–‡ã«æ›¸ã‹ã‚Œã¦ã„ãªã„é¸æŠè‚¢ã‚’æ¢ã™"]},{icon:"â±ï¸",title:"æ™‚é–“é…åˆ†ã¨å„ªå…ˆé †ä½",description:"å…¨å•è§£ããŸã‚ã®æˆ¦ç•¥çš„ãªæ™‚é–“ç®¡ç†",details:["1å•ã‚ãŸã‚Šã®ç›®å®‰æ™‚é–“ã‚’æ±ºã‚ã‚‹ï¼ˆä¾‹: 3åˆ†/å•ï¼‰","æ˜“ã—ã„å•é¡Œã‹ã‚‰è§£ã„ã¦å¾—ç‚¹ã‚’ç¢ºä¿","é›£å•ã¯å¾Œå›ã—ã€æœ€å¾Œã«æˆ»ã‚‹","æœ€ä½5åˆ†ã¯è¦‹ç›´ã—æ™‚é–“ã‚’ç¢ºä¿"]},{icon:"â“",title:"åˆ†ã‹ã‚‰ãªã„éƒ¨åˆ†ã®å¯¾å‡¦æ³•",description:"å®Œç’§ã‚’ç›®æŒ‡ã•ãšã€åŠ¹ç‡çš„ã«å¾—ç‚¹ã™ã‚‹",details:["çŸ¥ã‚‰ãªã„å˜èªã¯å‰å¾Œã‹ã‚‰æ¨æ¸¬ï¼ˆå“è©ãƒ»è‚¯å®šå¦å®šã‚’åˆ¤æ–­ï¼‰","ä¸€æ–‡ãŒåˆ†ã‹ã‚‰ãªãã¦ã‚‚æ®µè½å…¨ä½“ã‹ã‚‰æ„å‘³ã‚’æ´ã‚€","ç´°éƒ¨ã‚ˆã‚Šå…¨ä½“ã®æµã‚Œã‚’å„ªå…ˆ","æ¶ˆå»æ³•ã§é¸æŠè‚¢ã‚’çµã‚‹ï¼ˆæ˜ã‚‰ã‹ã«é•ã†ã‚‚ã®ã‚’é™¤å¤–ï¼‰"]}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-text-color mb-4",children:"é•·æ–‡èª­è§£ã®ã‚³ãƒ„"}),e.jsx("div",{className:"bg-yellow-50/20 rounded-lg p-6 border-l-4 border-yellow-500 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:"ğŸ’¡"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-yellow-800 mb-2",children:"åŸºæœ¬æˆ¦ç•¥"}),e.jsx("p",{className:"text-yellow-700 mb-3",children:"é•·æ–‡èª­è§£ã¯ã€Œå®Œç’§ã«ç†è§£ã™ã‚‹ã€ã®ã§ã¯ãªãã€Œå¿…è¦ãªæƒ…å ±ã‚’åŠ¹ç‡çš„ã«è¦‹ã¤ã‘ã‚‹ã€ä½œæ¥­ã§ã™ã€‚ æ³¨é‡ˆã¨è¨­å•ã‹ã‚‰æ‰‹ãŒã‹ã‚Šã‚’å¾—ã¦ã€å…¨ä½“ã®æµã‚Œã‚’æ´ã¿ãªãŒã‚‰ã€è§£ç­”ã«å¿…è¦ãªéƒ¨åˆ†ã‚’æ¢ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚"}),e.jsxs("div",{className:"bg-yellow-100/30 rounded p-3 text-sm",children:[e.jsx("p",{className:"font-semibold text-yellow-900 mb-1",children:"âš¡ æœ€é‡è¦ãƒã‚¤ãƒ³ãƒˆ"}),e.jsx("p",{className:"text-yellow-800",children:"èª­ã‚€é †ç•ª: â‘  æ³¨é‡ˆ â†’ â‘¡ è¨­å•ãƒ»é¸æŠè‚¢ â†’ â‘¢ ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ç¬¬1æ®µè½ â†’ â‘£ å„æ®µè½ã®ç¬¬1æ–‡ â†’ â‘¤ å¿…è¦ç®‡æ‰€ã‚’ç²¾èª­"})]})]})]})}),e.jsx("div",{className:"space-y-4",children:r.map((t,s)=>e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6 hover:shadow-lg transition-shadow border-l-4 border-primary/30",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("span",{className:"text-4xl",children:t.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-text-color mb-2",children:t.title}),e.jsx("p",{className:"text-text-secondary",children:t.description})]})]}),t.example&&e.jsx("div",{className:"ml-14 mb-4 bg-blue-50/20 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"space-y-3",children:[t.example.title&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"ğŸ“Œ ã‚¿ã‚¤ãƒˆãƒ«ä¾‹"}),e.jsx("div",{className:"bg-white rounded p-2 font-mono text-sm text-blue-700",children:t.example.title})]}),t.example.para1&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"ğŸ“„ ç¬¬1æ®µè½ä¾‹"}),e.jsx("div",{className:"bg-white rounded p-2 text-sm text-gray-700 leading-relaxed",children:t.example.para1})]}),t.example.structure&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-blue-600 mb-1",children:"ğŸ“Š æ®µè½ã®æ§‹é€ "}),e.jsx("div",{className:"bg-white rounded p-3 text-sm font-mono whitespace-pre-line text-gray-700",children:t.example.structure})]}),t.example.explanation&&e.jsxs("div",{className:"bg-yellow-50/30 rounded p-3 border-l-2 border-yellow-500",children:[e.jsx("div",{className:"text-xs font-semibold text-yellow-800 mb-1",children:"ğŸ’¡ èª­ã¿å–ã‚Œã‚‹ã“ã¨"}),e.jsx("div",{className:"text-sm text-yellow-700 whitespace-pre-line",children:t.example.explanation})]}),t.example.tips&&e.jsx("div",{className:"bg-green-50/30 rounded p-3 border-l-2 border-green-500",children:e.jsxs("div",{className:"text-sm font-semibold text-green-700",children:["âœ¨ ",t.example.tips]})})]})}),e.jsx("ul",{className:"space-y-2 ml-14",children:t.details.map((n,a)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-primary mt-1",children:"âœ“"}),e.jsx("span",{className:"text-text-color",children:n})]},a))})]},s))}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50/20/20 rounded-lg p-6 mt-8 border-2 border-blue-300",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“–"}),e.jsx("span",{children:"å®Ÿè·µï¼åŠ¹ç‡çš„ãªèª­è§£æ‰‹é †"})]}),e.jsx("ol",{className:"space-y-3",children:[{step:"æ³¨é‡ˆã‚’èª­ã‚€",detail:"â†’ é‡è¦å˜èªã‹ã‚‰å†…å®¹ã‚’äºˆæƒ³"},{step:"è¨­å•ã¨é¸æŠè‚¢ã‚’èª­ã‚€",detail:"â†’ ä½•ã‚’èã‹ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯"},{step:"ã‚¿ã‚¤ãƒˆãƒ«ã¨ç¬¬1æ®µè½ã‚’èª­ã‚€",detail:"â†’ ãƒ†ãƒ¼ãƒã¨è«–ç‚¹ã‚’æŠŠæ¡"},{step:"å„æ®µè½ã®ç¬¬1æ–‡ã‚’æµã—èª­ã¿",detail:"â†’ å…¨ä½“æ§‹æˆã‚’ç†è§£"},{step:"è¨­å•ã«é–¢é€£ã™ã‚‹æ®µè½ã‚’ç²¾èª­",detail:"â†’ ç­”ãˆã®æ ¹æ‹ ã‚’æ¢ã™"},{step:"é¸æŠè‚¢ã‚’æœ¬æ–‡ã¨ç…§ã‚‰ã—åˆã‚ã›ã‚‹",detail:"â†’ æ ¹æ‹ ãŒã‚ã‚‹é¸æŠè‚¢ã‚’é¸ã¶"},{step:"è¦‹ç›´ã—",detail:"â†’ é¸ã‚“ã ç­”ãˆãŒæœ¬æ–‡ã®å†…å®¹ã¨çŸ›ç›¾ã—ã¦ã„ãªã„ã‹ç¢ºèª"}].map((t,s)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5",children:s+1}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-color font-semibold",children:t.step}),e.jsx("span",{className:"text-text-secondary text-sm ml-2",children:t.detail})]})]},s))})]}),e.jsxs("div",{className:"bg-green-50/20 rounded-lg p-6 border-l-4 border-green-500",children:[e.jsxs("h3",{className:"text-lg font-bold text-green-800 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“Œ"}),e.jsx("span",{children:"æ³¨é‡ˆã®åŠ¹æœçš„ãªæ´»ç”¨æ³•"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-green-700",children:[e.jsxs("p",{children:["âœ“ ",e.jsx("strong",{children:"æ³¨é‡ˆãŒã‚ã‚‹ = ãã®å˜èªãŒå†…å®¹ç†è§£ã«å¿…é ˆ"}),"ã¨ã„ã†å‡ºé¡Œè€…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"]}),e.jsx("p",{children:"âœ“ æ³¨é‡ˆã®å˜èªã‚’ä¸¦ã¹ã‚‹ã¨ã€é•·æ–‡ã®ãƒ†ãƒ¼ãƒã‚„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãŒæµ®ã‹ã³ä¸ŠãŒã‚‹"}),e.jsx("p",{children:"âœ“ ä¾‹: ã€Œç’°å¢ƒã€ã€Œæ±šæŸ“ã€ã€Œå¯¾ç­–ã€â†’ ç’°å¢ƒå•é¡Œã«ã¤ã„ã¦ã®æ–‡ç« ã ã¨äºˆæ¸¬ã§ãã‚‹"}),e.jsx("p",{className:"pt-2 italic",children:"ğŸ’¡ æœ¬æ–‡ã‚’èª­ã‚€å‰ã«æ³¨é‡ˆã ã‘ã§å†…å®¹ã‚’äºˆæƒ³ã™ã‚‹ç·´ç¿’ã‚’ã™ã‚‹ã¨åŠ¹æœçš„ï¼"})]})]})]})},yo=()=>e.jsx("div",{className:"dictionary-view",children:e.jsxs("div",{className:"dictionary-container",children:[e.jsx("h2",{children:"ğŸ“š è‹±å˜èªè¾æ›¸"}),e.jsx("p",{className:"coming-soon",children:"è¾æ›¸æ©Ÿèƒ½ã¯æº–å‚™ä¸­ã§ã™"})]})}),vo=({isOpen:r,onClose:t,sets:s,onCreateSet:n,onDeleteSet:a,onEditSet:o,onRemoveWord:l})=>{const[i,c]=u.useState("manage"),[d,m]=u.useState(""),[h,g]=u.useState(""),[S,b]=u.useState(null),[y,v]=u.useState(null),[k,D]=u.useState(""),[C,w]=u.useState("");if(!r)return null;const E=()=>{d.trim()&&(n(d.trim(),h.trim()||void 0),m(""),g(""),c("manage"))},$=q=>{v(q.id),D(q.name),w(q.description||"")},G=()=>{y&&k.trim()&&(o(y,k.trim(),C.trim()||void 0),v(null))},Y=()=>{v(null),D(""),w("")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-2xl sm:max-w-4xl w-full mx-auto max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"ğŸ“š ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆç®¡ç†"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700:text-gray-200 text-2xl","aria-label":"é–‰ã˜ã‚‹",children:"âœ•"})]}),e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>c("manage"),className:`flex-1 px-6 py-3 font-medium ${i==="manage"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900:text-gray-200"}`,children:["ğŸ“‹ ã‚»ãƒƒãƒˆç®¡ç† (",s.length,")"]}),e.jsx("button",{onClick:()=>c("create"),className:`flex-1 px-6 py-3 font-medium ${i==="create"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900:text-gray-200"}`,children:"â• æ–°è¦ä½œæˆ"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i==="manage"?e.jsx("div",{className:"space-y-4",children:s.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg mb-2",children:"ğŸ“ ã¾ã ã‚»ãƒƒãƒˆãŒã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-sm",children:"ã€Œæ–°è¦ä½œæˆã€ã‚¿ãƒ–ã‹ã‚‰æœ€åˆã®ã‚»ãƒƒãƒˆã‚’ä½œã‚Šã¾ã—ã‚‡ã†"})]}):s.map(q=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 p-4",children:y===q.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:k,onChange:me=>D(me.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"ã‚»ãƒƒãƒˆå"}),e.jsx("textarea",{value:C,onChange:me=>w(me.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"èª¬æ˜ï¼ˆä»»æ„ï¼‰",rows:2}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:G,className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"ä¿å­˜"}),e.jsx("button",{onClick:Y,className:"px-4 py-2 bg-gray-300 text-gray-900 rounded-md hover:bg-gray-400:bg-gray-500",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"})]})]}):e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:q.icon||"ğŸ“–"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:q.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",q.words.length,"èª)"]})]}),q.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:q.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["ä½œæˆ: ",new Date(q.createdAt).toLocaleDateString("ja-JP")]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(q),className:"text-blue-600 hover:text-blue-700:text-blue-300 text-sm","aria-label":"ç·¨é›†",children:"âœï¸"}),e.jsx("button",{onClick:()=>b(S===q.id?null:q.id),className:"text-gray-600 hover:text-gray-700:text-gray-300 text-sm","aria-label":S===q.id?"æŠ˜ã‚ŠãŸãŸã‚€":"å±•é–‹",children:S===q.id?"â–²":"â–¼"}),e.jsx("button",{onClick:()=>{confirm(`ã€Œ${q.name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)&&a(q.id)},className:"text-red-600 hover:text-red-700:text-red-300 text-sm","aria-label":"å‰Šé™¤",children:"ğŸ—‘ï¸"})]})]})}),S===q.id&&e.jsx("div",{className:"p-4 bg-white",children:q.words.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"ã¾ã å˜èªãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã›ã‚“"}):e.jsx("div",{className:"space-y-2",children:q.words.map((me,Ne)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:me.word}),me.ipa&&e.jsxs("span",{className:"text-sm text-blue-600",children:["/",me.ipa,"/"]})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:me.meaning}),me.source&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["å‡ºå…¸: ",me.source,me.sourceDetail&&` (${me.sourceDetail})`]})]}),e.jsx("button",{onClick:()=>l(q.id,me),className:"ml-4 text-red-600 hover:text-red-700:text-red-300","aria-label":"å‰Šé™¤",children:"â–"})]},`${me.word}-${Ne}`))})})]},q.id))}):e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["ã‚»ãƒƒãƒˆå ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:d,onChange:q=>m(q.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"ä¾‹: è‹¦æ‰‹ãªå‰ç½®è©"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"èª¬æ˜ï¼ˆä»»æ„ï¼‰"}),e.jsx("textarea",{value:h,onChange:q=>g(q.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md bg-white text-gray-900",placeholder:"ä¾‹: é«˜æ ¡å…¥è©¦ã§ã‚ˆãå‡ºã‚‹å‰ç½®è©ã‚’ã¾ã¨ã‚ãŸã‚»ãƒƒãƒˆ",rows:3})]}),e.jsx("button",{onClick:E,disabled:!d.trim(),className:"w-full px-6 py-3 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300:bg-gray-600 disabled:cursor-not-allowed font-medium",children:"â• ã‚»ãƒƒãƒˆã‚’ä½œæˆ"})]}),e.jsxs("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"ğŸ’¡ ãƒ’ãƒ³ãƒˆ"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ ã‚»ãƒƒãƒˆã‚’ä½œæˆå¾Œã€å„ã‚¿ãƒ–ã®+ãƒœã‚¿ãƒ³ã§å˜èªã‚’è¿½åŠ ã§ãã¾ã™"}),e.jsx("li",{children:"â€¢ ã‚»ãƒƒãƒˆåã¯å¾Œã‹ã‚‰ç·¨é›†ã§ãã¾ã™"}),e.jsx("li",{children:"â€¢ è¤‡æ•°ã®ã‚»ãƒƒãƒˆã‚’ä½œã£ã¦ã€ãƒ†ãƒ¼ãƒã”ã¨ã«æ•´ç†ã—ã¾ã—ã‚‡ã†"})]})]})]})})]})})};function wo({onResetComplete:r,allQuestions:t,onQuestionSetsUpdated:s}){const[n,a]=u.useState(!1),[o,l]=u.useState(null),[i,c]=u.useState(!1),[d,m]=u.useState([]),[h,g]=u.useState(null),[S,b]=u.useState(null),[y,v]=u.useState([]),[k,D]=u.useState(null),[C,w]=u.useState([]),[E,$]=u.useState([]),[G,Y]=u.useState([]),[q,me]=u.useState(0),Ne=()=>{try{let A=0;const Q=[];for(let O=0;O<localStorage.length;O++){const ae=localStorage.key(O);if(ae){const Z=localStorage.getItem(ae);if(Z){const te=new Blob([Z]).size;A+=te,Q.push({key:ae,sizeMB:te/(1024*1024)})}}}Q.sort((O,ae)=>ae.sizeMB-O.sizeMB),l({totalMB:A/(1024*1024),details:Q.slice(0,5)})}catch(A){p.error("ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã®å–å¾—ã‚¨ãƒ©ãƒ¼:",A)}},be=u.useCallback(()=>{const A=ks(14);m(A),g(hs()),b(gs()),v(Cs(12)),D(Ds());const O=Jt(10).map(Z=>{const te=t.find(Ie=>Ie.word&&Z.word&&Ie.word.toLowerCase()===Z.word.toLowerCase());return{...Z,etymology:te==null?void 0:te.etymology,relatedWords:te==null?void 0:te.relatedWords,difficulty:te==null?void 0:te.difficulty}});w(O),$(ys(10)),Y(ps(7,5));const ae=Me();me(ae.statistics.streakDays),Ne()},[t]);u.useEffect(()=>{be();const A=async()=>{const ae=(await Zt()).some(Z=>Z.source==="weak-words");c(ae)};A();const Q=()=>{be(),A()};if(typeof window<"u"&&window.addEventListener(ft,Q),n){const O=setInterval(()=>{be(),A()},1e3);return()=>{clearInterval(O),typeof window<"u"&&window.removeEventListener(ft,Q)}}return()=>{typeof window<"u"&&window.removeEventListener(ft,Q)}},[n,be]);const Re=()=>{confirm("æœ¬å½“ã«ã™ã¹ã¦ã®å­¦ç¿’è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚")&&(Ss(),m([]),g(null),b(null),v([]),D(null),w([]),$([]),Y([]),me(0),alert("å­¦ç¿’è¨˜éŒ²ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ"),be(),r&&r())};return e.jsxs("div",{className:"stats-view",children:[e.jsxs("div",{className:"w-full mb-4 px-2",children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:["ğŸ“† å­¦ç¿’ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"ï¼ˆéå»12é€±é–“ï¼‰"})]}),e.jsx(bo,{data:d})]}),e.jsxs("div",{className:"w-full mb-4 px-2",children:[e.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:["ğŸ˜° è‹¦æ‰‹å˜èªãƒˆãƒƒãƒ—10",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"ï¼ˆè¦å¾©ç¿’ï¼‰"})]}),C.length>0?e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-orange-200 p-6",children:[e.jsx("ul",{className:"space-y-3",children:C.map((A,Q)=>e.jsx("li",{className:"p-4 bg-gradient-to-r from-orange-50 to-red-50/30/30 rounded-lg border border-orange-200 hover:shadow-md hover:scale-[1.02] transition-all duration-200",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 bg-orange-500 text-white font-bold rounded-full text-sm",children:Q+1}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:A.word}),A.meaning&&e.jsx("span",{className:"text-sm text-gray-600 mt-1",children:A.meaning}),A.reading&&e.jsx("span",{className:"text-xs text-gray-500 mt-0.5",children:A.reading}),A.etymology&&e.jsxs("span",{className:"text-xs text-blue-600 mt-1",children:["ğŸ“– ",A.etymology]}),A.relatedWords&&e.jsxs("span",{className:"text-xs text-purple-600 mt-0.5",children:["ğŸ”— ",A.relatedWords]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("span",{className:"px-3 py-1 bg-red-100/50 text-red-700 rounded-full font-medium",children:["âŒ ",A.mistakes,"å›"]}),A.recentAccuracy>0&&e.jsxs("span",{className:"px-3 py-1 bg-blue-100/50 text-blue-700 rounded-full font-medium",children:["æ­£è§£ç‡ ",A.recentAccuracy,"%"]})]})]})},Q))}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsxs("button",{onClick:async()=>{try{const A=await Ft(`è‹¦æ‰‹èªå¥é›† ${new Date().toLocaleDateString("ja-JP")}`,20,3,60,t);await zt(A),c(!0),s&&await s(),alert(`âœ… å•é¡Œã‚»ãƒƒãƒˆã€Œ${A.name}ã€ã‚’${i?"æ›´æ–°":"ä½œæˆ"}ã—ã¾ã—ãŸï¼
å’Œè¨³ãƒ»æš—è¨˜ãƒ»ã‚¹ãƒšãƒ«ã‚¿ãƒ–ã§åˆ©ç”¨ã§ãã¾ã™ã€‚`)}catch(A){p.error("å•é¡Œã‚»ãƒƒãƒˆä½œæˆã‚¨ãƒ©ãƒ¼:",A),alert("âŒ å•é¡Œã‚»ãƒƒãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}},className:"flex-1 px-6 py-3 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center gap-2",children:["ğŸ“š å•é¡Œã‚»ãƒƒãƒˆã‚’",i?"æ›´æ–°":"ä½œæˆ",e.jsx("span",{className:"text-xs opacity-90",children:"(ä¸Šä½20èª)"})]}),e.jsx("button",{onClick:async()=>{const A=prompt("å–å¾—ã™ã‚‹è‹¦æ‰‹èªå¥ã®æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆ1-100ï¼‰","30");if(!A)return;const Q=parseInt(A);if(isNaN(Q)||Q<1||Q>100){alert("1ã‹ã‚‰100ã¾ã§ã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");return}try{const O=await Ft(`è‹¦æ‰‹èªå¥é›† ${new Date().toLocaleDateString("ja-JP")} (${Q}èª)`,Q,3,60,t);await zt(O),c(!0),s&&await s(),alert(`âœ… å•é¡Œã‚»ãƒƒãƒˆã€Œ${O.name}ã€ã‚’${i?"æ›´æ–°":"ä½œæˆ"}ã—ã¾ã—ãŸï¼
å’Œè¨³ãƒ»æš—è¨˜ãƒ»ã‚¹ãƒšãƒ«ã‚¿ãƒ–ã§åˆ©ç”¨ã§ãã¾ã™ã€‚`)}catch(O){p.error("å•é¡Œã‚»ãƒƒãƒˆä½œæˆã‚¨ãƒ©ãƒ¼:",O),alert("âŒ å•é¡Œã‚»ãƒƒãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}},className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200",children:"âš™ï¸ ã‚«ã‚¹ã‚¿ãƒ "})]})]}):e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50/20/20 rounded-xl border-2 border-dashed border-green-300 p-8 text-center",children:[e.jsx("p",{className:"text-xl font-semibold text-green-700",children:"è‹¦æ‰‹ãªå˜èªã¯ã‚ã‚Šã¾ã›ã‚“ï¼ğŸ‰"}),e.jsx("p",{className:"text-sm text-green-600 mt-2",children:"é †èª¿ã«å­¦ç¿’ãŒé€²ã‚“ã§ã„ã¾ã™"})]})]}),e.jsx("div",{className:"w-full mb-4 px-2",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border-2 border-red-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:"âš ï¸ ãƒ‡ãƒ¼ã‚¿ã®ãƒªã‚»ãƒƒãƒˆ"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ã™ã¹ã¦ã®å­¦ç¿’è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚"})]}),e.jsx("button",{onClick:Re,className:"px-8 py-3 bg-red-600 hover:bg-red-700:bg-red-800 text-white font-bold rounded-lg shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center gap-2",children:"ğŸ—‘ï¸ ãƒªã‚»ãƒƒãƒˆå®Ÿè¡Œ"})]})})}),o&&e.jsxs("div",{className:"w-full mb-4 px-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2",children:"ğŸ’¾ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border-2 border-purple-200 p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"åˆè¨ˆä½¿ç”¨é‡"}),e.jsxs("span",{className:`text-xl font-bold ${o.totalMB>4?"text-red-600":"text-green-600"}`,children:[o.totalMB.toFixed(2)," MB"," ",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"/ ç´„ 5-10 MB"})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 overflow-hidden relative",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 absolute left-0 top-0 ${o.totalMB>8?"bg-red-600 w-full":o.totalMB>4?"bg-yellow-500":"bg-green-500"}`,"data-progress":Math.min(o.totalMB/10*100,100)})}),o.totalMB>4&&e.jsx("p",{className:"mt-2 text-sm font-medium text-red-600 flex items-center gap-1",children:"âš ï¸ å®¹é‡ãŒä¸è¶³ã—ã¦ã„ã¾ã™"})]}),e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-blue-600 hover:text-blue-700:text-blue-300 font-medium flex items-center gap-2",children:"ğŸ“Š è©³ç´°ã‚’è¡¨ç¤º"}),e.jsx("ul",{className:"mt-4 space-y-2",children:o.details.map((A,Q)=>e.jsxs("li",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("code",{className:"text-sm text-gray-700 font-mono",children:A.key}),e.jsxs("span",{className:"text-sm font-semibold text-gray-800",children:[A.sizeMB.toFixed(2)," MB"]})]},Q))}),e.jsx("div",{className:"mt-4 p-4 bg-blue-50/20 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-700 flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:"ğŸ’¡"}),e.jsx("span",{children:"ãƒ’ãƒ³ãƒˆ: ãƒ‡ãƒ¼ã‚¿ãŒå¤§ãããªã‚Šã™ããŸå ´åˆã¯ã€å¤ã„æˆç¸¾ã‚’å‰Šé™¤ã™ã‚‹ã¨å®¹é‡ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚"})]})})]})]})]})]})}function bo({data:r}){const t=new Date;t.setHours(0,0,0,0);const s=Gt(t),n=r.find(b=>b.date===s);if(r.length===0)return e.jsxs("div",{className:"w-full p-8 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300 text-center",children:[e.jsx("p",{className:"text-gray-500 text-lg",children:"ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"å­¦ç¿’ã‚’é–‹å§‹ã™ã‚‹ã¨ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"}),e.jsxs("p",{className:"text-xs text-red-500 mt-4",children:["DEBUG: ä»Šæ—¥=",s,", ãƒ‡ãƒ¼ã‚¿ä»¶æ•°=",r.length,", ä»Šæ—¥ã®ãƒ‡ãƒ¼ã‚¿=",n?`${n.count}å•`:"ãªã—"]})]});const a=new Date(t);a.setDate(a.getDate()-13);const o=new Map(r.map(b=>[b.date,b])),l=[[],[]],i=new Date(t),c=i.getDay(),d=c===0?6:c-1;i.setDate(i.getDate()-d);const m=new Date(i);m.setDate(m.getDate()-7);const h=new Date(m);for(let b=0;b<2;b++)for(let y=0;y<7;y++){const v=Gt(h),k=o.get(v),D=new Date(h);if(D.setHours(0,0,0,0),D.getTime()>t.getTime())l[b].push(null);else{const C=k?Math.round(k.count*k.accuracy/100):0,w=k?{...k,correct:C}:{date:v,count:0,accuracy:0,correct:0};l[b].push(w)}h.setDate(h.getDate()+1)}const g=b=>b===0?"calendar-color-0":b<10?"calendar-color-1":b<20?"calendar-color-2":b<30?"calendar-color-3":"calendar-color-4",S=["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ","æ—¥"];return e.jsxs("div",{className:"w-full p-6 bg-white rounded-xl shadow-lg border-2 border-blue-200",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"min-w-max mx-auto w-fit",children:[e.jsx("div",{className:"flex gap-2 mb-2",children:S.map((b,y)=>e.jsx("div",{className:"w-20 h-8 flex items-center justify-center text-sm font-bold text-gray-700",children:b},y))}),e.jsx("div",{className:"flex flex-col gap-2",children:l.map((b,y)=>e.jsx("div",{className:"flex gap-2",children:b.map((v,k)=>{if(!v)return e.jsx("div",{className:"w-20 h-20 rounded bg-gray-100 border border-dashed border-gray-300"},k);const D=new Date(v.date),C=["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"][D.getDay()],w=v.date===s,E={"calendar-color-0":"bg-gray-200 text-gray-500","calendar-color-1":"bg-blue-300 text-blue-900","calendar-color-2":"bg-blue-400 text-white","calendar-color-3":"bg-blue-500 text-white","calendar-color-4":"bg-blue-600 text-white"};return e.jsx("div",{className:`w-20 h-20 rounded-lg flex items-center justify-center text-xs font-bold transition-all duration-200 hover:scale-105 hover:shadow-xl cursor-pointer border-2 ${E[g(v.count)]} ${w?"ring-4 ring-yellow-400 ring-offset-2 ring-offset-white shadow-2xl border-yellow-400":"border-transparent"}`,title:`${v.date} (${C})${w?" [ä»Šæ—¥]":""}: ${v.count}å• (æ­£ç­”ç‡${v.accuracy.toFixed(0)}%, æ­£è§£${v.correct}å•)`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-base",children:v.correct}),e.jsx("span",{className:"text-[10px] opacity-80",children:"/"}),e.jsx("span",{className:"text-sm",children:v.count})]})},k)})},y))})]})}),e.jsxs("div",{className:"flex flex-col gap-2 mt-6 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"å­¦ç¿’é‡:"}),e.jsx("span",{className:"text-xs",children:"å°‘"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-300 border border-gray-300"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-400 border border-gray-300"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-500 border border-gray-300"}),e.jsx("div",{className:"w-8 h-8 rounded bg-blue-600 border border-gray-300"}),e.jsx("span",{className:"text-xs",children:"å¤š"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"è¡¨ç¤º:"})," æ­£è§£æ•°/å‡ºé¡Œæ•° |",e.jsx("span",{className:"ml-2 inline-block w-6 h-6 rounded bg-gray-200 border-2 border-yellow-400 align-middle"}),e.jsx("span",{className:"ml-1",children:"= ä»Šæ—¥"})]})]})]})}function jo({allQuestions:r,onStartSession:t}){const[s,n]=u.useState(null),[a,o]=u.useState(null),[l]=u.useState(3),[i,c]=u.useState({totalLearned:0,totalReviewed:0,averageAccuracy:0,estimatedCompletion:90});if(u.useEffect(()=>{const y=localStorage.getItem("learning-schedule-90days");if(y)try{const v=JSON.parse(y),k=Math.floor((Date.now()-v.startDate)/(1e3*60*60*24)),D=v.totalDays;v.currentDay=Math.min(k+1,D);const C=Math.floor(D/3),w=Math.floor(D*2/3);v.phase=v.currentDay<=C?1:v.currentDay<=w?2:3,n(v),o(xr(v,r))}catch(v){p.error("Failed to load schedule:",v)}},[r]),u.useEffect(()=>{if(s){c(yr(s));const y=document.querySelector(".progress-bar");if(y){const v=s.currentDay,k=s.totalDays,D=v/k*100;y.style.width=`${D}%`}}},[s]),!s)return null;const d=["åŸºç¤å›ºã‚æœŸ","å¿œç”¨æ‹¡å¤§æœŸ","å®Œæˆãƒ»å®šç€æœŸ"],m=s.phase,h=s.currentDay,g=s.totalDays,S=h/g*100,b=vr(s);return e.jsxs("div",{className:"learning-plan-dashboard",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsxs("div",{className:"day-counter",children:[e.jsx("span",{className:"day-number",children:h}),e.jsxs("span",{className:"day-label",children:["/ ",g,"æ—¥ç›®"]})]}),e.jsxs("div",{className:"phase-indicator",children:[e.jsxs("span",{className:`phase-badge phase-${m}`,children:["Phase ",m]}),e.jsx("span",{className:"phase-name",children:d[m-1]})]}),e.jsxs("div",{className:"progress-bar-container",children:[e.jsx("div",{className:`progress-bar phase-${m}`}),e.jsxs("span",{className:"progress-label",children:[S.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"stats-summary",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ“š"}),e.jsx("div",{className:"stat-value",children:i.totalLearned}),e.jsx("div",{className:"stat-label",children:"å­¦ç¿’æ¸ˆã¿å˜èª"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âœ…"}),e.jsxs("div",{className:"stat-value",children:[i.averageAccuracy.toFixed(1),"%"]}),e.jsx("div",{className:"stat-label",children:"å¹³å‡æ­£ç­”ç‡"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ğŸ¯"}),e.jsxs("div",{className:"stat-value",children:[b>0?b.toFixed(0):0,"%"]}),e.jsx("div",{className:"stat-label",children:"ä»Šé€±ã®é”æˆç‡"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"â±ï¸"}),e.jsx("div",{className:"stat-value",children:i.estimatedCompletion}),e.jsx("div",{className:"stat-label",children:"å®Œäº†ã¾ã§ï¼ˆæ—¥ï¼‰"})]})]}),a&&e.jsxs("div",{className:"today-plan",children:[e.jsxs("h2",{children:["ğŸ“– ä»Šæ—¥ã®å­¦ç¿’ãƒ—ãƒ©ãƒ³ï¼ˆDay ",h,"ï¼‰"]}),e.jsxs("div",{className:"session-cards",children:[e.jsxs("div",{className:"session-card morning",children:[e.jsxs("div",{className:"session-header",children:[e.jsx("span",{className:"session-icon",children:"ğŸŒ…"}),e.jsxs("div",{className:"session-info",children:[e.jsx("h3",{children:"æœï¼šæ–°è¦å­¦ç¿’"}),e.jsxs("p",{children:[a.morning.newWords.length,"èª Â· 20åˆ†"]})]})]}),e.jsx("button",{onClick:()=>t("morning",a.morning.newWords),className:"btn-start-session",disabled:a.morning.newWords.length===0,children:a.morning.newWords.length===0?"å˜èªãªã—":"é–‹å§‹ã™ã‚‹"})]}),e.jsxs("div",{className:"session-card afternoon",children:[e.jsxs("div",{className:"session-header",children:[e.jsx("span",{className:"session-icon",children:"â˜€ï¸"}),e.jsxs("div",{className:"session-info",children:[e.jsx("h3",{children:"æ˜¼ï¼šå¼±ç‚¹å¾©ç¿’"}),e.jsxs("p",{children:[a.afternoon.reviewWords.length,"èª Â· 15åˆ†"]})]})]}),e.jsx("button",{onClick:()=>t("afternoon",a.afternoon.reviewWords),className:"btn-start-session",disabled:a.afternoon.reviewWords.length===0,children:a.afternoon.reviewWords.length===0?"å˜èªãªã—":"é–‹å§‹ã™ã‚‹"})]}),e.jsxs("div",{className:"session-card evening",children:[e.jsxs("div",{className:"session-header",children:[e.jsx("span",{className:"session-icon",children:"ğŸŒ™"}),e.jsxs("div",{className:"session-info",children:[e.jsx("h3",{children:"å¤œï¼šç·åˆæ¼”ç¿’"}),e.jsxs("p",{children:[a.evening.mixedWords.length,"èª Â· 20åˆ†"]})]})]}),e.jsx("button",{onClick:()=>t("evening",a.evening.mixedWords),className:"btn-start-session",disabled:a.evening.mixedWords.length===0,children:a.evening.mixedWords.length===0?"å˜èªãªã—":"é–‹å§‹ã™ã‚‹"})]})]})]}),e.jsxs("div",{className:"milestones",children:[e.jsx("h2",{children:"ğŸ† ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³"}),e.jsx("div",{className:"milestone-list",children:s.milestones.map((y,v)=>{const k=h>y.day,D=h===y.day,C=i.totalLearned>=y.wordsTarget;return e.jsxs("div",{className:`milestone-item ${C?"achieved":""} ${D?"current":""} ${k?"passed":""}`,children:[e.jsxs("div",{className:"milestone-day",children:["Day ",y.day]}),e.jsx("div",{className:"milestone-title",children:y.title}),e.jsxs("div",{className:"milestone-target",children:[y.wordsTarget,"èª"]}),C&&e.jsx("span",{className:"check-mark",children:"âœ“"})]},v)})})]})]})}function No({allQuestions:r,onStartSession:t,_selectedDataSource:s="all",_onDataSourceChange:n,customQuestionSets:a,onOpenCustomSetManagement:o}){const[l,i]=u.useState(()=>{const w=localStorage.getItem("batchSize");return w?parseInt(w,10):20}),[c,d]=u.useState(()=>localStorage.getItem("aiPersonality")||"kind-teacher"),m=w=>{d(w),localStorage.setItem("aiPersonality",w)},[h,g]=u.useState(()=>{const w=localStorage.getItem("voiceGender");return w==="female"||w==="male"?w:"female"}),[S,b]=u.useState(()=>{const w=localStorage.getItem("speechRate");return w?parseFloat(w):.9}),y=w=>{g(w),localStorage.setItem("voiceGender",w)},v=w=>{b(w),localStorage.setItem("speechRate",w.toString())},[k,D]=u.useState(()=>{const w=localStorage.getItem("darkMode");return w==="system"||w==="light"||w==="dark"?w:w==="true"?"dark":w==="false"?"light":"system"}),C=w=>{let E=!1;w==="system"?E=window.matchMedia("(prefers-color-scheme: dark)").matches:E=w==="dark",document.documentElement.classList.toggle("dark",E)};return u.useEffect(()=>{if(C(k),k==="system"){const w=window.matchMedia("(prefers-color-scheme: dark)"),E=()=>{C("system")};return w.addEventListener("change",E),()=>w.removeEventListener("change",E)}},[k]),r.length,e.jsxs("div",{className:"w-full px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“š"}),e.jsx("span",{children:"ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆ"}),e.jsxs("span",{className:"text-sm font-normal text-text-secondary",children:["(",a.length,"å€‹)"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:o,className:"w-full px-6 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-center rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition-all shadow-md flex items-center justify-center gap-2",children:[e.jsx("span",{children:"ğŸ“š"}),e.jsx("span",{children:"ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã‚’ç®¡ç†"})]}),e.jsx("p",{className:"text-sm text-text-secondary bg-bg-secondary px-4 py-3 rounded-lg",children:"ğŸ’¡ è‡ªåˆ†ã ã‘ã®ã‚ªãƒªã‚¸ãƒŠãƒ«å•é¡Œã‚»ãƒƒãƒˆã‚’ä½œæˆãƒ»ç®¡ç†ã§ãã¾ã™ã€‚å­¦ç¿’ã—ãŸã„å˜èªã‚’è‡ªç”±ã«è¿½åŠ ã—ã¦ã€åŠ¹ç‡çš„ã«å¾©ç¿’ã—ã¾ã—ã‚‡ã†ã€‚"})]})]}),e.jsx(jo,{allQuestions:r,onStartSession:t}),e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ­"}),e.jsx("span",{children:"AIã®äººæ ¼"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.entries(Oa).map(([w,E])=>e.jsxs("button",{className:`flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-all duration-200 ${c===w?"bg-primary border-primary text-white shadow-lg scale-105":"bg-bg-secondary border-border-color text-text-color hover:border-primary hover:shadow-md hover:scale-102"}`,onClick:()=>m(w),children:[e.jsx("div",{className:"text-3xl",children:E.avatar}),e.jsx("div",{className:"font-semibold text-sm",children:E.name}),e.jsx("div",{className:"text-xs opacity-80 text-center",children:E.description})]},w))})]}),e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”Š"}),e.jsx("span",{children:"éŸ³å£°è¨­å®š"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-base font-semibold text-text-color mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ¤"}),e.jsx("span",{children:"å£°ã®ç¨®é¡"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{className:`flex flex-col items-center gap-2 px-4 py-4 rounded-lg border-2 transition-all duration-200 ${h==="female"?"bg-primary border-primary text-white shadow-lg scale-105":"bg-bg-secondary border-border-color text-text-color hover:border-primary hover:shadow-md"}`,onClick:()=>y("female"),children:[e.jsx("div",{className:"text-3xl",children:"ğŸ‘©"}),e.jsx("div",{className:"text-sm font-semibold",children:"å¥³æ€§"})]}),e.jsxs("button",{className:`flex flex-col items-center gap-2 px-4 py-4 rounded-lg border-2 transition-all duration-200 ${h==="male"?"bg-primary border-primary text-white shadow-lg scale-105":"bg-bg-secondary border-border-color text-text-color hover:border-primary hover:shadow-md"}`,onClick:()=>y("male"),children:[e.jsx("div",{className:"text-3xl",children:"ğŸ‘¨"}),e.jsx("div",{className:"text-sm font-semibold",children:"ç”·æ€§"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-base font-semibold text-text-color mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"â±ï¸"}),e.jsx("span",{children:"ç™ºéŸ³é€Ÿåº¦"}),e.jsx("span",{className:"text-xs font-normal text-text-secondary",children:"(WPM: Words Per Minute)"})]}),e.jsxs("div",{className:"bg-bg-secondary rounded-lg p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"font-bold text-primary text-4xl mb-1",children:Math.round(S*150)}),e.jsx("div",{className:"text-sm text-text-secondary",children:"WPM"}),e.jsx("div",{className:"text-xs text-text-secondary mt-2",children:S<.75?"ğŸ¢ ã‚†ã£ãã‚Šã¨ç™ºéŸ³":S>=.95?"ğŸš€ ãƒã‚¤ãƒ†ã‚£ãƒ–ä¸¦ã®é€Ÿåº¦":"ğŸ¯ é«˜æ ¡å…¥è©¦ãƒªã‚¹ãƒ‹ãƒ³ã‚°ç›¸å½“"})]}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("input",{type:"range",min:"0.6",max:"1.0",step:"0.05",value:S,onChange:w=>v(parseFloat(w.target.value)),className:"w-full h-3 bg-border-color rounded-lg appearance-none cursor-pointer accent-primary","aria-label":"ç™ºéŸ³é€Ÿåº¦"}),e.jsxs("div",{className:"absolute top-0 left-0 w-full h-3 pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/2 left-0 -translate-y-1/2 w-0.5 h-5 bg-gray-400"}),e.jsx("div",{className:"absolute top-1/2 left-[37.5%] -translate-y-1/2 w-0.5 h-5 bg-blue-500"}),e.jsx("div",{className:"absolute top-1/2 left-[75%] -translate-y-1/2 w-0.5 h-5 bg-green-500"}),e.jsx("div",{className:"absolute top-1/2 left-full -translate-y-1/2 -translate-x-0.5 w-0.5 h-5 bg-orange-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-center text-xs",children:[e.jsxs("button",{onClick:()=>v(.6),className:"bg-gray-50/50 rounded-lg p-3 border border-gray-200 hover:bg-gray-100:bg-gray-700/50 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-gray-600",children:"90 WPM"}),e.jsx("div",{className:"text-gray-500 mt-1",children:"æœ€ä½é€Ÿåº¦"})]}),e.jsxs("button",{onClick:()=>v(.75),className:"bg-blue-50/20 rounded-lg p-3 border border-blue-200 hover:bg-blue-100:bg-blue-800/30 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-blue-600",children:"113 WPM"}),e.jsx("div",{className:"text-blue-500 mt-1",children:"åˆå­¦è€…å‘ã‘"})]}),e.jsxs("button",{onClick:()=>v(.9),className:"bg-green-50/20 rounded-lg p-3 border border-green-200 hover:bg-green-100:bg-green-800/30 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-green-600",children:"135 WPM"}),e.jsx("div",{className:"text-green-500 mt-1",children:"é«˜æ ¡å…¥è©¦"})]}),e.jsxs("button",{onClick:()=>v(1),className:"bg-orange-50/20 rounded-lg p-3 border border-orange-200 hover:bg-orange-100:bg-orange-800/30 transition-colors cursor-pointer",children:[e.jsx("div",{className:"font-bold text-orange-600",children:"150 WPM"}),e.jsx("div",{className:"text-orange-500 mt-1",children:"ãƒã‚¤ãƒ†ã‚£ãƒ–"})]})]})]})]})]}),e.jsxs("div",{className:"bg-card-bg rounded-xl p-6 shadow-md border-2 border-card-border",children:[e.jsxs("h3",{className:"text-xl font-bold text-text-color mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“‹"}),e.jsx("span",{children:"ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("a",{href:"/privacy.html",target:"_blank",rel:"noopener noreferrer",className:"block w-full px-4 py-3 bg-primary text-white text-center rounded-lg font-semibold hover:bg-btn-primary-hover transition-colors shadow-md",children:"ğŸ“„ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼"}),e.jsx("p",{className:"text-sm text-text-secondary bg-bg-secondary px-4 py-3 rounded-lg text-center",children:"æœ¬ã‚¢ãƒ—ãƒªã¯å€‹äººæƒ…å ±ã‚’åé›†ã›ãšã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã«ã®ã¿ä¿å­˜ã•ã‚Œã¾ã™ã€‚"})]})]})]})}const So=({isVisible:r,message:t="èª­ã¿è¾¼ã¿ä¸­..."})=>r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 pointer-events-auto",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 flex flex-col items-center gap-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"relative w-16 h-16",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-gray-200"}),e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-blue-600 animate-spin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-800 font-semibold text-lg",children:t}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"æº–å‚™ä¸­ã§ã™..."})]})]})}):null;let Rt=null,Pt=null;async function tr(){return Rt||(Rt=(await rt(()=>Promise.resolve().then(()=>mo),void 0)).default,Rt)}async function sr(){return Pt||(Pt=(await rt(()=>Promise.resolve().then(()=>uo),void 0)).default,Pt)}function rr(){typeof requestIdleCallback<"u"?requestIdleCallback(()=>{tr(),sr()}):setTimeout(()=>{tr(),sr()},2e3)}const Qr=["è¨€èªåŸºæœ¬","å­¦æ ¡ãƒ»å­¦ç¿’","æ—¥å¸¸ç”Ÿæ´»","äººãƒ»ç¤¾ä¼š","è‡ªç„¶ãƒ»ç’°å¢ƒ","é£Ÿãƒ»å¥åº·","é‹å‹•ãƒ»å¨¯æ¥½","å ´æ‰€ãƒ»ç§»å‹•","æ™‚é–“ãƒ»æ•°é‡","ç§‘å­¦ãƒ»æŠ€è¡“"];function ko(){try{let r=0;const t=[];for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);if(a){const o=localStorage.getItem(a);if(o){const l=new Blob([o]).size;r+=l,t.push({key:a,size:l})}}}const s=r/(1024*1024);p.log(`ğŸ“Š LocalStorageä½¿ç”¨é‡: ${s.toFixed(2)}MB`),t.sort((n,a)=>a.size-n.size),t.slice(0,5).forEach(n=>{const a=n.size/1048576;p.log(`  - ${n.key}: ${a.toFixed(2)}MB`)}),s>4&&(p.warn("âš ï¸ LocalStorageã®ä½¿ç”¨é‡ãŒå¤šã„ãŸã‚ã€å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å‰Šé™¤ã—ã¦ã„ã¾ã™ã€‚"),et(),p.log("è‡ªå‹•åœ§ç¸®ãŒå®Œäº†ã—ã¾ã—ãŸã€‚"))}catch(r){p.error("LocalStorageã‚µã‚¤ã‚ºã®ç¢ºèªã‚¨ãƒ©ãƒ¼:",r)}}function Co(){const[r,t]=u.useState("translation"),[s,n]=u.useState(!1),[a,o]=u.useState([]),[l,i]=u.useState(()=>In()),[c,d]=u.useState(!1);u.useEffect(()=>{An(l)},[l]),u.useEffect(()=>{!window.location.hostname.includes("github.io")&&rt(()=>import("./scoreBoardTests-DZKaB3b9.js"),__vite__mapDeps([0,1,2])).then(()=>{p.log("âœ… ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ"),p.log("   ä½¿ã„æ–¹: window.runScoreBoardTests()"),p.log('   ã¾ãŸã¯: window.checkCurrentScoreBoardDisplay("translation")')}).catch(J=>{p.error("ãƒ†ã‚¹ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:",J)})},[]);const{categoryList:m,setCategoryList:h,selectedCategory:g,setSelectedCategory:S,selectedDifficulty:b,setSelectedDifficulty:y,selectedWordPhraseFilter:v,setSelectedWordPhraseFilter:k,selectedPhraseTypeFilter:D,setSelectedPhraseTypeFilter:C,selectedDataSource:w,setSelectedDataSource:E}=Dn(),[$,G]=u.useState([]),[Y,q]=u.useState(!1),me=u.useRef(!1);u.useEffect(()=>{me.current=!1},[r]),u.useEffect(()=>{Y&&(r==="translation"||r==="spelling")&&!me.current&&A.questions.length===0&&(me.current=!0,j())},[Y,r]);const[Ne]=u.useState(()=>{const _=localStorage.getItem("quiz-adaptive-mode");return _?JSON.parse(_):!1}),{sessionStats:be,setSessionStats:Re,quizState:A,setQuizState:Q,reviewFocusMode:O,setReviewFocusMode:ae,reviewQuestionPool:Z,setReviewQuestionPool:te,reviewCorrectStreak:Ie,setReviewCorrectStreak:ye}=Mn(),we=u.useRef(0),Se=u.useRef(0),Ge=u.useRef([]),Ce=u.useRef(0),We=u.useRef([]),_e=u.useRef(null),Fe=u.useRef(null),Ee=u.useRef(new Map),Pe=u.useRef([]),le=u.useRef([]);Cn(),u.useEffect(()=>{const _=de=>{const fe=de==="dark"||de==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.classList.toggle("dark-mode",fe)},R=localStorage.getItem("darkMode")||"system";_(R);const F=window.matchMedia("(prefers-color-scheme: dark)"),B=()=>{const de=localStorage.getItem("darkMode");(!de||de==="system")&&_("system")};return F.addEventListener("change",B),()=>F.removeEventListener("change",B)},[]),u.useEffect(()=>{(async()=>{try{p.log("ğŸ”„ ãƒ‡ãƒ¼ã‚¿ç§»è¡Œãƒã‚§ãƒƒã‚¯ä¸­...");try{await ln()}catch(ie){p.error("Migration error (continuing):",ie)}cn();let J=!1;try{const ie=await et();ie&&ie.wordProgress&&ie.statistics&&ie.questionSetStats?(nt(ie),p.log("âœ… Progress data loaded successfully"),J=!0):p.warn("âš ï¸ Progress data incomplete, reinitializing")}catch(ie){p.error("Progress load error:",ie)}if(!J){p.log("ğŸ”§ Initializing fresh progress data");const ie={results:[],statistics:{totalQuizzes:0,totalQuestions:0,totalCorrect:0,averageScore:0,bestScore:0,streakDays:0,lastStudyDate:0,studyDates:[]},questionSetStats:{},wordProgress:{},categoryStats:{},difficultyStats:{}};nt(ie);try{localStorage.setItem("progress-data",JSON.stringify(ie))}catch(ue){p.warn("Failed to save initial progress:",ue)}}ko();const F=await(await fetch("/data/vocabulary/high-school-entrance-words.csv")).text(),B=bt(F).map(ie=>({...ie,source:"junior"}));let de=[];try{const ue=await(await fetch("/data/vocabulary/high-school-entrance-phrases.csv")).text();de=bt(ue).map(W=>({...W,source:"junior"})),p.log(`ğŸ“š é«˜æ ¡å—é¨“è‹±ç†Ÿèªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ: ${de.length}å€‹`)}catch(ie){p.warn("é«˜æ ¡å—é¨“è‹±ç†Ÿèªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",ie)}let fe=[];try{const ue=await(await fetch("/data/vocabulary/high-school-intermediate-words.csv")).text();fe=bt(ue).map(W=>({...W,source:"intermediate"})),p.log(`ğŸ“š ä¸­ç´š1800å˜èªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ: ${fe.length}å€‹`)}catch(ie){p.warn("ä¸­ç´š1800å˜èªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",ie)}let M=[];try{const ue=await(await fetch("/data/vocabulary/high-school-intermediate-phrases.csv")).text();M=bt(ue).map(W=>({...W,source:"intermediate"})),p.log(`ğŸ“š ä¸­ç´š1800ç†Ÿèªã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ: ${M.length}å€‹`)}catch(ie){p.warn("ä¸­ç´š1800ç†Ÿèªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",ie)}const se=new Map;try{for(const ie of[1,2,3])try{const W=await(await fetch(`/data/sentence-ordering-grade${ie}.json`)).json();W.units&&W.units.forEach(U=>{const ee=`${ie}å¹´ ${U.unit}`;se.set(U.unit,`${U.unit}: ${U.title}`),se.set(ee,`${ie}å¹´ ${U.unit}: ${U.title}`)})}catch(ue){p.warn(`Grade ${ie} sentence ordering data not found:`,ue)}}catch(ie){p.warn("Unit title mapping failed:",ie)}const oe=[...B,...de,...fe,...M];if(oe.length>0){o(oe);try{const X=oe.map(pe=>({word:pe.word,difficulty:pe.difficulty||"beginner"}));localStorage.setItem("all-questions-cache",JSON.stringify(X))}catch(X){p.warn("Questions cache save failed:",X)}const W=Array.from(new Set(oe.map(X=>X.category||"").filter(X=>X))).map(X=>se.has(X)?se.get(X):X).sort((X,pe)=>{const Ae=/(\d+)å¹´\s+Unit\s+(\d+)/i,De=X.match(Ae),Te=pe.match(Ae);if(De&&Te){const ce=parseInt(De[1],10),he=parseInt(Te[1],10);if(ce!==he)return ce-he;const ne=parseInt(De[2],10),ge=parseInt(Te[2],10);return ne-ge}const Ye=/Unit\s+(\d+)/i,xe=X.match(Ye),ke=pe.match(Ye);if(xe&&ke){const ce=parseInt(xe[1],10),he=parseInt(ke[1],10);return ce-he}return X.localeCompare(pe,"ja")});h(W);const U={id:"all-set",name:"é«˜æ ¡å—é¨“ç·åˆ",questions:oe,createdAt:Date.now(),isBuiltIn:!0,source:"é«˜æ ¡å—é¨“2758èª + é«˜æ ¡å—é¨“æ¨™æº–1791èª"},ee={id:"advanced-set",name:"é«˜æ ¡å—é¨“ä¸Šç´š",questions:oe.filter(X=>X.difficulty==="advanced"),createdAt:Date.now(),isBuiltIn:!0,source:"high-school-entrance (å˜èª2662 + ç†Ÿèª96)"},I={id:"standard-set",name:"é«˜æ ¡å—é¨“æ¨™æº–",questions:oe.filter(X=>X.difficulty==="intermediate"||X.difficulty==="beginner"),createdAt:Date.now(),isBuiltIn:!0,source:"high-school-intermediate (å˜èª1579 + ç†Ÿèª212)"},{getCustomQuestionSets:z}=await rt(async()=>{const{getCustomQuestionSets:X}=await Promise.resolve().then(()=>Bs);return{getCustomQuestionSets:X}},void 0),K=(await z()).map(X=>{const pe=new Date(X.createdAt),Ae=`${pe.getMonth()+1}/${pe.getDate()}`,De=X.source==="reading"?"é•·æ–‡":X.source==="weak-words"?"è‹¦æ‰‹èªå¥":"æ‰‹å‹•";return{id:X.id,name:`ã‚«ã‚¹ã‚¿ãƒ å•é¡Œï¼ˆ${De}_${Ae}ï¼‰`,questions:X.questions,createdAt:X.createdAt,isBuiltIn:!1,source:X.source==="reading"?"é•·æ–‡èª­è§£":X.source==="weak-words"?"è‹¦æ‰‹èªå¥":"æ‰‹å‹•ä½œæˆ"}});G([U,ee,I,...K]),q(!0)}}catch(J){p.error("è‹±å˜èªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:",J),alert("è‹±å˜èªãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ")}})()},[]);const $e=async()=>{try{const{getCustomQuestionSets:_}=await rt(async()=>{const{getCustomQuestionSets:B}=await Promise.resolve().then(()=>Bs);return{getCustomQuestionSets:B}},void 0),J=await _(),R=$.find(B=>B.isBuiltIn),F=J.map(B=>({id:B.id,name:B.name,questions:B.questions,createdAt:B.createdAt,isBuiltIn:!1,source:B.source==="reading"?"é•·æ–‡èª­è§£":B.source==="weak-words"?"è‹¦æ‰‹èªå¥":"æ‰‹å‹•ä½œæˆ"}));R&&G([R,...F])}catch(_){p.error("ã‚«ã‚¹ã‚¿ãƒ å•é¡Œã‚»ãƒƒãƒˆã®å†èª­ã¿è¾¼ã¿ã«å¤±æ•—:",_)}};u.useEffect(()=>{localStorage.setItem("quiz-adaptive-mode",JSON.stringify(Ne))},[Ne]),u.useEffect(()=>{localStorage.setItem("selectedDataSource",w)},[w]),u.useEffect(()=>{A.questions.length>0&&j()},[w,g,b,v,D]);const Be=()=>{let _=a;if(w!=="all"&&(_=_.filter(J=>J.source===w)),g!=="all"&&(_=_.filter(J=>J.category===g)),b!=="all"){const J={all:"",beginner:"åˆç´š",intermediate:"ä¸­ç´š",advanced:"ä¸Šç´š"};_=_.filter(R=>R.difficulty===J[b])}return v==="words-only"?_=_.filter(J=>!J.word.includes(" ")):v==="phrases-only"&&(_=_.filter(J=>J.word.includes(" ")),D!=="all"&&(_=_.filter(J=>fr(J.word)===D))),_=ws(_),_},He=(_,J)=>{const R=Rn(_,J);i(F=>({...F,sets:[...F.sets,R]})),p.log(`âœ… ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã€Œ${_}ã€ã‚’ä½œæˆã—ã¾ã—ãŸ`)},je=_=>{i(J=>$n(J,_)),p.log("ğŸ—‘ï¸ ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ")},ze=(_,J,R)=>{i(F=>En(F,_,{name:J,description:R})),p.log(`âœï¸ ã‚«ã‚¹ã‚¿ãƒ ã‚»ãƒƒãƒˆã€Œ${J}ã€ã‚’æ›´æ–°ã—ã¾ã—ãŸ`)},Ue=(_,J)=>{i(R=>Pn(R,_,J)),p.log(`â• ã€Œ${J.word}ã€ã‚’ã‚»ãƒƒãƒˆã«è¿½åŠ ã—ã¾ã—ãŸ`)},Le=(_,J)=>{i(R=>Tn(R,_,J)),p.log(`â– ã€Œ${J.word}ã€ã‚’ã‚»ãƒƒãƒˆã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸ`)},j=async()=>{var I;const _=Pa();p.log("ğŸ® ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³:",_);const J=ms();let R=Be();if(R.length===0){alert("æŒ‡å®šã•ã‚ŒãŸæ¡ä»¶ã®å•é¡ŒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");return}if(O){const z=$t();if(R=R.filter(re=>z.some(K=>K&&re.word&&K.toLowerCase()===re.word.toLowerCase())),R.length===0){alert("è¦å¾©ç¿’å•é¡ŒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"),ae(!1),te([]);return}te([...R]),p.log(`ğŸ¯ è£œä¿®ãƒ¢ãƒ¼ãƒ‰é–‹å§‹: ${R.length}å•ã‚’ç¹°ã‚Šè¿”ã—å‡ºé¡Œ`)}const F=zn(a,m),B=kr();B?(Hn(F),p.log(`ğŸ“Š æ”¹å–„é€²æ—: ${B.currentDay}æ—¥ç›® - å…¨ä½“é€²æ—${B.overallProgress.toFixed(1)}%`)):F.weakCategories.length>0&&(Un(F),p.log("ğŸ¯ ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆæ”¹å–„ãƒ—ãƒ©ãƒ³ã‚’é–‹å§‹ã—ã¾ã—ãŸ")),F.aiRecommendations.length>0&&(p.log("ğŸ§  AIå­¦ç¿’ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ ã‹ã‚‰ã®æ¨å¥¨:"),F.aiRecommendations.forEach(z=>p.log(`  ${z}`))),F.weakCategories.length>0&&g==="all"&&(R=Bn(R,F.weakCategories,Math.min(30,R.length)),p.log(`ğŸ’¡ å¼±ç‚¹åˆ†é‡ã‚’å„ªå…ˆå‡ºé¡Œ: ${F.weakCategories.slice(0,3).map(z=>z.category).join(", ")}`));const de=$t(),M=js(10).map(z=>z.word);let se=[];if(de.length>0){const z=R.filter(K=>de.some(X=>X&&K.word&&X.toLowerCase()===K.word.toLowerCase()));se=J.maxReviewCount>0?z.slice(0,J.maxReviewCount):[];const re=R.filter(K=>!de.some(X=>X&&K.word&&X.toLowerCase()===K.word.toLowerCase()));R=[...se,...re],se.length>0&&p.log(`ğŸ”„ è¦å¾©ç¿’å•é¡Œ: ${se.length}å•ï¼ˆä¸Šé™: ${J.maxReviewCount}å•ï¼‰`)}if(M.length>0){const z=R.filter(re=>M.some(K=>K&&re.word&&K.toLowerCase()===re.word.toLowerCase()));if(z.length>0){const re=R.filter(K=>!M.some(X=>X&&K.word&&X.toLowerCase()===K.word.toLowerCase()));R=[...z,...re],p.log(`ğŸ”— æ··åŒå±¥æ­´: ${z.length}å•ã‚’å„ªå…ˆå‡ºé¡Œ`)}}if(!O&&R.length>0){const z=await et(),re=new Map;R.forEach(xe=>{const ke=z.wordProgress[xe.word];if(ke&&ke.learningHistory&&ke.learningHistory.length>0){const ce=ke.learningHistory.map(ne=>({timestamp:ne.timestamp,wasCorrect:ne.wasCorrect,responseTime:ne.responseTime,userAnswer:ne.userAnswer,confidenceLevel:ne.responseTime<2e3?"instant":ne.responseTime<5e3?"hesitant":"guessed",sessionContext:{questionIndex:ne.sessionIndex||0,previousQuestions:[],sessionFatigue:0}})),he=Vn(xe.word,ke,ce);re.set(xe.word,he)}});const K=Kn(R,z.wordProgress,re),X=ea(K,R.length),pe=Us(We.current,we.current);_e.current=pe;const Ae=ra(X,pe),De=new Map(Ae.map(xe=>[xe.word,xe]));if(R=R.filter(xe=>De.has(xe.word)).sort((xe,ke)=>{const ce=De.get(xe.word).priority;return De.get(ke.word).priority-ce}),p.log("ğŸ§  å­¦ç¿’æ›²ç·šAI: æœ€é©ãªå‡ºé¡Œé †åºã‚’æ±ºå®š"),p.log("  å‡ºé¡Œæˆ¦ç•¥:",Ae.slice(0,5).map(xe=>`${xe.word}(${xe.strategy}, æˆåŠŸç‡${xe.estimatedSuccessRate.toFixed(0)}%)`).join(", ")),pe.fatigueLevel>40){const xe=aa(pe);p.log(`âš¡ èªçŸ¥è² è·: ${pe.fatigueLevel.toFixed(0)}% - ${xe}`)}const Te=pa(R,z.wordProgress,le.current),Ye=new Map;if(Te.sequence.forEach((xe,ke)=>{Ye.set(xe,ke)}),R=R.sort((xe,ke)=>{const ce=Ye.get(xe.word)??999,he=Ye.get(ke.word)??999;return ce-he}),p.log("ğŸ”— æ–‡è„ˆå­¦ç¿’AI: æ„å‘³çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°å®Œäº†"),p.log(`  ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ•°: ${Te.clusters.length}`),Te.transitions.length>0){const xe=Te.transitions[0];p.log(`  ä¾‹: ${xe.from} â†’ ${xe.to} (${xe.reason})`)}}O?p.log(`ğŸ¯ è£œä¿®ãƒ¢ãƒ¼ãƒ‰: ${R.length}å•ã‚’ç¹°ã‚Šè¿”ã—å‡ºé¡Œä¸­`):p.log(`ğŸ“š å­¦ç¿’æ•°: ${R.length}å•`),Q({questions:R,currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedAnswer:null}),Re({correct:0,incorrect:0,review:0,mastered:0}),we.current=Date.now(),Se.current=Date.now(),Ge.current=[],We.current=[],_e.current=null;const oe=await et(),ie=ia(oe.wordProgress,Pe.current);Fe.current=ie;const ue=R.map(z=>z.word),W=((I=_e.current)==null?void 0:I.fatigueLevel)??0,U=ma(ue,oe.wordProgress,ie,W);Ee.current=U,p.log("ğŸ”® ã‚¨ãƒ©ãƒ¼äºˆæ¸¬AI: èª¤ç­”ãƒªã‚¹ã‚¯åˆ†æå®Œäº†");const ee=Array.from(U.values()).filter(z=>z.warningLevel==="high"||z.warningLevel==="critical").sort((z,re)=>re.errorRisk-z.errorRisk);ee.length>0&&(p.log(`  é«˜ãƒªã‚¹ã‚¯å•é¡Œ: ${ee.length}å•`),p.log(`  æœ€é«˜ãƒªã‚¹ã‚¯: ${ee[0].word} (${ee[0].errorRisk.toFixed(0)}% - ${ee[0].primaryPattern})`))},x=()=>{O?(ae(!1),te([]),ye(new Map)):(ae(!0),ye(new Map)),j()},f=()=>{O?(ae(!1),te([]),ye(new Map)):(ae(!0),ye(new Map)),j()},N=_=>{S(_),ae(!1),te([]),A.questions.length>0&&j()},T=_=>{y(_),ae(!1),te([]),A.questions.length>0&&j()},H=async(_,J,R)=>{var oe,ie,ue,W;if(A.answered)return;const F=_==="åˆ†ã‹ã‚‰ãªã„",B=_.trim(),de=J.trim(),fe=!F&&B===de,M=A.questions[A.currentIndex];!fe&&R&&R.word&&(await bs(R.word,M.word),p.log(`ğŸ”— æ··åŒã‚’è¨˜éŒ²: ${R.word} â† ${M.word}`));const se=Date.now()-Se.current;if(M){const ee=(oe=(await et()).wordProgress)==null?void 0:oe[M.word],z=1-(ee?ee.correctCount/(ee.correctCount+ee.incorrectCount):.5);We.current.push({timestamp:Date.now(),wasCorrect:fe,responseTime:se,questionDifficulty:z});const re=Us(We.current,we.current);_e.current=re,(ie=re.breakRecommendation)!=null&&ie.shouldBreak&&p.log(`ğŸ’¤ ä¼‘æ†©æ¨å¥¨: ${re.breakRecommendation.reason}`),Pe.current.push({word:M.word,wasCorrect:fe,userAnswer:B}),Pe.current.length>50&&(Pe.current=Pe.current.slice(-50))}if(M){await mt(M.word,fe,se,void 0,"translation");const ee=(ue=(await et()).wordProgress)==null?void 0:ue[M.word];let I=fe?"correct":"incorrect";ee&&ee.masteryLevel==="mastered"?I="mastered":!fe&&ee&&ee.incorrectCount>=2&&(I="review"),Re(K=>({...K,correct:K.correct+(I==="correct"?1:0),incorrect:K.incorrect+(I==="incorrect"?1:0),review:K.review+(I==="review"?1:0),mastered:K.mastered+(I==="mastered"?1:0)})),yt({status:I,word:M.word,timestamp:Date.now()},"translation"),le.current.push(M.word),le.current.length>10&&(le.current=le.current.slice(-10)),Ce.current++;const re=(W=(await et()).wordProgress)==null?void 0:W[M.word];if(re&&re.skippedCount&&re.skippedCount>0&&(fe?Sr(M.word):(Nr(M.word),p.log("ğŸ¤” AIå­¦ç¿’ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ: ã‚¹ã‚­ãƒƒãƒ—ã—ãŸå˜èªãŒä¸æ­£è§£ã§ã—ãŸã€‚åŒæ™‚æœŸã®å˜èªã‚’å†ç¢ºèªã—ã¾ã™ã€‚"))),St({id:kt(),questionSetId:"main-set-single",questionSetName:"é«˜æ ¡å—é¨“è‹±å˜èª",score:fe?1:0,total:1,percentage:fe?100:0,date:Date.now(),timeSpent:Math.floor(se/1e3),incorrectWords:fe?[]:[M.word],mode:"translation",category:g!=="all"?g:void 0,difficulty:b!=="all"?b:void 0}),fe||Ge.current.push(M.word),O){const K=new Map(Ie);if(fe){const X=K.get(M.word)||0;if(K.set(M.word,X+1),X+1>=2){const pe=Z.filter(Ae=>Ae.word!==M.word);te(pe),p.log(`âœ… ${M.word} ã‚’è£œä¿®å¯¾è±¡ã‹ã‚‰é™¤å¤– (2å›é€£ç¶šæ­£è§£)`),pe.length===0&&(alert("ğŸ‰ ã™ã¹ã¦ã®è¦å¾©ç¿’å•é¡Œã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼"),ae(!1),ye(new Map))}}else K.set(M.word,0);ye(K)}}!fe&&!O&&Q(U=>{U.totalAnswered%3;{const ee=U.questions.slice(U.currentIndex+1);if(ee.length>1){const I=localStorage.getItem("learning-limit-translation"),z=localStorage.getItem("review-limit-translation"),re=I?parseInt(I):null,K=z?parseInt(z):null,X=es(ee,{isReviewFocusMode:!1,learningLimit:re,reviewLimit:K,mode:"translation"});return{...U,questions:[...U.questions.slice(0,U.currentIndex+1),...X]}}}return U}),Q(U=>({...U,answered:!0,selectedAnswer:_,score:fe?U.score+1:U.score,totalAnswered:U.totalAnswered+1}))},V=()=>{Q(_=>{var F;const J=O?Z:_.questions,R=_.currentIndex+1;if(!O&&R>=J.length){const B=Date.now(),de=We.current.reduce((W,U)=>W+U.responseTime,0),fe=We.current.length>0?de/We.current.length:0,M=((F=_e.current)==null?void 0:F.fatigueLevel)??0,se=fa(we.current,B,_.totalAnswered,_.score,fe,M,be.correct+be.mastered,be.review);ba(se);const oe=ja();if(oe.length>=3){const W=wa("user",oe),U=Ir(),ee=Na(W,U);p.log("ğŸ“Š å­¦ç¿’ã‚¹ã‚¿ã‚¤ãƒ«AI:",ee)}const ie=(B-we.current)/(1e3*60),ue=Ra(_.score,_.totalAnswered,fe,ie,be.correct+be.mastered,M);p.log("ğŸ® ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµæœ:"),p.log(`  ç²å¾—XP: ${ue.xpGained}`),ue.leveledUp&&p.log(`  ğŸ‰ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—! Lv.${ue.newLevel}`),ue.feedback.forEach(W=>{p.log(`  ${W.icon} ${W.message}`)})}return O&&R>=J.length?(p.log("ğŸ”„ è£œä¿®ãƒ¢ãƒ¼ãƒ‰: å•é¡Œã‚’ç¹°ã‚Šè¿”ã—ã¾ã™"),{..._,questions:J,currentIndex:0,answered:!1,selectedAnswer:null}):{..._,questions:J,currentIndex:R%J.length,answered:!1,selectedAnswer:null}}),Se.current=Date.now()},L=()=>{Q(_=>({..._,currentIndex:_.currentIndex>0?_.currentIndex-1:0,answered:!1,selectedAnswer:null}))},P=async()=>{const _=A.questions[A.currentIndex];if(_){const J=Date.now()-Se.current;await Xt(_.word,30),jr(_.word),await mt(_.word,!0,J,void 0,"translation"),Q(R=>({...R,score:R.score+1,totalAnswered:R.totalAnswered+1,currentIndex:(R.currentIndex+1)%R.questions.length,answered:!1,selectedAnswer:null})),Re(R=>({...R,correct:R.correct+1,mastered:R.mastered+1})),yt({status:"correct",word:_.word,timestamp:Date.now()},"translation")}else Q(J=>({...J,currentIndex:(J.currentIndex+1)%J.questions.length,answered:!1,selectedAnswer:null}));Se.current=Date.now()},ve=_=>{const J=A.questions[A.currentIndex];if(J){const R=Date.now()-Se.current;mt(J.word,A.selectedAnswer===J.meaning,R,_,"translation")}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(So,{isVisible:s,message:"èª­ã¿è¾¼ã¿ä¸­..."}),e.jsxs("div",{className:"flex gap-0 bg-gray-100 shadow-md py-1 sm:py-2",children:[e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="memorization"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("memorization"),children:"ğŸ’¡ æš—è¨˜"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="translation"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("translation"),children:"ğŸ“ å’Œè¨³"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="spelling"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("spelling"),children:"âœï¸ ã‚¹ãƒšãƒ«"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="grammar"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>{t("grammar"),n(!0),setTimeout(()=>n(!1),1500),rr()},children:"ğŸ“š æ–‡æ³•"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="reading"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>{t("reading"),n(!0),setTimeout(()=>n(!1),1500),rr()},children:"ğŸ“– é•·æ–‡"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="grammar-guide"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("grammar-guide"),children:"ğŸ”– å‚è€ƒ"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="dictionary"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("dictionary"),children:"ğŸ“• è¾æ›¸"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="stats"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("stats"),children:"ğŸ“Š æˆç¸¾"}),e.jsx("button",{className:`flex-1 py-3 sm:py-4 px-2 sm:px-3 text-sm sm:text-base font-semibold transition-all duration-200 border-b-4 ${r==="settings"?"bg-white text-blue-600 border-blue-600":"bg-blue-50 text-gray-700 border-transparent hover:bg-blue-100:bg-gray-800"}`,onClick:()=>t("settings"),children:"âš™ï¸ è¨­å®š"})]}),e.jsx(vo,{isOpen:c,onClose:()=>d(!1),sets:l.sets,onCreateSet:He,onDeleteSet:je,onEditSet:ze,onRemoveWord:Le}),e.jsx("div",{className:"p-2 md:p-6 bg-gray-50",children:e.jsx("div",{className:"max-w-app mx-auto",children:r==="memorization"?e.jsx(ho,{allQuestions:a,questionSets:$,customQuestionSets:l.sets,onAddWordToCustomSet:Ue,onRemoveWordFromCustomSet:Le,onOpenCustomSetManagement:()=>d(!0)}):r==="translation"?e.jsx(Oi,{quizState:A,_categoryList:m,selectedCategory:g,onCategoryChange:N,selectedDifficulty:b,onDifficultyChange:T,selectedWordPhraseFilter:v,onWordPhraseFilterChange:k,selectedPhraseTypeFilter:D,onPhraseTypeFilterChange:C,selectedDataSource:w,onDataSourceChange:E,questionSets:$,onStartQuiz:j,onAnswer:H,onNext:V,onPrevious:L,onSkip:P,onDifficultyRate:ve,onReviewFocus:x,sessionStats:be,isReviewFocusMode:O,errorPrediction:A.questions.length>0&&A.currentIndex<A.questions.length?Ee.current.get(A.questions[A.currentIndex].word):void 0,customQuestionSets:l.sets,onAddWordToCustomSet:Ue,onRemoveWordFromCustomSet:Le,onOpenCustomSetManagement:()=>d(!0)}):r==="spelling"?e.jsx(Fi,{questions:A.questions,_categoryList:m,selectedCategory:g,onCategoryChange:N,selectedDifficulty:b,onDifficultyChange:T,selectedWordPhraseFilter:v,onWordPhraseFilterChange:k,selectedPhraseTypeFilter:D,onPhraseTypeFilterChange:C,selectedDataSource:w,onDataSourceChange:E,onStartQuiz:j,onReviewFocus:f,isReviewFocusMode:O,customQuestionSets:l.sets,onAddWordToCustomSet:Ue,onRemoveWordFromCustomSet:Le,onOpenCustomSetManagement:()=>d(!0)}):r==="reading"?e.jsx(zr,{customQuestionSets:l.sets,onAddWordToCustomSet:Ue,onRemoveWordFromCustomSet:Le,onOpenCustomSetManagement:()=>d(!0),onSaveUnknownWords:async _=>{if(_.length===0)return;const J=new Date,F=`é•·æ–‡å˜èªé›† (${`${J.getMonth()+1}/${J.getDate()}`})`,B=prompt(`${_.length}å€‹ã®å˜èªãŒé¸æŠã•ã‚Œã¦ã„ã¾ã™ã€‚
å•é¡Œé›†ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:`,F);if(!B)return;const de={id:kt(),name:B,questions:_.map(M=>({word:M.word,reading:M.reading||"",meaning:M.meaning,etymology:M.etymology||"",relatedWords:M.relatedWords||"",relatedFields:M.relatedFields||"",difficulty:M.difficulty||"intermediate"})),createdAt:Date.now(),isBuiltIn:!1,source:"é•·æ–‡èª­è§£"},fe=[...$,de];G(fe),gr(fe),alert(`âœ… å•é¡Œé›†ã€Œ${B}ã€ã‚’ä½œæˆã—ã¾ã—ãŸï¼ˆ${_.length}èªï¼‰`)}}):r==="grammar"?e.jsx(Fr,{}):r==="grammar-guide"?e.jsx(go,{}):r==="dictionary"?e.jsx(yo,{}):r==="stats"?e.jsx(wo,{questionSets:$,allQuestions:a,categoryList:m,onResetComplete:()=>t("stats"),onQuestionSetsUpdated:$e}):e.jsx(No,{allQuestions:a,_selectedDataSource:w,_onDataSourceChange:E,customQuestionSets:l.sets,onOpenCustomSetManagement:()=>d(!0),onStartSession:(_,J)=>{Q({questions:J,currentIndex:0,score:0,totalAnswered:0,answered:!1,selectedAnswer:null}),we.current=Date.now(),Se.current=Date.now(),Ge.current=[],t("translation")}})})})]})}const Do=()=>{const r=localStorage.getItem("darkMode");let t="system";r==="system"||r==="light"||r==="dark"?t=r:r==="true"?(t="dark",localStorage.setItem("darkMode","dark")):r==="false"&&(t="light",localStorage.setItem("darkMode","light"));let s=!1;t==="system"?s=window.matchMedia("(prefers-color-scheme: dark)").matches:s=t==="dark",document.documentElement.classList.toggle("dark",s)};Do();ls.createRoot(document.getElementById("root")).render(e.jsx(Jr.StrictMode,{children:e.jsx(Co,{})}));export{hi as a,p as b,Ns as c,Kt as d,Ot as e,_t as f,Et as g,lr as h,$r as i,ur as j,Po as k,Me as l};
//# sourceMappingURL=index-BiaPVNL0.js.map
