import{B as P}from"./ScheduleStrategy-BFw-1z1Q.js";import{w as C,l as O}from"./index-DZEYaTGs.js";import"./chart-vendor-Eu4deRvW.js";import"./react-vendor-C14am9Lm.js";class V extends P{async schedule(S){const{params:r,startTime:f,dependencies:u}=S,i=u.scheduler;this.log("デフォルトモード開始",{questionCount:r.questions.length,mode:r.mode});const s=i.buildContext(r),c=i.detectSignals(s),w=i.calculatePriorities(r.questions,s,c,!1),y=i.applyAntiVibration(w,s),o=i.sortAndBalance(y,r,s),l=i.postProcess(o,s);try{const t=l.slice(0,30).map((a,I)=>{var m,h;const e=o.find(x=>x.question.word===a.word);return{word:a.word,position:(e==null?void 0:e.position)||0,category:(m=e==null?void 0:e.status)==null?void 0:m.category,attempts:((h=e==null?void 0:e.status)==null?void 0:h.attempts)||0}}),n={timestamp:new Date().toISOString(),mode:s.mode,source:"DefaultScheduleStrategy",top30:t};C("debug_postProcess_output",n,{mode:s.mode})}catch{}const d=u.antiVibration.calculateVibrationScore(o,s.recentAnswers,20),b=o.slice(0,10).map(t=>t.position),D=l.slice(0,10).map(t=>{var n;return((n=o.find(a=>a.question.word===t.word))==null?void 0:n.position)??0}),_=!b.every((t,n)=>t===D[n]),p=performance.now()-f,g={top10Words:l.slice(0,10).map(t=>t.word),top10Positions:o.slice(0,10).map(t=>({word:t.question.word,position:t.position})),orderMismatch:_};O.info("[DefaultScheduleStrategy] スケジューリング完了",{processingTime:Math.round(p)+"ms",vibrationScore:d,signalCount:c.length,resultDebug:g});try{const t=JSON.parse(localStorage.getItem("debug_scheduler_results")||"[]");t.push({timestamp:new Date().toISOString(),...g}),t.length>10&&t.shift(),localStorage.setItem("debug_scheduler_results",JSON.stringify(t))}catch{}return this.buildResult(o,{source:"DefaultScheduleStrategy",elapsed:p,vibrationScore:d,signalCount:c.length})}}export{V as DefaultScheduleStrategy};
//# sourceMappingURL=DefaultScheduleStrategy-CnBVq84Z.js.map
