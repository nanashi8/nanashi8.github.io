{"version":3,"file":"MetricsCollector-GSSz_ROG.js","sources":["../../src/ai/experiments/MetricsCollector.ts"],"sourcesContent":["/**\n * ABテストのメトリクス収集システム\n *\n * 学習効果、エンゲージメント、AI信頼度などの指標を収集・分析します。\n */\n\nexport interface MetricEvent {\n  /** イベントタイプ */\n  type: MetricEventType;\n\n  /** テストID */\n  testId: string;\n\n  /** バリアントID */\n  variantId: string;\n\n  /** イベント発生時刻 */\n  timestamp: Date;\n\n  /** イベント固有のデータ */\n  data: Record<string, any>;\n}\n\nexport type MetricEventType =\n  | 'learning_outcome'      // 学習成果\n  | 'engagement'            // エンゲージメント\n  | 'trust_rating'          // AI信頼度評価\n  | 'feature_interaction'   // 機能インタラクション\n  | 'session_duration'      // セッション時間\n  | 'completion_rate';      // 完了率\n\nexport interface LearningOutcomeData {\n  /** 単語 */\n  word: string;\n\n  /** 正誤 */\n  isCorrect: boolean;\n\n  /** 学習中かどうか */\n  isStillLearning: boolean;\n\n  /** 記憶保持率 */\n  retentionRate?: number;\n\n  /** 優先度スコア */\n  priorityScore?: number;\n}\n\nexport interface EngagementData {\n  /** アクションタイプ */\n  action: 'question_answered' | 'dashboard_viewed' | 'explanation_viewed' | 'stats_viewed';\n\n  /** セッションID */\n  sessionId: string;\n\n  /** アクション継続時間（ミリ秒） */\n  duration?: number;\n}\n\nexport interface TrustRatingData {\n  /** 評価スコア (1-5) */\n  rating: number;\n\n  /** 評価対象機能 */\n  feature: 'calibration_dashboard' | 'priority_explanation' | 'overall';\n\n  /** コメント（オプション） */\n  comment?: string;\n}\n\nexport interface FeatureInteractionData {\n  /** 機能名 */\n  feature: string;\n\n  /** インタラクションタイプ */\n  interactionType: 'click' | 'view' | 'expand' | 'collapse';\n\n  /** 要素ID */\n  elementId?: string;\n}\n\n/**\n * メトリクス集計結果\n */\nexport interface MetricsSummary {\n  /** テストID */\n  testId: string;\n\n  /** バリアント別の集計 */\n  byVariant: Record<string, VariantMetrics>;\n\n  /** 集計期間 */\n  period: {\n    start: Date;\n    end: Date;\n  };\n\n  /** 総イベント数 */\n  totalEvents: number;\n}\n\nexport interface VariantMetrics {\n  /** バリアントID */\n  variantId: string;\n\n  /** サンプル数（ユーザー数） */\n  sampleSize: number;\n\n  /** 学習成果メトリクス */\n  learningOutcome: {\n    correctRate: number;        // 正答率\n    avgRetentionRate: number;   // 平均記憶保持率\n    totalQuestions: number;     // 総問題数\n  };\n\n  /** エンゲージメントメトリクス */\n  engagement: {\n    avgSessionDuration: number;   // 平均セッション時間（秒）\n    actionsPerSession: number;    // セッションあたりのアクション数\n    featureInteractions: number;  // 機能インタラクション数\n  };\n\n  /** 信頼度メトリクス */\n  trust: {\n    avgRating: number;            // 平均評価スコア\n    ratingCount: number;          // 評価数\n  };\n}\n\nexport interface MetricsStorage {\n  logEvent(event: MetricEvent): void;\n  getEvents(testId: string, variantId?: string, startDate?: Date, endDate?: Date): MetricEvent[];\n  getEventsByType(testId: string, type: MetricEventType): MetricEvent[];\n  clearEvents(testId: string): void;\n  getAllEvents?(): MetricEvent[]; // デバッグ用（オプショナル）\n}\n\n/**\n * インメモリストレージ（テスト用）\n */\nexport function createInMemoryMetricsStorage(): MetricsStorage {\n  const events: MetricEvent[] = [];\n\n  return {\n    logEvent(event: MetricEvent): void {\n      events.push(event);\n    },\n\n    getEvents(testId: string, variantId?: string, startDate?: Date, endDate?: Date): MetricEvent[] {\n      return events.filter(e => {\n        if (e.testId !== testId) return false;\n        if (variantId && e.variantId !== variantId) return false;\n        if (startDate && e.timestamp < startDate) return false;\n        if (endDate && e.timestamp > endDate) return false;\n        return true;\n      });\n    },\n\n    getEventsByType(testId: string, type: MetricEventType): MetricEvent[] {\n      return events.filter(e => e.testId === testId && e.type === type);\n    },\n\n    clearEvents(testId: string): void {\n      const filtered = events.filter(e => e.testId !== testId);\n      events.length = 0;\n      events.push(...filtered);\n    },\n\n    getAllEvents(): MetricEvent[] {\n      return [...events];\n    }\n  };\n}\n\n/**\n * メトリクスコレクター\n */\nexport class MetricsCollector {\n  private storage: MetricsStorage;\n\n  constructor(storage: MetricsStorage) {\n    this.storage = storage;\n  }\n\n  /**\n   * 学習成果イベントを記録\n   */\n  logLearningOutcome(\n    testId: string,\n    variantId: string,\n    data: LearningOutcomeData\n  ): void {\n    this.storage.logEvent({\n      type: 'learning_outcome',\n      testId,\n      variantId,\n      timestamp: new Date(),\n      data\n    });\n  }\n\n  /**\n   * エンゲージメントイベントを記録\n   */\n  logEngagement(\n    testId: string,\n    variantId: string,\n    data: EngagementData\n  ): void {\n    this.storage.logEvent({\n      type: 'engagement',\n      testId,\n      variantId,\n      timestamp: new Date(),\n      data\n    });\n  }\n\n  /**\n   * 信頼度評価を記録\n   */\n  logTrustRating(\n    testId: string,\n    variantId: string,\n    data: TrustRatingData\n  ): void {\n    this.storage.logEvent({\n      type: 'trust_rating',\n      testId,\n      variantId,\n      timestamp: new Date(),\n      data\n    });\n  }\n\n  /**\n   * 機能インタラクションを記録\n   */\n  logFeatureInteraction(\n    testId: string,\n    variantId: string,\n    data: FeatureInteractionData\n  ): void {\n    this.storage.logEvent({\n      type: 'feature_interaction',\n      testId,\n      variantId,\n      timestamp: new Date(),\n      data\n    });\n  }\n\n  /**\n   * メトリクスを集計\n   */\n  summarize(testId: string, startDate?: Date, endDate?: Date): MetricsSummary {\n    const events = this.storage.getEvents(testId, undefined, startDate, endDate);\n\n    if (events.length === 0) {\n      return {\n        testId,\n        byVariant: {},\n        period: {\n          start: startDate || new Date(),\n          end: endDate || new Date()\n        },\n        totalEvents: 0\n      };\n    }\n\n    // バリアント別にグループ化\n    const variantGroups = new Map<string, MetricEvent[]>();\n    for (const event of events) {\n      if (!variantGroups.has(event.variantId)) {\n        variantGroups.set(event.variantId, []);\n      }\n      variantGroups.get(event.variantId)!.push(event);\n    }\n\n    // 各バリアントのメトリクスを計算\n    const byVariant: Record<string, VariantMetrics> = {};\n\n    for (const [variantId, variantEvents] of variantGroups) {\n      byVariant[variantId] = this.calculateVariantMetrics(variantId, variantEvents);\n    }\n\n    return {\n      testId,\n      byVariant,\n      period: {\n        start: startDate || events[0].timestamp,\n        end: endDate || events[events.length - 1].timestamp\n      },\n      totalEvents: events.length\n    };\n  }\n\n  /**\n   * バリアント別メトリクスを計算\n   */\n  private calculateVariantMetrics(variantId: string, events: MetricEvent[]): VariantMetrics {\n    const learningEvents = events.filter(e => e.type === 'learning_outcome');\n    const engagementEvents = events.filter(e => e.type === 'engagement');\n    const trustEvents = events.filter(e => e.type === 'trust_rating');\n    const interactionEvents = events.filter(e => e.type === 'feature_interaction');\n\n    // 学習成果メトリクス\n    const correctCount = learningEvents.filter(e => e.data.isCorrect).length;\n    const totalQuestions = learningEvents.length;\n    const correctRate = totalQuestions > 0 ? correctCount / totalQuestions : 0;\n\n    const retentionRates = learningEvents\n      .map(e => e.data.retentionRate)\n      .filter((r): r is number => typeof r === 'number');\n    const avgRetentionRate = retentionRates.length > 0\n      ? retentionRates.reduce((sum, r) => sum + r, 0) / retentionRates.length\n      : 0;\n\n    // エンゲージメントメトリクス\n    const sessionIds = new Set(\n      engagementEvents.map(e => e.data.sessionId).filter(Boolean)\n    );\n    const sampleSize = sessionIds.size || 1; // 最低1と仮定\n\n    const sessionDurations = engagementEvents\n      .filter(e => e.data.action === 'question_answered')\n      .map(e => e.data.duration)\n      .filter((d): d is number => typeof d === 'number');\n    const avgSessionDuration = sessionDurations.length > 0\n      ? sessionDurations.reduce((sum, d) => sum + d, 0) / sessionDurations.length / 1000\n      : 0;\n\n    const actionsPerSession = engagementEvents.length / sampleSize;\n\n    // 信頼度メトリクス\n    const ratings = trustEvents.map(e => e.data.rating);\n    const avgRating = ratings.length > 0\n      ? ratings.reduce((sum, r) => sum + r, 0) / ratings.length\n      : 0;\n\n    return {\n      variantId,\n      sampleSize,\n      learningOutcome: {\n        correctRate,\n        avgRetentionRate,\n        totalQuestions\n      },\n      engagement: {\n        avgSessionDuration,\n        actionsPerSession,\n        featureInteractions: interactionEvents.length\n      },\n      trust: {\n        avgRating,\n        ratingCount: ratings.length\n      }\n    };\n  }\n\n  /**\n   * 統計的有意差を検定（簡易的なt検定）\n   */\n  compareVariants(\n    testId: string,\n    variantId1: string,\n    variantId2: string,\n    metric: 'correctRate' | 'avgRetentionRate' | 'avgRating'\n  ): ComparisonResult {\n    const summary = this.summarize(testId);\n    const variant1 = summary.byVariant[variantId1];\n    const variant2 = summary.byVariant[variantId2];\n\n    if (!variant1 || !variant2) {\n      throw new Error('Variant not found');\n    }\n\n    let value1: number, value2: number;\n    let n1: number, n2: number;\n\n    switch (metric) {\n      case 'correctRate':\n        value1 = variant1.learningOutcome.correctRate;\n        value2 = variant2.learningOutcome.correctRate;\n        n1 = variant1.learningOutcome.totalQuestions;\n        n2 = variant2.learningOutcome.totalQuestions;\n        break;\n      case 'avgRetentionRate':\n        value1 = variant1.learningOutcome.avgRetentionRate;\n        value2 = variant2.learningOutcome.avgRetentionRate;\n        n1 = variant1.learningOutcome.totalQuestions;\n        n2 = variant2.learningOutcome.totalQuestions;\n        break;\n      case 'avgRating':\n        value1 = variant1.trust.avgRating;\n        value2 = variant2.trust.avgRating;\n        n1 = variant1.trust.ratingCount;\n        n2 = variant2.trust.ratingCount;\n        break;\n    }\n\n    const diff = value1 - value2;\n    const relativeDiff = value2 !== 0 ? (diff / value2) * 100 : 0;\n\n    // 簡易的な有意性判定（サンプルサイズと差の大きさから）\n    const minSampleSize = Math.min(n1, n2);\n    const isSignificant = minSampleSize >= 30 && Math.abs(relativeDiff) > 5;\n\n    return {\n      variant1: { id: variantId1, value: value1, sampleSize: n1 },\n      variant2: { id: variantId2, value: value2, sampleSize: n2 },\n      difference: diff,\n      relativeDifference: relativeDiff,\n      isSignificant,\n      confidence: this.calculateConfidence(minSampleSize, Math.abs(relativeDiff))\n    };\n  }\n\n  /**\n   * 信頼度を計算（簡易版）\n   */\n  private calculateConfidence(sampleSize: number, relativeDiff: number): number {\n    if (sampleSize < 30) return 0;\n    if (sampleSize >= 100 && relativeDiff >= 10) return 0.95;\n    if (sampleSize >= 50 && relativeDiff >= 5) return 0.90;\n    if (sampleSize >= 30 && relativeDiff >= 5) return 0.80;\n    return 0.50;\n  }\n}\n\nexport interface ComparisonResult {\n  variant1: { id: string; value: number; sampleSize: number };\n  variant2: { id: string; value: number; sampleSize: number };\n  difference: number;\n  relativeDifference: number;\n  isSignificant: boolean;\n  confidence: number;\n}\n\n/**\n * グローバルメトリクスコレクターのインスタンス\n */\nlet globalMetricsCollector: MetricsCollector | null = null;\n\nexport function getMetricsCollector(): MetricsCollector {\n  if (!globalMetricsCollector) {\n    // 本番環境ではlocalStorageベースのストレージを使用\n    const storage: MetricsStorage = {\n      logEvent(event: MetricEvent): void {\n        const key = `ab_test_metrics_${event.testId}`;\n        const existing = localStorage.getItem(key);\n        const events: MetricEvent[] = existing ? JSON.parse(existing) : [];\n\n        events.push({\n          ...event,\n          timestamp: event.timestamp.toISOString() as any\n        });\n\n        // 最大10,000イベントまで保持\n        if (events.length > 10000) {\n          events.splice(0, events.length - 10000);\n        }\n\n        localStorage.setItem(key, JSON.stringify(events));\n      },\n\n      getEvents(testId: string, variantId?: string, startDate?: Date, endDate?: Date): MetricEvent[] {\n        const key = `ab_test_metrics_${testId}`;\n        const data = localStorage.getItem(key);\n        if (!data) return [];\n\n        const events: MetricEvent[] = JSON.parse(data).map((e: any) => ({\n          ...e,\n          timestamp: new Date(e.timestamp)\n        }));\n\n        return events.filter(e => {\n          if (variantId && e.variantId !== variantId) return false;\n          if (startDate && e.timestamp < startDate) return false;\n          if (endDate && e.timestamp > endDate) return false;\n          return true;\n        });\n      },\n\n      getEventsByType(testId: string, type: MetricEventType): MetricEvent[] {\n        const key = `ab_test_metrics_${testId}`;\n        const data = localStorage.getItem(key);\n        if (!data) return [];\n\n        const events: MetricEvent[] = JSON.parse(data).map((e: any) => ({\n          ...e,\n          timestamp: new Date(e.timestamp)\n        }));\n\n        return events.filter(e => e.type === type);\n      },\n\n      clearEvents(testId: string): void {\n        const key = `ab_test_metrics_${testId}`;\n        localStorage.removeItem(key);\n      }\n    };\n\n    globalMetricsCollector = new MetricsCollector(storage);\n  }\n\n  return globalMetricsCollector;\n}\n\nexport function resetMetricsCollector(): void {\n  globalMetricsCollector = null;\n}\n"],"names":["MetricsCollector","storage","__publicField","testId","variantId","data","startDate","endDate","events","variantGroups","event","byVariant","variantEvents","learningEvents","e","engagementEvents","trustEvents","interactionEvents","correctCount","totalQuestions","correctRate","retentionRates","r","avgRetentionRate","sum","sampleSize","sessionDurations","d","avgSessionDuration","actionsPerSession","ratings","avgRating","variantId1","variantId2","metric","summary","variant1","variant2","value1","value2","n1","n2","diff","relativeDiff","minSampleSize","isSignificant","globalMetricsCollector","getMetricsCollector","key","existing","type"],"mappings":"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"}