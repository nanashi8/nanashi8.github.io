#!/bin/sh

echo "🚀 Pre-push チェック開始..."

# 1. 煙テスト（Smoke Test）を実行
echo "🔥 煙テスト実行中..."
npm run test:smoke || {
  echo "❌ 煙テストに失敗しました"
  echo "💡 基本機能が壊れている可能性があります"
  echo "💡 プッシュを中止する場合は Ctrl+C を押してください"
  echo "💡 強制的にプッシュする場合は git push --no-verify を使用してください"
  
  # 10秒待機して、ユーザーが中断できるようにする
  echo "⏱️  10秒後に自動的にプッシュが中止されます..."
  sleep 10
  exit 1
}

echo "✨ すべてのチェックが完了しました！プッシュを続行します"
